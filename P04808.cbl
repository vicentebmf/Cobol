DOCINI****P* ENTCOB_BATCH_DB2/P04808
DOCTXT* NOME
DOCTXT*   P04808 - Programa de atualizacao de contas correntes do BNB.
DOCTXT* OBJETIVO
DOCTXT*   Atualiza as contas do BNB com base nas movimentacoes do dia.
DOCTXT*   Este programa eh responsavel por atualizar os saldos de contas
DOCTXT*   levando em consideracao os produtos oferecidos. Os produtos p
DOCTXT*   definicao sao os tres primeiros. Os posteriores sao derivacoes
DOCTXT*   e situacoes especificas de saldo. Os produtos sao:
DOCTXT*   * Cheque Especial   - Limite para pessoas fisicas;
DOCTXT*   * Cheque Empresa    - Limite para pessoas juridicas de menor
DOCTXT*                       porte;
DOCTXT*   * Conta Empresarial - Limite para pessoas juridicas de maior
DOCTXT*                         porte;
DOCTXT*   * Adt. Depositante  - Manobra contabil para clientes sem
DOCTXT*                         contrato de limite de credito;
DOCTXT*   * Exc. sobre limite - Acontece quando a conta usa um limite
DOCTXT*                           superior ao contratado.
DOCTXT*   Este programa tambem eh responsavel por realizar calculos de
DOCTXT*   juros (em algumas situacoes), IOF, bem como das devolucoes
DOCTXT*   destes encargos quando da situacao de devolucao de cheques.
DOCTXT* ENTRADAS
DOCTXT*   O programa espera as seguintes entradas de dados:
DOCTXT*   * D091.BANCO.DADOS.TABELAS - Arquivo contendo tabela de ag.,
DOCTXT*         indices, moedas, feriados. Contem tabelas comuns.
DOCTXT*   * D048.CONTA.EXTRATO.MENSAL.EX - Extrato mensal. Serve para
DOCTXT*        consultar se houve alguns tipos de historicos no mes
DOCTXT*        anterior
DOCTXT*   * D159.INTERFAC.SEDE.S924 - Arquivo contem dados historicos,
DOCTXT*        nao eh mais usado.
DOCTXT*   * D159.SALDOS.POUPCTA.TOTAL.X - Contem os saldos do S159;
DOCTXT*   * D302.A020.CONTA.CORRENTE - Contem os beneficiarios do INSS;
DOCTXT*   * D270.A2028.SALDOS.MEDIOS.X - Saldos medios mensais do S270;
DOCTXT*   * D493.SALDO.MEDIO.CLIENTE.EX - Saldos medios mensais do S493
DOCTXT*   * D159.SALDOS.MEDIOS - Saldos medios do S159;
DOCTXT*   * D194.SALDOS.MEDIOS - Saldos medios do S194/S410;
DOCTXT*   * W048.MOVIM.JUNTADO - Movimentos no layout B04807X contendo
DOCTXT*        transacoes bancarias (debito, credito, contratacao chq
DOCTXT*        etc.)
DOCTXT*   * D493.CARTCLI.HOME.BANKING.EX - Contem saldos de aplicacoes
DOCTXT*        do S860
DOCTXT*   * D048.CONTROLE.PERSONA.CHEQUES - Controle de personalizacao
DOCTXT*        de cheques.
DOCTXT*   * D048.CONTAS.CANCELA.X - Registro de contas canceladas.
DOCTXT*   * D270.SALDOS.CLIENTES.FUNDOS.X - Saldos de fundos de
DOCTXT*        investimentos
DOCTXT*   * D048.DIRETOR.CADASTRO.CORRE.EX - Diretorio de agencias do
DOCTXT*        S048. Contem as datas de procesamento das agencias.
DOCTXT*   * D048.CADASTRO.CORRENTE.ANTE.EX - Arquivo de contas. CONTEM
DOCTXT*        extratos e registros de correntistas conforme ultima
DOCTXT*        atualizacao. Serve de base para a atualizacao de saldo.
DOCTXT*   * D048.CADASTRO.CORRENTE.ATUAL.EX - Sera atualizado e contera
DOCTXT*       os extratos e contas atualizados ao final da rotina.
DOCTXT*
DOCTXT* SAIDAS
DOCTXT*   Este programa gera as seguintes sa?das:
DOCTXT*   * W048.RENOV.AUTOMAT - Arquivo de interface com o banco 24
DOCTXT*        horas. Contem informacoes relativas a cadastro de contas
DOCTXT*        emprestimos, senhas, etc.
DOCTXT*   * W048.OCORR.CTASIMPL - Contem as ocorrencias relativas a
DOCTXT*        contas simplificadas como data de bloqueio/desbloqueio..
DOCTXT*   * W048.OCORR.ATUAL.CORRENTE - Arquivo de ocorrencias do
DOCTXT*        processo de atualizacao. Erros de cadastro, insuf.
DOCTXT*        de fundos, excesso sobre limites, etc...
DOCTXT*   * W048.COPIA.MESTRE.CORRENTE - Uma copia do arquivo D04809 no
DOCTXT*        formato B04811X para ser usado rapidamente nos processos
DOCTXT*        subsequentes.
DOCTXT*        ARQUIVO EM DISCO CONTENDO TODAS
DOCTXT*        AS OCORRENCIAS DECORRENTES   DA
DOCTXT*        MOVIMENTACAO.
DOCTXT*   * W048.EVENTOS.RENDAS - Movimento destinado ao SEDE relativo
DOCTXT*        aos eventos de rendas (efetiva/a apropriar).
DOCTXT*        ARQUIVO CONTENDO CONTABILIZACOES
DOCTXT*        RELATIVAS A EFETIVACAO DE RAP -
DOCTXT*        RESOLUCAO 2682
DOCTXT*   * W048.D%%OYMD3.ESTORNO.JUROS.IOF - Arquivo contendo
DOCTXT*       transacoes de estorno de encargos para ser processado no
DOCTXT*       proximo dia util.
DOCTXT* FLUXO
DOCTXT*   Sequencia macro de passos do programa.
DOCTXT*
DOCTXT*                          +-----------+
DOCTXT*                          |00-CONTROLE|
DOCTXT*                          +-----------+
DOCTXT*                                |
DOCTXT*                      +---------------------+
DOCTXT*                      |35-PROCESSA-AGENCIA  |
DOCTXT*                      |Ate FIM-PROCESSAMENTO|
DOCTXT*                      +---------------------+
DOCTXT*                                |
DOCTXT*                      +---------------------+ If D04808 < D04807
DOCTXT*                      | 35-32-BALANCE-LINE  |   Chave = D04808
DOCTXT*                      +---------------------+ Else
DOCTXT*                                |               Chave = D04807
DOCTXT*                                |
DOCTXT*                     +-----------------------+
DOCTXT*                     | 35-35-SELECIONA-PERNA |
DOCTXT*                     +-----------------------+
DOCTXT*                    /            |           \
DOCTXT*                   /             |            \
DOCTXT*                1 /             2|            3\
DOCTXT*                 /               |              \
DOCTXT*                /                |               \
DOCTXT*               /                 |                \
DOCTXT*    +----------------+  +---------------+  +--------------------+
DOCTXT*    |40-35-PERNA-F10 |  |70-35-PERNA-D07|  |38-35-PERNA-GRAVACAO|
DOCTXT*    +----------------+  +---------------+  +--------------------+
DOCTXT*    Leitura do D04808    Processamento de   Gravacao da conta
DOCTXT*    contendo informacao  transacoes.        atualizada.
DOCTXT*    da conta conforme          ||
DOCTXT*    ultima atualizacao         || A depender da existencia
DOCTXT*                               /\ da conta.
DOCTXT*                              /  \
DOCTXT*                             /    \
DOCTXT*                            /      \
DOCTXT*           +-----------------+      +--------------+ Gravacao de
DOCTXT*           |75-35-ATUALIZACAO|      |78-35-INCLUSAO| contas a
DOCTXT*           +-----------------+      +--------------+ classificar
DOCTXT*                            \       /
DOCTXT*                             \     /
DOCTXT*                       +------------------+
DOCTXT*                       |220-35-LEITURA-D07|
DOCTXT*                       +------------------+
DOCTXT*
DOCTXT*
DOCTXT* OBSERVACOES
DOCTXT*   A data de processamento nao e passada por parametro.
DOCTXT*   Este programa espera que a data do movimento seja a data sendo
DOCTXT*   processada. Caso o movimento tenha data futura, o programa
DOCTXT*   nao ira falhar e assumirah a data como corrente, atualizando
DOCTXT*   as agencias com aquela data.
DOCEND******
000040 IDENTIFICATION DIVISION.                                         0000040
000060*-----------------------------------------------------------------00000060
000080  PROGRAM-ID.    P04808.                                          00000080
000100  AUTHOR.        ALDI  - COD 050                                  00000100
000110                 JAYME - COD 023-COORDENADOR.                     00000110
000130* DATE-WRITTEN. -INICIO ESTRUTURA LOGICA      19.06.79            00000130
000140*               -TERMINO CODIFICACAO          31.08.79            00000140
000150*               -ELIMINACAO ERROS COMPILACAO  14.09.79            00000150
000160*               -DEPURACAO                                        00000160
000170*               -ENTRADA EM OPERACAO                              00000170
000180*PROGRAMA COM TODAS ALTERACOES                                    00000180
000220*               -OBJETIVO                                         00000220
000230*                  -ATUALIZAR O ARQUIVO MESTRE DO SISTEMA,        00000230
000240*                   GERANDO, INCLUSIVE, UM ARQUIVO DE OCOR-       00000240
000250*                   RENCIAS.                                      00000250
000260*                                                                 00000260
000270*               -ARQUIVO E DADOS DE ENTRADA                       00000270
000280*                  -ArqContasBase MESTRE ANTERIOR DO SISTEMA,     00000280
000290*                          CONTENDO OS DADOS A SEREM ATUALIZA-    00000290
000300*                          DOS.                                   00000300
000310*                                                                 00000310
000320*                  -D04807 ARQUIVO DE MOVIMENTOS CONTENDO         00000320
000330*                          OS DADOS A PARTIR DOS QUAIS   A        00000330
000340*                          MESTRE ANTERIOR SERA ATUALIZADA.       00000340
000350*                                                                 00000350
000360*               -ARQUIVO E DADOS DE SAIDA                         00000360
000370*                  -ArqContasUpdate MESTRE ATUALIZADA.(DISCO)     00000370
000380*                                                                 00000380
000390*                  -D04811 COPIA DA MESTRE ATUALIZADA. EH         00000390
000400*                   DELETADO APOS CADA PROCESSAMENTO.             00000400
000490*                                                                 00000490
000500*                  -D04807B ESTORNO JUR-IOF DEVOL                 00000500
000510*                                                                 00000510
000520*                  -D12802 ARQUIVO EM DISCO CONTENDO MOVIMENTACAO 00000520
000530*                          DIARIA (EXTRATOS TELEX).               00000530
000540*                                                                 00000540
000550*               -ARQUIVOS DE ENTRADA-SAIDA.                       00000550
000560*             -ArqAgencias DIRETORIO DA MESTRE, CONTEM INFORMACOES00000560
000570*                          SOBRE A MESTRE ANTERIOR E A MESTRE     00000570
000580*                           ATUAL.                                00000580
000590*                                                                 00000590
000600*                  -D04819 ARQUIVO DE CONTROLE DE PERSONALIZACAO  00000600
000610*                          DE CHEQUES.                            00000610
000620*                                                                 00000620
000630*               OBS1:O PROGRAMA ESTAH PREPARADO PARA CALCU        00000630
000640*                    LAR CORRECAO MONETARIA (VARIACAO   DA        00000640
000650*                    ORTN) SOBRE SALDOS DEVEDORES  DO  CON        00000650
000660*                    TERRANEO, PARA TANTO, DEVERAO SER ATI        00000660
000670*                    VADA AS ROTINAS 086-35-CRITICA-VALOR-        00000670
000680*                    ORTN E 800-15-TESTA-VENCIMENTO.              00000680
000690*                                                                 00000690
000700*          OBS2:AS MESTRES ArqContasBase E ArqContasUpdate FO-    00000700
000710*                    RAM ADAPTADAS PARA DISCO, SEUS REGIS-        00000710
000720*                    TROS SAO VARIAVEIS.                          00000720
000730*                                                                 00000730
000740*               OBS3:AUTOMATIZACAO DE PEDIDOS DE TALONARIOS       00000740
000750*                    IMPLANTADO EM 03.05.91                       00000750
000760*                                                                 00000760
000770*               OBS4:ENCARGOS DIFERENCIADOS-GECRE-DINOR-91/49,    00000770
000780*                    DE 09.05.91 - JESUS SOARES DA FONSECA.       00000780
000790*               OBS5:INCLUSAO CARTAO APOS 515300 PERFORM 999-31-  00000790
000800*                    LIMPA-TAB-MOVTOS 700 TIMES.                  00000800
000810*    ......................................                       00000810
000820*               NOTA1 - INCLUSAO DE NOVAS TAXAS DE IOC COM CALCU- 00000820
000830*                       LO DIFERENCIADO PARA PES.FISICAS E JURIDI-00000830
000840*                       CAS, CFE. TELEX-DEBAN-DIPOP-91/007, DE 18 00000840
000850*                       11/91. FEITA POR JESUS SOARES DA FONSECA. 00000850
000860*               NOTA2 - IPMF E AUTOMATIZACAO DE PEDIDOS DE TALONA-00000860
000870*                       RIO DO CHEQUE-TB (TRANSFERENCIA BANCARIA),00000870
000880*                       CFE. DESEB-DITES-93/    , DE 10/08/93,FEI-00000880
000890*                       TA POR JESUS SOARES DA FONSECA.           00000890
000900*               NOTA3 - SPREAD - CALCULO DO FATOR DIARIO DO SPREAD00000900
000910*                       A PARTIR DA TAXA CADASTRADA PELAS AGENCIAS00000910
000920*                       NAS CONTAS INDIVIDUAIS. NOVEMBRO/93,  FEI-00000920
000930*                       TA POR JESUS SOARES DA FONSECA.           00000930
000940*                                                                 00000940
000950*               OBS6:INIBIDO NOS PARAGRAFOS 999-96-VALIDA-DOC E 9900000950
000960*               9-96-VALIDA-RG OS ACESSOS AO PARAGRAFO 999-96-VER-00000960
000970*               CARACTER. ALTERACAO FEITA POR KLEBER VIDAL EM: 08.00000970
000980*               02.2006.                                          00000980
000990*                                                                 00000990
000990*-----------------------------------------------------------------00000990
000190* REMARKS.    *** ALTERADO POR ELVIRA  PROJETO ANO 2000  ***      00000190
000200*               -SISTEMA 048-CONTAS CORRENTES-CONTERRANEO.        00000200
000210*                                                                 00000210
001020* FOI IMPLEMENTADO POR KLEBER VIDAL EM 05.02.2005, O CALCU        00001020
001030* LO DIFERENCIADO DOS JUROS DO CHEQUE ESPECIAL, PARA CLIEN        00001030
001040* TES COM APLICACAO FINANCEIRA.                                   00001040
001050* RCP-MAIO/2006 - SUBSTITUICAO DO BOOK B04896 PELA TABELA V048NMCT00001050
001060* LCVM-AGO/2006  - GSOL00085588 REGRAS RENOVACAO CHEQUE ESPECIAL  00001060
001070* ERIKA-FEV/2007 - GSOL00093546 REGRAS RENOVACAO CHEQUE ESPECIAL  00001070
001080*                                                                 00001080
001090* ALTERADO EM 13/11/2007 GSOL00156103 - INCLUIR CO-TITULAR        00001090
001100*                                                                 00001100
001110* 01/04/2008 - GSOL00179016 -  ANALISTA: ELVIRA   - DESENV.: BOSSA00001110
001120*              NOVO MODELO DE COBRANCA DE TARIFAS.                00001120
001130*                                                                 00001130
001140* 30/12/2008 - GSOL00229193 -  ANALISTA: REGINA   - DESENV.: BOSSA00001140
001150*              CRIACAO FUNDO 40.                                  00001150
001160*                                                                 00001160
001140* 04/05/2009 - GSOL00201049 -  ANALISTA: REGINA                   00001140
001150*              ALTERACAO NO CALCULO DO IOF NORMAL E ADICIONAL     00001150
001160*                                                                 00001160
001140* 20/05/2009 - GSOL00267742 -  ANALISTA: REGINA                   00001140
001150*              CRIACAO FUNDO 41(CONTA 29546)                      00001150
      *
      * 24/07/2009 - GSOL00274968 - ANALISTA: REGINA
      *              COBRANCA DE TARIFAS
001160*                                                                 00001160
001140* 25/08/2009 - GSOL00290818 - DESENVOLVEDOR: CARLOS VENICIO       00001140
001150*              CRIACAO FUNDO 42(CONTA 32178)                      00001150
001160*                                                                 00001160
001140* 08/01/2010 - GSOL00317898 - REGINA CELI PAZ                     00001140
001150*              ALTERAR O NUMERO DE OCORRENCIAS DO TAB-MOVTOS      00001150
      *
      * 25/01/2010 - GSOL00312167 - ELVIRA / ALBERTO / BOSSA
      *              CRIACAO DA CONTA DE DEPOSITOS JUDICIAIS
      *              E NAO ACEITAR TIPO PESSOA = N.
      *
      * 24/06/2010 - GSOL00357160 - REGINA CELI PAZ
      *              INCLUSAO DO ACESSO DA V048HIST
      *              INCLUSAO DO TESTE DO CAMPO GP_FBB E CH-HIST-D07
      *              NO PARAGRAFO 155-35-REG7-ATL-CORRENTISTA


      * 02/08/2010 - GSOL00293313 - REGINA CELI PAZ
      *              ACERTO NO CALCULO DO IOF
001170*-----------------------------------------------------------------00001170
      * 26/10/2010 - GSOL00384693 - REMUNERACAO DIARIA CONTA JUDICIAL
      *                             CONVENIO TRIBUNAL DE JUSTICA.
001170*-----------------------------------------------------------------00001170
      * 27/05/2011 - GSOL00444184 - REGINA CELI PAZ
      *              ALTERACAO NA FORMA DE DEBITO DE IOF S/OPERACOES
      *              INADIMPLENTES
001170*-----------------------------------------------------------------00001170
      * 21/06/2011 - GSOL00449389 - REGINA CELI PAZ
      *              CHEQUE EMPRESA
      * 05/07/2011   INCLUIR O PARAGRAFO 999-64-CALC-DIA-UTIL-ANT
      *----------------------------------------------------------------*
      * 09/09/2011 - REGINA CELI PAZ
      *              GSOL00470251 - GSOL00470297 - EXPANSAO S048
001170*-----------------------------------------------------------------00001170
100112* 10/01/2012 - GSOL00493794/GSOL00494853 - FCO.CARLOS
100112*              INCLUIR TIPO CONTABIL 31 E 33 (PRECATORIO)
      *----------------------------------------------------------------*
      * 25/01/2012 - GSOL00508316 - REGINA CELI PAZ
      *              NOVO PRODUTO DE FUNDO DE INVESTIMENTO
001170*-----------------------------------------------------------------00001170
      * 27/03/2012 - BOSSA
      *              GSOL00523958 - GSOL00524437 - EXPANSAO S048
      *              AJUSTE P04808 (garantia da ospp GSOL00470251)
      *-----------------------------------------------------------------
      * 03/10/2012 - GSOL00578005                                       12122011
      *            - OBJETIVO - ADEQUAR O SISTEMA DE CONTA-CORRENTE AOS 12122011
      *              NOVOS PACOTES DE TARIFAS.                          12122011
001170*-----------------------------------------------------------------00001170
250412* 25/04/2012 - BOSSA                                               250412
250412*              GSOL00532844 - GSOL00532858 - EXPANSAO S048         250412
250412*              AJUSTE P04808 (garantia da ospp GSOL00470251)       250412
      *-----------------------------------------------------------------
250412* 17/05/2012 - CARLOS VENICIO                                      250412
250412*              GSOL00532844 - GSOL00532858 - EXPANSAO S048         250412
250412*              AJUSTE P04808 (garantia da ospp GSOL00470251)       250412
      *              INICIALIZAR CAMPO C-CC-NOME-MENS-D10
      *-----------------------------------------------------------------
250412* 29/08/2012 - REGINA CELI PAZ                                     250412
250412*              GSOL00570638 - GSOL00570725 - EXPANSAO S048         250412
250412*              INCLUIR A ROTINA 99-ZERA-EXT-MOVIMENTOS-D10 E       250412
250412*              INICIALIZAR O REGISTRO REG-EXTRATO-D10              250412
      *-----------------------------------------------------------------
250412* 05/02/2013 - MARGARETH LOURENCO (MG1)                          *
250412*              GSOL00621633 - GSOL00621863                       *
250412*              ATENDIMENTO DA DEMANDA: GSOL00621534              *
250412*              EXCLUSAO DE RESTRICAO S048                        *
      *                  CPF.                                          *
      *                  '000001581473834',                            *
      *                  '000000177377372',                            *
      *                  '000002291860330',                            *
      *                  '000027493040753',                            *
      *                  '000010078533520',                            *
      *----------------------------------------------------------------*
250412* 18/02/2013 - GSOL00618469 - SUBTRATACAO DE NUMEROS DE IOF  DE  *
250412*                             INSUFICIENCIA DE FUNDOS.           *
      *----------------------------------------------------------------*
250412* 03/07/2013 - GSOL00637354 - AJUSTE NO CALCULO DE JUROS E IOF   *
250412*                             QUANDO DA DEVOLUCAO A CREDITO.     *
      *----------------------------------------------------------------*
      * 14/11/2013 - GSOL00718526 -  REGINA CELI PAZ
      *              CRIACAO FUNDO 51(CONTA 19954).
      *----------------------------------------------------------------*
      * 11/12/2013 - GSOL00726413 -  REGINA CELI PAZ
      *              CRIACAO FUNDO 52(CONTA 39486).
      *              CRIACAO FUNDO 53(CONTA 39496).
      *              CRIACAO FUNDO 54(CONTA 39497).
      *-----------------------------------------------------------------
      * 06/10/2015 - GSOL00950038 - CARLOS VENICIO                      00001140
      *              FUNDOS DE INVESTIMENTO                             00001150
      *----------------------------------------------------------------*
      * 16/11/2015 - GSOL00961060 - D000846 - REMOVER PEDIDO AUTOMATICO
      *              DE TALONARIO DE CHEQUE NO CADASTRO DE CONTAS NOVAS.
      *----------------------------------------------------------------*
      * 07/03/2016 - GSOL00993382 - D000846 - TRATAR A POSSIBILIDADE DE*
      *              ANO BISSEXTO NOS VENCIMENTOS DE CONTRATO.         *
      *NAO INSERIR HISTORICO AQUI, COMENTAR DEVIDAMENTE NA ENTREGA VIA *
      *FERRAMENTA DE CONTROLE DE VERSAO.                               *
      *----------------------------------------------------------------*
001210 ENVIRONMENT DIVISION.                                            00001210
001230*-----------------------------------------------------------------00001230
001250  CONFIGURATION SECTION.                                          00001250
001260                                                                  00001260
001270   SPECIAL-NAMES.                                                 00001270
001280     DECIMAL-POINT IS COMMA.                                      00001280
001290                                                                  00001290
001300  INPUT-OUTPUT SECTION.                                           00001300
001310                                                                  00001310
001320   FILE-CONTROL.                                                  00001320
001330                                                                  00001330
001340     SELECT ArqContasBase ASSIGN TO DA-D04808                     00001340
001350             ORGANIZATION IS INDEXED                              00001350
001360             ACCESS MODE  IS DYNAMIC                              00001360
001370             RECORD KEY   IS Chave-ArqContasBase                  00001370
001380             PASSWORD     IS Senha-ArqContasBase-WS               00001380
001390             FILE STATUS  IS FS-ArqContasBase.                    00001390
001400                                                                  00001400
001410     SELECT D04807   ASSIGN TO UT-S-D04807.                       00001410
001420     SELECT D0480701 ASSIGN TO UT-S-D0480701.                     00001420
001430     SELECT D04810S  ASSIGN TO UT-S-D04810S.                      00001430
001440                                                                  00001440
001450     SELECT ArqContasUpdate                                       00001450
001460             ASSIGN TO DA-D04809                                  00001460
001470             ORGANIZATION IS INDEXED                              00001470
001480             ACCESS MODE  IS SEQUENTIAL                           00001480
001490             RECORD KEY   IS CHAVE-ARQ-UPDT                       00001490
001500             PASSWORD     IS SENHA-ARQ-UPDT-WS                    00001500
001510             FILE STATUS  IS STATUS-ARQ-UPDT-WS.                  00001510
001520                                                                  00001520
001530     SELECT D04811 ASSIGN  TO UT-S-D04811                         00001530
001540            FILE STATUS    IS STATUS-D811-WS.                     00001540
001550                                                                  00001550
001560     SELECT D04810 ASSIGN  TO UT-S-D04810.                        00001560
001570     SELECT D04883 ASSIGN  TO UT-S-D04883.                        00001570
001580     SELECT D04807B ASSIGN TO UT-S-D04807B                        00001580
001540            FILE STATUS    IS FS-D07B.                            00001540
001660                                                                  00001660
001600     SELECT ArqAgencias ASSIGN TO DA-D04804                       00001600
001610            ORGANIZATION IS INDEXED                               00001610
001620            ACCESS MODE  IS DYNAMIC                               00001620
001630            RECORD KEY   IS COD-AG-D04                            00001630
001640            PASSWORD     IS SENHA-D04-WS                          00001640
001650            FILE STATUS  IS STATUS-D04-WS.                        00001650
001660                                                                  00001660
001670     SELECT ArqExtMensal ASSIGN TO DA-D04801
001680            ORGANIZATION IS INDEXED
001690            ACCESS MODE  IS SEQUENTIAL
001700            RECORD KEY   IS CHAVE-EXT
001710            FILE STATUS  IS ST-ArqExtMensal.
001720
001730     SELECT TabUtils ASSIGN TO DA-D091TAB
001740            ORGANIZATION IS INDEXED
001750            ACCESS MODE  IS SEQUENTIAL                            00001750
001760            RECORD KEY   IS CHAVE-D01                             00001760
001770            FILE STATUS  IS STATUS-D01-WS.                        00001770
001780                                                                  00001780
001790     SELECT D04819 ASSIGN TO DA-D04819                            00001790
001800            ORGANIZATION IS INDEXED                               00001800
001810            ACCESS MODE  IS DYNAMIC                               00001810
001820            RECORD KEY   IS COD-AG-D19                            00001820
001830            FILE STATUS  IS STATUS-D19-WS.                        00001830
001840                                                                  00001840
001850     SELECT D048CAN ASSIGN TO DA-D048CAN                          00001850
001860            ORGANIZATION IS INDEXED                               00001860
001870            ACCESS MODE  IS DYNAMIC                               00001870
001880            RECORD KEY   IS CHAVE-CAN                             00001880
001890            FILE STATUS  IS STATUS-CAN-WS.                        00001890
001900                                                                  00001900
001910     SELECT D15901  ASSIGN TO DA-D15901                           00001910
001920            ORGANIZATION IS INDEXED                               00001920
001930            ACCESS MODE  IS DYNAMIC                               00001930
001940            RECORD KEY   IS CHAVE-D159                            00001940
001950            FILE STATUS  IS STATUS-D15901.                        00001950
001960                                                                  00001960
001970     SELECT D13002  ASSIGN TO DA-D13002                           00001970
001980            ORGANIZATION IS INDEXED                               00001980
001990            ACCESS MODE  IS DYNAMIC                               00001990
002000            RECORD KEY   IS CHAVE-D02                             00002000
002010            FILE STATUS  IS STATUS-D02-WS.                        00002010
002020                                                                  00002020
002030     SELECT D04815   ASSIGN TO DA-D04815                          00002030
002040            ORGANIZATION IS INDEXED                               00002040
002050            ACCESS MODE  IS DYNAMIC                               00002050
002060            RECORD KEY   IS CHAVE-D15                             00002060
002070            FILE STATUS  IS STATUS-D04815-WS.                     00002070
002080                                                                  00002080
002090     SELECT D27030   ASSIGN TO DA-D27030                          00002090
002100            ORGANIZATION IS INDEXED                               00002100
002110            ACCESS MODE  IS DYNAMIC                               00002110
002120            RECORD KEY   IS CHAVE-D30                             00002120
002130            FILE STATUS  IS STATUS-D27030-WS.                     00002130
002140                                                                  00002140
002150     SELECT D30201   ASSIGN TO DA-D30201                          00002150
002160            ORGANIZATION IS INDEXED                               00002160
002170            ACCESS MODE  IS DYNAMIC                               00002170
002180            RECORD KEY   IS CHAVE-D302                            00002180
002190            FILE STATUS  IS STATUS-D302-WS.                       00002190
002200                                                                  00002200
002210     SELECT D12802 ASSIGN TO UT-S-D12802.                         00002210
002220                                                                  00002220
002290* D104.A002.RESUMO.CDBRDB                                         00002290
002300     SELECT D86042 ASSIGN TO DA-D86042                            00002300
002310            ORGANIZATION IS INDEXED                               00002310
002320            ACCESS       IS DYNAMIC                               00002320
002330            RECORD KEY CHAVE-D42                                  00002330
002340            FILE STATUS IS FS-D42.                                00002340
002350                                                                  00002350
002360     SELECT D27028 ASSIGN TO DA-D27028                            00002360
002370                   ORGANIZATION IS INDEXED                        00002370
002380                   ACCESS MODE  IS DYNAMIC                        00002380
002390                   RECORD KEY   IS CHAVE-D28                      00002390
002400                   FILE STATUS  IS FS-D27028.                     00002400
002410                                                                  00002410
002420     SELECT D86041 ASSIGN TO DA-D86041                            00002420
002430                   ORGANIZATION IS INDEXED                        00002430
002440                   ACCESS MODE  IS DYNAMIC                        00002440
002450                   RECORD KEY   IS CHAVE-D41                      00002450
002460                   FILE STATUS  IS FS-D86041.                     00002460
002470                                                                  00002470
002540     SELECT D15903  ASSIGN TO DA-D15903                           00002540
002550                    ORGANIZATION IS INDEXED                       00002550
002560                    ACCESS MODE  IS DYNAMIC                       00002560
002570                    RECORD KEY   IS CHAVE-D15903                  00002570
002580                    FILE STATUS  IS FS-D15903.                    00002580
002590                                                                  00002590
002600     SELECT D19401  ASSIGN TO DA-D19401                           00002600
002610                    ORGANIZATION IS INDEXED                       00002610
002620                    ACCESS MODE  IS DYNAMIC                       00002620
002630                    RECORD KEY   IS CHAVE-D19401                  00002630
002640                    FILE STATUS  IS FS-D19401.                    00002640
002650                                                                  00002650
002660* D860.CARTCLI.HOME.BANKING                                       00002660
002670*    ......................................                       00002670
002690*-----------------------------------------------------------------00002690
002700*                                                                 00002700
002710 DATA DIVISION.                                                   00002710
002720*                                                                 00002720
002730*-----------------------------------------------------------------00002730
002740                                                                  00002740
002750  FILE SECTION.                                                   00002750
002760                                                                  00002760
002770 FD  ArqContasBase                                                00002770
002780     RECORD CONTAINS 200 TO 1250 CHARACTERS.                      00002780
002790*     LABEL RECORD STANDARD.                                      00002790

002810*    ......................................                       00002810
002830  01 REG-HEADER-AG-F10.                                           00002830
002840     05 Chave-ArqContasBase.
002850        10 SEQUENCIAL-F10-ANT    PIC 9(04).                       00002850
002860        10 CH-AG-F10             PIC 9(05)       COMP-3.          00002860
002870        10 CH-NUM-CONTA-F10.                                      00002870
002880           15 CH-CONTA-F10       PIC 9(09)       COMP-3.          00002880
002890           15 CH-DIGITO-F10      PIC X.                           00002890
002900        10 CH-TIPOREG-F10        PIC 9.                           00002900
002910           88 HEAD-AG-F10                        VALUE 1.         00002910
002920           88 REG-EXT-F10                        VALUE 4.         00002920
002930           88 REG-COR-F10                        VALUE 5.         00002930
002940           88 TRAIL-AG-F10                       VALUE 8.         00002940
002950        10 CH-SEQUENCIAL-F10     PIC 999.                         00002950
002960     05 HF-ATUALIZACAO-F10.                                       00002960
002970        10 HF-DATA-ANT-F10       PIC 9(6)        COMP-3.          00002970
002980        10 HF-DATA-ATL-F10       PIC 9(6)        COMP-3.          00002980
002990        10 HF-SEQUENC-ANT-F10    PIC 999         COMP-3.          00002990
003000        10 HF-SEQUENC-ATL-F10    PIC 999         COMP-3.          00003000
003010                                                                  00003010
003020     05 HAG-TELEPROCES-F10       PIC 9.                           00003020
003030     05 HAG-PARAMETROS-F10.                                       00003030
003040        10 HAG-GR-CRED-PJUR-F10  PIC S9(13)V99   COMP-3.          00003040
003050        10 HAG-GR-DEB-PJUR-F10   PIC S9(13)V99   COMP-3.          00003050
003060        10 HAG-GR-DIF-SLD-PJUR-F10                                00003060
003070                                 PIC S9(13)V99   COMP-3.          00003070
003080        10 HAG-GR-CRED-PFIS-F10  PIC S9(13)V99   COMP-3.          00003080
003090        10 HAG-GR-DEB-PFIS-F10   PIC S9(13)V99   COMP-3.          00003090
003100        10 HAG-GR-DIF-SLD-PFIS-F10                                00003100
003110                                 PIC S9(13)V99   COMP-3.          00003110
003120     05 HAG-VALOR-TAXAS-F10.                                      00003120
003130        10 HAG-TX-JUROS-F10      PIC 9(3)V99     COMP-3.          00003130
003140        10 HAG-TX-IOF-JURID-F10  PIC 9V9999      COMP-3.          00003140
003150        10 HAG-TX-IOF-FISICA-F10 PIC 9V9999      COMP-3.          00003150
003160        10 HAG-TX-PERMANC-F10    PIC 9(3)V99     COMP-3.          00003160
003170        10 HAG-MVR-F10           PIC S9(9)V99    COMP-3.          00003170
003180        10 HAG-ORTN-ANT-F10      PIC S9(9)V99    COMP-3.          00003180
003190        10 HAG-ORTN-ATL-F10      PIC S9(9)V99    COMP-3.          00003190
003200        10 HAG-VRMIN-F10         PIC S999V99     COMP-3.          00003200
003240     05 HAG-AGENCIA-F10.                                          00003240
003250        10 HAG-AG-NOME-F10       PIC X(30).                       00003250
003260        10 HAG-AG-EST-F10        PIC XX.                          00003260
003270        10 HAG-AG-ENDER-F10      PIC X(40).                       00003270
003280        10 HAG-AG-CEP-F10        PIC 9(5)        COMP-3.          00003280
003290        10 HAG-AG-CGC-F10        PIC 9(11)       COMP-3.          00003290
003300     05 HAG-DATA-IMPLANT-AG-F10  PIC 9(6)        COMP-3.          00003300
003310     05 HAG-INDICA-ATUALIZACAO-AG-F10.                            00003310
003320        10 HAG-INDICADOR-F10     PIC 9.                           00003320
003330     05 HAG-INDICA-LISTAO-F10    PIC 9.                           00003330
003340     05 HAG-DIAS-UTEIS-F10       PIC 99.                          00003340
003350                                                                  00003350
003360  01 REG-EXTRATO-F10.                                             00003360
003370                                                                  00003370
003380     05 FILLER                   PIC X(17).                       00003380
003390     05 EXT-TPCONTAB-F10         PIC 9(03)       COMP-3.          00003390
003400     05 EXT-CONTERR-F10.                                          00003400
003410        10 EXT-EMP-VENC-F10      PIC 9(06)       COMP-3.          00003410
003420        10 EXT-EMP-LIM-F10       PIC S9(13)V99   COMP-3.          00003420
003430     05 EXT-EXTRATO-F10.                                          00003430
003440        10 EXT-EXT-DATA-F10      PIC 9(06)       COMP-3.          00003440
003450        10 EXT-EXT-SLD-F10       PIC S9(13)V99   COMP-3.          00003450
003460        10 EXT-EXT-TP-SLD-F10    PIC X.                           00003460
003470     05 EXT-MOVIMENTOS-F10.                                       00003470
003480        10 EXT-MOV-NUM-F10       PIC 99.                          00003480
003490        10 EXT-MOV-UNID-F10 OCCURS 17 TIMES.                      00003490
003500           15 EXT-DIA-F10        PIC 99.                          00003500
003510           15 EXT-HIST-F10       PIC 9(05)       COMP-3.          00003510
003520           15 EXT-REF-F10        PIC 9(6)        COMP-3.          00003520
003530           15 EXT-VAL-F10        PIC S9(13)V99   COMP-3.          00003530
003540        10 FILLER                PIC X(30).                       00003540
003550     05 EXT-EXTRATO-ESPECIAL-F10 PIC 9.                           00003550
003560     05 EXT-MENS-F10             PIC X(02).                       00003560
003570     05 EXT-VR-BLOQ-F10          PIC S9(13)V99    COMP-3.         00003570
003580                                                                  00003580
003590*    ......................................                       00003590
003610  01 REG-CORRENT-F10.                                             00003610
003620                                                                  00003620
003630     05 FILLER                   PIC X(17).                       00003630
003640     05 TPCONTAB-F10             PIC 9(03)       COMP-3.          00003640
003650     05 DATA-IMPLANTA-F10        PIC 9(6)        COMP-3.          00003650
003660     05 NOME-CLIENTE-F10.                                         00003660
003670        10 NOME-F10              PIC X(34).                       00003670
003680        10 CONT-NOME-F10         PIC X(34).                       00003680
003690        10 COD-DIRGE-F10         PIC XX.                          00003690
003700     05 ENDERECO-F10.                                             00003700
003710        10 E-RUA-F10             PIC X(30).                       00003710
003720        10 E-CIDADE-F10.                                          00003720
003730           15 E-BAIR-F10         PIC X(12).                       00003730
003740           15 E-CEP-F10          PIC 9(5)        COMP-3.          00003740
003750           15 E-CID-F10          PIC X(14).                       00003750
003760           15 E-EST-F10          PIC XX.                          00003760
003770           15 E-FONE-F10         PIC 9(7)        COMP-3.          00003770
003780     05 IDENTIFICACAO-F10.                                        00003780
003790        10 CPF-CGC-F10           PIC 9(15)       COMP-3.          00003790
003800        10 EXTRATO-ESPECIAL-F10  PIC 9.                           00003800
003810        10 TP-PESSOA-F10         PIC XX.                          00003810
003820        10 TX-PERM-F10           PIC 9.                           00003820
003830        10 CALC-SMED-F10         PIC 9.                           00003830
003840     05 ATUALIZACAO-F10.                                          00003840
003850        10 ATL-ULT-DT-F10        PIC 9(6)        COMP-3.          00003850
003860        10 ATL-ULT-MOV-F10       PIC 9(6)        COMP-3.          00003860
003870        10 ATL-DIAS-PARAL-F10    PIC 9(5)        COMP-3.          00003870
003880     05 SALDOS-F10.                                               00003880
003890        10 SLD-DEP-F10           PIC S9(13)V99   COMP-3.          00003890
003900        10 SLD-EMP-F10           PIC S9(13)V99   COMP-3.          00003900
003910        10 SALDOS-BLOQUEADOS-F10.                                 00003910
003920           15 SLD-BLO-F10 OCCURS 21 TIMES                         00003920
003930                                 PIC S9(13)V99   COMP-3.          00003930
003940     05 INSUF-EXCESSO-F10        PIC 9.                           00003940
003960     05 NUM-SMED-ESTE-F10        PIC S9(13)      COMP-3.          00003960
003970     05 SMED-TRIM-ATL-F10.                                        00003970
003980        10 SMED-ATL1-F10         PIC S9(13)      COMP-3.          00003980
003990        10 SMED-ATL2-F10         PIC S9(13)      COMP-3.          00003990
004000        10 SMED-ATL3-F10         PIC S9(13)      COMP-3.          00004000
004010     05 CONTERRANEO-F10.                                          00004010
004020        10 EMP-DATA-F10          PIC 9(6)        COMP-3.          00004020
004030        10 EMP-VENC-F10          PIC 9(6)        COMP-3.          00004030
004040        10 EMP-LIM-F10           PIC 9(13)V99    COMP-3.          00004040
004050        10 EMP-TAXA-JUR-F10      PIC 99V999      COMP-3.          00004050
004060        10 EMP-NUM-F10           PIC S9(13)      COMP-3.          00004060
004070        10 EMP-NUM-EXCED-FUNC-F10                                 00004070
004080                                 PIC S9(13)      COMP-3.          00004080
004090        10 EMP-JCOB-F10          PIC S9(9)V99    COMP-3.          00004090
004100        10 EMP-NUM-IOF-F10       PIC S9(13)      COMP-3.          00004100
004110     05 EXTRATO-F10.                                              00004110
004120        10 EXT-DATA-F10          PIC 9(6)        COMP-3.          00004120
004130        10 EXT-SLD-F10           PIC S9(13)V99   COMP-3.          00004130
004140        10 EXT-TPSLD-F10         PIC X.                           00004140
004150     05 FICHA-F10.                                                00004150
004160        10 FICHA-NUM-F10         PIC 999         COMP-3.          00004160
004170        10 FICHA-DATA-F10        PIC 9(6)        COMP-3.          00004170
004180     05 MOVIMENTOS-F10.                                           00004180
004190        10 MOV-NUM-F10           PIC 99.                          00004190
004200        10 MOV-UNID-F10 OCCURS 17 TIMES.                          00004200
004210           15 DIA-MOV-F10        PIC 99.                          00004210
004220           15 HIST-MOV-F10       PIC 9(05)       COMP-3.          00004220
004230           15 REF-MOV-F10        PIC 9(6)        COMP-3.          00004230
004240           15 VR-MOV-F10         PIC S9(13)V99   COMP-3.          00004240
004250     05 CD-CLI-F10               PIC 9(9)        COMP-3.          00004250
004260     05 FILLER                   PIC X.                           00004260
004270     05 DT-BLOQ-DESBLOQ-F10      PIC 9(6).                        00004270
004280*                                                                 00004280
004330     05 CD-CLI-COTIT-F10         PIC 9(08).                       00004330
004340     05 IND-ALT-COTIT-F10        PIC X(01).                       00004340
004360*                                                                 00004360
004370     05 DIA-DEBITO-JUROS-F10     PIC 99.                          00004370
004380     05 DT-TARIF-RENOV-F10       PIC 9(6)        COMP-3.          00004380
004390     05 TARIFA-PROPORCIONAL-F10  PIC S9(13)V99   COMP-3.          00004390
004400     05 QDE-SAQ-CARTAO-CTASAL-F10 PIC 9(7)        COMP-3.         00004400
004410     05 QDE-CHQ-PROCES-F10       PIC 9(7)        COMP-3.          00004410
004420     05 GRUPO-TARIFA-F10         PIC 9.                           00004420
004430     05 ADESAO-GRUPO-TARIFA-F10  PIC 9(6)        COMP-3.          00004430
004440     05 INSPECAO-F10.                                             00004440
004450        10 INSUFIC-F10.                                           00004450
004460           15 INS-ULT-F10        PIC 9(6)        COMP-3.          00004460
004470           15 INS-VEZ-F10        PIC 999         COMP-3.          00004470
004480           15 INS-MOR-F10        PIC S9(13)V99   COMP-3.          00004480
004490           15 INS-DATA-MOR-F10   PIC 9(6)        COMP-3.          00004490
004500           15 INS-NOVA-F10       PIC 9(6)        COMP-3.          00004500
004510           15 INS-NJUR-REAL-F10  PIC S9(11)V99   COMP-3.          00004510
004520           15 INS-NJUR-DECOR-F10 PIC S9(11)V99   COMP-3.          00004520
004530           15 INS-IOF-REAL-F10   PIC S9(9)V99    COMP-3.          00004530
004540           15 INS-IOF-DECOR-F10  PIC S9(9)V99    COMP-3.          00004540
004550        10 EXCESSO-F10.                                           00004550
004560           15 EXC-ULT-F10        PIC 9(6)        COMP-3.          00004560
004570           15 EXC-VEZ-F10        PIC 999         COMP-3.          00004570
004580           15 EXC-MOR-F10        PIC S9(13)V99   COMP-3.          00004580
004590           15 EXC-DATA-MOR-F10   PIC 9(6)        COMP-3.          00004590
004600           15 EXC-NOVO-F10       PIC 9(6)        COMP-3.          00004600
004610        10 ACERTO-F10.                                            00004610
004620           15 ACT-ULT-F10        PIC 9(6)        COMP-3.          00004620
004630           15 ACT-VEZ-F10        PIC 999         COMP-3.          00004630
004640           15 ACT-MOR-F10        PIC S9(13)V99   COMP-3.          00004640
004650           15 ACT-DATA-MOR-F10   PIC 9(6)        COMP-3.          00004650
004660        10 NUMEROS-F10.                                           00004660
004670           15 NUM-ULT-F10        PIC 9(6)        COMP-3.          00004670
004680           15 NUM-VEZ-F10        PIC 999         COMP-3.          00004680
004690           15 NUM-MOR-F10        PIC S9(13)      COMP-3.          00004690
004700           15 NUM-DATA-MOR-F10   PIC 9(6)        COMP-3.          00004700
004710        10 ADIANTAMENTOS-F10.                                     00004710
004720           15 VALOR-ACUM-ADIANT-F10                               00004720
004730                                 PIC S9(13)V99   COMP-3.          00004730
004740     05 SENHA-ONLINE-F10.                                         00004740
004750        10 STATUS-PRINC-F10      PIC 9.                           00004750
004760        10 VIA-PRINC-F10         PIC 9.                           00004760
004770        10 REF-PRINC-F10         PIC 9(8)        COMP-3.          00004770
004780        10 STATUS-SECON-F10      PIC 9.                           00004780
004790        10 VIA-SECON-F10         PIC 9.                           00004790
004800        10 REF-SECON-F10         PIC 9(8)        COMP-3.          00004800
004810     05 SELIC-F10.                                                00004810
004820        10 CRED-ANTECIP          PIC S9(13)V99   COMP-3.          00004820
004830     05 INDICACOES-ONLINE-F10.                                    00004830
004840        10 INDICACOES-F10        PIC 9(7)        COMP-3.          00004840
004850     05 CHEQUES-PERSON-F10.                                       00004850
004860        10 CH-PERSON             PIC 9(5)        COMP-3.          00004860
004870        10 CH-COMUM              PIC 9(5)        COMP-3.          00004870
004880        10 CH-ESPECIAL           PIC 9(5)        COMP-3.          00004880
004890     05 TALONARIOS-PERSON-F10 REDEFINES CHEQUES-PERSON-F10.       00004890
004900        10 TALON-FORNECIDOS-F10   PIC  9(5)      COMP-3.          00004900
004910        10 TALON-RESIDUO-F10      PIC  9(5)      COMP-3.          00004910
004920        10 TALON-PEDIDOS-ACUM-F10 PIC S9(5)      COMP-3.          00004920
004930     05 COD-POSTO-F10            PIC 9.                           00004930
004940     05 NUM-INSUF-EXCES-F10      PIC S9(13)      COMP-3.          00004940
004950     05 VAR-OTN-F10              PIC S99V999     COMP-3.          00004950
004960     05 MOVIMENTACAO-F10         PIC 9.                           00004960
004970     05 CAMPO-DISPONIVEL-F10     PIC S9(13)V99   COMP-3.          00004970
004980     05 DATA-ADIANT-F10          PIC 9(6) COMP-3.                 00004980
004990     05 NUM-DEV-AJUST-F10.                                        00004990
005000        10 NUM-SEM-BLOQ-F10      PIC S9(11)      COMP-3.          00005000
005010     05 ADICAO-SUBT-JUROS-F10.                                    00005010
005020        10 INDICADOR-JUROS-F10   PIC X.                           00005020
005030     05 EXTRATO-EXTRA-F10        PIC 99.                          00005030
005040     05 EXPANSAO-MAIO-91-F10.                                     00005040
005050        10 CONTRA-ORDEM-OPOS-F10 PIC 9.                           00005050
005060        10 ATIVIDADE-F10         PIC 999          COMP-3.         00005060
005070        10 DIA-IOC-RED-F10 REDEFINES ATIVIDADE-F10                00005070
005080                                 PIC 999          COMP-3.         00005080
005090        10 VALOR-MEDIO-LIMITE-F10                                 00005090
005100                                 PIC S9(13)       COMP-3.         00005100
005110        10 RAP-F10               PIC S9(13)V99    COMP-3.         00005110
005120        10 IOCS-DIARIOS-EXIGIVEIS-F10                             00005120
005130                                 PIC S9(13)V99    COMP-3.         00005130
005140        10 IOCS-DIARIOS-DISPENS-F10                               00005140
005150                                 PIC S9(13)V99    COMP-3.         00005150
005160        10 SMED-TRIM-ANT-F10.                                     00005160
005170           15 SMED-ATL4-F10      PIC S9(13)       COMP-3.         00005170
005180           15 SMED-ATL5-F10      PIC S9(13)       COMP-3.         00005180
005190           15 SMED-ATL6-F10      PIC S9(13)       COMP-3.         00005190
005200*                                                                 00005200
005300        10 QDE-CHQ-COMP-INTERNA-F10 PIC 999       COMP-3.         00005300
005310        10 QDE-CHQ-PG-CAIXA-F10     PIC 999       COMP-3.         00005310
005320        10 VR-DEP-CHQ-SEM-F10       PIC S9(13)V99 COMP-3.         00005320
005330        10 QDE-CHQ-AVULSO-F10       PIC 999       COMP-3.         00005330
005340        10 QDE-SAQ-CARTAO-CAIXA-F10 PIC 999       COMP-3.         00005340
005350        10 QDE-SAQ-CARTAO-F10       PIC 999       COMP-3.         00005350
005360        10 QDE-SAQ-BCO24HS-F10      PIC 999       COMP-3.         00005360
005370        10 QDE-SAQ-BB-F10           PIC 999       COMP-3.         00005370
005380        10 QDE-SAQ-RVA-F10          PIC 999       COMP-3.         00005380
005410*                                                                 00005410
005420        10 TAXA-APLICADA-F10     PIC S9(9)V9(9)   COMP-3.         00005420
005430        10 JUROS-DO-DIA-F10      PIC S9(07)V9(8)  COMP-3.         00005430
005440        10 IN89-F10.                                              00005440
005450           15 MANIFESTACAO-F10   PIC X.                           00005450
005460           15 VIGENCIA-LIMINAR-CPMF-F10.                          00005460
005470              20 INI-LIMINAR-F10 PIC 9(6)         COMP-3.         00005470
005480              20 FIM-LIMINAR-F10 PIC 9(6)         COMP-3.         00005480
005490        10 FATOR-ACUMULADO-F10   PIC 9(9)V9(9)    COMP-3.         00005490
005500        10 ISENTA-COMPULSO-F10   PIC X.                           00005500
005510        10 QDE-SAQUE-CARTAO-DO-MES-F10                            00005510
005520                                 PIC 9(6)         COMP-3.         00005520
005530        10 SALDO-ANTERIOR-F10    PIC S9(13)V99    COMP-3.         00005530
005540        10 EMP-PROPOSTA-F10      PIC 9(15)        COMP-3.         00005540
005550        10 DIAS-UTEIS-UTIL-F10   PIC 99.                          00005550
005560        10 FILLER                PIC X(02).                       00005560
005570        10 SMED-DEV-ESTE-F10     PIC S9(13)V99    COMP-3.         00005570
005580        10 SMED-DEV-UTI1-F10     PIC S9(13)V99    COMP-3.         00005580
005590        10 INDICADORES-DO-MES-F10.                                00005590
005600           15 QDE-INS-EXC-MES-F10                                 00005600
005610                                 PIC 999          COMP-3.         00005610
005620           15 QDE-CHQS-DEV-MES-F10                                00005620
005630                                 PIC 999          COMP-3.         00005630
005640        10 SMED-DEV-UTI2-F10     PIC S9(13)V99    COMP-3.         00005640
005650        10 SMED-DEV-UTI3-F10     PIC S9(13)V99    COMP-3.         00005650
005660        10 IMPEDE-RENOV-AUTO-F10 PIC 9.                           00005660
005670        10 COD-POSTAL-F10        PIC 9(9)         COMP-3.         00005670
005680        10 CLIENTE-PREFEREN-F10  PIC 9.                           00005680
005690        10 IPMF-F10.                                              00005690
005700           15 ISENCAO-IPMF-F10   PIC 9.                           00005700
005710           15 CHEQUE-TB-FORNECI-F10 PIC 9(5)      COMP-3.         00005710
005720           15 CHEQUE-TB-RESIDUO-F10 PIC 9(5)      COMP-3.         00005720
005730           15 CHEQUE-TB-PEDIDOS-F10 PIC S9(5)      COMP-3.        00005730
005740        10 TP-TALAO-F10          PIC 9.                           00005740
005750        10 AVISO-LANC-F10        PIC X.                           00005750
005760        10 ID-CPF-CGC-F10        PIC 9.                           00005760
005770        10 GANHO-POTENCIAL-DIARIO-F10 PIC S9(13)V99 COMP-3.       00005770
005780        10 EXC-VEZ-CONTRATO-F10  PIC 999 COMP-3.                  00005780
005790        10 EMP-SEGURO-F10        PIC X.                           00005790
005800        10 EMP-DATA-ENC-F10      PIC 9(6) COMP-3.                 00005800
005810        10 OPCAO-PC-F10          PIC X.                           00005810
005820        10 DT-OPCAO-PC-F10       PIC 9(6) COMP-3.                 00005820
005830        10 FILLER                PIC X(3).                        00005830
005840*                                                                 00005840
005850*   NOTAS: 1 - REGISTRO DE CORRENTISTA OCUPA 1200 BYTES.          00005850
005860*                                                                 00005860
005870*          2 - OS CAMPOS INS-VEZ-D08 E EXC-VEZ-D08 INDICAM A QUAN-00005870
005880*             TIDADE DE VEZES QUE A CONTA COMETEU INSUFICIENCIA OU00005880
005890*              EXCESSO NOS ULTIMOS SEIS MESES.                    00005890
005900*                                                                 00005900
005910*          3 - O CAMPO QDE-CHQ-DEV-SEM-D08 INFOR A QUANTIDADE DE  00005910
005920*              CHEQUES DE NOSSOS CLIENTES DEVOLVIDOS DEVIDO A IN- 00005920
005930*              SUFIENCIA/EXCESSO SOBRE LIMITE A CADA MES NOS UL-  00005930
005940*              TIMOS SEIS MESES.      HA TAMBEM O CAMPO QDE-ESTOR-00005940
005950*              MES-D08 COM A MESMO SIGNIFICADO P/O MES CORRENTE.  00005950
005960*                                                                 00005960
005970*          4 - O CAMPO VR-DEP-CHQ-SEM-D08 INFORMA O TOTAL DOS DE- 00005970
005980*              POSITOS EM CHEQUE A CADA MES NOS ULTIMOS SEIS MESES00005980
005990*              HA TAMBEM O CAMPO VR-DEP-CHQ-SEM-D08 COM O MESMO   00005990
006000*              SIGNIFICADAO PARA O MES CORRENTE.                  00006000
006010*                                                                 00006010
006020*          5 - O CAMPO VR-DEP-DEV-SEM-D08 INFORMA O VALOR DOS DE- 00006020
006030*              POSITOS NAO COMPENSADOS A CADA MES NOS ULTIMOS SEIS00006030
006040*              MESES.         HA TAMBEM O CAMPO VR-DEP-DEV-SEM-D0800006040
006050*              COM O MESMO SIGNIFICADO PARA O MES CORRENTE.       00006050
006060*    ......................................                       00006060
006080  01 REG-TRAILLER-AG-F10.                                         00006080
006090                                                                  00006090
006100     05 FILLER                   PIC X(17).                       00006100
006110     05 ESTATISTICA-CAD-F10.                                      00006110
006120        10 INCLUSAO-F10          PIC 9(5)        COMP-3.          00006120
006130        10 ALTERACAO-F10         PIC 9(5)        COMP-3.          00006130
006140        10 EXCLUSAO-F10          PIC 9(5)        COMP-3.          00006140
006150     05 TRAG-TOTAIS-TPCONTA-F10 OCCURS 49 TIMES.                  00006150
006160        10 TRAG-TPCONTAB-F10     PIC 9(03)       COMP-3.          00006160
006170        10 TRAG-TOTAIS-ANT-F10.                                   00006170
006180           15 TOT-ANT-CONTAS-F10 PIC 9(5)        COMP-3.          00006180
006190           15 TOT-ANT-SALDOS-F10 PIC S9(13)V99   COMP-3.          00006190
006200        10 TRAG-TOTAIS-ATL-F10.                                   00006200
006210           15 TOT-ATL-CONTAS-F10 PIC 9(5)        COMP-3.          00006210
006220           15 TOT-ATL-SALDOS-F10 PIC S9(13)V99   COMP-3.          00006220
006230     05 AREA-LIVRE-TRAILLER-F10  PIC X(48).                       00006230
006240                                                                  00006240
006250*  NOTAS:                                                         00006250
006260*        1 - O REGISTRO DE TRAILLER OCUPA 1250 POSICOES.          00006260
006270*    ......................................                       00006270
006290     COPY B04807X.                                                00006290
006300                                                                  00006300
006310  FD D0480701                                                     00006310
006320     RECORD CONTAINS 240 CHARACTERS                               00006320
006330     BLOCK CONTAINS 0 RECORDS                                     00006330
006340     RECORDING MODE IS F.                                         00006340
006350*                                                                 00006350
         01 REG-MOV-D0701               PIC X(240).
         01 REG-GRADE-D0701.
            05 CHAVE-D0701.
               10 CH-TPREG-D0701        PIC 9.
               10 CH-CODAG-D0701        PIC 9(5)   COMP-3.
               10 CH-DATA-D0701         PIC 9(6)   COMP-3.
               10 CH-N-LOTE-D0701       PIC 99.
               10 CH-HIST-D0701         PIC 9(5).
               10 CH-CONTA-D0701.
                  15 CONTA-D0701        PIC 9(9)   COMP-3.
                  15 DV-CONTA-D0701     PIC X.
            05 RESTO-GRADE-D0701        PIC X(219).

         01 REG-CAD-CC-D0701.
            05 FILLER                   PIC X(21).
            05 PARTE-1-D0701            PIC X(153).
            05 CC-TPCONTAB-D0701        PIC 9(3).
            05 PARTE-2-D0701            PIC X(02).
            05 CC-TPPESSOA-D0701        PIC XX.
            05 PARTE-3-D0701            PIC X(59).

         01 REG-CAD-EMP-D0701.
            05 FILLER                   PIC X(21).
            05 RESTO-CAD-EMP-VENC-D0701 PIC X(219).

         01 REG-CAD-SENHA-D0701.
            05 FILLER                   PIC X(21).
            05 RESTO-CAD-SENHA-D0701    PIC X(219).

         01 REG-ACERTO-EXTCONTB-D0701.
            05 FILLER                   PIC X(21).
            05 RESTO-ACE-EXTCTB-D0701   PIC X(219).

         01 REG-ACERTO-NUMEROS-D0701.
            05 FILLER                   PIC X(21).
            05 RESTO-ACE-NUMEROS-D0701  PIC X(219).

         01 REG-TRANSACAO-D0701.
            05 FILLER                   PIC X(21).
            05 RESTO-TRANSACAO-D0701    PIC X(219).

         01 REG-ESPECIAIS-D0701.
            05 FILLER                   PIC X(21).
            05 RESTO-ESPECIAIS-D0701    PIC X(219).

006370*                                                                 00006370
006380  FD D04810S                                                      00006380
006390     RECORD CONTAINS 30 CHARACTERS                                00006390
006400     BLOCK CONTAINS 0 RECORDS                                     00006400
006410     RECORDING MODE IS F.                                         00006410
006420                                                                  00006420
006430  01 REG-D10S.                                                    00006430
006440     05 AGN-D10S        PIC 9(5)      COMP-3.                     00006440
006450     05 CTA-D10S        PIC 9(9)      COMP-3.                     00006450
006460     05 DIG-D10S        PIC 9.                                    00006460
006470     05 DT-OCOR-D10S    PIC 9(6)      COMP-3.                     00006470
006480     05 DT-BLOQ-D10S    PIC 9(6)      COMP-3.                     00006480
006490     05 SALDO-D10S      PIC S9(13)V99 COMP-3.                     00006490
006500     05 COD-OCOR-D10S   PIC 99.                                   00006500
006510        88 TRANSFORMADA               VALUE 01.                   00006510
006520        88 CANCELADA                  VALUE 02.                   00006520
006530        88 REATIVADA                  VALUE 03.                   00006530
006540     05 FILLER          PIC XXX.                                  00006540
006550                                                                  00006550
006560*    ......................................                       00006560

006580     COPY B04811X.                                                00006580

006600  FD D04810                                                       00006600
006610     RECORD CONTAINS 100 TO 1300 CHARACTERS                       00006610
006620     BLOCK CONTAINS 0 RECORDS                                     00006620
006630     RECORDING MODE IS V.                                         00006630
006640*                                                                 00006640
006650   01 REG-HEADER-AGENCIA-D10.                                     00006650
006660*                                                                 00006660
006670     05  CHAVE-D10.                                               00006670
006680         10 CH-TPREG-D10         PIC 99.                          00006680
006690            88 HEAD-AG-D10       VALUE 01.                        00006690
006700            88 FICHA-D10         VALUE 08.                        00006700
006710            88 EXTRATO-D10       VALUE 10.                        00006710
006720            88 DIARIO-D10        VALUE 12.                        00006720
006730            88 CH-PERSONAL       VALUE 14.                        00006730
006740            88 PROTOC-D10        VALUE 16.                        00006740
006750            88 ESPEC-D10         VALUE 18.                        00006750
006760            88 DEP-BLO-D10       VALUE 19.                        00006760
006770            88 AC-EC-D10         VALUE 20.                        00006770
006780            88 CAD-CC-D10        VALUE 22.                        00006780
006790            88 INSUF-D10         VALUE 24.                        00006790
006800            88 CAD-EMP-D10       VALUE 26.                        00006800
006810            88 AC-NUM-D10        VALUE 28.                        00006810
006820            88 CTA-VENC-D10      VALUE 30.                        00006820
006830            88 EXCESSO-D10       VALUE 32.                        00006830
006840            88 NUF-D10           VALUE 33.                        00006840
006850            88 JUROS-IOF-D10     VALUE 34.                        00006850
006860            88 NUJ-D10           VALUE 35.                        00006860
006870            88 TR-P-EMP-D10      VALUE 36.                        00006870
006880            88 TR-P-CHE-IN-D10   VALUE 37.                        00006880
006890            88 TR-DE-EMP-D10     VALUE 38.                        00006890
006900            88 TR-DE-CHE-IN-D10  VALUE 39.                        00006900
006910            88 TR-P-CHE-CO-D10   VALUE 40.                        00006910
006920            88 TR-D-CHE-CO-D10   VALUE 41.                        00006920
006930            88 TR-P-CHE-OU-D10   VALUE 42.                        00006930
006940            88 TR-D-CHE-OU-D10   VALUE 43.                        00006940
006950            88 TR-P-CTA-EMP-IN-D10 VALUE 44.                      00006950
006960            88 TR-D-CTA-EMP-IN-D10 VALUE 45.                      00006960
006970            88 TR-P-CTA-EMP-CO-D10 VALUE 46.                      00006970
006980            88 TR-D-CTA-EMP-CO-D10 VALUE 47.                      00006980
006990            88 TR-P-CTA-EMP-OU-D10 VALUE 48.                      00006990
007000            88 TR-D-CTA-EMP-OU-D10 VALUE 49.                      00007000
007010            88 COM-PERMAN-D10    VALUE 50.                        00007010
007020            88 RAZAO-D10         VALUE 52.                        00007020
007030            88 FH-RECOLHER-D10   VALUE 54.                        00007030
007040            88 CAD-CARTAO-D10    VALUE 55.                        00007040
007050         10 CH-CODAG-D10         PIC 9(05)       COMP-3.          00007050
007060         10 CH-CONTA-D10.                                         00007060
007070            15 CONTA-D10         PIC 9(09)       COMP-3.          00007070
007080            15 DV-CONTA-D10      PIC X.                           00007080
007090        10 CH-SEQUENC-D10        PIC 999         COMP-3.          00007090
007100     05  HAG-TELEPROC-D10        PIC 9.                           00007100
007110     05  HAG-PARAMETRO-D10.                                       00007110
007120        10 HAG-GDE-CRED-PJUR-D10 PIC S9(13)V99   COMP-3.          00007120
007130        10 HAG-GDE-DEB-PJUR-D10  PIC S9(13)V99   COMP-3.          00007130
007140        10 HAG-GDE-DIF-SLD-PJUR-D10                               00007140
007150                                 PIC S9(13)V99   COMP-3.          00007150
007160        10 HAG-GDE-CRED-PFIS-D10 PIC S9(13)V99   COMP-3.          00007160
007170        10 HAG-GDE-DEB-PFIS-D10  PIC S9(13)V99   COMP-3.          00007170
007180        10 HAG-GDE-DIF-SLD-PFIS-D10                               00007180
007190                                 PIC S9(13)V99   COMP-3.          00007190
007200     05  HAG-VR-TAXAS-D10.                                        00007200
007210         10 HAG-TX-JUROS-D10     PIC 9(3)V99     COMP-3.          00007210
007240        10 HAG-TX-IOF-JURID-D10  PIC 9V9999      COMP-3.          00007240
007250        10 HAG-TX-IOF-FISICA-D10 PIC 9V9999      COMP-3.          00007250
007260         10 HAG-TX-PERMAN-D10    PIC 9(3)V99     COMP-3.          00007260
007270         10 HAG-MVR-D10          PIC S9(9)V99    COMP-3.          00007270
007280        10 HAG-VRMIN-D10         PIC S999V99     COMP-3.          00007280
007290     05  HAG-NOMEAG-D10          PIC X(30).                       00007290
007300     05  HAG-DATA-D10            PIC 9(6)        COMP-3.          00007300
007310     05  HAG-CLASSE-GEROF-D10    PIC S9(13)V99   COMP-3.          00007310
007320     05 FILLER                   PIC X(160).                      00007320
007330*                                                                 00007330
007340*    ......................................                       00007340

007360   01 REG-FICHA-D10.                                              00007360
007370*                                                                 00007370
007380     05 FILLER                   PIC X(13).                       00007380
007390     05 FH-TPCONTAB-D10          PIC 9(03)       COMP-3.          00007390
007400     05 FH-NOME-D10              PIC X(40).                       00007400
007410     05 FH-SALDOS-D10.                                            00007410
007420        10 FH-SLD-DEP-D10        PIC S9(13)V99   COMP-3.          00007420
007430        10 FH-SLD-EMP-D10        PIC S9(13)V99   COMP-3.          00007430
007440        10 FH-SLD-BLO-1DIA-D10   PIC S9(13)V99   COMP-3.          00007440
007450        10 FH-SLD-BLO-2DIA-D10   PIC S9(13)V99   COMP-3.          00007450
007460        10 FH-SLD-BLO-3DIA-D10   PIC S9(13)V99   COMP-3.          00007460
007470     05 FH-SMED-D10              PIC S9(13)      COMP-3.          00007470
007480     05 FH-EMPRESTIMO-D10.                                        00007480
007490        10 FH-EMP-VENC-D10       PIC 9(6)        COMP-3.          00007490
007500        10 FH-EMP-LIM-D10        PIC S9(13)V99   COMP-3.          00007500
007510        10 FH-EMP-NUM-D10        PIC S9(13)      COMP-3.          00007510
007520     05 FH-FICHA-D10.                                             00007520
007530        10 FH-DATA-D10           PIC 9(6)        COMP-3.          00007530
007540        10 FH-NUM-D10            PIC 999         COMP-3.          00007540
007550     05 FH-ATL-ULT-MOV-D10       PIC 9(6)        COMP-3.          00007550
007560     05 FH-MOVIMENTOS-D10.                                        00007560
007570        10 FH-MOV-NUM-D10        PIC 99.                          00007570
007590        10 FH-MOV-UNID-D10 OCCURS 17 TIMES.                       00007590
007600           15 FH-DIA-MOV-D10     PIC 99.                          00007600
007610           15 FH-HIST-MOV-D10    PIC 9(05)       COMP-3.          00007610
007620           15 FH-REF-MOV-D10     PIC 9(6)        COMP-3.          00007620
007630           15 FH-VR-MOV-D10      PIC S9(13)V99   COMP-3.          00007630
007640        10 FILLER                PIC X(31).                       00007640
007650     05 FH-SITUACAO-CONTA-D10    PIC X(11).                       00007650
007660     05 FH-JUROS-IOF-D10.                                         00007660
007670        10 FH-JUR-ATE-EMIS-D10   PIC S9(7)V99    COMP-3.          00007670
007680        10 FH-JUR-DIA-D10        PIC S9(5)V9999  COMP-3.          00007680
007690        10 FH-IOF-ATE-EMIS-D10   PIC S9(7)V99    COMP-3.          00007690
007700        10 FH-IOF-DIA-D10        PIC S9(5)V9999  COMP-3.          00007700
007710     05 SELIC-D10.                                                00007710
007720        10 CRED-ANTECIP-D10      PIC S9(13)V99   COMP-3.          00007720
007730     05 VAR-ORTN-D10             PIC 99V9(5)     COMP-3.          00007730
007740     05 FH-COD-POSTO-D10         PIC 9.                           00007740
007750     05 FH-TP-PESSOA-D10         PIC XX.                          00007750
007760     05 FH-CLI-ESPECIAL-D10      PIC 9.                           00007760
007780*    ......................................                       00007780

007800   01 REG-EXTRATO-D10.                                            00007800
007810*                                                                 00007810
007820     05 FILLER                   PIC X(13).                       00007820
007830     05 EXT-TPCONTAB-D10.                                         00007830
007840        10 EXT-COD-TPCONTAB-D10  PIC 9(03)       COMP-3.          00007840
007850        10 EXT-NOME-TPCONTAB-D10 PIC X(28).                       00007850
007860     05 EXT-NOME-CLIENTE-D10.                                     00007860
007870        10 EXT-NOME-D10          PIC X(34).                       00007870
007880        10 EXT-CONT-NOME-D10     PIC X(34).                       00007880
007890        10 FILLER                PIC X(11).                       00007890
007900     05 EXT-TPPESSOA-D10         PIC XX.                          00007900
007910     05 EXT-ENDERECO-D10.                                         00007910
007920        10 EXT-RUA-D10           PIC X(30).                       00007920
007930        10 EXT-CIDADE-D10.                                        00007930
007940           15 EXT-BAIR-D10       PIC X(12).                       00007940
007950           15 EXT-CEP-D10        PIC 9(8)        COMP-3.          00007950
007960           15 EXT-CID-D10        PIC X(14).                       00007960
007970           15 EXT-EST-D10        PIC XX.                          00007970
007980           15 EXT-FONE-D10       PIC 9(7)        COMP-3.          00007980
007990     05 EXT-CPF-CGC-D10          PIC 9(15)       COMP-3.          00007990
008000     05 EXT-CONTER-D10.                                           00008000
008010        10 EXT-EMP-VENC-D10      PIC 9(6)        COMP-3.          00008010
008020        10 EXT-LIM-D10           PIC S9(13)V99   COMP-3.          00008020
008030     05 EXT-EXTRATO-D10.                                          00008030
008040        10 EXT-EXT-DATA-D10      PIC 9(6)        COMP-3.          00008040
008050        10 EXT-EXT-SLD-D10       PIC S9(13)V99   COMP-3.          00008050
008060        10 EXT-EXT-TPSLD-D10     PIC X.                           00008060
008070     05 EXT-MOVIMENTOS-D10.                                       00008070
008080        10 EXT-MOV-NUM-D10       PIC 99.                          00008080
008100        10 EXT-MOV-UNID-D10 OCCURS 17 TIMES.                      00008100
008110           15 EXT-DIA-D10        PIC 99.                          00008110
008120           15 EXT-HIST-D10       PIC 9(05)       COMP-3.          00008120
008130           15 EXT-REF-D10        PIC 9(6)        COMP-3.          00008130
008140           15 EXT-VR-D10         PIC S9(13)V99   COMP-3.          00008140
008150        10 FILLER                PIC X(11).                       00008150
008160     05 EXT-MENS-D10.                                             00008160
008170        10 EXT-COD-MENS-D10      PIC 99.                          00008170
008180        10 EXT-NOME-MENS-D10     PIC X(48).                       00008180
008190        10 EXT-VR-BLOQ-D10       PIC S9(13)V99    COMP-3.         00008190
008200     05 FILLER                   PIC X(100).                      00008200
008210     05 ESPECIAIS-D10            PIC 9.                           00008210
008220     05 EXT-COD-POSTO-D10        PIC 9.                           00008220
008230     05 EXT-CLI-ESPECIAL-D10     PIC 9.                           00008230
008240     05 FILLER                   PIC X(16).                       00008240
008250*                                                                 00008250
008260   01 REG-DIARIO-D10.                                             00008260
008270*                                                                 00008270
008280     05 FILLER                   PIC X(13).                       00008280
008290     05 DI-TPCONTAB-D10          PIC 9(03)       COMP-3.          00008290
008300     05 DI-NOME-D10              PIC X(40).                       00008300
008310     05 DI-SALDOS-D10.                                            00008310
008320        10 DI-SLD-ANT-D10        PIC S9(13)V99   COMP-3.          00008320
008330        10 DI-TPSLD-ANT-D10      PIC  X.                          00008330
008340        10 DI-SLD-ATL-D10        PIC S9(13)V99   COMP-3.          00008340
008350        10 DI-TPSLD-ATL-D10      PIC X.                           00008350
008360     05 DI-MOVIMENTO-D10.                                         00008360
008370        10 DI-MOVIM-D10.                                          00008370
008380           15 DI-MOV-LOTE-D10    PIC 99.                          00008380
008390           15 DI-MOV-HIST-D10    PIC 9(05)       COMP-3.          00008390
008400           15 DI-MOV-REF-D10     PIC 9(6)        COMP-3.          00008400
008410           15 DI-MOV-VR-D10      PIC S9(13)V99   COMP-3.          00008410
008420           15 DI-AC-CAD-D10      PIC X.                           00008420
008430     05 DI-CONTRA-ORD-D10        PIC XX.                          00008430
008440     05 DI-COD-POSTO-D10         PIC 9.                           00008440
008450     05 DI-CLI-ESPECIAL-D10      PIC 9.                           00008450
008460     05 DI-DATA-REMUN-D10        PIC 9(6)        COMP-3.          00008460
008470     05 DI-INTERFACE-D10         PIC 99.                          00008470
008480     05 DI-CALC-SMED-D10         PIC 9.                           00008480
008500                                                                  00008500
008510*    ......................................                       00008510
008520   01 REG-PERSONAL-D10.                                           00008520
008530      05 FILLER                   PIC X(13).                      00008530
008540      05 PER-NOME-D10             PIC X(34).                      00008540
008550      05 PER-ORIGEM-COMANDO-D10   PIC 9.                          00008550
008560      05 PER-NATUREZA-COMANDO-D10 PIC 9.                          00008560
008570      05 PER-QTDE-D10             PIC 9(5)        COMP-3.         00008570
008580      05 PER-DATA-D10             PIC 9(6)        COMP-3.         00008580
008590      05 CH-PER-MENS-D10.                                         00008590
008600         10 PER-COD-MENS-D10      PIC 99.                         00008600
008610         10 PER-NOME-MENS-D10     PIC X(41).                      00008610
008620      05 PER-COD-POSTO-D10        PIC 9.                          00008620
008630      05 PER-CLI-ESPECIAL-D10     PIC 9.                          00008630
008640****** IPMF *******************************                       00008640
008650      05 PER-CHEQUE-TB-D10        PIC XX.                         00008650
008660*******************************************                       00008660
008670      05 PER-TP-TALAO-D10         PIC 9.                          00008670
008680                                                                  00008680
008690***** ORIGEM DO COMANDO:   1- AUTOMATICO                          00008690
008700****                       2- MANUAL                              00008700
008710*****                      9- TOTALIZADOR - FORNECIDO P/ 131      00008710
008720***** NATUREZA DO COMANDO: 0- REJEITADO                           00008720
008730****                       1- ADICIONAR                           00008730
008740****                       9- SUBTRAIR                            00008740
008750                                                                  00008750
008770   01 REG-PROTOC-D10.                                             00008770
008780*                                                                 00008780
008790     05 FILLER                   PIC X(13).                       00008790
008800     05 PR-FORM-D10 OCCURS 36 TIMES.                              00008800
008810        10 PR-COD-OCR-D10        PIC 99.                          00008810
008820        10 PR-NOME-OCR-D10       PIC X(30).                       00008820
008830        10 PR-QDE-OCR-D10        PIC 9(4)        COMP-3.          00008830
008840     05 PR-TOT-REG-D10.                                           00008840
008850        10 PR-TOT-REG-ANT-D10    PIC 9(7)        COMP-3.          00008850
008860        10 PR-TOT-REG-ATL-D10    PIC 9(7)        COMP-3.          00008860
008870     05 PR-MUD-MES-D10           PIC 9.                           00008870
008880     05 PR-CAD-CC-D10            PIC 9(5)        COMP-3.          00008880
008890     05 PR-TRANSF-EMP-D10        PIC 9(5)        COMP-3.          00008890
008900     05 PR-OUTROS-D10            PIC 9(5)        COMP-3.          00008900
008910     05 PR-CAD-CARTAO-D10        PIC 9(5)        COMP-3.          00008910
008920     05 FILLER                   PIC X(6).                        00008920
008930*                                                                 00008930
008940   01 REG-ESPEC-D10.                                              00008940
008950*                                                                 00008950
008960     05 FILLER                   PIC X(13).                       00008960
008970     05 ESP-TPCONTAB-D10         PIC 9(03)       COMP-3.          00008970
008980     05 ESP-NOME-D10             PIC X(40).                       00008980
008990     05 ESP-MOVIMENTO-D10.                                        00008990
009000        10 ESP-MOV-DIA-D10       PIC 99.                          00009000
009010        10 ESP-MOV-HIST-D10      PIC 9(05)       COMP-3.          00009010
009020        10 ESP-MOV-REF-D10       PIC 9(6)        COMP-3.          00009020
009030        10 ESP-VR-D10            PIC S9(13)V99   COMP-3.          00009030
009040     05 ESP-SALDOS-D10.                                           00009040
009050        10 ESP-SLD-ANT-D10       PIC S9(13)V99   COMP-3.          00009050
009060        10 ESP-TPSLD-ANT-D10     PIC X.                           00009060
009070        10 ESP-SLD-ATL-D10       PIC S9(13)V99   COMP-3.          00009070
009080        10 ESP-TPSLD-ATL-D10     PIC X.                           00009080
009090     05 ESP-NUM-SMED-MES-D10     PIC 9(13)       COMP-3.          00009090
009100     05 ESP-AC-CAD-D10           PIC X.                           00009100
009110     05 ESP-COD-POSTO-D10        PIC 9.                           00009110
009120     05 ESP-CLI-ESPECIAL-D10     PIC 9.                           00009120
009130     05 ESP-TP-PESSOA-D10        PIC XX.                          00009130
009150*                                                                 00009150
009160   01 REG-DEP-BLO-D10.                                            00009160
009170*                                                                 00009170
009180     05 FILLER                   PIC X(13).                       00009180
009190     05 DBLO-TPCONTAB-D10        PIC 9(03)       COMP-3.          00009190
009200     05 DBLO-NOME-D10            PIC X(40).                       00009200
009210     05 DBLO-D10 OCCURS 12 TIMES                                  00009210
009220                                 PIC S9(13)V99   COMP-3.          00009220
009230     05 DBLO-HIST-D10            PIC 9(05)       COMP-3.          00009230
009240     05 DBLO-QDE-D10             PIC 99.                          00009240
009250     05 DBLO-MENS-D10.                                            00009250
009260        10 DBLO-COD-MENS-D10     PIC 99.                          00009260
009270        10 DBLO-NOME-MENS-D10    PIC X(43).                       00009270
009280     05 FILLER                   PIC X(4).                        00009280
009290     05 DESBLOQ-D10              PIC S9(13)V99    COMP-3.         00009290
009300     05 HIST-DESBLOQ-D10         PIC 9(05)        COMP-3.         00009300
009310     05 PRAZO-DESBLOQ-D10        PIC 99.                          00009310
009320     05 DBLO-COD-POSTO-D10       PIC 9.                           00009320
009330     05 DBLO-CLI-ESPECIAL-D10    PIC 9.                           00009330
009340     05 FILLER                   PIC X(30).                       00009340
009350*                                                                 00009350
009360   01 REG-AC-EXT-CONTAB-D10.                                      00009360
009370*                                                                 00009370
009380     05 FILLER                   PIC X(13).                       00009380
009390     05 AC-EC-TPCONTAB-D10       PIC 9(03)       COMP-3.          00009390
009400     05 AC-EC-NOME-D10           PIC X(40).                       00009400
009410     05 AC-EC-MOVIM-D10.                                          00009410
009420        10 AC-EC-MOV-NLOTE-D10   PIC 99.                          00009420
009430        10 AC-EC-MOV-HIST-D10    PIC 9(5)        COMP-3.          00009430
009440        10 AC-EC-REF-D10         PIC 9(6)        COMP-3.          00009440
009450        10 AC-EC-VR-D10          PIC S9(13)V99   COMP-3.          00009450
009460     05 AC-EC-CAD-D10            PIC X.                           00009460
009470     05 AC-EC-COD-POSTO-D10      PIC 9.                           00009470
009480     05 AC-EC-CLI-ESPECIAL-D10   PIC 9.                           00009480
009490     05 FILLER                   PIC X(25).                       00009490
009500*                                                                 00009500
009510*    ......................................                       00009510

009530   01 REG-CAD-CC-D10.                                             00009530
009540*                                                                 00009540
009550     05 FILLER                   PIC X(13).                       00009550
009560     05 C-CC-TPCONTAB-D10        PIC 9(03)       COMP-3.          00009560
009570     05 C-CC-DATA-IMP-D10        PIC 9(6)        COMP-3.          00009570
009580     05 C-CC-IDENTIFICACAO-D10.                                   00009580
009590        10 C-CC-CPF-CGC-D10      PIC 9(15)       COMP-3.          00009590
009600        10 C-CC-ERRO-CPF-CGC-D10 PIC 9.                           00009600
009610        10 C-CC-TPPESSOA-D10     PIC XX.                          00009610
009620        10 C-CC-TX-PERM-D10      PIC 9.                           00009620
009630        10 C-CC-CALC-SMED-D10    PIC 9.                           00009630
009640     05 C-CC-SLD-ANT-D10         PIC S9(13)V99   COMP-3.          00009640
009650     05 C-CC-TPSLD-ANT-D10       PIC X.                           00009650
009660     05 C-CC-NOME-CLIENTE-D10.                                    00009660
009670        10 C-CC-NOME-D10         PIC X(34).                       00009670
009680        10 C-CC-CONT-NOME-D10    PIC X(34).                       00009680
009690        10 FILLER                PIC X(11).                       00009690
009700     05 C-CC-ENDERECO-D10.                                        00009700
009710        10 C-CC-RUA-D10          PIC X(30).                       00009710
009720        10 C-CC-CIDADE-D10.                                       00009720
009730           15 C-CC-BAIR-D10      PIC X(12).                       00009730
009740           15 C-CC-CEP-D10       PIC 9(8)        COMP-3.          00009740
009750           15 C-CC-CID-D10       PIC X(14).                       00009750
009760           15 C-CC-EST-D10       PIC XX.                          00009760
009770           15 C-CC-FONE-D10      PIC 9(7)        COMP-3.          00009770
009780     05 C-CC-MENS-D10.                                            00009780
009790        10 C-CC-COD-MENS-D10     PIC 99.                          00009790
009800        10 C-CC-NOME-MENS-D10    PIC X(48).                       00009800
009810     05 C-CC-COD-POSTO-D10       PIC 9.                           00009810
009820     05 C-CC-CAMPOS-DO-SOMA.                                      00009820
009830        10 C-CC-COD-TJUR-D10     PIC 99.                          00009830
009840        10 C-CC-INDICA-CTAREMUN-D10   PIC X.                      00009840
009850        10 C-CC-INDICA-TRIB-D10  PIC X.                           00009850
009860        10 C-CC-ALIQ-IRESTL-D10  PIC 999V99   COMP-3.             00009860
009870     05 C-CC-CLI-ESPECIAL-D10    PIC 9.                           00009870
009880     05 C-CC-ISENCAO-IPMF-D10    PIC 9.                           00009880
009890     05 C-CC-TP-TALAO-D10        PIC 9.                           00009890
009900     05 C-CC-AVISO-LANC-D10      PIC X.                           00009900
009910     05 C-CC-OPCAO-PC-D10        PIC X.                           00009910
009920     05 C-CC-MANIFESTACAO-IN89-D10 PIC X.                         00009920
009930     05 C-CC-GRUPO-TARIFA-D10    PIC 9.                           00009930
009940*                                                                 00009940
009990     05 C-CC-CD-CLI-COTIT-D10    PIC 9(08).                       00009990
010000     05 C-CC-IND-ALT-COTIT-D10   PIC X(01).                       00010000
010020*                                                                 00010020
010030     05 C-CC-INI-ISEN-D10        PIC 9(6).                        00010030
010040     05 C-CC-FIM-ISEN-D10        PIC 9(6).                        00010040
010050     05 C-CC-CD-CLI-D10          PIC 9(9)          COMP-3.        00010050
010060*                                                                 00010060
010070   01 REG-CAD-CARTAO-D10.                                         00010070
010080*                                                                 00010080
010090     05 FILLER                   PIC X(13).                       00010090
010100     05 TIPO-MOV-D10             PIC 9.                           00010100
010110     05 SEQ-CARTAO-D10           PIC 9.                           00010110
010120     05 VIA-CARTAO-D10           PIC 9.                           00010120
010130     05 NOME-CARTAO-D10          PIC X(25).                       00010130
010140     05 COD-SERVICO-D10          PIC 99.                          00010140
010150     05 TIPO-DESTINO-D10         PIC X.                           00010150
010160     05 C-CC-COD-MENS-CAR-D10    PIC 99.                          00010160
010170     05 C-CC-NOME-MESN-CAR-D10   PIC X(48).                       00010170
010180     05 FILLER                   PIC X(06).                       00010180
010190                                                                  00010190
010200*    ......................................                       00010200

010220   01 REG-INSUF-D10.                                              00010220
010230*                                                                 00010230
010240     05 FILLER                   PIC X(13).                       00010240
010250     05 INS-TPREG-D10            PIC 9.                           00010250
010260     05 INS-TPCONTAB-D10         PIC 9(03)       COMP-3.          00010260
010270     05 INS-NOME-CLIENTE-D10.                                     00010270
010280        10 INS-NOME-D10          PIC X(34).                       00010280
010290        10 INS-CONT-NOME-D10     PIC X(34).                       00010290
010300        10 INS-CV-D10            PIC X(3).                        00010300
010310     05 INS-ID-CPF-CGC-D10       PIC 9.                           00010310
010320     05 INS-CPF-CGC-D10          PIC 9(15)       COMP-3.          00010320
010330     05 INS-ENDERECO-D10.                                         00010330
010340        10 INS-RUA-D10           PIC X(30).                       00010340
010350        10 INS-CIDADE-D10.                                        00010350
010360           15 INS-BAIR-D10       PIC X(12).                       00010360
010370           15 INS-CEP-D10        PIC 9(8)        COMP-3.          00010370
010380           15 INS-CID-D10        PIC X(14).                       00010380
010390           15 INS-EST-D10        PIC XX.                          00010390
010400           15 INS-FONE-D10       PIC 9(7)        COMP-3.          00010400
010410     05 INS-ANTERIOR-D10.                                         00010410
      * Dados referentes a ultima vez em que a conta esteve com insuficiencia
      * de saldo. Ultima data na qual esteve com insuficiencia e a quantidade
      * de vezes que a conta tinha ficado com insuficiencia de fundos.
010420        10 INS-DATA-ULT-D10      PIC 9(6)        COMP-3.          00010420
010430        10 INS-NUM-VEZES-D10     PIC 999         COMP-3.          00010430
010440     05 INS-SLD-ANT-D10          PIC S9(13)V99   COMP-3.          00010440
010450     05 INS-ATUAL-D10.                                            00010450
      * Data de inicio da insuficiencia de fundos.
010460        10 INS-DATA-INIC-D10     PIC 9(6)        COMP-3.          00010460
      * Quantidade de dias em insuficiencia.
010470        10 INS-NUM-DIAS-D10      PIC 999         COMP-3.          00010470
010480        10 INS-SLDS-ATUAIS-D10.                                   00010480
      * Saldo de deposito atual, que em caso de adiantamento a depositantes
      * sera negativo.
010490           15 INS-SLD-DEP-D10      PIC S9(13)V99   COMP-3.        00010490
010500           15 INS-SLD-BLO-D10      PIC S9(13)V99   COMP-3.        00010500
010510           15 INS-SLD-BLO-24HS-D10 PIC S9(13)V99   COMP-3.        00010510
010520        10 INS-JUROS-D10.                                         00010520
010530           15 INS-JUR-ATL-R-D10  PIC S9(13)V99   COMP-3.          00010530
010540           15 INS-JUR-ATL-D-D10  PIC S9(13)V99   COMP-3.          00010540
010550           15 INS-JUR-1DIA-R-D10 PIC S9(13)V99   COMP-3.          00010550
010560           15 INS-JUR-1DIA-D-D10 PIC S9(13)V99   COMP-3.          00010560
010570        10 INS-IOF-D10.                                           00010570
010580           15 INS-IOF-ATL-R-D10  PIC S9(9)V99    COMP-3.          00010580
010590           15 INS-IOF-ATL-D-D10  PIC S9(9)V99    COMP-3.          00010590
010600           15 INS-IOF-1DIA-R-D10 PIC S9(9)V99    COMP-3.          00010600
010610           15 INS-IOF-1DIA-D-D10 PIC S9(9)V99    COMP-3.          00010610
010620        10 INS-SALDO-MEDIO-D10.                                   00010620
010630           15 INS-NUM-SMEDIO-MES-D10                              00010630
010640                                 PIC 9(11)       COMP-3.          00010640
010650     05 INS-CRED-ANTECIP-D10     PIC S9(13)V99   COMP-3.          00010650
010660     05 INS-COD-POSTO-D10        PIC 9.                           00010660
010670     05 INS-CLI-ESPECIAL-D10     PIC 9.                           00010670
010680     05 INS-CALC-SMED-D10        PIC 9.                           00010680
010690     05 INS-QDE-OCORR-D10        PIC 9(03)       COMP-3.          00010690
010700     05 INS-CTRL-FIM-D10         PIC 9.                           00010700
010710     05 INS-RAP-D10              PIC S9(13)V99   COMP-3.          00010710
010710     05 INS-TPPES-D10            PIC XX.                          00010710
010710     05 INS-GRTAR-D10            PIC 9.                           00010710
010720*                                                                 00010720
010730*    ......................................                       00010730
010750                                                                  00010750
010760   01 REG-INSUF-MOVTOS-D10.                                       00010760
010770                                                                  00010770
010780    05 FILLER                   PIC X(13).                        00010780
010790    05 INS-MOV-TPREG-D10        PIC 9.                            00010790
010800    05 INS-MOVTOS-D10.                                            00010800
010810       10 INS-MOV-LOTE-D10      PIC 99.                           00010810
010820       10 INS-MOV-HIST-D10      PIC 9(05)          COMP-3.        00010820
010830       10 INS-MOV-REF-D10       PIC 9(6)           COMP-3.        00010830
010840       10 INS-MOV-VR-D10        PIC S9(13)V99      COMP-3.        00010840
010850    05 FILLER                   PIC X(70).                        00010850
010860                                                                  00010860
010870*    ......................................                       00010870
010890                                                                  00010890
010900   01 REG-CAD-EMP-D10.                                            00010900
010910*                                                                 00010910
010920     05 FILLER                   PIC X(13).                       00010920
010930     05 C-EMP-TPCONTAB-D10       PIC 9(03)       COMP-3.          00010930
010940     05 C-EMP-NOME-CLIENTE-D10.                                   00010940
010950        10 C-EMP-NOME-D10        PIC X(34).                       00010950
010960        10 C-EMP-CONT-NOME-D10   PIC X(34).                       00010960
010970        10 FILLER                PIC X(9).                        00010970
010980     05 C-EMP-TPPES-D10          PIC XX.                          00010980
010990     05 C-EMP-ENDERECO-D10.                                       00010990
011000        10 C-EMP-RUA-D10         PIC X(30).                       00011000
011010        10 C-EMP-CIDADE-D10.                                      00011010
011020           15 C-EMP-BAIR-D10     PIC X(12).                       00011020
011030           15 C-EMP-CEP-D10      PIC 9(8)        COMP-3.          00011030
011040           15 C-EMP-CID-D10      PIC X(14).                       00011040
011050           15 C-EMP-EST-D10      PIC XX.                          00011050
011060           15 C-EMP-FONE-D10     PIC 9(7)        COMP-3.          00011060
011070     05 C-EMP-SLDS-D10.                                           00011070
011080        10 C-EMP-SMED-TRIM-D10   PIC S9(13)      COMP-3.          00011080
011090        10 C-EMP-SLD-CONTA-D10   PIC S9(13)V99   COMP-3.          00011090
011100        10 C-EMP-TPSLD-D10       PIC X.                           00011100
011110     05 C-EMP-VENC-D10           PIC 9(6)        COMP-3.          00011110
011120     05 C-EMP-LIM-D10            PIC S9(13)V99   COMP-3.          00011120
011130     05 CAD-EMP-TAXA-D10         PIC 99V999      COMP-3.          00011130
011140     05 C-EMP-JUR-DEV-D10        PIC S9(13)V99   COMP-3.          00011140
011150     05 C-EMP-IOF-D10            PIC S9(11)V99   COMP-3.          00011150
011160     05 C-EMP-COD-POSTO-D10      PIC 9.                           00011160
011170     05 C-EMP-CLI-ESPECIAL-D10   PIC 9.                           00011170
011180     05 C-EMP-SEG-D10            PIC X.                           00011180
011190     05 C-EMP-MENS-D10.                                           00011190
011200        10 C-EMP-COD-MENS-D10    PIC 99.                          00011200
011210        10 C-EMP-NOME-MENS-D10   PIC X(44).                       00011210
011220     05 C-EMP-PROPOSTA-D10       PIC 9(15)       COMP-3.          00011220
011230     05 C-EMP-RAP-D10            PIC S9(13)V99   COMP-3.          00011230
011240     05 C-EMP-DIA-DEBITO-D10     PIC 99.                          00011240
           05 C-EMP-IDPES-D10          PIC 9.
           05 C-EMP-GRTAR-D10          PIC 9.

011250*                                                                 00011250
011260   01 REG-AC-NUM-D10.                                             00011260
011270*                                                                 00011270
011280     05 FILLER                   PIC X(13).                       00011280
011290     05 AC-N-NOME-D10            PIC X(40).                       00011290
011300     05 AC-N-NANTERIOR-D10.                                       00011300
011310        10 AC-N-DTAULT-NANT-D10  PIC 9(6)        COMP-3.          00011310
011320        10 AC-N-NANT-D10         PIC S9(13)      COMP-3.          00011320
011330     05 AC-N-COMANDO-D10.                                         00011330
011340        10 AC-N-DOC-D10          PIC 9(6)        COMP-3.          00011340
011350        10 AC-N-NUMEROS-D10      PIC S9(13)      COMP-3.          00011350
011360     05 AC-N-NATL-D10            PIC S9(13)      COMP-3.          00011360
011370     05 AC-N-NVEZES-D10          PIC 999         COMP-3.          00011370
011380     05 AC-N-MENS-D10.                                            00011380
011390        10 AC-N-COD-MENS-D10     PIC 99.                          00011390
011400        10 AC-N-NOME-MENS-D10    PIC X(48).                       00011400
011410     05 AC-N-COD-POSTO-D10       PIC 9.                           00011410
011420     05 AC-N-CLI-ESPECIAL-D10    PIC 9.                           00011420
011430     05 FILLER                   PIC X(114).                      00011430
011440*                                                                 00011440
011450*    ......................................                       00011450

011470   01 REG-CTA-VENC-D10.                                           00011470
011480*                                                                 00011480
011490     05 FILLER                   PIC X(13).                       00011490
011500     05 CV-NOME-CLIENTE-D10.                                      00011500
011510        10 CV-NOME-D10           PIC X(34).                       00011510
011520        10 CV-CONT-NOME-D10      PIC X(34).                       00011520
011530        10 FILLER                PIC X(12).                       00011530
011540     05 CV-ENDERECO-D10.                                          00011540
011550        10 CV-RUA-D10            PIC X(30).                       00011550
011560        10 CV-CIDADE-D10.                                         00011560
011570           15 CV-BAIR-D10        PIC X(12).                       00011570
011580           15 CV-CEP-D10         PIC 9(8)        COMP-3.          00011580
011590           15 CV-CID-D10         PIC X(14).                       00011590
011600           15 CV-EST-D10         PIC XX.                          00011600
011610           15 CV-FONE-D10        PIC 9(7)        COMP-3.          00011610
011620     05 CV-SLDS-D10.                                              00011620
011630        10 CV-SLD-DEP-D10        PIC S9(13)V99   COMP-3.          00011630
011640        10 CV-SLD-EMP-D10        PIC S9(13)V99   COMP-3.          00011640
011650        10 CV-SMED-D10           PIC S9(13)      COMP-3.          00011650
011660     05 CV-CONTER-D10.                                            00011660
011670        10 CV-EMP-VENC-D10       PIC 9(6)        COMP-3.          00011670
011680        10 CV-EMP-LIM-D10        PIC S9(13)V99   COMP-3.          00011680
011690        10 CV-EMP-NUM-D10        PIC S9(13)      COMP-3.          00011690
011700        10 CV-EMP-TAXA-D10       PIC 99V999      COMP-3.          00011700
011710        10 CV-JUR-1DIA-D10       PIC S9(9)V99    COMP-3.          00011710
011720        10 CV-JUR-EMIS-D10       PIC S9(9)V99    COMP-3.          00011720
011730        10 CV-EMP-NUM-IOF-D10    PIC S9(11)V99   COMP-3.          00011730
011740        10 CV-IOF-1DIA-D10       PIC S9(9)V99    COMP-3.          00011740
011750        10 CV-IOF-EMIS-D10       PIC S9(9)V99    COMP-3.          00011750
011760     05 CV-TEMPO-D10.                                             00011760
011770        10 CV-ULT-MOV-D10        PIC 9(6)        COMP-3.          00011770
011780        10 CV-QDE-DIA-D10        PIC 999.                         00011780
011790        10 CV-TR-CL-D10          PIC 9.                           00011790
011800     05 CV-COD-POSTO-D10         PIC 9.                           00011800
011810     05 CV-CLI-ESPECIAL-D10      PIC 9.                           00011810
011820     05 CV-EMP-SEG-D10           PIC X.                           00011820
011830     05 FILLER                   PIC X(03).                       00011830
011840*                                                                 00011840
011850*    ......................................                       00011850

011870   01 REG-EXCESSO-D10.                                            00011870
011880*                                                                 00011880
011890     05 FILLER                   PIC X(13).                       00011890
011900     05 EXC-TPREG-D10            PIC 9.                           00011900
011910     05 EXC-NOME-CLIENTE-D10.                                     00011910
011920        10 EXC-NOME-D10          PIC X(34).                       00011920
011930        10 EXC-CONT-NOME-D10     PIC X(34).                       00011930
011940        10 EXC-GARANTIA-D10      PIC XX.                          00011940
011950        10 FILLER                PIC X.                           00011950
011960     05 EXC-ID-CPF-CGC-D10       PIC 9.                           00011960
011970     05 EXC-CPF-CGC-D10          PIC 9(15)       COMP-3.          00011970
011980     05 EXC-ENDERECO-D10.                                         00011980
011990        10 EXC-RUA-D10           PIC X(30).                       00011990
012000        10 EXC-CIDADE-D10.                                        00012000
012010           15 EXC-BAIR-D10       PIC X(12).                       00012010
012020           15 EXC-CEP-D10        PIC 9(8)        COMP-3.          00012020
012030           15 EXC-CID-D10        PIC X(14).                       00012030
012040           15 EXC-EST-D10        PIC XX.                          00012040
012050           15 EXC-FONE-D10       PIC 9(7)        COMP-3.          00012050
012060     05 EXC-DATA-ANT-D10         PIC 9(6)        COMP-3.          00012060
012070     05 EXC-NVEZES-D10           PIC 999         COMP-3.          00012070
012080     05 EXC-SLD-ANT-D10          PIC S9(13)V99   COMP-3.          00012080
012090     05 EXC-EXCESSO-D10.                                          00012090
012100        10 EXC-DATA-INIC-D10     PIC 9(6)        COMP-3.          00012100
012110        10 EXC-NDIA-D10          PIC 999         COMP-3.          00012110
012120        10 EXC-SLD-EMP-D10       PIC S9(13)V99   COMP-3.          00012120
012130        10 EXC-SLD-BLO-D10       PIC S9(13)V99   COMP-3.          00012130
012140        10 EXC-SLD-BLO-24HS-D10  PIC S9(13)V99   COMP-3.          00012140
012150        10 EXC-EMP-LIM-D10       PIC S9(13)V99   COMP-3.          00012150
012160        10 EXC-VALOR-D10         PIC S9(13)V99   COMP-3.          00012160
012170        10 EXC-VENCTO-EMP-D10    PIC 9(6)        COMP-3.          00012170
012180        10 EXC-TAXA-D10          PIC 99V999      COMP-3.          00012180
012190     05 EXC-SALDO-MEDIO.                                          00012190
012200        10 EXC-NUM-SMEDIO-MES-D10                                 00012200
012210                                 PIC 9(13)       COMP-3.          00012210
012220     05 EXC-CRED-ANTECIP-D10     PIC S9(13)V99   COMP-3.          00012220
012230     05 EXC-COD-POSTO-D10        PIC 9.                           00012230
012240     05 EXC-TPES-D10             PIC XX.                          00012240
012250     05 EXC-CLI-ESPECIAL-D10     PIC 9.                           00012250
012260     05 EXC-CALC-SMED-D10        PIC 9.                           00012260
012270     05 EXC-EMP-SEG-D10          PIC X.                           00012270
012280     05 EXC-QDE-OCORR-D10        PIC 9(3)        COMP-3.          00012280
012290     05 EXC-CTRL-FIM-D10         PIC 9.                           00012290
012300     05 EXC-VEZ-CONTRATO-D10     PIC 9(3) COMP-3.                 00012300
012310     05 EXC-EMP-DATA-D10         PIC 9(6) COMP-3.                 00012310
012320     05 EXC-RESTO-D10            PIC X(22).                       00012320
           05 EXC-GRTAR-D10            PIC 9.
012330*                                                                 00012330
012340   01 REG-EXCESSO-MOVTOS-D10.                                     00012340
012350                                                                  00012350
012360    05 FILLER                   PIC X(13).                        00012360
012370    05 EXC-MOV-TPREG-D10        PIC 9.                            00012370
012380    05 EXC-MOVTOS-D10.                                            00012380
012390       10 EXC-MOV-LOTE-D10      PIC 99.                           00012390
012400       10 EXC-MOV-HIST-D10      PIC 9(05)          COMP-3.        00012400
012410       10 EXC-MOV-REF-D10       PIC 9(6)           COMP-3.        00012410
012420       10 EXC-MOV-VR-D10        PIC S9(13)V99      COMP-3.        00012420
012430    05 FILLER                   PIC X(70).                        00012430
012440                                                                  00012440
012450   01 REG-JUROS-IOF-D10.                                          00012450
012460*                                                                 00012460
012470     05 FILLER                   PIC X(13).                       00012470
012480     05 JUR-NOME-D10             PIC X(40).                       00012480
012490     05 JUR-SLD-ATL-D10          PIC S9(13)V99   COMP-3.          00012490
012500     05 JUR-TPSLD-D10            PIC X.                           00012500
012510     05 JUR-COBR-D10.                                             00012510
012520        10 JUR-NUM-D10           PIC S9(13)      COMP-3.          00012520
012530        10 JUR-IOF-MEDIA-D10 REDEFINES JUR-NUM-D10                00012530
012540                                 PIC S9(11)V99   COMP-3.          00012540
012550        10 JUR-TAXA-D10          PIC 99V999      COMP-3.          00012550
012560        10 JUR-COB-D10           PIC S9(13)V99   COMP-3.          00012560
012570        10 JUR-DEV-D10           PIC S9(13)V99   COMP-3.          00012570
012580        10 JUR-CANC-D10          PIC X.                           00012580
012590        10 JUR-DIF-D10           PIC S9(13)V99   COMP-3.          00012590
012600     05 JUR-COD-POSTO-D10        PIC 9.                           00012600
012610     05 JUR-CLI-ESPECIAL-D10     PIC 9.                           00012610
012620     05 JUR-SEG-D10              PIC X.                           00012620
012640*                                                                 00012640
012650   01 REG-TR-P-EMP-D10.                                           00012650
012660*                                                                 00012660
012670     05 FILLER                   PIC X(13).                       00012670
012680     05 TPE-NOME-D10             PIC X(40).                       00012680
012690     05 TPE-VALOR-D10            PIC 9(13)V99    COMP-3.          00012690
012700     05 TPE-COD-POSTO-D10        PIC 9.                           00012700
012710     05 TPE-CLI-ESPECIAL-D10     PIC 9.                           00012710
012720     05 FILLER                   PIC X(37).                       00012720
012730*                                                                 00012730
012740*    ......................................                       00012740

012760   01 REG-TR-DE-EMP-D10.                                          00012760
012770*                                                                 00012770
012780     05 FILLER                   PIC X(13).                       00012780
012790     05 TDE-NOME-D10             PIC X(40).                       00012790
012800     05 TDE-VALOR-D10            PIC 9(13)V99    COMP-3.          00012800
012810     05 TDE-COD-POSTO-D10        PIC 9.                           00012810
012820     05 TDE-CLI-ESPECIAL-D10     PIC 9.                           00012820
012830     05 FILLER                   PIC X(37).                       00012830
012840*                                                                 00012840
012870*--------- REGS DE TRANSFERENCIA PARA/DA CHEQUE EMPRESA    -------00012870
012880*                                                                 00012880
012890   01 TR-P-CHE-IND-D10.                                           00012890
012900*                                                                 00012900
012910     05 FILLER                   PIC X(13).                       00012910
012920     05 CPI-NOME-D10             PIC X(40).                       00012920
012930     05 CPI-VALOR-D10            PIC 9(13)V99    COMP-3.          00012930
012940     05 CPI-COD-POSTO-D10        PIC 9.                           00012940
012950     05 CPI-CLI-ESPECIAL-D10     PIC 9.                           00012950
012960     05 FILLER                   PIC X(37).                       00012960
012970*                                                                 00012970
012980   01 TR-P-CHE-COM-D10.                                           00012980
012990*                                                                 00012990
013000     05 FILLER                   PIC X(13).                       00013000
013010     05 CPC-NOME-D10             PIC X(40).                       00013010
013020     05 CPC-VALOR-D10            PIC 9(13)V99    COMP-3.          00013020
013030     05 CPC-COD-POSTO-D10        PIC 9.                           00013030
013040     05 CPC-CLI-ESPECIAL-D10     PIC 9.                           00013040
013050     05 FILLER                   PIC X(37).                       00013050
013060*                                                                 00013060
013070   01 TR-P-CHE-OUT-D10.                                           00013070
013080*                                                                 00013080
013090     05 FILLER                   PIC X(13).                       00013090
013100     05 CPO-NOME-D10             PIC X(40).                       00013100
013110     05 CPO-VALOR-D10            PIC 9(13)V99    COMP-3.          00013110
013120     05 CPO-COD-POSTO-D10        PIC 9.                           00013120
013130     05 CPO-CLI-ESPECIAL-D10     PIC 9.                           00013130
013140     05 FILLER                   PIC X(37).                       00013140
013150*                                                                 00013150
013160   01 TR-D-CHE-IND-D10.                                           00013160
013170*                                                                 00013170
013180     05 FILLER                   PIC X(13).                       00013180
013190     05 CDI-NOME-D10             PIC X(40).                       00013190
013200     05 CDI-VALOR-D10            PIC 9(13)V99    COMP-3.          00013200
013210     05 CDI-COD-POSTO-D10        PIC 9.                           00013210
013220     05 CDI-CLI-ESPECIAL-D10     PIC 9.                           00013220
013230     05 FILLER                   PIC X(37).                       00013230
013240*                                                                 00013240
013250   01 TR-D-CHE-COM-D10.                                           00013250
013260*                                                                 00013260
013270     05 FILLER                   PIC X(13).                       00013270
013280     05 CDC-NOME-D10             PIC X(40).                       00013280
013290     05 CDC-VALOR-D10            PIC 9(13)V99    COMP-3.          00013290
013300     05 CDC-COD-POSTO-D10        PIC 9.                           00013300
013310     05 CDC-CLI-ESPECIAL-D10     PIC 9.                           00013310
013320     05 FILLER                   PIC X(37).                       00013320
013330*                                                                 00013330
013340   01 TR-D-CHE-OUT-D10.                                           00013340
013350*                                                                 00013350
013360     05 FILLER                   PIC X(13).                       00013360
013370     05 CDO-NOME-D10             PIC X(40).                       00013370
013380     05 CDO-VALOR-D10            PIC 9(13)V99    COMP-3.          00013380
013390     05 CDO-COD-POSTO-D10        PIC 9.                           00013390
013400     05 CDO-CLI-ESPECIAL-D10     PIC 9.                           00013400
013410     05 FILLER                   PIC X(37).                       00013410
013430*                                                                 00013430
013440*--------- REGS DE TRANSFERENCIA PARA/DA CONTA EMPRESARIAL -------00013440
013450*                                                                 00013450
013460   01 TR-P-CTA-E-IND-D10.                                         00013460
013470*                                                                 00013470
013480     05 FILLER                   PIC X(13).                       00013480
013490     05 TPI-NOME-D10             PIC X(40).                       00013490
013500     05 TPI-VALOR-D10            PIC 9(13)V99    COMP-3.          00013500
013510     05 TPI-COD-POSTO-D10        PIC 9.                           00013510
013520     05 TPI-CLI-ESPECIAL-D10     PIC 9.                           00013520
013530     05 FILLER                   PIC X(37).                       00013530
013540*                                                                 00013540
013550   01 TR-P-CTA-E-COM-D10.                                         00013550
013560*                                                                 00013560
013570     05 FILLER                   PIC X(13).                       00013570
013580     05 TPC-NOME-D10             PIC X(40).                       00013580
013590     05 TPC-VALOR-D10            PIC 9(13)V99    COMP-3.          00013590
013600     05 TPC-COD-POSTO-D10        PIC 9.                           00013600
013610     05 TPC-CLI-ESPECIAL-D10     PIC 9.                           00013610
013620     05 FILLER                   PIC X(37).                       00013620
013630*                                                                 00013630
013640   01 TR-P-CTA-E-OUT-D10.                                         00013640
013650*                                                                 00013650
013660     05 FILLER                   PIC X(13).                       00013660
013670     05 TPO-NOME-D10             PIC X(40).                       00013670
013680     05 TPO-VALOR-D10            PIC 9(13)V99    COMP-3.          00013680
013690     05 TPO-COD-POSTO-D10        PIC 9.                           00013690
013700     05 TPO-CLI-ESPECIAL-D10     PIC 9.                           00013700
013710     05 FILLER                   PIC X(37).                       00013710
013720*                                                                 00013720
013730   01 TR-D-CTA-E-IND-D10.                                         00013730
013740*                                                                 00013740
013750     05 FILLER                   PIC X(13).                       00013750
013760     05 TDI-NOME-D10             PIC X(40).                       00013760
013770     05 TDI-VALOR-D10            PIC 9(13)V99    COMP-3.          00013770
013780     05 TDI-COD-POSTO-D10        PIC 9.                           00013780
013790     05 TDI-CLI-ESPECIAL-D10     PIC 9.                           00013790
013800     05 FILLER                   PIC X(37).                       00013800
013810*                                                                 00013810
013820   01 TR-D-CTA-E-COM-D10.                                         00013820
013830*                                                                 00013830
013840     05 FILLER                   PIC X(13).                       00013840
013850     05 TDC-NOME-D10             PIC X(40).                       00013850
013860     05 TDC-VALOR-D10            PIC 9(13)V99    COMP-3.          00013860
013870     05 TDC-COD-POSTO-D10        PIC 9.                           00013870
013880     05 TDC-CLI-ESPECIAL-D10     PIC 9.                           00013880
013890     05 FILLER                   PIC X(37).                       00013890
013900*                                                                 00013900
013910   01 TR-D-CTA-E-OUT-D10.                                         00013910
013920*                                                                 00013920
013930     05 FILLER                   PIC X(13).                       00013930
013940     05 TDO-NOME-D10             PIC X(40).                       00013940
013950     05 TDO-VALOR-D10            PIC 9(13)V99    COMP-3.          00013950
013960     05 TDO-COD-POSTO-D10        PIC 9.                           00013960
013970     05 TDO-CLI-ESPECIAL-D10     PIC 9.                           00013970
013980     05 FILLER                   PIC X(37).                       00013980
013990*                                                                 00013990
014000   01 NUF-NAO-UTILIZACAO-PF-D10.                                  00014000
014010*                                                                 00014010
014020     05 FILLER                   PIC X(13).                       00014020
014030     05 NUF-NOME-D10             PIC X(40).                       00014030
014040     05 NUF-VALOR-D10            PIC 9(13)V99    COMP-3.          00014040
014050     05 NUF-COD-POSTO-D10        PIC 9.                           00014050
014060     05 NUF-CLI-ESPECIAL-D10     PIC 9.                           00014060
014070     05 FILLER                   PIC X(37).                       00014070
014080*                                                                 00014080
014090   01 NUJ-NAO-UTILIZACAO-PJ-D10.                                  00014090
014100*                                                                 00014100
014110     05 FILLER                   PIC X(13).                       00014110
014120     05 NUJ-NOME-D10             PIC X(40).                       00014120
014130     05 NUJ-VALOR-D10            PIC 9(13)V99    COMP-3.          00014130
014140     05 NUJ-COD-POSTO-D10        PIC 9.                           00014140
014150     05 NUJ-CLI-ESPECIAL-D10     PIC 9.                           00014150
014160     05 FILLER                   PIC X(37).                       00014160
014170*-----------------------------------------------------------------
014180   01 REG-COM-PERMAN-D10.
014200     05 FILLER                   PIC X(13).
014210     05 CP-TPCONTAB-D10          PIC 9(03)       COMP-3.
014220     05 CP-NOME-D10              PIC X(40).
014230     05 CP-VALOR-D10             PIC S9(13)V99   COMP-3.
014240     05 CP-COD-POSTO-D10         PIC 9.
014250     05 CP-CLI-ESPECIAL-D10      PIC 9.
014260     05 FILLER                   PIC X(35).
014270*
014280   01 REG-RAZAO-D10.
014300     05 FILLER                   PIC X(13).
014310     05 RZ-CONTAS-D10.
014320        10 RZ-TPCONTAB-D10       PIC 9(03)       COMP-3.
014330        10 RZ-NOME-CONTAB-D10    PIC X(30).
014340        10 RZ-VRS-ANT-D10.
014350           15 RZ-TOTCTAS-ANT-D10 PIC 9(5)        COMP-3.
014360           15 RZ-TOTSLDS-ANT-D10 PIC S9(13)V99   COMP-3.
014370        10 RZ-CRED-D10.
014380           15 RZ-C-QDE-D10       PIC 9(5)        COMP-3.
014390           15 RZ-C-VR-D10        PIC S9(13)V99   COMP-3.
014400        10 RZ-DEB-D10.
014410           15 RZ-D-QDE-D10       PIC 9(5)        COMP-3.
014420           15 RZ-D-VR-D10        PIC S9(13)V99   COMP-3.
014430        10 RZ-VRS-ATL-D10.
014440           15 RZ-TOTCTAS-ATL-D10 PIC 9(5)        COMP-3.
014450           15 RZ-TOTSLDS-ATL-D10 PIC S9(13)V99   COMP-3.
014460     05 RZ-DIFERENCA-D10.
014470        10 RZ-DIF-CTAS-D10       PIC 9(5)        COMP-3.
014480        10 RZ-DIF-SLDS-D10       PIC S9(13)V99   COMP-3.
014490     05 RZ-COD-POSTO-D10         PIC 9.
014500     05 RZ-CLI-ESPECIAL-D10      PIC 9.
014510     05 FILLER                   PIC X(148).
014530*    ......................................
014550   01 REG-FH-RECOL-D10.
014570     05 FILLER                   PIC X(13).

250412     05 ESSENCIA-FH-RECOL-D10    PIC X(72).
250412     05 FILLER                   PIC X(15).
014600
014610
014620
014630  FD ArqContasUpdate
014640     RECORD CONTAINS 200 TO 1250 CHARACTERS.
014660
014670 01  REG-HEADER-AG-ARQ-UPDT.
014680     05  CHAVE-ARQ-UPDT.
014690         10  SEQUENCIAL-ARQ-UPDT        PIC 9(04).
014700         10  CH-AG-ARQ-UPDT             PIC 9(05)    COMP-3.
014710         10  CH-NUM-CONTA-ARQ-UPDT.
014720             15  CH-CONTA-ARQ-UPDT      PIC 9(09)    COMP-3.
014730             15  CH-DIGITO-ARQ-UPDT     PIC X.
014740         10  CH-TIPOREG-ARQ-UPDT        PIC 9.
014750         10  CH-SEQUENCIAL-ARQ-UPDT     PIC 999.
014760     05  FILLER                         PIC X(183).
014770 01  REG-EXTRATO-ARQ-UPDT               PIC X(376).
014780 01  REG-CORRENT-ARQ-UPDT               PIC X(1200).
014790 01  REG-TRAILLER-AG-ARQ-UPDT           PIC X(1250).
014800
014810 FD  D04883
014820     RECORD CONTAINS 39 CHARACTERS
014830     RECORDING MODE IS F
014840     BLOCK CONTAINS 0 RECORDS
014850     DATA RECORD IS REG-D83.
014860
014870 01  REG-D83.
014880     05 DATA-D83.
014890        10 DIA-D83              PIC 99.
014900        10 MES-D83              PIC 99.
014910        10 ANO-D83              PIC 99.
014920     05 AGN-D83                 PIC 9(05)      COMP-3.
014930     05 EVENTO-D83              PIC 9(5).
014940     05 DIG-EVENTO-D83          PIC 9.
014950     05 LANCTO-D83              PIC 9.
014960     05 TITULAR-D83             PIC 9(09)      COMP-3.
014970     05 DIG-TITULAR-D83         PIC 9.
014980     05 VALOR-D83               PIC 9(13)V99.
014990     05 TIPO-CONTABIL-D83       PIC 9(3)       COMP-3.

       FD  D04807B
           RECORD CONTAINS 240 CHARACTERS
           BLOCK CONTAINS 0 RECORDS
           RECORDING MODE IS F.

       01  REG-D07B.
           05 CHAVE-D07B.
              10 CH-TPREG-D07B         PIC 9(01).
              10 CH-CODAG-D07B         PIC 9(05)       COMP-3.
              10 CH-DATA-D07B          PIC 9(06)       COMP-3.
              10 CH-N-LOTE-D07B        PIC 9(02).
              10 CH-HIST-D07B          PIC 9(05).
              10 CH-CONTA-D07B.
                 15 CONTA-D07B         PIC 9(09)       COMP-3.
                 15 DV-CONTA-D07B      PIC X(01).
            05 TR-REF-D07B             PIC 9(06)       COMP-3.
            05 TR-VALOR-D07B           PIC 9(13)V99    COMP-3.
            05 PRAZO-DESBLOQ-D07B      PIC 9(02).
            05 DATA-REMUN-D07B         PIC 9(06)       COMP-3.
            05 TPMOV-D07B              PIC 9(02).
            05 ZEROS-1                 PIC X(164).
            05 ZEROS-2                 PIC X(35).

014100 FD  ArqAgencias
014200     RECORD CONTAINS 80 CHARACTERS
014300     LABEL RECORD STANDARD.
           COPY B048AGES.
015330
015340 FD  TabUtils                                                     00015340
015360     RECORD CONTAINS 179 CHARACTERS.                              00015360
015390                                                                  00015390
015400 01  REG-D01.                                                     00015400
015410     05 CHAVE-D01.                                                00015410
015420        10  CHAVE-TAXA-D01.                                       00015420
015430            15 TABE-TAXA-D01         PIC X(4).                    00015430
015440               88 TAB-TAXAS                     VALUE 'TBTX'.     00015440
015450               88 TAB-AGENCIAS                  VALUE 'TBAG'.     00015450
015460               88 TAB-FERIADO                   VALUE 'TBF2'.     00015460
015470            15 COD-TAXA-D01          PIC X(4).                    00015470
015480               88 JUROS-INSUF                   VALUE '00CP'.     00015480
015490               88 IOC-INSUF                     VALUE '020I'.     00015490
015500               88 IOC-CONTERR                   VALUE '000I'.     00015500
015510               88 IOC-JURID                     VALUE 'IOCJ'.     00015510
015520               88 IOC-FISICA                    VALUE 'IOCF'.     00015520
015530               88 JUR-CONT-NFUN                 VALUE '060E'.     00015530
015540               88 JUR-CONT-FUNC                 VALUE '040E'.     00015540
015550               88 JUR-CH-EMPRESA                VALUE '080E'.     00015550
015560               88 MVR                           VALUE 'MMVR'.     00015560
015570               88 OTN                           VALUE 'MOTN'.     00015570
015580               88 OTNF                          VALUE 'IOTN'.     00015580
015590               88 FATOR-CH-EMPRESA              VALUE 'FCHE'.     00015590
015600               88 FATOR-CH-ESPECIAL             VALUE 'CHEF'.     00015600
015610               88 FATOR-CH-FUNC                 VALUE 'CHED'.     00015610
015620               88 FATOR-CTA-EMPRESAR            VALUE 'FCEM'.     00015620
015630               88 SPREAD05                      VALUE 'F005'.     00015630
015640               88 SPREAD06                      VALUE 'F006'.     00015640
015650               88 SPREAD07                      VALUE 'F007'.     00015650
015660               88 SPREAD08                      VALUE 'F008'.     00015660
015670               88 SPREAD09                      VALUE 'F009'.     00015670
015680               88 SPREAD10                      VALUE 'F010'.     00015680
015690               88 SPREAD11                      VALUE 'F011'.     00015690
015700               88 SPREAD12                      VALUE 'F012'.     00015700
015710               88 SPREAD13                      VALUE 'F013'.     00015710
015720               88 SPREAD14                      VALUE 'F014'.     00015720
015730               88 SPREAD15                      VALUE 'F015'.     00015730
015740               88 FATOR-INSUF-PJ                VALUE 'IAC '.     00015740
015750               88 FATOR-INSUF-PF                VALUE 'IAC '.     00015750
015760               88 BTN                           VALUE 'BTNF'.     00015760
015770               88 IDRM                          VALUE 'IDRM'.     00015770
015780               88 IDER                          VALUE 'IDER'.     00015780
015790        10 SITUACAO-TX-D01       PIC 9.                           00015790
015800           88 TAXA-ATUALIZADA                    VALUE 1.         00015800
015810        10 RESTO-CHAVE-D01       PIC X(27).                       00015810
015820     05 VR-TAXA-D01              PIC 9(06).                       00015820
015830     05 VR-TAXA-RED-D01 REDEFINES VR-TAXA-D01                     00015830
015840                                 PIC 99V9999.                     00015840
015850     05 VIGENCIA-D01             PIC 9(6).                        00015850
015860     05 VIGENCIA-RED-D01 REDEFINES VIGENCIA-D01.                  00015860
015870        10 FILLER                PIC 99.                          00015870
015880        10 VIG-MENSAL            PIC 9(4).                        00015880
015890     05 FILLER                   PIC X(07).                       00015890
015900     05 VR-MVR-OTN-D01           PIC 9(16).                       00015900
015910     05 VR-MVR-OTN-RED-D01 REDEFINES VR-MVR-OTN-D01               00015910
015920                                 PIC 9(14)V99.                    00015920
015930     05 VR-OTNF-D01 REDEFINES VR-MVR-OTN-RED-D01                  00015930
015940                                 PIC 9(10)V9(6).                  00015940
015950     05 FATOR-JUR-D01 REDEFINES VR-OTNF-D01                       00015950
015960                                 PIC 9(7)V9(9).                   00015960
015970     05 VR-ITAH-D01 REDEFINES FATOR-JUR-D01                       00015970
015980                                 PIC 9(12)V9(4).                  00015980
015990     05 VR-ITAF-D01 REDEFINES FATOR-JUR-D01                       00015990
016000                                 PIC 9(12)V9(4).                  00016000
016010     05 VR-IDRM-D01 REDEFINES FATOR-JUR-D01                       00016010
016020                                 PIC 9(8)V9(8).                   00016020
016030     05 FILLER                   PIC X(108).                      00016030
016040                                                                  00016040
016050 01  REG-AGN-D01.                                                 00016050
016060     05 FILLER                   PIC X(5).                        00016060
016070     05 COD-AGN-D01              PIC 999.                         00016070
016080     05 FILLER                   PIC X(28).                       00016080
016090     05 TAB-AGENCIAS-D01.                                         00016090
016100        10 TIPO-AG-D01           PIC 9.                           00016100
016110        10 CLASSE-AG-D01         PIC 9.                           00016110
016120        10 COD-ESTADO-D01        PIC 99.                          00016120
016130        10 COD-ANT-D01           PIC 999.                         00016130
016140        10 NOME-AG-D01           PIC X(30).                       00016140
016150        10 REGIAO-D01            PIC 9.                           00016150
016160        10 SIGLA-D01             PIC XX.                          00016160
016170        10 GRUPO-D01             PIC X.                           00016170
016180        10 INSTALACAO-D01        PIC 9.                           00016180
016190        10 GRUPO-SELIC-D01       PIC 9.                           00016190
016200        10 CLASSE-SELIC-D01      PIC 9.                           00016200
016210        10 FILLER                PIC X(99).                       00016210
016220                                                                  00016220
016230 01  REG-FER-D01.                                                 00016230
016240     05 FILLER                   PIC X(4).                        00016240
016250     05 EVENTO-D01               PIC 999.                         00016250
016260     05 DATA-FER-D01.                                             00016260
016270        10 ANO-FER-D01           PIC 9999.                        00016270
016280        10 MES-FER-D01           PIC 99.                          00016280
016290        10 DIA-FER-D01           PIC 99.                          00016290
016300     05 FILLER                   PIC X(164).                      00016300
016310*    ......................................                       00016310
016320                                                                  00016320
016330 FD  D15901                                                       00016330
EXP048     RECORD CONTAINS 104 CHARACTERS.                              00016340
016360                                                                  00016360
016370 01  REG-D159.                                                    00016370
016380     05 CHAVE-D159.                                               00016380
016390        10 AGENCIA-D159          PIC 999.                         00016390
016400        10 CONTA-D159            PIC 9(9).                        00016400
016410        10 DIGITO-D159           PIC 9.                           00016410
016420     05 DATA-D159                PIC 9(8).                        00016420
016430     05 SALDO-D159               PIC S9(13)V99 COMP-3.            00016430
016440     05 BLOQ-1-D159              PIC S9(13)V99 COMP-3.            00016440
016450     05 BLOQ-2-D159              PIC S9(13)V99 COMP-3.            00016450
016460     05 BLOQ-3-D159              PIC S9(13)V99 COMP-3.            00016460
016470     05 BLOQ-4-D159              PIC S9(13)V99 COMP-3.            00016470
016480     05 BLOQ-5-D159              PIC S9(13)V99 COMP-3.            00016480
016490     05 BLOQ-6-D159              PIC S9(13)V99 COMP-3.            00016490
016500     05 BLOQ-7-D159              PIC S9(13)V99 COMP-3.            00016500
016510     05 BLOQ-8-D159              PIC S9(13)V99 COMP-3.            00016510
EXP048     05 FILLER                   PIC  X(11).                      00016520
016530                                                                  00016530
016540 FD  D13002                                                       00016540
016550     RECORD CONTAINS 100 CHARACTERS.                              00016550
016560                                                                  00016560
016570 01  REGISTRO-D02.                                                00016570
016580     05 CHAVE-D02.                                                00016580
016590       10 COD-AGENCIA-D02        PIC 9(04).                       00016590
016600       10 CONTA-CORRENTE-D02     PIC 9(10).                       00016600
016610       10 DATA-VENCIMENTO-D02    PIC 9(08).                       00016610
016620       10 NUM-ODC-D02            PIC 9(08).                       00016620
016630     05 FILLER                    PIC X(03).                      00016630
016640     05 VALOR-D02                 PIC 9(11)V99.                   00016640
016650     05 CGC-D02                   PIC 9(14).                      00016650
016660     05 NOME-ESTABELECIMENTO-D02  PIC X(40).                      00016660
016670                                                                  00016670
016680 FD  D12802                                                       00016680
016690     RECORD CONTAINS 7 TO 87 CHARACTERS                           00016690
016700     RECORDING MODE IS V                                          00016700
016710     BLOCK CONTAINS 0 RECORDS.                                    00016710
016730                                                                  00016730
016760*---  LAY-OUT DO ARQUIVO D12802 - D128.MOVIMENT.DIARIO.&GAS  ---* 00016760
016770*-                                                                00016770
016780 01  REG-HEAD-02DD.                                               00016780
016790     05 TIPO-HEAD-02DD           PIC 9.                           00016790
016800     05 CODAG-HEAD-02DD          PIC 9(3)       COMP-3.           00016800
016810     05 DTREF-HEAD-02DD          PIC 9(6)       COMP-3.           00016810
016820*-                                                                00016820
016830 01  REG-CAD-02DD.                                                00016830
016840     05 TIPO-CAD-02DD            PIC 9.                           00016840
016850     05 CONTA-CAD-02DD           PIC 9(5)       COMP-3.           00016850
016860     05 CONTAA-CAD-02DD    REDEFINES    CONTA-CAD-02DD PIC XXX.   00016860
016870     05 DIGITO-CAD-02DD          PIC X.                           00016870
016880     05 NOME-CLI-CAD-02DD        PIC X(34).                       00016880
016890     05 NOME-CLI2-CAD-02DD       PIC X(32).                       00016890
016900     05 DTVENC-CHBNB-02DD        PIC 9(6)       COMP-3.           00016900
016910     05 LIMITE-CHBNB-02DD        PIC 9(13)V99   COMP-3.           00016910
016920     05 DTCONTR-CHBNB-02DD       PIC 9(6)       COMP-3.           00016920
016930*-                                                                00016930
016940 01  REG-MOV-02DD.                                                00016940
016950     05 TIPO-MOV-02DD            PIC 9.                           00016950
016960     05 CONTA-MOV-02DD           PIC 9(5)       COMP-3.           00016960
016970     05 CONTAA-MOV-02DD    REDEFINES    CONTA-MOV-02DD PIC XXX.   00016970
016980     05 DIGITO-MOV-02DD          PIC X.                           00016980
016990     05 CODHIST-MOV-02DD         PIC 999        COMP-3.           00016990
017000     05 NUMDOC-MOV-02DD          PIC 9(6)       COMP-3.           00017000
017010     05 VALOR-MOV-02DD           PIC S9(13)V99  COMP-3.           00017010
017020*-                                                                00017020
017030                                                                  00017030
017040 FD  D04819                                                       00017040
017050     RECORD CONTAINS 10 CHARACTERS.                               00017050
017070 01  REG-D19.                                                     00017070
017080     05  COD-AG-D19              PIC 9(5)       COMP-3.           00017080
017090     05  CONTROLE-PERSONA-D19    PIC 9.                           00017090
017100         88 INICIO-MES-D19                       VALUE 1.         00017100
017110     05  DATA-D19                PIC 9(6)        COMP-3.          00017110
017120     05  FILLER                  PIC XX.                          00017120
017130                                                                  00017130
017140     COPY B04806X.                                                00017140

014100 FD  ArqExtMensal
014200     RECORD CONTAINS 200 TO 1250 CHARACTERS.
017150     COPY B048CTAX.                                               00017150
017160                                                                  00017160
017170 FD  D04815                                                       00017170
017180     RECORD CONTAINS 110 CHARACTERS.                              00017180
017190                                                                  00017190
017200 01  REG-D04815.                                                  00017200
017210     05 CHAVE-D15.                                                00017210
017220        10 DATA-MOV-D15          PIC 9(08).                       00017220
017230        10 DATA-MOV-D15-RED REDEFINES DATA-MOV-D15.               00017230
017240           15 ANO-MOV-D15        PIC 9999.                        00017240
017250           15 MES-MOV-D15        PIC 99.                          00017250
017260           15 DIA-MOV-D15        PIC 99.                          00017260
017270        10 AGENCIA-D15           PIC 9(05).                       00017270
017280        10 CONTA-D15             PIC 9(09).                       00017280
017290        10 DV-CONTA-D15          PIC 9.                           00017290
017300     05 NOME-D15                 PIC X(34).                       00017300
017310     05 VLR-DECORRENT-D15        PIC 9(13)V99.                    00017310
017320     05 VLR-REAL-D15             PIC 9(13)V99.                    00017320
017330     05 MATRICULA-D15            PIC X(07).                       00017330
006600     05 STATUS-D15EX             PIC 9(01).                       00001800
006600     05 TPCONTAB-D15EX           PIC 9(03).                       00001810
006600     05 QTD-DIAS-OCOR-D15EX      PIC 9(03).                       00001820
006600     05 FILLER-D15               PIC X(09).                       00001830
017350                                                                  00017350
017360 FD  D30201                                                       00017360
017380     RECORD CONTAINS 15 CHARACTERS.                               00017380
017390                                                                  00017390
017400 01  CHAVE-D302.                                                  00017400
017410     05 AGENCIA-D302             PIC 999.                         00017410
017420     05 CONTA-D302               PIC 9(9).                        00017420
017430     05 DG-D302                  PIC 9.                           00017430
017440                                                                  00017440
017450 FD  D27030                                                       00017450
017470     RECORD CONTAINS 70 CHARACTERS.                               00017470
017480                                                                  00017480
017490 01  REG-D30.                                                     00017490
017500     05 CHAVE-D30.                                                00017500
017510        10 CH-PARCIAL-D30.                                        00017510
017520           15 AGENCIA-D30        PIC 999.                         00017520
017530           15 CLIENTE-D30        PIC 9(09).                       00017530
017540        10 FUNDO-D30             PIC 999.                         00017540
017550           88 FIF30-D30          VALUE 14.                        00017550
017560           88 FIF60-D30          VALUE 15 30 31 32 33.            00017560
017570           88 FIFCP-D30          VALUE 16.                        00017570
017580           88 ACOES-D30          VALUE 23.                        00017580
017590     05 DG-CLIENTE-D30           PIC 9.                           00017590
017600     05 POSICAO-AGENCIA-D30      PIC 9(08)    COMP-3.             00017600
017610     05 SALDO-D30                PIC 9(13)V99 COMP-3.             00017610
017620     05 SALDO-DISP-D30           PIC 9(13)V99 COMP-3.             00017620
017630     05 VR-IR-DISP-D30           PIC 9(11)V99 COMP-3.             00017630
017640     05 VR-IR-CAR-D30            PIC 9(11)V99 COMP-3.             00017640
017650     05 VR-IOF-D30               PIC 9(11)V99 COMP-3.             00017650
017660     05 FILLER                   PIC X(12).                       00017660
017670                                                                  00017670
017830 FD  D86042                                                       00017830
017840     LABEL RECORD IS STANDARD                                     00017840
017850     BLOCK CONTAINS 0 RECORDS                                     00017850
EXP048     RECORD CONTAINS 91 CHARACTERS                                00017860
017870     DATA RECORD IS REG-D42.                                      00017870
017880                                                                  00017880
017890 01  REG-D42.                                                     00017890
017900     05  CHAVE-D42.                                               00017900
017910         10  CH-PARCIAL-D42.                                      00017910
EXP048             15  COD-AG-D42       PIC 9(05).                      00017920
EXP048             15  NUM-CTACORR-D42  PIC 9(09).                      00017930
017940         10  SEQ-D42              PIC 9(03).                      00017940
017950     05  DV-CTACORR-D42           PIC 9(01).                      00017950
017960     05  NOME-CLI-D42             PIC X(40).                      00017960
017970     05  QTDE-TIT-ESTQ-D42        PIC 9(11)V99     COMP-3.        00017970
017980     05  VLR-BRUTO-D42            PIC 9(15)V99     COMP-3.        00017980
017990     05  VLR-LIQ-D42              PIC 9(15)V99     COMP-3.        00017990
018000     05  TAXA-CORR-D42            PIC S9(03)V9(04) COMP-3.        00018000
018010     05  DT-SEM-IOF-D42           PIC 9(06)        COMP-3.        00018010
018030                                                                  00018030
018040*                                                                 00018040
018040     COPY D2702028.                                               00018040
018050                                                                  00018050
018060 FD  D86041                                                       00018060
018070     RECORD CONTAINS 50 CHARACTERS                                00018070
018080     DATA RECORD IS REG-D41.                                      00018080
018090 01  REG-D41.                                                     00018090
018100     05  CHAVE-D41.                                               00018100
EXP048         10  AG-D41                  PIC 9(05).                   00018110
EXP048         10  CONTA-D41               PIC 9(09).                   00018120
018130         10  DV-CONTA-D41            PIC X.                       00018130
018140         10  ANO-MES-D41.                                         00018140
018150             15 SEC-D41              PIC 99.                      00018150
018160             15 ANO-D41              PIC 99.                      00018160
018170             15 MES-D41              PIC 99.                      00018170
018180     05  VLR-SALDO-MEDIO-D41         PIC S9(13)V99   COMP-3.      00018180
018190     05  VLR-LUCRO-PREJ-D41          PIC S9(13)V99   COMP-3.      00018190
018200     05  CD-SICAD-D41                PIC 9(10).                   00018200
018210     05  FILLER                      PIC X(03).                   00018210
018220                                                                  00018220
018380 FD  D15903                                                       00018380
018390     RECORD CONTAINS 57 CHARACTERS                                00018390
018400     BLOCK CONTAINS 0 RECORDS                                     00018400
018410     LABEL RECORD STANDARD.                                       00018410
018420                                                                  00018420
018430 01  REG-D15903.                                                  00018430
018440     05 CHAVE-D15903.                                             00018440
018450        10 NUM-CPFCGC-D15903.                                     00018450
018460           15 CPF-CGC-D15903         PIC 9(09).                   00018460
018470           15 FILIAL-D15903          PIC 9(04).                   00018470
018480           15 DV-CPF-CGC-D15903      PIC 99.                      00018480
018490        10 AGENCIA-D15903            PIC 9(05).                   00018490
018500        10 CONTA-D15903              PIC 9(09).                   00018500
018510        10 DV-CONTA-D15903           PIC 9(01).                   00018510
018520        10 ANO-D15903                PIC 9(04).                   00018520
018530        10 MES-D15903                PIC 9(02).                   00018530
018540     05 SALDO-MEDIO-D15903           PIC 9(13)V99 COMP-3.         00018540
018550     05 TIPO-CONTABIL-D15903         PIC 9(03).                   00018550
018560     05 CD-CLI-SICAD-D15903          PIC 9(10).                   00018560
018570                                                                  00018570
018580 FD  D19401                                                       00018580
018590     RECORD CONTAINS 57 CHARACTERS                                00018590
018600     BLOCK CONTAINS 0 RECORDS                                     00018600
018610     LABEL RECORD STANDARD.                                       00018610
018620                                                                  00018620
018630 01  REG-D19401.                                                  00018630
018640     05 CHAVE-D19401.                                             00018640
018650        10 NUM-CPFCGC-D19401.                                     00018650
018660           15 CPF-CGC-D19401         PIC 9(09).                   00018660
018670           15 FILIAL-D19401          PIC 9(04).                   00018670
018680           15 DV-CPF-CGC-D19401      PIC 99.                      00018680
018690        10 AGENCIA-D19401            PIC 9(05).                   00018690
018700        10 CONTA-D19401              PIC 9(09).                   00018700
018710        10 DV-CONTA-D19401           PIC 9(01).                   00018710
018720        10 ANO-D19401                PIC 9(04).                   00018720
018730        10 MES-D19401                PIC 9(02).                   00018730
018740     05 SALDO-MEDIO-D19401           PIC 9(13)V99 COMP-3.         00018740
018750     05 TIPO-CONTABIL-D19401         PIC 9(03).                   00018750
018760     05 CD-CLI-SICAD-D19401          PIC 9(10).                   00018760
018770                                                                  00018770
018790  WORKING-STORAGE SECTION.                                        00018790
018800                                                                  00018800
018810     EXEC SQL INCLUDE SQLCA    END-EXEC.                          00018810
018820     EXEC SQL INCLUDE E048HIST END-EXEC.                          00018820
018820     EXEC SQL INCLUDE E048NMCT END-EXEC.                          00018820
018820     EXEC SQL INCLUDE E048PARM END-EXEC.
018840     EXEC SQL INCLUDE E400PFIS END-EXEC.                          00018840
018850     EXEC SQL INCLUDE E400TITC END-EXEC.                          00018850
018860     EXEC SQL INCLUDE E134CCNI END-EXEC.                          00018860
018870     EXEC SQL INCLUDE E400PESS END-EXEC.                          00018870
018880     EXEC SQL INCLUDE E400CTAD END-EXEC.                          00018880
018890     EXEC SQL INCLUDE E950OPRA END-EXEC.                          00018890
018900     EXEC SQL INCLUDE E950SOPR END-EXEC.                          00018900
018820     EXEC SQL INCLUDE E048CCAD END-EXEC.
018930                                                                  00018930
      * CONSTANTES USADAS PELO PROGRAMA P048PARM EM SUA INTERFACE.
           COPY C048PARM.
      * INTERFACE DE COMUNICACAO COM O PROGRAMA P048PARM.
           COPY I048PARM.
      * INTERFACE DE COMUNICACAO COM O PROGRAMA P048INFO.
           COPY I048INFO.
      * INTERFACE DE COMUNICACAO COM A SUBROTINA P048VEMP.
           COPY I048VEMP.
      * CONSTANTES DA SUBROTINA P048VEMP.
           COPY C048VEMP.

       01  CAMPOS-PARM.
           05 PARM-RETORNO             PIC X(416).
           05 FILLER REDEFINES PARM-RETORNO.
              10 PARM-SIM-NAO         PIC X(001).
              10 FILLER               PIC X(415).

           05 PARM-CALC-EXCESSO       PIC X(01).
              88 PRM-CALC-EXCESSO     VALUE 'S'.
           05 PARM-CALC-TX-IAC1       PIC X(01).
              88 PRM-CALC-TX-IAC1     VALUE 'S'.

019060 01  VARIAVEIS-AUX-DB2.
018950     05 ERROR-MESSAGE.                                            00018950
018960        10 ERROR-LEN            PIC S9(04) COMP VALUE +960.       00018960
018970        10 ERROR-TEXT           PIC X(120) OCCURS 8 TIMES         00018970
018980                                INDEXED BY ERROR-INDEX.           00018980
018990                                                                  00018990
019000     05 COD-ERRO-WS             PIC S9(03) LEADING SEPARATE.      00019000
019010     05 ERROR-TEXT-LEN          PIC S9(09) COMP VALUE +120.       00019010
019020     05 GOOD                    PIC S9(09) COMP VALUE +0.         00019020
019030     05 NOTFOUND                PIC S9(09) COMP VALUE +100.       00019030
019040     05 DUPLICADO               PIC S9(09) COMP VALUE -803.       00019040
019050                                                                  00019050
019070     05 VISAO-WS                PIC X(08)  VALUE SPACES.          00019070
019080     05 TIPO-ACESSO-WS          PIC X(08)  VALUE SPACES.          00019080
019090     05 PROGRAMA-WS             PIC X(08)  VALUE SPACES.          00019090
019100     05 LOCAL-WS                PIC X(30)  VALUE SPACES.          00019100
019110     05 TAM-RG                   PIC S9(02) COMP VALUE ZEROS.     00019110
019120     05 NUM-CONTA-DB2           PIC 9(10).                        00019120
019130     05 NUM-CONTA-DB2-RD REDEFINES NUM-CONTA-DB2.                 00019130
019140        10 CONTA-DB2            PIC 9(09).                        00019140
019150        10 DIGITO-DB2           PIC 9(01).                        00019150
           05 DATA-DB2.
              10 DIA-DB2              PIC 9(02)  VALUE ZEROS.
              10 FILLER               PIC X(01)  VALUE '/'.
              10 MES-DB2              PIC 9(02)  VALUE ZEROS.
              10 FILLER               PIC X(01)  VALUE '/'.
              10 ANO-DB2              PIC 9(04)  VALUE ZEROS.
019160                                                                  00019160
       01  CAMPOS-DISPLAY.
           05 CTA-DISPLAY-WS         PIC 9(15) VALUE ZEROS.
           05 FILLER REDEFINES CTA-DISPLAY-WS.
022030        10 AGE-DISP-WS           PIC 9(05).
022210        10 CTA-DISP-WS           PIC 9(09).
022370        10 DIG-DISP-WS           PIC 9(01).                       00022370
           05 CONTA-ACERTO-WS          PIC 9(02) VALUE ZEROS.
           05 MOSTRA-DISPLAY-WS        PIC 9(01) VALUE ZEROS.
           05 DIS-VALOR-SINALIZ        PIC +.+++.+++.+++.++9,99.
           05 DIS-VALOR-NSINAL         PIC Z.ZZZ.ZZZ.ZZZ.ZZ9,99.

       01  W-DATA-COMPILACAO.
            05  W-ANO-COMP             PIC  9(04)  VALUE ZEROS.
            05  W-MES-COMP             PIC  9(02)  VALUE ZEROS.
            05  W-DIA-COMP             PIC  9(02)  VALUE ZEROS.
            05  W-HOR-COMP             PIC  9(02)  VALUE ZEROS.
            05  W-MIN-COMP             PIC  9(02)  VALUE ZEROS.
            05  W-SEG-COMP             PIC  9(02)  VALUE ZEROS.
            05  W-CEN-COMP             PIC  9(02)  VALUE ZEROS.
            05  filler                 PIC  X(05)  VALUE ZEROS.

019170     COPY B091CL.                                                 00019170
019180                                                                  00019180
019190     COPY B09508.                                                 00019190
019200                                                                  00019200
        01 W-REG-MOV-D07                  PIC X(240).
        01 W-REG-GRADE-D07 REDEFINES W-REG-MOV-D07.
           05 W-CHAVE-D07.
              10 W-CH-TPREG-D07           PIC 9.
              10 W-CH-CODAG-D07           PIC 99999       COMP-3.
              10 W-CH-DATA-D07            PIC 9(6)        COMP-3.
              10 W-CH-N-LOTE-D07          PIC 99.
              10 W-CH-HIST-D07            PIC 9(5).
              10 W-CH-CONTA-D07.
                 15 W-CONTA-D07           PIC 9(9)        COMP-3.
                 15 W-DV-CONTA-D07        PIC X.
           05 W-RESTO-GRADE-D07           PIC X(219).
      *
        01 W-REG-CAD-CC-D07 REDEFINES W-REG-MOV-D07.
           05 FILLER                      PIC X(21).
           05 W-PARTE-1-D07               PIC X(153).
           05 W-CC-TPCONTAB-D07           PIC 999.
           05 W-PARTE-2-D07               PIC X(02).
           05 W-CC-TPPESSOA-D07           PIC XX.
           05 W-PARTE-3-D07               PIC X(59).
      *
         01 W-REG-CAD-EMP-D07 REDEFINES W-REG-MOV-D07.
            05 FILLER                     PIC X(21).
            05 W-RESTO-CAD-EMP-D07        PIC X(219).

         01 W-REG-CAD-SENHA-D07 REDEFINES W-REG-MOV-D07.
            05 FILLER                     PIC X(21).
            05 W-RESTO-CAD-SENHA-D07      PIC X(219).

         01 W-REG-ACERTO-EXTCONTB-D07 REDEFINES W-REG-MOV-D07.
            05 FILLER                     PIC X(21).
            05 W-RESTO-ACE-EXTCTB-D07     PIC X(219).

         01 W-REG-ACERTO-NUMEROS-D07 REDEFINES W-REG-MOV-D07.
            05 FILLER                     PIC X(21).
            05 W-RESTO-ACE-NUMEROS-D07    PIC X(219).

         01 W-REG-TRANSACAO-D07 REDEFINES W-REG-MOV-D07.
            05 FILLER                     PIC X(21).
            05 W-RESTO-TRANSACAO-D07      PIC X(219).

         01 W-REG-ESPECIAIS-D07 REDEFINES W-REG-MOV-D07.
            05 FILLER                     PIC X(21).
            05 W-RESTO-ESPECIAIS-D07      PIC X(219).

019240*    .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-                       00019240
019250 01  ACUMULADORES  COMP-3.                                        00019250
019260*    .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-                       00019260
019270     05 ACUM-REG-EXTRATO         PIC 9(9)        VALUE ZEROS.     00019270
019280     05 ACUM-REG-CORRENTISTA     PIC 9(9)        VALUE ZEROS.     00019280
019290     05 ACUM-QDE-AGENCIA         PIC 999         VALUE ZEROS.     00019290
019300     05 ACUM-REG-F10             PIC 9(5)        VALUE ZEROS.     00019300
019310     05 ACUM-REG-AG-ANT          PIC 9(5)        VALUE ZEROS.     00019310
019320     05 ACUM-REG-AG-ATL          PIC 9(5)        VALUE ZEROS.     00019320
019330     05 ACUM-CAD-CC              PIC S9(5)       VALUE ZEROS.     00019330
019340     05 ACUM-CAD-CARTAO          PIC S9(5)       VALUE ZEROS.     00019340
019350     05 ACUM-TRANSF-EMP          PIC S9(5)       VALUE ZEROS.     00019350
019360     05 ACUM-OUTROS              PIC S9(5)       VALUE ZEROS.     00019360
019370     05 ACUM-SALDO-DEP-WS        PIC S9(13)V99   VALUE +0.        00019370
019380     05 ACUM-SALD-ANT-D04-WS     PIC S9(13)V99   VALUE +0.        00019380
019390     05 ACUM-SALD-ATL-D04-WS     PIC S9(13)V99   VALUE +0.        00019390
019400     05 ACUM-JUROS-AUX-WS        PIC S9(09)V9(8) VALUE ZEROS.     00019400
019410     05 ACUM-JUROS-PF-WS         PIC S9(09)V9(8) VALUE ZEROS.     00019410
019420     05 ACUM-JUROS-PJ-WS         PIC S9(09)V9(8) VALUE ZEROS.     00019420
019430     05 ACUM-JUROS-PJ-PP-WS      PIC S9(09)V9(8) VALUE ZEROS.     00019430
019440     05 ACUM-JUROS-FUNC-WS       PIC S9(13)V99   VALUE ZEROS.     00019440
019450     05 ACUM-JUROS-CE-WS         PIC S9(09)V9(8) VALUE ZEROS.     00019450
019460     05 EXCESSO-WS               PIC S9(13)V99   VALUE ZEROS.     00019460
019460     05 EXCESSO-ANT-WS           PIC 9(13)V99    VALUE ZEROS.     00019460
019470     05 SLD-EXCEDENTE-WS         PIC S9(13)V99   COMP-3.          00019470
019480     05 SALDO-ANTERIOR-INS       PIC S9(13)V99   COMP-3.          00019480
019490     05 SALDO-ATUAL-INS          PIC S9(13)V99   COMP-3.          00019490
019500     05 SALDO-BLOQ-INS           PIC S9(13)V99   COMP-3.          00019500
019510     05 INS-JUR-REAL-DEVOL-WS    PIC S9(13)V99   COMP-3.          00019510
019520     05 INS-IOF-REAL-DEVOL-WS    PIC S9(13)V99   COMP-3.          00019520
019530     05 SLD-DEVOL-WS             PIC S9(13)V99   COMP-3.          00019530
019540     05 VALOR-D07-WS             PIC S9(13)V99   COMP-3.          00019540
019550     05 VALOR-IOF-WS             PIC S9(13)V99   COMP-3.          00019550
019560     05 ACUM-CH-PROCESSADOS-WS   PIC 9(5)        VALUE ZEROS.     00019560
019570     05 ACUM-PEDIDOS-TALON-CORR-WS PIC S9(5) COMP-3 VALUE ZEROS.  00019570
019580     05 ACUM-CH-TB-PROCESSADOS-WS  PIC 9(5)      VALUE ZEROS.     00019580
019590     05 ACUM-PEDIDOS-CHEQUE-TB-WS PIC S9(5)  COMP-3 VALUE ZEROS.  00019590
019600     05 ACUM-TALON-CTA-88887-WS  PIC 9(5)    COMP-3 VALUE ZEROS.  00019600
019610     05 ACUM-IOC-DIARIO-WS       PIC S9(13)V99   VALUE ZEROS.     00019610
019620     05 ACUM-IOC-FERIADO-WS      PIC S9(13)V99   VALUE ZEROS.     00019620
019630     05 WVALOR-EXCESSO-ATU       PIC 9(13)V99  COMP-3 VALUE ZEROS.00019630
019640     05 WVALOR-EXCESSO-ANT       PIC 9(13)V99  COMP-3 VALUE ZEROS.00019640
019650     05 WSALDO-EXCESSO-ATU       PIC S9(13)V99        VALUE ZEROS.00019650
019660     05 WINSUFICIENCIA-ATU       PIC S9(13)V99        VALUE ZEROS.00019660
019410     05 VLR-JUROS-DEVOL-WS       PIC 9(09)V9(8)  VALUE ZEROS.     00019410
019410     05 VLR-JUROS-DEVOL-PF-WS    PIC S9(15)V9(2) VALUE ZEROS.     00019410
019420     05 VLR-JUROS-DEVOL-PJ-WS    PIC S9(15)V9(2) VALUE ZEROS.     00019420
019430     05 VLR-JUROS-DEVOL-PJ-PP-WS PIC S9(15)V9(2) VALUE ZEROS.     00019430
019450     05 VLR-JUROS-DEVOL-CE-WS    PIC S9(15)V9(2) VALUE ZEROS.     00019450
           05 JUR-DEVOL-1DIA-WS        PIC 9(16)V99    VALUE ZEROS.
           05 IOF-DEVOL-1DIA-WS        PIC 9(16)V99    VALUE ZEROS.
           05 JUR-MENSAL-1DIA-WS       PIC 9(16)V99    VALUE ZEROS.
           05 IOF-MENSAL-1DIA-WS       PIC 9(16)V99    VALUE ZEROS.
019670                                                                  00019670
019680 01  CONTADORES.                                                  00019680
019690     05  CONT-REG-EXTRATO        PIC 9(07)        VALUE 0.        00019690
019700     05  CONT-REG-CORRENTISTA    PIC 9(07)        VALUE 0.        00019700
019710     05  CONT-QDE-AGENCIA        PIC 999          VALUE 0.        00019710
019720     05  CONT-ABERTURA           PIC 99           VALUE 0.        00019720
019730*                                                                 00019730
019740*    ......................................                       00019740
019760                                                                  00019760
019770     COPY B04801X.                                                00019770
019780                                                                  00019780
019790     COPY B04819.                                                 00019790
019800                                                                  00019800
019834*    .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-                       00019834
019835 01  CAMPOS-AUXILIARES.                                           00019835
019836*    .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-                       00019836
           05 CH-NUM-CONTA-RED-WS.
              10 NUM-CONTA-RED-WS      PIC 9(09)       VALUE ZEROS.
              10 DIG-CONTA-RED-WS      PIC 9(01)       VALUE ZEROS.
           05 HST-REVERSAO-RENDAS      PIC 9(06)       VALUE 386.
           05 HST-BAIXA-DO-ATIVO       PIC 9(06)       VALUE 387.
           05 VLR-CRED-BAIXA-ATV-WS    PIC 9(13)V99    VALUE ZEROS.

019840     05 DT-INFOR-11                  PIC 9(8)       VALUE ZEROS.  00019840
019850     05 DT-INFOR-11-RED REDEFINES DT-INFOR-11.                    00019850
019860        10 DD-INFOR-11               PIC 99.                      00019860
019870        10 MM-INFOR-11               PIC 99.                      00019870
019880        10 AA-INFOR-11               PIC 9(4).                    00019880
019890     05 DT-INFOR-22                  PIC 9(8)       VALUE ZEROS.  00019890
019900     05 DT-INFOR-22-RED REDEFINES DT-INFOR-22.                    00019900
019910        10 DD-INFOR-22               PIC 99.                      00019910
019920        10 MM-INFOR-22               PIC 99.                      00019920
019930        10 SS-INFOR-22               PIC 99.                      00019930
019940        10 AA-INFOR-22               PIC 99.                      00019940
020050     05 COD-EVENTO-WS                PIC 9(6)       VALUE ZEROS.  00020050
020060     05 VALOR-TARIFA-WS              PIC 9(8)V99    VALUE ZEROS.  00020060
020070     05 AGENCIA-APLIC                PIC 9(05)      VALUE ZEROS.  00020070
020080     05 CTA-DIG-APLIC                PIC 9(10)      VALUE ZEROS.  00020080
020090     05 CTA-DIG-APLIC-RED REDEFINES CTA-DIG-APLIC.                00020090
020100        10 CONTA-APLIC               PIC 9(09).                   00020100
020110        10 DIGITO-APLIC              PIC 9(01).                   00020110
020120     05 DIAS-ANT-WS       COMP-3     PIC S9(10)     VALUE ZEROS.  00020120
020120     05 DIAS-WS           COMP-3     PIC S9(10)     VALUE ZEROS.  00020120
020130     05 QT-DIAS-VENC      COMP-3     PIC  9(03)     VALUE ZEROS.  00020130
020130     05 QTD-DIAS-ANT-WS   COMP-3     PIC  9(03)     VALUE ZEROS.  00020130
020140     05 SLD-TOT-WS        COMP-3     PIC S9(13)V99  VALUE ZEROS.  00020140
020150     05 SLD-DISP-S159-WS  COMP-3     PIC S9(13)V99  VALUE ZEROS.  00020150
020160     05 VR-ADIANT-REAL-WS COMP-3     PIC S9(13)V99  VALUE ZEROS.  00020160
020170     05 VR-ADIANT-ANT-WS  COMP-3     PIC S9(13)V99  VALUE ZEROS.  00020170
020180     05 SALDO-ATUAL-WS    COMP-3     PIC S9(13)V99  VALUE ZEROS.  00020180
           05 STATUS-CHQ-ESP-ANT-WS        PIC  9(01)     VALUE ZEROS.
              88 NAO-EXISTIA-CHQ           VALUE 0.
              88 EXISTIA-CHQ               VALUE 1.
           05 SALDO-BLOQUEADO-WS
                                COMP-3     PIC S9(13)V99  VALUE ZEROS.
           05 SALDO-ANTERIOR-BLOQUEADO-WS
                                COMP-3     PIC S9(13)V99  VALUE ZEROS.
           05 SLD-ATL-SBLOQ-WS  COMP-3     PIC S9(13)V99  VALUE ZEROS.
           05 SLD-ANT-SBLOQ-WS  COMP-3     PIC S9(13)V99  VALUE ZEROS.
           05 SLD-ANT-SBLOQ-COM-SLDDEVOL-WS
                                COMP-3     PIC S9(13)V99  VALUE ZEROS.
           05 SLD-ATL-SBLOQ-COM-SLDDEVOL-WS
                                COMP-3     PIC S9(13)V99  VALUE ZEROS.
           05 TOTAL-MOVTO-BLOQ-WS          PIC 9(13)V99  VALUE ZEROS.
           05 HISTS-MOVTO-BLOQ-WS          PIC 9(06)     VALUE ZEROS.
              88 HISTS-MOVTO-BLOQ      VALUE 52, 53, 54, 55, 668, 669,
                                             64, 65, 66, 67, 68.
           05 RAP-POS-WS        COMP-3     PIC S9(13)V99  VALUE ZEROS.
020190     05 SALDO-DEVEDOR-WS  COMP-3     PIC S9(13)V99  VALUE ZEROS.  00020190
020200     05 SALDO-WS          COMP-3     PIC S9(13)V99  VALUE ZEROS.  00020200
020210     05 AMORTIZACAO-WS    COMP-3     PIC S9(13)V99  VALUE ZEROS.  00020210
020220     05 HIST-383-WS       COMP-3     PIC  9(13)V99  VALUE ZEROS.  00020220
020230     05 HIST-384-WS       COMP-3     PIC  9(13)V99  VALUE ZEROS.  00020230
020240     05 HIST-392-WS       COMP-3     PIC  9(13)V99  VALUE ZEROS.  00020240
020250     05 HIST-393-WS       COMP-3     PIC  9(13)V99  VALUE ZEROS.  00020250
020260     05 LIMITE-WS         COMP-3     PIC S9(13)V99  VALUE ZEROS.  00020260
020270     05 CPMF-WS           COMP-3     PIC S9(13)V99  VALUE ZEROS.  00020270
020280     05 W-RAP-WS          COMP-3     PIC S9(13)V99  VALUE ZEROS.  00020280
020290     05 BLOQUEIO-WS       COMP-3     PIC S9(13)V99  VALUE ZEROS.  00020290
020300     05 NAO-UTILIZACAO-WS COMP-3     PIC S9(13)V99  VALUE ZEROS.  00020300
020310     05 UTILIZACAO-WS     COMP-3     PIC 9999V9(6)  VALUE ZEROS.  00020310
020320        88 FAIXA-1                   VALUE 0,00  THRU 30,00.      00020320
020330        88 FAIXA-2                   VALUE 30,01 THRU 50,00.      00020330
020340        88 FAIXA-3                   VALUE 50,01 THRU 80,00.      00020340
020350        88 FAIXA-4                   VALUE 80,01 THRU 9999,99.    00020350
020360     05 REDUCAO-WS                   PIC 9(5)       VALUE ZEROS.  00020360
042800     05 DIV-TR-WS         COMP-3     PIC 9(10)V9(8) VALUE ZEROS.
020370     05 DIV-SIEF-WS       COMP-3     PIC 9(10)V9(8) VALUE ZEROS.  00020370
           05 VR-SELIC-ANO-WS   COMP-3     PIC S9(8)V9(8) VALUE ZEROS.
           05 VR-SELIC-DIA-WS   COMP-3     PIC S9(8)V9(8) VALUE ZEROS.
           05 VR-SELIC-DIA-PREC-WS COMP-3  PIC S9(8)V9(8) VALUE ZEROS.
           05 CM-JUDIC-WS       COMP-3     PIC S9(11)V99  VALUE ZEROS.
           05 JUR-JUDIC-WS      COMP-3     PIC S9(11)V99  VALUE ZEROS.
047600     05 VR-TR-DIA-PREC-WS COMP-3     PIC S9(8)V9(6) VALUE ZEROS.
046400     05 QTD-DIAS-UTEIS-WS            PIC 9(02)      VALUE ZEROS.
046400     05 QTD-DIAS-UTEIS-MES-WS        PIC 9(02)      VALUE ZEROS.
046400     05 ULT-DIA-MES-ANT-WS           PIC 9(02)      VALUE ZEROS.
046400     05 ULT-DIA-PROC-WS              PIC 9(02)      VALUE ZEROS.
046400     05 DIA-PROC-WS                  PIC 9(02)      VALUE ZEROS.
025580     05 SALDO-ANTERIOR-RED-AUX COMP-3 PIC 9(13)V99  VALUE ZEROS.
020380     05 DATA-SIEF-WS.                                             00020380
020390        10 DIA-SIEF-WS               PIC 99         VALUE ZEROS.  00020390
020400        10 FILLER                    PIC X          VALUE '/'.    00020400
020410        10 MES-SIEF-WS               PIC 99         VALUE ZEROS.  00020410
020420        10 FILLER                    PIC X          VALUE '/'.    00020420
020430        10 ANO-SIEF-WS               PIC 9999       VALUE ZEROS.  00020430
020440     05 DT-VENC-MIN-WS.                                           00020440
020450        10 DD-VENC-MIN-WS            PIC 99.                      00020450
020460        10 MM-VENC-MIN-WS            PIC 99.                      00020460
020470        10 AA-VENC-MIN-WS            PIC 9(4).                    00020470
020480     05 DT-VENCTO-WS                 PIC 9(8)       VALUE ZEROS.  00020480
020490     05 DT-VENCTO-WS-RED REDEFINES DT-VENCTO-WS.                  00020490
020500        10 DD-VENCTO-WS              PIC 99.                      00020500
020510        10 MM-VENCTO-WS              PIC 99.                      00020510
020520        10 AA-VENCTO-WS              PIC 9(4).                    00020520
020530     05 DATA-ONTEM-WS                PIC 9(8)       VALUE ZEROS.  00020530
020540     05 DATA-ONTEM-RED REDEFINES DATA-ONTEM-WS.                   00020540
020550        10 DD-ONTEM-WS               PIC 99.                      00020550
020560        10 MM-ONTEM-WS               PIC 99.                      00020560
020570        10 AA-ONTEM-WS               PIC 9(4).                    00020570
020580     05 DT-INFOR-1                   PIC 9(8)       VALUE ZEROS.  00020580
020590     05 DT-INFOR-1-RED REDEFINES DT-INFOR-1.                      00020590
020600        10 AA-INFOR-1                PIC 9(4).                    00020600
020610        10 MM-INFOR-1                PIC 99.                      00020610
020620        10 DD-INFOR-1                PIC 99.                      00020620
020630     05 DT-INFOR-2                   PIC 9(8)       VALUE ZEROS.  00020630
020640     05 DT-INFOR-2-RED REDEFINES DT-INFOR-2.                      00020640
020650        10 AA-INFOR-2                PIC 9(4).                    00020650
020660        10 MM-INFOR-2                PIC 99.                      00020660
020670        10 DD-INFOR-2                PIC 99.                      00020670
020680     05 DT-INFOR-3                   PIC 9(8)       VALUE ZEROS.  00020680
020690     05 DT-INFOR-3-RED REDEFINES DT-INFOR-3.                      00020690
020700        10 AA-INFOR-3                PIC 9(4).                    00020700
020710        10 MM-INFOR-3                PIC 99.                      00020710
020720        10 DD-INFOR-3                PIC 99.                      00020720
           05 ADESAO-WS                    PIC 9(6)       VALUE ZEROS.
           05 ADESAO-WS-RED REDEFINES ADESAO-WS.
              10 DIA-ADESAO-WS             PIC 99.
              10 MES-ADESAO-WS             PIC 99.
              10 ANO-ADESAO-WS             PIC 99.
020730     05 VIA-CARTAO                   PIC 99            VALUE 0.   00020730
020740     05 DIA-FER-WS                   PIC 99            VALUE 0.   00020740
020750     05 NUM-IOC-WS                   PIC S9(13) COMP-3 VALUE +0.  00020750
020760     05 NUM-SIMPLES-WS               PIC 9(13)  COMP-3 VALUE 0.   00020760
020770        88 FAIXA-NUM-SIMPLES         VALUE 0 THRU 30000.          00020770
020780     05 QDE-DIAS-WS                  PIC 999    COMP-3 VALUE 0.   00020780
020790     05 QDE-DIAS-VENC-WS             PIC 999    COMP-3 VALUE 0.   00020790
020800     05 CAMPOS-DO-SOMA-WS.                                        00020800
020810        10 COD-TJUR-WS               PIC 99         VALUE 0.      00020810
020820        10 INDICA-CTAREMUN-WS        PIC X          VALUE SPACES. 00020820
020830        10 INDICA-TRIB-WS            PIC X          VALUE SPACES. 00020830
020840        10 ALIQ-IRESTL-WS            PIC 999V99 COMP-3 VALUE 0.   00020840
020850     05 DIAS-UTEIS-WS                PIC 99          VALUE 0.     00020850
020910     05 ENDERECO-WS.                                              00020910
020920        10 RUA-WS                    PIC X(30) VALUE SPACES.      00020920
020930        10 CIDADE-WS.                                             00020930
020940           15 BAIR-WS                PIC X(12) VALUE SPACES.      00020940
020950           15 CEP-WS                 PIC 9(8)  VALUE ZEROS COMP-3.00020950
020960           15 CID-WS                 PIC X(14) VALUE SPACES.      00020960
020970           15 EST-WS                 PIC XX    VALUE SPACES.      00020970
020980           15 FONE-WS                PIC 9(7)  VALUE ZEROS COMP-3.00020980
020990     05 NUM-ACERTO-IOC-WS            PIC S9(13) COMP-3 VALUE +0.  00020990
021000     05 TALONARIOS-PERSON-ANT-WS.                                 00021000
021010        10 TALON-FORNECIDOS-ANT-WS   PIC  9(5) COMP-3 VALUE ZEROS.00021010
021020        10 TALON-RESIDUO-ANT-WS      PIC  9(5) COMP-3 VALUE ZEROS.00021020
021030        10 TALON-PEDIDOS-ACUM-ANT-WS PIC S9(5) COMP-3 VALUE ZEROS.00021030
021040     05 TALON-SOLICIT-PARA-S131-WS   PIC S9(5) COMP-3 VALUE ZEROS.00021040
021050     05 TALON-AUTOM-WS           PIC S9(5) COMP-3 VALUE ZEROS.    00021050
021060     05 TALON-AUTOM-REJ-WS       PIC S9(5) COMP-3 VALUE ZEROS.    00021060
021070     05 CONSUMO-PERSON-WS        PIC 9(5)  COMP-3 VALUE ZEROS.    00021070
021080     05 PADRAO-PERSON-WS         PIC 99           VALUE 18.       00021080
021090     05 PADRAO-PERSON-COMUN-WS   PIC 99           VALUE 8.        00021090
021100     05 PADRAO-JURIDICA-WS       PIC 99           VALUE 40.       00021100
021110     05 QUOCIENTE-PERSON-WS      PIC 99           VALUE ZEROS.    00021110
021120     05 RESTO-PERSON-WS          PIC 99           VALUE ZEROS.    00021120
021130     05 TALONARIOS-PERSON-ANT-TB-WS.                              00021130
021140        10 TALON-FORNECIDOS-ANT-TB-WS   PIC  9(5) COMP-3 VALUE 0. 00021140
021150        10 TALON-RESIDUO-ANT-TB-WS      PIC  9(5) COMP-3 VALUE 0. 00021150
021160        10 TALON-PEDIDOS-ACUM-ANT-TB-WS PIC S9(5) COMP-3 VALUE +0.00021160
021170     05 TALON-SOLICIT-PARA-S131-TB-WS   PIC S9(5) COMP-3 VALUE +0.00021170
021180     05 TALON-AUTOM-TB-WS           PIC S9(5) COMP-3 VALUE ZEROS. 00021180
021190     05 TALON-AUTOM-REJ-TB-WS       PIC S9(5) COMP-3 VALUE ZEROS. 00021190
021200     05 CONSUMO-PERSON-TB-WS        PIC 9(5)  COMP-3 VALUE ZEROS. 00021200
021210     05 PADRAO-PERSON-CHEQUE-TB.                                  00021210
021220        10 TB-JURIDICAS-WS       PIC 99           VALUE 05.       00021220
021230        10 TB-FISICAS-WS         PIC 99           VALUE 08.       00021230
021240        10 TB-OUTRAS-WS          PIC 99           VALUE 01.       00021240
021250        10 PADRAO-TB-WS          PIC 99           VALUE 18.       00021250
021260     05 QUOCIENTE-PERSON-TB-WS   PIC 99           VALUE ZEROS.    00021260
021270     05 RESTO-PERSON-TB-WS       PIC 99           VALUE ZEROS.    00021270
021280     05 ES-QT-CH-WS              PIC S9(3) COMP-3 VALUE ZEROS.    00021280
021290     05 COD-MSG-OCORR-TALON-WS   PIC 99           VALUE ZEROS.    00021290
021300     05 CM-REINV-WS              PIC S9(11)V99 COMP-3 VALUE ZEROS.00021300
021310     05 QTDE-DIAS-FERIADO-WS     PIC 99           VALUE ZEROS.    00021310
021320     05 PARAMETRO-LIMITE         PIC S9(13)V99 COMP-3             00021320
021330                                                 VALUE +50000,00. 00021330
021340     05 NUM-CPF-CGC-WS           PIC 9(15)       VALUE ZEROS.     00021340
021350     05 NUM-CPF-RED-WS REDEFINES NUM-CPF-CGC-WS.                  00021350
021360        10 BARRA-CPF-WS          PIC 9(4).                        00021360
021370        10 CPF-WS                PIC 9(9).                        00021370
021380        10 CONTR-CPF-WS          PIC 99.                          00021380
021390     05 NUM-CGC-RED-WS REDEFINES NUM-CPF-CGC-WS.                  00021390
021400        10 CGC-WS                PIC 9(9).                        00021400
021410        10 BARRA-CGC-WS          PIC 9(4).                        00021410
021420        10 CONTR-CGC-WS          PIC 99.                          00021420
021430     05 SALDO-EMP-ANT-WS         PIC S9(13)V99 COMP-3 VALUE ZEROS.00021430
021440     05  GR-CRED-DEB-FIS-WS      PIC S9(13)V99 COMP-3 VALUE ZEROS.00021440
021450     05  GR-CRED-DEB-JUR-WS      PIC S9(13)V99 COMP-3 VALUE ZEROS.00021450
021460     05  CLASSE-GEROF-WS    PIC S9(13)V99 COMP-3 VALUE +200000,00.00021460
021470     05  NUM-JUR-REAL-WS         PIC S9(13)V99   COMP-3.          00021470
021480     05  NUM-JUR-DECOR-WS        PIC S9(13)V99   COMP-3.          00021480
021490     05  NUM-IOC-REAL-WS         PIC S9(9)V99    COMP-3.          00021490
021500     05  NUM-IOC-DECOR-WS        PIC S9(9)V99    COMP-3.          00021500
025020     05  JUROS-DIARIOS-WSW         PIC 9(13)V99   COMP-3.         00025020
      *    Base para calculo do iof ADICIONAL
      *    Calculado como sendo o saldo de emprestimo atualizado menos
      *    o resultado do saldo de emprestimo do dia anterior + o saldo
      *    de devolucao do dia.
021510     05  BASE-IOF-ADICIONAL-WS   PIC S9(13)V99 COMP-3 VALUE ZEROS.00021510
021512     05  BASE-IOF-ADICIONAL-POS-WS PIC 9(13)V99       VALUE ZEROS.00021512
021513     05  SLD-DEP-RED-POS-WS        PIC 9(13)V99       VALUE ZEROS.00021514
021514     05  SLD-DEP-ANT-POS-WS        PIC 9(13)V99       VALUE ZEROS.00021515
021514     05  VLR-IOF-NORMAL-WS         PIC 9(13)V99       VALUE ZEROS.00021517
030460     05  ALIQUOTA-WS               PIC 9V9999         VALUE ZEROS.00021518
021514     05  QTDE-DIAS-CORRIDOS-WS     PIC 9(8)           VALUE ZEROS.00021520
021520     05  IOF-ADICIONAL-WS        PIC S9(13)V99 COMP-3 VALUE ZEROS.00021522
021520     05  IOF-DEVOL-ADICIONAL-WS  PIC S9(13)V99 COMP-3 VALUE ZEROS.00021522
021520     05  IOF-DEVOL-TOTAL-WS      PIC S9(13)V99 COMP-3 VALUE ZEROS.00021522
021520     05  IOF-DEVOL-NORMAL-WS     PIC S9(13)V99 COMP-3 VALUE ZEROS.
021530     05  INTERVALO-WS            PIC 9(08)       VALUE 00010000.
021540     05  Senha-ArqContasBase-WS        PIC X(08)     VALUE SPACES.
021550     05  SENHA-ARQ-UPDT-WS        PIC X(08)       VALUE SPACES.
021560     05  SENHA-D04-WS            PIC X(08)       VALUE SPACES.
021570     05  STATUS-CAN-WS           PIC XX          VALUE SPACES.
021580     05  STATUS-D15901           PIC XX          VALUE SPACES.
021590     05  FS-ArqContasBase       PIC XX           VALUE SPACES.
021600     05  STATUS-ARQ-UPDT-WS       PIC XX         VALUE SPACES.
021610     05  STATUS-D811-WS          PIC XX          VALUE SPACES.
021620     05  STATUS-D04-WS           PIC XX          VALUE SPACES.
021630     05  STATUS-D19-WS           PIC XX          VALUE SPACES.
021640     05  ST-ArqExtMensal         PIC XX          VALUE SPACES.
021650     05  STATUS-D01-WS           PIC XX          VALUE SPACES.
021660     05  FS-D27028               PIC XX          VALUE SPACES.
021670     05  FS-D86041               PIC XX          VALUE SPACES.
021690     05  FS-D15903               PIC XX          VALUE SPACES.
021700     05  FS-D19401               PIC XX          VALUE SPACES.
           05  FS-D07B                 PIC XX          VALUE SPACES.
021710     05  STATUS-D02-WS           PIC XX          VALUE SPACES.    00021710
021720     05  STATUS-D04815-WS        PIC XX          VALUE SPACES.    00021720
021730     05  STATUS-D27030-WS        PIC XX          VALUE SPACES.    00021730
021740     05  STATUS-D302-WS          PIC XX          VALUE SPACES.    00021740
021760     05  FS-D42                  PIC XX          VALUE SPACES.    00021760
021770     05  INS-JUR-REAL-WS         PIC S9(13)V99 COMP-3 VALUE ZEROS.00021770
021780     05  INS-JUR-DECOR-WS        PIC S9(13)V99 COMP-3 VALUE ZEROS.00021780
021790     05  FATOR-CM-WS             PIC S99V9(11) COMP-3 VALUE ZEROS.00021790
021800     05  VR-BTNF-DIA-WS      PIC S9(10)V9(8) COMP-3 VALUE ZEROS.  00021800
021810     05  VR-BTNF-NEXT-WS     PIC S9(10)V9(8) COMP-3 VALUE ZEROS.  00021810
021820     05  LIMITE-ANTERIOR-WS  PIC 9(13)V99    COMP-3 VALUE ZEROS.  00021820
021830     05  MENS-AUX            PIC 9(02)              VALUE ZEROS.  00021830
021840         88 ACEITO           VALUE 01 02 04 22 23 24 26 27        00021840
021850                                   32 51 54 55 56 61 62 69.       00021850
021860     05  QDE-SAQUE-CASH-WS       PIC 9(6) COMP-3 VALUE ZEROS.     00021860
021870     05  QDE-CHQ-PROCES-WS       PIC 9(7) COMP-3 VALUE ZEROS.     00021870
021880     05  QDE-SAQ-CARTAO-CTASAL-WS PIC 9(7) COMP-3 VALUE ZEROS.    00021880
021890* ELV - 12/04/2008                                                00021890
021900     05  QDE-CHQ-COMP-INTERNA-WS PIC 999 COMP-3  VALUE ZEROS.     00021900
021910     05  QDE-CHQ-PG-CAIXA-WS     PIC 999 COMP-3  VALUE ZEROS.     00021910
021920     05  QDE-CHQ-AVULSO-WS       PIC 999 COMP-3  VALUE ZEROS.     00021920
021930     05  QDE-SAQ-CARTAO-CAIXA-WS PIC 999 COMP-3  VALUE ZEROS.     00021930
021940     05  QDE-SAQ-CARTAO-WS       PIC 999 COMP-3  VALUE ZEROS.     00021940
021950     05  QDE-SAQ-BCO24HS-WS      PIC 999 COMP-3  VALUE ZEROS.     00021950
021960     05  QDE-SAQ-BB-WS           PIC 999 COMP-3  VALUE ZEROS.     00021960
021970     05  QDE-SAQ-RVA-WS          PIC 999 COMP-3  VALUE ZEROS.     00021970
021980* ELV - 12/04/2008                                                00021980
021990     05 REG-HEADER-AG-RED-WS.                                     00021990
022000*                                                                 00022000
022010        10 CHAVE-WS.                                              00022010
022020           15 CH-SEQ-WS   PIC 9(04).                              00022020
022030           15 CH-AG-WS           PIC 9(05)  COMP-3.               00022030
022040              88 AG-ON-LINE                 VALUE 005 006 009     00022040
022050                                      014 016 019 027 028 029     00022050
022060                                          031 033 034 035 041     00022060
022070                                          044 046 052 056 058     00022070
022080                                          059 064 071 073 075     00022080
022090                                      076 079 081 090 092 099     00022090
022100                                  104 120 124 131 132 136 137     00022100
022110                                      142 150 152 160 163 179     00022110
022120                                          180 181 182 183 185     00022120
022130                                      186 187 188 189 190 191.    00022130
022140              88 AG-BLOQ-24H          VALUE 005 011 018 051 069   00022140
022150                                            078 098 116 129 146   00022150
022160                                            155 161 171 180.      00022160
022170                                                                  00022170
022180************* HA 47 AGENCIAS ON-LINE, 44 INTERLIGADAS *******     00022180
022190************* AGENCIAS NAO INTERLIGADAS  092-120-185  *******     00022190
022200           15 CH-NUM-CONTA-WS.                                    00022200
022210              20 CH-CONTA-WS     PIC 9(09)  COMP-3.               00022210
022220               88 IMPESSOAL                     VALUE 88885 88886 00022220
022230                                          88884 88887 88888 90388 00022230
022240                                          90539 89997 99991 99992 00022240
022250                                          99996 99993 99994 99997 00022250
022260                                          99995 99998 89996 89999
                                            333333 444444 555555 666666
                                            777777 888888 999999.
022360                                                                  00022360
022370              20 CH-DIGITO-WS    PIC 9.                           00022370
022400           15 CH-TIPOREG-WS      PIC 9.                           00022400
022410              88 HEAD-AG-WS                      VALUE 1.         00022410
022420              88 REG-EXT-WS                      VALUE 4.         00022420
022430              88 REG-COR-WS                      VALUE 5.         00022430
022440              88 TRAIL-AG-WS                     VALUE 8.         00022440
022450           15 CH-SEQUENCIAL-WS   PIC 999.                         00022450
022460        10 HF-ATUALIZACAO-WS.                                     00022460
022470           15 HF-DATA-ANT-WS     PIC 9(6)        COMP-3.          00022470
022480           15 HF-DATA-ATL-WS     PIC 9(6)        COMP-3.          00022480
022490           15 HF-SEQUENC-ANT-WS  PIC 999         COMP-3.          00022490
022500           15 HF-SEQUENC-ATL-WS  PIC 999         COMP-3.          00022500
022510                                                                  00022510
022520        10 HAG-TELEPROCES-RED-WS PIC 9.                           00022520
022530        10 HAG-PARAMETROS-RED-WS.                                 00022530
022540           15 HAG-GR-CRED-PJUR-RED-WS                             00022540
022550                                 PIC S9(13)V99   COMP-3.          00022550
022560           15 HAG-GR-DEB-PJUR-RED-WS                              00022560
022570                                 PIC S9(13)V99   COMP-3.          00022570
022580           15 HAG-GR-DIF-SLD-PJUR-RED-WS                          00022580
022590                                 PIC S9(13)V99   COMP-3.          00022590
022600           15 HAG-GR-CRED-PFIS-RED-WS                             00022600
022610                                 PIC S9(13)V99   COMP-3.          00022610
022620           15 HAG-GR-DEB-PFIS-RED-WS                              00022620
022630                                 PIC S9(13)V99   COMP-3.          00022630
022640           15 HAG-GR-DIF-SLD-PFIS-RED-WS                          00022640
022650                                 PIC S9(13)V99   COMP-3.          00022650
022660        10 HAG-VALOR-TAXAS-RED-WS.                                00022660
022670           15 HAG-TX-JUROS-RED-WS                                 00022670
022680                                 PIC 9(3)V99     COMP-3.          00022680
022730           15 HAG-TX-IOF-JURID-RED-WS                             00022730
022740                                 PIC 9V9999      COMP-3.          00022740
022750           15 HAG-TX-IOF-FISICA-RED-WS                            00022750
022760                                 PIC 9V9999      COMP-3.          00022760
022770           15 HAG-TX-PERMANENC-RED-WS                             00022770
022780                                 PIC 9(3)V99     COMP-3.          00022780
022790           15 HAG-MVR-RED-WS     PIC S9(9)V99    COMP-3.          00022790
022800           15 HAG-ORTN-ANT-RED-WS                                 00022800
022810                                 PIC S9(9)V99    COMP-3.          00022810
022820           15 HAG-ORTN-ATL-RED-WS                                 00022820
022830                                 PIC S9(9)V99    COMP-3.          00022830
022840           15 HAG-VRMIN-RED-WS   PIC 999V99      COMP-3.          00022840
022880        10 HAG-AGENCIA-RED-WS.                                    00022880
022890           15 HAG-AG-NOME-RED-WS PIC X(30).                       00022890
022900           15 HAG-AG-EST-RED-WS  PIC XX.                          00022900
022910           15 HAG-AG-ENDER-RED-WS                                 00022910
022920                                 PIC X(40).                       00022920
022930           15 HAG-AG-CEP-RED-WS  PIC 9(5)        COMP-3.          00022930
022940           15 HAG-AG-CGC-RED-WS  PIC 9(11)       COMP-3.          00022940
022950        10 HAG-DATA-IMPLANT-AG-WS PIC 9(6)       COMP-3.          00022950
022960        10 HAG-INDICA-ATUALIZACAO-AG-WS.                          00022960
022970           15 HAG-INDICADOR-WS   PIC 9.                           00022970
022980        10 HAG-INDICA-LISTAO-RED-WS PIC 9.                        00022980
022990           88 LISTAO-TOTAL                       VALUE 1.         00022990
023000           88 CONTAS-MOV                         VALUE 2 THRU 5.  00023000
023010        10 HAG-DIAS-UTEIS-RED-WS PIC 99.                          00023010
023020        10 FILLER                PIC X(1050).                     00023020
023030*    ......................................                       00023030
023050*                                                                 00023050
023060     05 REG-CORRENT-RED-WS REDEFINES REG-HEADER-AG-RED-WS.        00023060
023070*                                                                 00023070
023080        10 FILLER                PIC X(17).                       00023080
023090        10 TPCONTAB-RED-WS       PIC 9(03)       COMP-3.          00023090
023100           88 P-FISICAS                          VALUE 01.        00023100
023110           88 P-JURIDICAS                        VALUE 02.        00023110
023120           88 CONTA-A-CLASS                      VALUE 84.        00023120
023130           88 CONTA-SALARIO                      VALUE 73 74 75.  00023130
023140           88 CONTA-CONVENIO                     VALUE 77.        00023140
BOSSA            88 CONTA-JUDICIAL                     VALUE 30.
023150        10 DATA-IMPLANTA-RED-WS  PIC 9(6)        COMP-3.          00023150
023160        10 NOME-CLIENTE-RED-WS.                                   00023160
023170           15 NOME-RED-WS        PIC X(34).                       00023170
023180           15 CONT-NOME-RED-WS   PIC X(34).                       00023180
023190           15 COD-GARANTIA-RED-WS PIC XX.                         00023190
023200        10 ENDERECO-RED-WS.                                       00023200
023210           15 E-RUA-RED-WS       PIC X(30).                       00023210
023220           15 E-CIDADE-RED-WS.                                    00023220
023230              20 E-BAIR-RED-WS   PIC X(12).                       00023230
023240              20 E-CEP-RED-WS    PIC 9(5)        COMP-3.          00023240
023250              20 E-CID-RED-WS    PIC X(14).                       00023250
023260              20 E-EST-RED-WS    PIC XX.                          00023260
023270              20 E-FONE-RED-WS   PIC 9(7)        COMP-3.          00023270
023280        10 IDENTIFICACAO-RED-WS.                                  00023280
023290           15 CPF-CGC-RED-WS     PIC 9(15)       COMP-3.          00023290
023300              88 AD-BANCO  VALUE 000000411221353.                 00023300
023320*                                000001581473834                  00023320
023330*                                000000177377372                  00023330
023340*                                000002291860330                  00023340
023360*                                000010078533520.                 00023360
023370           15 EXTRATO-ESPECIAL-RED-WS                             00023370
023380                                 PIC 9.                           00023380
023390           15 TP-PESSOA-RED-WS   PIC XX.                          00023390
023400             88 FUNC                   VALUE 'A' 'D' 'E'          00023400
023410                                             'H'.                 00023410
023420             88 SERVI           VALUE 'A' 'E' 'H'.                00023420
023430             88 FISICA          VALUE 'A' 'B' 'C' 'D' 'E'         00023430
023440                                      'F' 'G' 'H' '<' '>'         00023440
023450                                      'R' 'S' 'T' 'V' 'W'         00023450
                                            '#'.
023460             88 FISICA-LIGADAS  VALUE 'A' 'C' 'D' 'E'             00023460
023470                                      'F' 'H' 'R' 'S' 'T'.        00023470
023480             88 JURIDICA        VALUE 'J' 'X' 'Y'                 00023480
023490                                      'Z' 'O' 'I' 'L'             00023490
023500                                      'M' 'P' 'Q' 'U' '1'         00023500
023510                                      '2' '3' '4' '5' '6'         00023510
023520                                      '7' '8' '9' '&'.            00023520
023530             88 PESSOA-K        VALUE 'K'.                        00023530
023540             88 PESSOA-N        VALUE 'N'.                        00023540
023550             88 FACTORING       VALUE 'L' 'M'.                    00023550
023560             88 RECEBIVEIS      VALUE '4' '5' '6' '7' '8' '9'.    00023560
023570             88 SIMPLES         VALUE 'P' 'Q' 'U' '1' '2' '3'     00023570
023580                                      '7' '8' '9'.                00023580
023590             88 CTA-EMPRESARIAL VALUE 'Y' 'X' 'Z' 'M' '1' '2' '3' 00023590
023600                                      '4' '5' '6' '7' '8' '9'.    00023600
023530             88 PESSOA-MPE      VALUE 'Y'.                        00023530
023610             88 INDUSTRIA       VALUE 'Y' '2' '5' '8'.            00023610
023620             88 COMERCIO        VALUE 'X' '1' '4' '7'.            00023620
023630             88 OUTROS          VALUE 'Z' 'M' '3' '6' '9'.        00023630
023640             88 CH-EMPRESA      VALUE 'I' 'J' 'O' 'L' 'P' 'Q' 'U'.00023640
023650             88 CHE-INDUST      VALUE 'I' 'P'.                    00023650
023660             88 CHE-COMERC      VALUE 'J' 'Q'.                    00023660
023670             88 CHE-OUTROS      VALUE 'O' 'L' 'U'.                00023670
023680             88 CH-EMPRESA-PP   VALUE '0' '+' '-' '=' '*' '/'.    00023680
023690             88 CHE-INDUST-PP   VALUE '0' '*'.                    00023690
023700             88 CHE-COMERC-PP   VALUE '+' '/'.                    00023700
023710             88 CHE-OUTROS-PP   VALUE '=' '-'.                    00023710
023720             88 CTA-SALARIO     VALUE 'A' 'B' 'C' 'D' 'E' 'H'     00023720
023730                                      'R' 'S' 'T'.                00023730
                   88 CTA-DIGITAL     VALUE '@'.
023430             88 CHEQUE-ESPECIAL VALUE 'A' 'B' 'C' 'D' 'E' 'F'     00023430
023440                                      'G' 'H' 'N' 'R' 'S' 'T'     00023440
023450                                      'V' 'W' '@' '#'  '<' '>'.   00023450
023740           15 TX-PERM-RED-WS     PIC 9.                           00023740
023750           15 CALC-SMED-RED-WS   PIC 9.                           00023750
023760              88 CONTA-NAO-CADASTRADA  VALUE 0.                   00023760
023770        10 ATUALIZACAO-RED-WS.                                    00023770
023780           15 ATL-ULT-DT-RED-WS  PIC 9(6)        COMP-3.          00023780
023790           15 ATL-ULT-MOV-RED-WS PIC 9(6)        COMP-3.          00023790
023800           15 ATL-DIAS-PARAL-RED-WS                               00023800
023810                                 PIC 9(5)        COMP-3.          00023810
023820        10 SALDOS-RED-WS.                                         00023820
023830           15 SLD-DEP-RED-WS     PIC S9(13)V99   COMP-3.          00023830
023840           15 SLD-EMP-RED-WS     PIC S9(13)V99   COMP-3.          00023840
023850           15 SALDOS-BLOQUEADOS-RED-WS.                           00023850
023860              20 SLD-BLO-RED-WS OCCURS 21 TIMES                   00023860
023870                                 PIC S9(13)V99   COMP-3.          00023870
023880        10 INSUF-EXCESSO-RED-WS  PIC 9.                           00023880
023900        10 NUM-SMED-ESTE-RED-WS  PIC S9(13)      COMP-3.          00023900
023910        10 SMED-TRIM-ATL-RED-WS.                                  00023910
023920           15 SMED-ATL1-RED-WS   PIC S9(13)      COMP-3.          00023920
023930           15 SMED-ATL2-RED-WS   PIC S9(13)      COMP-3.          00023930
023940           15 SMED-ATL3-RED-WS   PIC S9(13)      COMP-3.          00023940
023950        10 CONTERRANEO-RED-WS.                                    00023950
023960           15 EMP-DATA-RED-WS    PIC 9(6)        COMP-3.          00023960
023970           15 EMP-VENC-RED-WS    PIC 9(6)        COMP-3.          00023970
023980           15 EMP-LIM-RED-WS     PIC 9(13)V99    COMP-3.          00023980
023990           15 EMP-TAXA-JUR-RED-WS                                 00023990
024000                                 PIC 99V999      COMP-3.          00024000
024010           15 EMP-NUM-RED-WS     PIC S9(13)      COMP-3.          00024010
024020           15 EMP-NUM-EXCED-FUNC-RED-WS                           00024020
024030                                 PIC S9(13)      COMP-3.          00024030
024040           15 EMP-JCOB-RED-WS    PIC S9(9)V99    COMP-3.          00024040
024050           15 EMP-NUM-IOF-RED-WS PIC S9(13)      COMP-3.          00024050
024060        10 EXTRATO-RED-WS.                                        00024060
024070           15 EXT-DATA-RED-WS    PIC 9(6)        COMP-3.          00024070
024080           15 EXT-SLD-RED-WS     PIC S9(13)V99   COMP-3.          00024080
024090           15 EXT-TPSLD-RED-WS   PIC X.                           00024090
024100        10 FICHA-RED-WS.                                          00024100
024110           15 FICHA-NUM-RED-WS   PIC 999         COMP-3.          00024110
024120           15 FICHA-DATA-RED-WS  PIC 9(6)        COMP-3.          00024120
024130        10 MOVIMENTOS-RED-WS.                                     00024130
024140           15 MOV-NUM-RED-WS     PIC 99.                          00024140
024150           15 MOV-UNID-RED-WS OCCURS 17 TIMES.                    00024150
024160              20 DIA-MOV-RED-WS  PIC 99.                          00024160
024170              20 HIST-MOV-RED-WS PIC 9(05)       COMP-3.          00024170
024180              20 REF-MOV-RED-WS  PIC 9(6)        COMP-3.          00024180
024190              20 VR-MOV-RED-WS   PIC S9(13)V99   COMP-3.          00024190
024200        10 CD-CLI-RED-WS         PIC 9(9)        COMP-3.          00024200
024210        10 FILLER                PIC X.                           00024210
024220        10 DT-BLOQ-DESBLOQ-RED-WS PIC 9(6).                       00024220
024230*                                                                 00024230
024280        10 CD-CLI-COTIT-RED-WS   PIC 9(08).                       00024280
024290        10 IND-ALT-COTIT-RED-WS  PIC X(01).                       00024290
024310*                                                                 00024310
024320        10 DIA-DEBITO-JUROS-RED-WS PIC 99.                        00024320
024330        10 DT-TARIF-RENOV-RED-WS PIC 9(6)        COMP-3.          00024330
024340        10 TARIFA-PROPORCIONAL-RED-WS PIC S9(13)V99 COMP-3.       00024340
024350        10 QDE-SAQ-CARTAO-CTASAL-RED-WS PIC 9(7)        COMP-3.   00024350
024360        10 QDE-CHQ-PROCES-RED-WS PIC 9(7)        COMP-3.          00024360
024370        10 GRUPO-TARIFA-RED-WS   PIC 9.                           00024370
024380        10 ADESAO-GRUPO-TARIFA-RED-WS PIC 9(6)   COMP-3.          00024380
024390        10 INSPECAO-RED-WS.                                       00024390
024400           15 INSUF-RED-WS.                                       00024400
024410              20 INS-ULT-RED-WS  PIC 9(6)        COMP-3.          00024410
024420              20 INS-VEZ-RED-WS  PIC 999         COMP-3.          00024420
024430              20 INS-MOR-RED-WS  PIC S9(13)V99   COMP-3.          00024430
024440              20 INS-MOR-RED-R-WS REDEFINES INS-MOR-RED-WS        00024440
024450                                 PIC 9(13)V99    COMP-3.          00024450
024460              20 INS-DATA-MOR-RED-WS                              00024460
024470                                 PIC 9(6)        COMP-3.          00024470
024480              20 INS-NOVA-RED-WS PIC 9(6)        COMP-3.          00024480
024490              20 INS-NJUR-REAL-RED-WS  PIC S9(11)V99   COMP-3.    00024490
024500              20 INS-NJUR-DECOR-RED-WS PIC S9(11)V99   COMP-3.    00024500
024510              20 INS-NIOF-REAL-RED-WS  PIC S9(9)V99    COMP-3.    00024510
024520              20 INS-NIOF-DECOR-RED-WS PIC S9(9)V99    COMP-3.    00024520
024530           15 EXCESSO-RED-WS.                                     00024530
024540              20 EXC-ULT-RED-WS  PIC 9(6)        COMP-3.          00024540
024550              20 EXC-VEZ-RED-WS  PIC 999         COMP-3.          00024550
024560              20 EXC-MOR-RED-WS  PIC S9(13)V99   COMP-3.          00024560
024570              20 EXC-MOR-RED-R-WS REDEFINES EXC-MOR-RED-WS        00024570
024580                                 PIC 9(13)V99    COMP-3.          00024580
024590              20 EXC-DATA-MOR-RED-WS                              00024590
024600                                 PIC 9(6)        COMP-3.          00024600
024610              20 EXC-NOVO-RED-WS PIC 9(6)        COMP-3.          00024610
024620           15 ACERTO-RED-WS.                                      00024620
024630              20 ACT-ULT-RED-WS  PIC 9(6)        COMP-3.          00024630
024640              20 ACT-VEZ-RED-WS  PIC 999         COMP-3.          00024640
024650              20 ACT-MOR-RED-WS  PIC S9(13)V99   COMP-3.          00024650
024660              20 ACT-DATA-MOR-RED-WS                              00024660
024670                                 PIC 9(6)        COMP-3.          00024670
024680           15 NUMEROS-RED-WS.                                     00024680
024690              20 NUM-ULT-RED-WS  PIC 9(6)        COMP-3.          00024690
024700              20 NUM-VEZ-RED-WS  PIC 999         COMP-3.          00024700
024710              20 NUM-MOR-RED-WS  PIC S9(13)      COMP-3.          00024710
024720              20 NUM-DATA-MOR-RED-WS                              00024720
024730                                 PIC 9(6)        COMP-3.          00024730
024740           15 ADIANTAMENTOS-RED-WS.                               00024740
024750              20 VALOR-ACUM-ADIANT-RED-WS                         00024750
024760                                 PIC S9(13)V99   COMP-3.          00024760
024770        10 SENHA-RED-WS.                                          00024770
024780           15 STATUS-PRINC-RED-WS PIC 9.                          00024780
024790           15 VIA-PRINC-RED-WS   PIC 9.                           00024790
024800           15 REF-PRINC-RED-WS   PIC 9(8)        COMP-3.          00024800
024810           15 STATUS-SECON-RED-WS PIC 9.                          00024810
024820           15 VIA-SECON-RED-WS   PIC 9.                           00024820
024830           15 REF-SECON-RED-WS   PIC 9(8)        COMP-3.          00024830
024840        10 SELIC-RED-WS.                                          00024840
024850           15 CRED-ANTECIP-WS    PIC S9(13)V99   COMP-3.          00024850
024860        10 INDICACOES-ONLINE-RED-WS.                              00024860
024870           15 INDICACOES-WS      PIC 9(7)        COMP-3.          00024870
024880        10 CHEQUES-PERSON-WS.                                     00024880
024890           15 CH-PERSON-WS       PIC 9(5)        COMP-3.          00024890
024900           15 CH-COMUM-WS        PIC 9(5)        COMP-3.          00024900
024910           15 CH-ESPECIAL-WS     PIC 9(5)        COMP-3.          00024910
024920        10 TALONARIOS-PERSON-RED-WS REDEFINES CHEQUES-PERSON-WS.  00024920
024930           15 TALON-FORNECIDOS-RED-WS   PIC  9(5) COMP-3.         00024930
024940           15 TALON-RESIDUO-RED-WS      PIC  9(5) COMP-3.         00024940
024950           15 TALON-PEDIDOS-ACUM-RED-WS PIC S9(5) COMP-3.         00024950
024960        10 COD-POSTO-RED-WS      PIC 9.                           00024960
024970        10 NUM-INSUF-EXCES-RED-WS PIC S9(13)      COMP-3.         00024970
024980        10 NUM-INSUF-EXCESSO-RED-WS REDEFINES                     00024980
024990           NUM-INSUF-EXCES-RED-WS PIC 9(13)      COMP-3.          00024990
025000        10 VAR-OTN-RED-WS           PIC S99V999     COMP-3.       00025000
025010        10 MOVIMENTACAO-RED-WS      PIC 9.                        00025010
025020        10 JUROS-DIARIOS-WS         PIC S9(13)V99   COMP-3.       00025020
025030        10 DATA-ADIANT-RED-WS       PIC 9(6)  COMP-3.             00025030
025040        10 NUM-DEV-AJUST-RED-WS.                                  00025040
025050           15 NUM-SEM-BLOQ-RED-WS   PIC S9(11) COMP-3.            00025050
025060        10 ADICAO-SUBT-JUROS-WS.                                  00025060
025070           15 INDICADOR-JUROS-WS    PIC X.                        00025070
025080        10 EXTRATO-EXTRA-RED-WS     PIC 99.                       00025080
025090        10 EXPANSAO-MAIO-91-RED-WS.                               00025090
025100           15 CONTRA-ORDEM-OPOS-RED-WS PIC 9.                     00025100
025110           15 ATIVIDADE-RED-WS   PIC 999          COMP-3.         00025110
025120           15 DIA-IOC-RED-WS REDEFINES ATIVIDADE-RED-WS           00025120
025130                                 PIC 999          COMP-3.         00025130
025140           15 VALOR-MEDIO-LIMITE-RED-WS                           00025140
025150                                 PIC S9(13)       COMP-3.         00025150
025160           15 RAP-RED-WS         PIC S9(13)V99    COMP-3.         00025160
025170           15 IOCS-DIARIOS-EXIGIVEIS-RED-WS                       00025170
025180                                 PIC S9(13)V99    COMP-3.         00025180
025190           15 IOCS-DIARIOS-DISPENS-RED-WS                         00025190
025200                                 PIC S9(13)V99    COMP-3.         00025200
025210           15 SMED-TRIM-ANT-RED-WS.                               00025210
025220              20 SMED-ATL4-RED-WS   PIC S9(13)       COMP-3.      00025220
025230              20 SMED-ATL5-RED-WS   PIC S9(13)       COMP-3.      00025230
025240              20 SMED-ATL6-RED-WS   PIC S9(13)       COMP-3.      00025240
025250*                                                                 00025250
025350           15 QDE-CHQ-COMP-INTERNA-RED-WS  PIC 999       COMP-3.  00025350
025360           15 QDE-CHQ-PG-CAIXA-RED-WS      PIC 999       COMP-3.  00025360
025370*          15 VR-DEP-CHQ-SEM-RED-WS        PIC S9(13)V99 COMP-3.  00025370
025370           15 ACUM-BASE-IOF-ADIC-RED-WS    PIC S9(13)V99 COMP-3.
025380           15 QDE-CHQ-AVULSO-RED-WS        PIC 999       COMP-3.  00025380
025390           15 QDE-SAQ-CARTAO-CAIXA-RED-WS  PIC 999       COMP-3.  00025390
025400           15 QDE-SAQ-CARTAO-RED-WS        PIC 999       COMP-3.  00025400
025410           15 QDE-SAQ-BCO24HS-RED-WS       PIC 999       COMP-3.  00025410
025420           15 QDE-SAQ-BB-RED-WS            PIC 999       COMP-3.  00025420
025430           15 QDE-SAQ-RVA-RED-WS           PIC 999       COMP-3.  00025430
025460*                                                                 00025460
025470           15 TAXA-APLICADA-RED-WS      PIC S9(9)V9(9)   COMP-3.  00025470
025480           15 JUROS-DO-DIA-RED-WS       PIC S9(07)V9(8)  COMP-3.  00025480
025490           15 IN89-RED-WS.                                        00025490
025500              20 MANIFESTACAO-RED-WS    PIC X.                    00025500
025510              20 VIGENCIA-LIMINAR-CPMF-RED-WS.                    00025510
025520                 25 INI-LIMINAR-RED-WS  PIC 9(6)         COMP-3.  00025520
025530                 25 FIM-LIMINAR-RED-WS  PIC 9(6)         COMP-3.  00025530
025540           15 FATOR-ACUMULADO-RED-WS    PIC 9(9)V9(9)    COMP-3.  00025540
025550           15 ISENTA-COMPULSO-RED-WS    PIC X.                    00025550
025560           15 QDE-SAQUE-CARTAO-DO-MES-RED-WS                      00025560
025570                                        PIC 9(6)         COMP-3.  00025570
025580           15 SALDO-ANTERIOR-RED-WS     PIC S9(13)V99    COMP-3.  00025580
025590           15 EMP-PROPOSTA-RED-WS       PIC 9(15)        COMP-3.  00025590
025600           15 DIAS-UTEIS-UTIL-RED-WS    PIC 99.                   00025600
025610           15 FILLER                    PIC X(02).                00025610
025620           15 SMED-DEV-ESTE-RED-WS      PIC S9(13)V99    COMP-3.  00025620
025630           15 SMED-DEV-UTI1-RED-WS      PIC S9(13)V99    COMP-3.  00025630
025640           15 INDICADORES-DO-MES-RED-WS.                          00025640
025650              20 QDE-INS-EXC-MES-RED-WS                           00025650
025660                                        PIC 999          COMP-3.  00025660
025670              20 QDE-CHQS-DEV-MES-RED-WS                          00025670
025680                                        PIC 999          COMP-3.  00025680
025690           15 SMED-DEV-UTI2-RED-WS      PIC S9(13)V99    COMP-3.  00025690
025700           15 SMED-DEV-UTI3-RED-WS      PIC S9(13)V99    COMP-3.  00025700
025710           15 IMPEDE-RENOV-AUTO-RED-WS  PIC 9.                    00025710
025720              88 NAO-HA-IMPEDIMENTO-AG             VALUE 0.       00025720
025730           15 COD-POSTAL-RED-WS         PIC 9(9)         COMP-3.  00025730
025740           15 CLIENTE-PREFEREN-RED-WS   PIC 9.                    00025740
025750              88 CLIENTE-PREFEREN                 VALUE 1.        00025750
025760           15 CLIENTE-PREFEREN-RED-RED REDEFINES                  00025760
025770              CLIENTE-PREFEREN-RED-WS   PIC X.                    00025770
025780           15 IPMF-RED-WS.                                        00025780
025790              20 ISENCAO-IPMF-RED-WS      PIC 9.                  00025790
025800                 88 CONTRIBUINTE                   VALUE 0.       00025800
025810                 88 ISENTO                         VALUE 1 2 3 4. 00025810
025820              20 CHEQUE-TB-FORNECI-RED-WS PIC 9(5) COMP-3.        00025820
025830              20 CHEQUE-TB-RESIDUO-RED-WS PIC 9(5) COMP-3.        00025830
025840              20 CHEQUE-TB-PEDIDOS-RED-WS PIC S9(5) COMP-3.       00025840
025850           15 TP-TALAO-RED-WS           PIC 9.                    00025850
025860              88 FORMULARIO-CONTINUO            VALUE 1 4.        00025860
025870           15 AVISO-LANC-RED-WS         PIC X.                    00025870
025880           15 ID-CPF-CGC-RED-WS         PIC 9.                    00025880
025890           15 GANHO-POTENCIAL-DIARIO-WS PIC S9(13)V99 COMP-3.     00025890
025900           15 EXC-VEZ-CONTRATO-RED-WS   PIC 999 COMP-3.           00025900
025910           15 EMP-SEGURO-RED-WS         PIC X.                    00025910
025920           15 EMP-DATA-ENC-RED-WS       PIC 9(6) COMP-3.          00025920
025930           15 OPCAO-PC-RED-WS           PIC X.                    00025930
025940           15 DT-OPCAO-PC-RED-WS        PIC 9(6) COMP-3.          00025940
025950           15 FILLER                    PIC X(3).                 00025950
025960           15 FILLER                    PIC X(50).                00025960
025970*                                                                 00025970
025980*    NOTA: - O CAMPO VAR-OTN-RED EH UTILIZADO SOMENTE NO          00025980
025990*            PROGRAMA P94817. SEU VALOR NO ARQUIVO MESTRE         00025990
026000*            (D948.CADASTRO.CORRENTE.ANT/ATUAL) SEMPRE SE         00026000
026010*            RAH IGUAL A ZEROS.                                   00026010
026020*          - O CAMPO SELIC-RED-WS, PARA AS CONTAS COM TIPO CONTA- 00026020
026030*            BIL 49, CONTEM O VALOR DA CM.                        00026030
026040*                                                                 00026040
026050*    ......................................                       00026050
026070*                                                                 00026070
026080     05 REG-TRAILLER-AG-RED-WS REDEFINES REG-CORRENT-RED-WS.      00026080
026090*                                                                 00026090
026100        10 FILLER                PIC X(17).                       00026100
026110        10 ESTATISTICA-CAD-RED-WS.                                00026110
026120           15 INCLUSAO-RED-WS    PIC 9(5)        COMP-3.          00026120
026130           15 ALTERACAO-RED-WS   PIC 9(5)        COMP-3.          00026130
026140           15 EXCLUSAO-RED-WS    PIC 9(5)        COMP-3.          00026140
026150        10 TRAG-TOTAIS-TPCONTAB-RED-WS OCCURS 49 TIMES.           00026150
026160           15 TRAG-TPCONTAB-RED-WS                                00026160
026170                                 PIC 9(03)       COMP-3.          00026170
026180           15 TRAG-TOTAIS-ANT-RED-WS.                             00026180
026190              20 TOT-ANT-CONTAS-RED-WS                            00026190
026200                                 PIC 9(5)        COMP-3.          00026200
026210              20 TOT-ANT-SALDOS-RED-WS                            00026210
026220                                 PIC S9(13)V99   COMP-3.          00026220
026230           15 TRAG-TOTAIS-ATL-RED-WS.                             00026230
026240              20 TOT-ATL-CONTAS-RED-WS                            00026240
026250                                 PIC 9(5)        COMP-3.          00026250
026260              20 TOT-ATL-SALDOS-RED-WS                            00026260
026270                                 PIC S9(13)V99   COMP-3.          00026270
026280        10 AREA-LIVRE-TRAILLER-RED-WS  PIC X(48).                 00026280
026290                                                                  00026290
026300     05 FH-RECOLHER-D10-WS.                                       00026300
026310        10 FR-QDE-FICHA-D10-WS   PIC 99.                          00026310
026320        10 FR-REPETICAO-D10-WS OCCURS 10 TIMES.                   00026320
026330           15 FR-CONTA-D10-WS    PIC 9(9)        COMP-3.          00026330
026340           15 FR-DV-CONTA-D10-WS PIC X.                           00026340
026350           15 FR-EXCL-D10-WS     PIC X.                           00026350
026360*                                                                 00026360
026370*    ......................................                       00026370
026390*                                                                 00026390
026400     05 REG-EXTRATO-WS.                                           00026400
026410*                                                                 00026410
026420        10 CH-EXT-SEQ-WS         PIC 9(04).                       00026420
BOSSA         10 EXT-AG-WS             PIC 9(05)     COMP-3.            00026430
026440        10 EXT-NUM-CONTA-WS.                                      00026440
026450           15 EXT-CONTA-WS       PIC 9(9)      COMP-3.            00026450
026460           15 EXT-DIGITO-WS      PIC X.                           00026460
026470        10 EXT-TPREG-WS          PIC 9.                           00026470
026480        10 EXT-SEQ-WS            PIC 999.                         00026480
026490        10 EXT-TPCONTAB-WS       PIC 9(3)      COMP-3.            00026490
026500        10 EXT-CONTERR-WS.                                        00026500
026510           15 EXT-EMP-VENC-WS    PIC 9(6)      COMP-3.            00026510
026520           15 EXT-EMP-LIM-WS     PIC S9(13)V99 COMP-3.            00026520
026530        10 EXT-EXTRATO-WS.                                        00026530
026540           15 EXT-EXT-DATA-WS    PIC 9(6)      COMP-3.            00026540
026550           15 EXT-EXT-SLD-WS     PIC S9(13)V99 COMP-3.            00026550
026560           15 EXT-EXT-TP-SLD-WS  PIC X.                           00026560
026570        10 EXT-MOVIMENTOS-WS.                                     00026570
026580           15 EXT-MOV-NUM-WS     PIC 99.                          00026580
026590           15 EXT-MOV-UNID-WS OCCURS 17 TIMES.                    00026590
026600              20 EXT-DIA-WS      PIC 99.                          00026600
026610              20 EXT-HIST-WS     PIC 9(5)        COMP-3.          00026610
026620              20 EXT-REF-WS      PIC 9(6)        COMP-3.          00026620
026630              20 EXT-VR-WS       PIC S9(13)V99   COMP-3.          00026630
026640           15 FILLER             PIC X(30).                       00026640
026650        10 EXT-EXTRATO-ESPECIAL-WS PIC 9.                         00026650
026660        10 EXT-MENS-WS.                                           00026660
026670           15 EXT-COD-MENS-WS    PIC 99.                          00026670
026680        10 EXT-VR-BLOQ-WS        PIC S9(13)V99   COMP-3.          00026680
026690        10 EXT-TPPESSOA-WS       PIC XX.                          00026690
026700        10 FILLER                PIC X(547).                      00026700
026710                                                                  00026710
026720     05 EXTRA-EXTRA-WS.                                           00026720
026730*                                                                 00026730
026740        10 EXTRA-SEQ-WS          PIC 9(04).                       00026740
026750        10 EXTRA-AG-WS           PIC 9(5)      COMP-3.            00026750
026760        10 EXTRA-NUM-CONTA-WS.                                    00026760
026770           15 EXTRA-CONTA-WS     PIC 9(9)      COMP-3.            00026770
026780           15 EXTRA-DIGITO-WS    PIC X.                           00026780
026790        10 EXTRA-TPREG-WS        PIC 9.                           00026790
026800        10 EXTRA-SEQ-WS          PIC 999.                         00026800
026810        10 EXTRA-TPCONTAB-WS     PIC 999       COMP-3.            00026810
026820        10 EXTRA-CONTERR-WS.                                      00026820
026830           15 EXTRA-EMP-VENC-WS  PIC 9(6)      COMP-3.            00026830
026840           15 EXTRA-EMP-LIM-WS   PIC S9(13)V99 COMP-3.            00026840
026850        10 EXTRA-EXTRATO-WS.                                      00026850
026860           15 EXTRA-EXT-DATA-WS  PIC 9(6)      COMP-3.            00026860
026870           15 EXTRA-EXT-SLD-WS   PIC S9(13)V99 COMP-3.            00026870
026880           15 EXTRA-EXT-TP-SLD-WS PIC X.                          00026880
026890        10 EXTRA-MOVIMENTOS-WS.                                   00026890
026900           15 EXTRA-MOV-NUM-WS   PIC 99.                          00026900
026920           15 EXTRA-MOV-UNID-WS OCCURS 17 TIMES.                  00026920
026930              20 EXTRA-DIA-WS    PIC 99.                          00026930
026940              20 EXTRA-HIST-WS   PIC 9(5)        COMP-3.          00026940
026950              20 EXTRA-REF-WS    PIC 9(6)        COMP-3.          00026950
026960              20 EXTRA-VR-WS     PIC S9(13)V99   COMP-3.          00026960
026970           15 FILLER             PIC X(31).                       00026970
026980        10 EXTRA-MENS-WS.                                         00026980
026990           15 EXTRA-COD-MENS-WS  PIC 99.                          00026990
027000        10 EXTRA-VR-BLOQ-WS      PIC S9(13)V99   COMP-3.          00027000
027010        10 EXTRA-TPPESSOA-WS     PIC XX.                          00027010
027020        10 FILLER                PIC X(547).                      00027020
027030                                                                  00027030
027040     05 REG-D83-WS.                                               00027040
027050        10 COD-AG-D83-WS         PIC 9(5)        COMP-3.          00027050
027060        10 CONTA-D83-WS          PIC 9(9)        COMP-3.          00027060
027070        10 DIGITO-D83-WS         PIC X.                           00027070
027080        10 ENDERECO-D83-WS.                                       00027080
027090           15 RUA-D83-WS         PIC X(30).                       00027090
027100           15 BAIRRO-D83-WS      PIC X(12).                       00027100
027110           15 CEP-D83-WS         PIC 9(8)        COMP-3.          00027110
027120           15 CIDADE-D83-WS      PIC X(14).                       00027120
027130           15 ESTADO-D83-WS      PIC XX.                          00027130
027140        10 FONE-D83-WS           PIC 9(7)        COMP-3.          00027140
027150        10 NOME-D83-WS           PIC X(34).                       00027150
027160        10 CONT-NOME-D83-WS      PIC X(34).                       00027160
027170        10 CGC-CPF-D83-WS        PIC 9(9)        COMP-3.          00027170
027180        10 BARRA-CGC-D83-WS      PIC 9(4)        COMP-3.          00027180
027190        10 CONTR-CGC-CPF-D83-WS  PIC 99.                          00027190
027200        10 TIPO-CONTABIL-D83-WS  PIC 999         COMP-3.          00027200
027210        10 TIPO-PESSOA-D83-WS    PIC XX.                          00027210
027220        10 ISENCAO-IPMF-D83-WS   PIC 9.                           00027220
027230        10 CALC-SMED-D83-WS      PIC 9.                           00027230
027240        10 FILLER                PIC X(20).                       00027240
027610                                                                  00027610
027620*    .......................................                      00027620

027640     05 ESTATISTICA-CAD-WS.                                       00027640
027650        10 INCLUSAO-WS           PIC 9(5) COMP-3 VALUE ZEROS.     00027650
027660        10 ALTERACAO-WS          PIC 9(5) COMP-3 VALUE ZEROS.     00027660
027670        10 EXCLUSAO-WS           PIC 9(5) COMP-3 VALUE ZEROS.     00027670
027680     05 INDICA-WS                PIC 9(7)        VALUE ZEROS.     00027680
027690     05 INDICA-RED-WS REDEFINES INDICA-WS.                        00027690
027700        10 CONTRA-ORDEM-WS       PIC 9.                           00027700
027710        10 FILLER                PIC X.                           00027710
027720        10 FORNECER-TALAO-WS     PIC 9.                           00027720
027730        10 RESTO-WS              PIC 9(4).                        00027730
027740     05 INDICACOES               PIC 9(7)        VALUE ZEROS.     00027740
027750     05 INDICACOES-RED REDEFINES INDICACOES.                      00027750
027760        10 IND-BLOQUEIO          PIC 9.                           00027760
027770           88 DESBLOQUEADA                       VALUE 0 2.       00027770
027780           88 BLOQUEADA                          VALUE 1 3.       00027780
027790           88 PRIMEIRO-BLOQUEIO                  VALUE 1.         00027790
027800           88 PRIMEIRO-DESBLOQUEIO               VALUE 2.         00027800
027810           88 SEGUNDO-BLOQUEIO                   VALUE 3.         00027810
027820        10 FILLER                PIC X(6).                        00027820
027830     05 FILE-STATUS-WS           PIC XX          VALUE SPACES.    00027830
027840     05 MENSAGEM-ERRO-WS         PIC X(45)       VALUE SPACES.    00027840
027850     05 SOMA-BLOQ-WS      COMP-3 PIC S9(13)V99   VALUE ZEROS.     00027850
027860     05 TOTAL-SLD-BLO-WS  COMP-3 PIC S9(13)V99   VALUE ZEROS.     00027860
027870     05 VALOR-BLOQ-WS     COMP-3 PIC S9(13)V99   VALUE ZEROS.     00027870
029160     05 SLD-DEV-NUM-ANT-WS    COMP-3  PIC S9(13)V99   VALUE ZEROS.00029160
027880     05 HUM-PORCENTO-WS   COMP-3 PIC S9(9)V9(9)  VALUE ZEROS.     00027880
027890     05 FATOR-VENCIDO-WS  COMP-3 PIC S9(9)V9(9)      VALUE ZEROS. 00027890
027900     05 FATOR-JUR-PF-F1   COMP-3 PIC S9(9)V9(9)      VALUE ZEROS. 00027900
027910     05 FATOR-JUR-PF-F2   COMP-3 PIC S9(9)V9(9)      VALUE ZEROS. 00027910
027920     05 FATOR-JUR-PF-F3   COMP-3 PIC S9(9)V9(9)      VALUE ZEROS. 00027920
027930     05 FATOR-JUR-PF-F4   COMP-3 PIC S9(9)V9(9)      VALUE ZEROS. 00027930
027940     05 FATOR-JUR-PF-F5   COMP-3 PIC S9(9)V9(9)      VALUE ZEROS. 00027940
027950     05 FATOR-JUR-PJ-F1   COMP-3 PIC S9(9)V9(9)      VALUE ZEROS. 00027950
027960     05 FATOR-JUR-PJ-F2   COMP-3 PIC S9(9)V9(9)      VALUE ZEROS. 00027960
027970     05 FATOR-JUR-PJ-F3   COMP-3 PIC S9(9)V9(9)      VALUE ZEROS. 00027970
027980     05 FATOR-JUR-PJ-F4   COMP-3 PIC S9(9)V9(9)      VALUE ZEROS. 00027980
027990     05 FATOR-JUR-PJ-PP-F1 COMP-3 PIC S9(9)V9(9)      VALUE ZEROS.00027990
028000     05 FATOR-JUR-PJ-PP-F2 COMP-3 PIC S9(9)V9(9)      VALUE ZEROS.00028000
028010     05 FATOR-JUR-PJ-PP-F3 COMP-3 PIC S9(9)V9(9)      VALUE ZEROS.00028010
028020     05 FATOR-JUR-PJ-PP-F4 COMP-3 PIC S9(9)V9(9)      VALUE ZEROS.00028020
028030     05 FATOR-JUR-CE-WS   COMP-3 PIC S9(9)V9(9)      VALUE ZEROS. 00028030
      *    FATOR-INSUF-PJ-WS computado como o quociente entre o indice
      *    121 do dia atual e do dia seguinte - 1.
028060     05 FATOR-IAC-PF-WS   COMP-3 PIC S9(9)V9(9)     VALUE ZEROS.
028060     05 FATOR-IAC-PJ-WS   COMP-3 PIC S9(9)V9(9)     VALUE ZEROS.
028040     05 FATOR-INSUF-PJ-WS COMP-3 PIC S9(9)V9(9)     VALUE ZEROS.  00028040
028060     05 FATOR-INSUF-PF-WS COMP-3 PIC S9(9)V9(9)     VALUE ZEROS.  00028060
028070     05 FATOR-EXCESSO-PF-WS COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.  00028070
028080     05 FATOR-EXCESSO-PJ-WS COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.  00028080
028090     05 FATOR-EXCESSO-CE-WS COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.  00028090
      *    VR-IAC-ANT-WS - Valor do indice de atraso de credito no dia
      *                    de processamento.
028100     05 VR-IAC-ANT-WS     COMP-3 PIC S9(10)V9(8)  VALUE ZEROS.    00028100
028110     05 VR-IAC-ATL-WS     COMP-3 PIC S9(10)V9(8)  VALUE ZEROS.    00028110
028120     05 VR-IAC-ONTEM-WS  COMP-3 PIC S9(10)V9(8)  VALUE ZEROS.     00028120
028130     05 VR-ITAH-ANT-WS    COMP-3 PIC S9(10)V9(8)  VALUE ZEROS.    00028130
028140     05 VR-ITAH-ATL-WS    COMP-3 PIC S9(10)V9(8)  VALUE ZEROS.    00028140
028150     05 VR-ITAF-ANT-WS    COMP-3 PIC S9(10)V9(8)  VALUE ZEROS.    00028150
028160     05 VR-ITAF-ATL-WS    COMP-3 PIC S9(10)V9(8)  VALUE ZEROS.    00028160
028170     05 VR-ITAH-ONTEM-WS  COMP-3 PIC S9(10)V9(8)  VALUE ZEROS.    00028170
028180     05 VR-ITAF-ONTEM-WS  COMP-3 PIC S9(10)V9(8)  VALUE ZEROS.    00028180
028190     05 FATOR-JUR-CAP-PF-WS    COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028190
028200     05 FATOR-JUR-CAP-PF-F1    COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028200
028210     05 FATOR-JUR-CAP-PF-F2    COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028210
028220     05 FATOR-JUR-CAP-PF-F3    COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028220
028230     05 FATOR-JUR-CAP-PF-F4    COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028230
028240     05 FATOR-JUR-CAP-PF-F5    COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028240
028250     05 FATOR-JUR-CAP-PJ-WS    COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028250
028260     05 FATOR-JUR-CAP-PJ-F1    COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028260
028270     05 FATOR-JUR-CAP-PJ-F2    COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028270
028280     05 FATOR-JUR-CAP-PJ-F3    COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028280
028290     05 FATOR-JUR-CAP-PJ-F4    COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028290
028300     05 FATOR-JUR-CAP-PJ-PP-F1 COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028300
028310     05 FATOR-JUR-CAP-PJ-PP-F2 COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028310
028320     05 FATOR-JUR-CAP-PJ-PP-F3 COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028320
028330     05 FATOR-JUR-CAP-PJ-PP-F4 COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028330
028340     05 FATOR-JUR-CAP-CE-WS    COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028340
028350     05 FATOR-INSUF-CAP-PF-WS  COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028350
028360     05 FATOR-INSUF-CAP-PJ-WS  COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028360
028370     05 FATOR-INSUF-CAP-CE-WS  COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028370
028380     05 FATOR-INSUF-EXC-PF-WS  COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028380
028390     05 FATOR-INSUF-EXC-PJ-WS  COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028390
028400     05 FATOR-INSUF-EXC-CE-WS  COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028400
028410     05 FATOR-EXCESSO-CAP-PF-WS COMP-3 PIC S9(9)V9(9) VALUE +0.   00028410
028420     05 FATOR-EXCESSO-CAP-PJ-WS COMP-3 PIC S9(9)V9(9) VALUE +0.   00028420
028430     05 FATOR-EXCESSO-CAP-CE-WS COMP-3 PIC S9(9)V9(9) VALUE +0.   00028430
028440     05 VR-IAC-PRIMEIRO-FERIADO-WS                                00028440
028450                               COMP-3 PIC S9(10)V9(8) VALUE ZEROS.00028450
028460     05 VR-ITAF-PRIMEIRO-FERIADO-WS                               00028460
028470                               COMP-3 PIC S9(10)V9(8) VALUE ZEROS.00028470
028480     05 VR-ITAH-PRIMEIRO-FERIADO-WS                               00028480
028490                               COMP-3 PIC S9(10)V9(8) VALUE ZEROS.00028490
028500     05 FATOR-DIARIO-AUX-WS    COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028500
028510     05 FATOR-JUROS-PFISICA-WS COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028510
028520     05 FATOR-JUROS-PJURIDICA-WS                                  00028520
028530                               COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028530
028540     05 FATOR-JUROS-PJ-PP-WS   COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028540
028550     05 FATOR-JUROS-CTA-EMPRES-WS                                 00028550
028560                               COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028560

      * CAMPOS UTILIZADOS NO CALCULO JUROS DEVOLUCAO
           05  DT-ULT-AG-WS             PIC 9(06)      VALUE ZEROS.
           05  DT-ULT-AG-WS-RED REDEFINES DT-ULT-AG-WS.
               10  ANO-ULT-AG-WS        PIC 9(02).
               10  MES-ULT-AG-WS        PIC 9(02).
               10  DIA-ULT-AG-WS        PIC 9(02).

020380     05 DATA-SIEF-DEVOL-WS.                                       00020380
020390        10 DIA-SIEF-DEVOL-WS         PIC 99           VALUE ZEROS.00020390
020400        10 FILLER                    PIC X            VALUE '/'.  00020400
020410        10 MES-SIEF-DEVOL-WS         PIC 99           VALUE ZEROS.00020410
020420        10 FILLER                    PIC X            VALUE '/'.  00020420
020430        10 ANO-SIEF-DEVOL-WS         PIC 9999         VALUE ZEROS.00020430

031330     05 DATA-AUX-Y2-INV-DEVOL.                                    00031330
031340        10 ANO-AUX-Y2-INV-DEVOL      PIC 9999.                    00031340
031350        10 MES-AUX-Y2-INV-DEVOL      PIC 99.                      00031350
031360        10 DIA-AUX-Y2-INV-DEVOL      PIC 99.                      00031360
031370     05 DATA-AUX-Y2-INV-DEVOL-RED REDEFINES DATA-AUX-Y2-INV-DEVOL 00031370
031380                                 PIC 9(8).                        00031380
031810     05 DATA-DEVOL-WS.                                            00031810
031820        10 DIA-DEVOL-WS              PIC 99.                      00031820
031830        10 MES-DEVOL-WS              PIC 99.                      00031830
031840        10 ANO-DEVOL-WS              PIC 99.                      00031840
031850     05 DATA-RED-DEVOL-WS REDEFINES DATA-DEVOL-WS                 00031850
031860                                 PIC 9(6).                        00031860

031460     05 DATA-INVERTIDA-DEVOL.                                     00031460
031470        10 ANO-INV-DEVOL             PIC 9999.                    00031470
031480        10 MES-INV-DEVOL             PIC 99.                      00031480
031490        10 DIA-INV-DEVOL             PIC 99.                      00031490
031500     05 DATA-INVERTIDA-DEVOL-RED REDEFINES DATA-INVERTIDA-DEVOL   00031500
031510                                 PIC 9(8).                        00031510
027900     05 FATOR-JUR-PF-F1-WS    COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00027900
027910     05 FATOR-JUR-PF-F2-WS    COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00027910
027920     05 FATOR-JUR-PF-F3-WS    COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00027920
027930     05 FATOR-JUR-PF-F4-WS    COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00027930
027940     05 FATOR-JUR-PF-F5-WS    COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00027940
027950     05 FATOR-JUR-PJ-F1-WS    COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00027950
027960     05 FATOR-JUR-PJ-F2-WS    COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00027960
027970     05 FATOR-JUR-PJ-F3-WS    COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00027970
027980     05 FATOR-JUR-PJ-F4-WS    COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00027980
027900     05 FATOR-JUR-PJ-PP-F1-WS COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00027900
028000     05 FATOR-JUR-PJ-PP-F2-WS COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00028000
028010     05 FATOR-JUR-PJ-PP-F3-WS COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00028010
028020     05 FATOR-JUR-PJ-PP-F4-WS COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00028020
028510     05 FATOR-JUROS-PFISICA-AUX COMP-3 PIC S9(9)V9(9) VALUE ZEROS.00028510
028520     05 FATOR-JUROS-PJURIDICA-AUX                                 00028520
028530                              COMP-3  PIC S9(9)V9(9)  VALUE ZEROS.00028530
028540     05 FATOR-JUROS-PJ-PP-AUX COMP-3  PIC S9(9)V9(9)  VALUE ZEROS.00028540
028550     05 FATOR-JUROS-CTA-EMPRES-AUX                                00028550
028560                              COMP-3  PIC S9(9)V9(9)  VALUE ZEROS.00028560
028510     05 FATOR-JUROS-PFISICA-ANT-WS                                00028510
028510                              COMP-3  PIC S9(9)V9(9)  VALUE ZEROS.00028510
028520     05 FATOR-JUROS-PJURIDICA-ANT-WS                              00028520
028530                              COMP-3  PIC S9(9)V9(9)  VALUE ZEROS.00028530
028540     05 FATOR-JUROS-PJ-PP-ANT-WS                                  00028540
028540                              COMP-3  PIC S9(9)V9(9)  VALUE ZEROS.00028540
028550     05 FATOR-JUROS-CTA-EMPRES-ANT-WS                             00028550
028560                              COMP-3  PIC S9(9)V9(9)  VALUE ZEROS.00028560
028040     05 FATOR-INSUF-PJ-ANT-WS COMP-3  PIC S9(9)V9(9)  VALUE ZEROS.00028040
028060     05 FATOR-INSUF-PF-ANT-WS COMP-3  PIC S9(9)V9(9)  VALUE ZEROS.00028060
027890     05 FATOR-VENCIDO-ANT-WS  COMP-3  PIC S9(9)V9(9)  VALUE ZEROS.00027890
028750     05 FATOR-EXCESSO-PF-ANT-WS                                   00028750
028760                              COMP-3  PIC S9(9)V9(9)  VALUE ZEROS.00028760
028770     05 FATOR-EXCESSO-PJ-ANT-WS                                   00028770
028780                              COMP-3  PIC S9(9)V9(9)  VALUE ZEROS.00028780
028090     05 FATOR-EXCESSO-CE-ANT-WS                                   00028090
028090                              COMP-3 PIC S9(9)V9(9)   VALUE ZEROS.00028090
029150     05 SLD-DEVOL-EMP-ANT-WS  COMP-3  PIC S9(13)V99   VALUE ZEROS.00029150
029150     05 SLD-DEVOL-EXCESSO-ANT-WS                                  00029150
029150                              COMP-3  PIC 9(13)V99    VALUE ZEROS.00029150
029160     05 SLD-DEV-ANT-DEVOL-WS  COMP-3  PIC 9(13)V99    VALUE ZEROS.00029160
029150     05 SLD-DEVOL-NUM-WS      COMP-3  PIC S9(13)V99   VALUE ZEROS.00029150
021512     05 BASE-DEVOL-IOF-ADI-ANT-WS     PIC 9(13)V99    VALUE ZEROS.00021512
019480     05 SLD-ANT-ANTERIOR-WS   COMP-3  PIC S9(13)V99   VALUE ZEROS.00019480
019480     05 SLD-DEV-ANT-WS        COMP-3  PIC 9(13)V99    VALUE ZEROS.
      *    SLD-EMP-ANT-AJUS-IOF-AD-DEV-WS - Saldo devedor do dia anterior
      *    mais o saldo de devolucao do dia atual, usado apenas na ocorrencia
      *    de insuficiencia.
019480     05 SLD-EMP-ANT-AJUS-IOF-AD-DEV-WS  COMP-3 PIC S9(13)V99      00019480
019480                                     VALUE ZEROS.                 00019480
      * FIM CAMPOS UTILIZADOS NO CALCULO JUROS DEVOLUCAO

028570     05 PERCENTUAL-RECEBIVEIS-WS                                  00028570
028580                               COMP-3 PIC S9(2)V9(8) VALUE ZEROS. 00028580
028590     05 DIAS-UTEIS-SPREAD-WS           PIC 99         VALUE ZEROS.00028590
028600     05 DIAS-NAO-UTEIS-WS              PIC 99         VALUE ZEROS.00028600
028610     05 SPREAD-05-WS           COMP-3 PIC S9(7)V9(9) VALUE ZEROS. 00028610
028620     05 SPREAD-WS               COMP-3 PIC S99V9(9)   VALUE ZEROS.00028620
028630     05 SPREAD-06-WS            COMP-3 PIC S9(7)V9(9) VALUE ZEROS.00028630
028640     05 SPREAD-07-WS            COMP-3 PIC S9(7)V9(9) VALUE ZEROS.00028640
028650     05 SPREAD-08-WS            COMP-3 PIC S9(7)V9(9) VALUE ZEROS.00028650
028660     05 SPREAD-09-WS            COMP-3 PIC S9(7)V9(9) VALUE ZEROS.00028660
028670     05 SPREAD-10-WS            COMP-3 PIC S9(7)V9(9) VALUE ZEROS.00028670
028680     05 SPREAD-11-WS            COMP-3 PIC S9(7)V9(9) VALUE ZEROS.00028680
028690     05 SPREAD-12-WS            COMP-3 PIC S9(7)V9(9) VALUE ZEROS.00028690
028700     05 SPREAD-13-WS            COMP-3 PIC S9(7)V9(9) VALUE ZEROS.00028700
028710     05 SPREAD-14-WS            COMP-3 PIC S9(7)V9(9) VALUE ZEROS.00028710
028720     05 SPREAD-15-WS            COMP-3 PIC S9(7)V9(9) VALUE ZEROS.00028720
028730     05 TAXA-SPREAD-WS          COMP-3 PIC S9(7)V9(9) VALUE ZEROS.00028730
028740     05 FATOR-VEZES-SPREAD      COMP-3 PIC S9(7)V9(9) VALUE ZEROS.00028740
028750     05 FATOR-EXCESSO-PFISICA-WS                                  00028750
028760                               COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028760
028770     05 FATOR-EXCESSO-PJURIDICA-WS                                00028770
028780                               COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028780
028790     05 FATOR-EXCESSO-CTA-EMPRES-WS                               00028790
028800                               COMP-3 PIC S9(9)V9(9) VALUE ZEROS. 00028800
028810     05 VR-BTN-WS         COMP-3 PIC S9(12)V9(4)  VALUE ZEROS.    00028810
028820     05 NUMEROS-WS        COMP-3 PIC S9(13)      VALUE ZEROS.     00028820
           05 AGE-EXT-WS        COMP-3 PIC 9(05)       VALUE ZEROS.
028830     05 CONTA-EXT-WS      COMP-3 PIC 9(9)        VALUE ZEROS.     00028830
028840     05 SEQ-EXT-WS               PIC 999         VALUE ZEROS.     00028840
028850     05 SALDO-VR-ABSOLUTO        PIC 9(13)V99    COMP-3.          00028850
028860     05 NUM-DEV-VR-ABSOLUTO      PIC 9(13)       COMP-3.          00028860
      *    INS-VR-ABSOLUTO - Usado em momentos diferentes do codigo.
      *    Pode siginificar:
      *        EXCESSO-F10-WS - Valor de excesso sobre limite de cheque;
      *        INS-VR-RELATIVO- Valor de insuficiencia contando bloqueios;
      *        ABS(INS-VR-RELATIVO) - Valor absoluto da insuf. relativa.
      *
028870     05 INS-VR-ABSOLUTO          PIC 9(13)V99    COMP-3.          00028870
      *    INS-VR-ABSOLUTO-WS - Valor relativo sem sinal, valor INS-VR-ABSOLUTO
      *    do saldo relativo.
028880     05 INS-VR-ABSOLUTO-WS       PIC 9(13)V99  COMP-3 VALUE ZEROS.00028880
      *    INS-VR-RELATIVO - Valor relativo de insuficiencia, saldo dev.
      *    menos os saldos bloqueados.
028890     05 INS-VR-RELATIVO          PIC S9(13)V99 COMP-3 VALUE ZEROS.00028890
028900     05 JURO-MINIMO-WS           PIC S9(13)V99   COMP-3.          00028900
028910     05 SLD-BLO-WS               PIC 9(13)V99    COMP-3.          00028910
028920     05 SALDO-BLOQ-WS    COMP-3  PIC S9(13)V99   VALUE ZEROS.     00028920
028930     05 RESTO            COMP-3  PIC 999         VALUE ZEROS.     00028930
028940     05 SEQ-FH-RECOL-WS  COMP-3  PIC 999         VALUE ZEROS.     00028940
028950     05 SEQ-MST-WS       COMP-3  PIC 999.                         00028950
028960     05 COD-AE-WS        COMP-3  PIC 999         VALUE ZEROS.     00028960
028970     05 DBLO-QDE-WS      COMP-3  PIC 99          VALUE ZEROS.     00028970
028980     05 SLD-DISPONIVEL   COMP-3  PIC S9(13)V99   VALUE ZEROS.     00028980
028990     05 SLD-REAL-WS      COMP-3  PIC S9(13)V99   VALUE ZEROS.     00028990
029000     05 SLD-DEP-ANT-WS   COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029000
      *    Valor de adiantamento recebido no ultimo dia util.
029010     05 SLD-DEP-ANT      COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029010
029020     05 SLD-DEP-RED      COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029020
029030     05 SLD-EMP-ANT-WS   COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029030
029040     05 SLD-DEV-CALCULO-WS COMP-3 PIC S9(13)V99   VALUE ZEROS.    00029040
029050     05 INSUF-AUX-WS     COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029050
029060     05 NUMEROS-IOC-WS           COMP-3 PIC S9(13) VALUE ZEROS.   00029060
029070     05 NUMEROS-IOC-CALCULADO-WS COMP-3 PIC S9(13) VALUE ZEROS.   00029070
029080     05 IOC-DIARIOS-WS   COMP-3    PIC S9(13)V99 VALUE ZEROS.     00029080
029090     05 ENCARGOS-DIARIOS-WS COMP-3 PIC S9(13)V99 VALUE ZEROS.     00029090
029100     05 QTDE-DIAS-WS     COMP-3  PIC S9(07)      VALUE ZEROS.     00029100
029120     05 TX-IOC-FISICA-WS COMP-3  PIC 9V9999      VALUE ZEROS.     00029120
029130     05 TX-IOC-JURID-WS  COMP-3  PIC 9V9999      VALUE ZEROS.     00029130
029140     05 TX-IOC-SIMPLES-WS  COMP-3  PIC 9V9999      VALUE ZEROS.   00029140
029150     05 SLD-DEV-NUM-WS   COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029150
029170     05 INSUF-ANT        COMP-3  PIC 9(13)V99    VALUE ZEROS.     00029170
029180     05 INSUF-PARIOC-WS  COMP-3  PIC 9(13)V99    VALUE ZEROS.     00029180
029190     05 INSUFICIENCIA-WS COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029190
029200     05 AGENCIA-F10-WS   COMP-3  PIC 9(5)        VALUE ZEROS.     00029200
029210     05 AGENCIA-D07-WS   COMP-3  PIC 9(5)        VALUE ZEROS.     00029210
029220     05 COD-AG-D07-ANT   COMP-3  PIC 9(5)        VALUE ZEROS.     00029220
029230     05 SLD-ANT          COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029230
029240     05 TPSLD-ANT                PIC X.                           00029240
029250     05 GR-DIFERENCA     COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029250
029260     05 GR-DIF-VR-ABSOLUTO       PIC 9(13)V99 COMP-3.             00029260
029270     05 QDE-GR-DIFERENCA COMP-3  PIC 999         VALUE ZEROS.     00029270
029280     05 DIF-INS-SLD-WS   COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029280
029290     05 MVR-CALC-WS      COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029290
029300     05 DIFERENCA-DIAS-WS        PIC S99         VALUE ZEROS.     00029300
           05 QT-DIAS-IOF              PIC 99          VALUE ZEROS.
029310     05 DI-MOV-REF-WS    COMP-3  PIC 9(6)        VALUE ZEROS.     00029310
029320     05 DI-MOV-LOTE-WS           PIC 99.                          00029320
029330     05 DI-AC-CAD-WS             PIC X.                           00029330
029340     05 DI-MOV-HIST-WS           PIC 9(05)       VALUE ZEROS.     00029340
029350     05 DI-MOV-VR-WS     COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029350
029360     05 AC-N-COD-MENS-WS         PIC 99.                          00029360
029370     05 DBLO-COD-MENS-WS         PIC 99          VALUE ZEROS.     00029370
029380     05 DESBLOQ-WS       COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029380
029390     05 HIST-DESBLOQ-WS          PIC 9(05)       VALUE ZEROS.     00029390
029400     05 PRAZO-DESBLOQ-WS         PIC 99          VALUE ZEROS.     00029400
029410     05 DIVISOR-IOF              PIC 9(5)        COMP-3.          00029410
029420     05 DIAS-PARAL-WS    COMP-3  PIC S9(10)      VALUE ZEROS.     00029420
029430     05 CH-SEQUENC-WS    COMP-3  PIC 999         VALUE ZEROS.     00029430
029430     05 CH-SEQUENC-AUX   COMP-3  PIC 999         VALUE ZEROS.     00029430
029440     05 AC-EC-CAD-WS             PIC X.                           00029440
029450     05 ESP-AC-CAD-WS            PIC X.                           00029450
029460     05 EXCESSO-F10-WS   COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029460
029470     05 ASTERISCO                PIC X(39)       VALUE ALL '*'.   00029470
029480     05 ACT-MOR-WS1      COMP-3  PIC 9(13)V99    VALUE ZEROS.     00029480
029490     05 DI-SLD-ANT-WS    COMP-3  PIC S9(13)V99   VALUE ZEROS.     00029490
029500     05 DI-TPSLD-ANT-WS          PIC X           VALUE SPACE.     00029500
029510     05 DISPON-WS   COMP-3       PIC S9(13)V99   VALUE ZEROS.     00029510
029520     05 FH-JUR-DIA-D10-CENT   PIC S9(9) COMP-3 VALUE +0.          00029520
029530     05 FH-IOF-DIA-D10-CENT   PIC S9(9) COMP-3 VALUE +0.          00029530
029540     05 FH-JUR-ATE-EMIS-D10-CENT PIC S9(9) COMP-3 VALUE +0.       00029540
029550     05 FH-IOF-ATE-EMIS-D10-CENT PIC S9(9) COMP-3 VALUE +0.       00029550
029560     05 INS-JUR-1DIA-D10-CENT    PIC S9(13) COMP-3 VALUE +0.      00029560
029570     05 INS-JUR-ATL-D10-CENT     PIC S9(13) COMP-3 VALUE +0.      00029570
029580     05 C-EMP-IOF-D10-CENT       PIC S9(13) COMP-3 VALUE +0.      00029580
029590     05 C-EMP-JUR-DEV-D10-CENT   PIC S9(13) COMP-3 VALUE +0.      00029590
029600     05 CV-JUR-1DIA-D10-CENT     PIC S9(13) COMP-3 VALUE +0.      00029600
029610     05 CV-JUR-EMIS-D10-CENT     PIC S9(13) COMP-3 VALUE +0.      00029610
029620     05 CV-IOF-EMIS-D10-CENT     PIC S9(13) COMP-3 VALUE +0.      00029620
029630     05 CV-IOF-1DIA-D10-CENT     PIC S9(13) COMP-3 VALUE +0.      00029630
029640     05 INS-IOF-RED-CENT         PIC S9(11) COMP-3 VALUE +0.      00029640
029650     05 JUR-DEV-D10-CENT         PIC S9(13) COMP-3 VALUE +0.      00029650
029660     05 ACUM-CH-NPROC            PIC 9(5)   COMP-3 VALUE 0.       00029660
029670     05 NUM-TOTAL-FUNC-WS        PIC S9(13) COMP-3 VALUE +0.      00029670
029680     05 NUM-DEV-VR-ABSOLUTO-WS   PIC S9(13) COMP-3 VALUE +0.      00029680
029690     05 NUM-PADRAO-WS            PIC S9(13) COMP-3 VALUE +0.      00029690
029700     05 OTNF-ANT-WS              PIC S9(10)V9(6) COMP-3 VALUE +0. 00029700
029710     05 OTNF-ATL-WS              PIC S9(10)V9(6) COMP-3 VALUE +0. 00029710
029720     05 JUROS-EXCED-FUNC-WS      PIC S9(13)V99 COMP-3 VALUE +0.   00029720
029730     05 INDICA-IMPLA-WS          PIC 9                VALUE  0.   00029730
029740        88 IMPLANTA-AGENCIA                           VALUE  2.   00029740
029750     05 LISTAO-WS                PIC 9                VALUE ZEROS.00029750
029760     05 ACUM-DIAS-LISTAO-WS      PIC S9(7)V99 COMP-3  VALUE ZEROS.00029760
029770     05 QUOCIENTE-LISTAO-WS      PIC S9(7)   COMP-3  VALUE ZEROS. 00029770
029780     05 RESTO-SEMANA-WS          PIC X(14)           VALUE SPACES.00029780
029790        88 DOMINGO                        VALUE '1DOMINGO      '. 00029790
029800        88 SEGUNDA                        VALUE '2SEGUNDA FEIRA'. 00029800
029810        88 TERCA                          VALUE '3TERCA FEIRA  '. 00029810
029820        88 QUARTA                         VALUE '4QUARTA FEIRA '. 00029820
029830        88 QUINTA                         VALUE '5QUINTA FEIRA '. 00029830
029840        88 SEXTA                          VALUE '6SEXTA FEIRA  '. 00029840
029850        88 SABADO                         VALUE '7SABADO       '. 00029850
029860     05 PROXIMO-DIA-WS           PIC X              VALUE SPACES. 00029860
029870        88 PROXIMO-DIA-FERIADO                         VALUE 'S'. 00029870
029880     05 DIVIDENDO-PROX-WS        PIC 9999           VALUE ZEROS.  00029880
029890     05 QUOCIENTE-PROX-WS        PIC 9999           VALUE ZEROS.  00029890
029900     05 RESTO-PROX-WS            PIC 9999           VALUE ZEROS.  00029900
029910     05 QUOCIENTE-AUX-WS  COMP-3 PIC S9(7)          VALUE ZEROS.  00029910
029920     05 RESTO-AUX-WS             PIC S9999          VALUE ZEROS.  00029920
044200     05 BISSEXTO                 PIC 9              VALUE ZEROS.  00044200
044300     05 QUOCIENTE-WS             PIC 99             VALUE ZEROS.  00044300
029930     05 MES-AUX-WS               PIC 99             VALUE ZEROS.  00029930
029940     05 ANO-AUX-WS               PIC 9999           VALUE ZEROS.  00029940
029950     05 ANO-AUX-Y2-WS            PIC 9999           VALUE ZEROS.  00029950
029960     05 PRAZO-WS                 PIC S999           VALUE ZEROS.  00029960
029970     05 EXCESSO-AUX-WS    COMP-3 PIC S9(13)V99      VALUE ZEROS.  00029970
029980     05 NUM-DIAS-MES-WS          PIC 99             VALUE ZEROS.  00029980
029990     05 RESTO-DIAS-MES-WS        PIC 99             VALUE ZEROS.  00029990
030030     05 VARIACAO-OTNF-WS         PIC 99V9(5)     COMP-3.          00030030
030040     05 PARAMETROS-WS.                                            00030040
030050        10 GR-CRED-PJUR-WS       PIC S9(13)V99   COMP-3.          00030050
030060        10 GR-DEB-PJUR-WS        PIC S9(13)V99   COMP-3.          00030060
030070        10 GR-DIF-SLD-PJUR-WS    PIC S9(13)V99   COMP-3.          00030070
030080        10 GR-CRED-PFIS-WS       PIC S9(13)V99   COMP-3.          00030080
030090        10 GR-DEB-PFIS-WS        PIC S9(13)V99   COMP-3.          00030090
030100        10 GR-DIF-SLD-PFIS-WS    PIC S9(13)V99   COMP-3.          00030100
030110                                                                  00030110
042900     05 DATA-TR-WS.                                               00042900
043000        10 DIA-TR-WS             PIC 99          VALUE ZEROS.     00043000
043100        10 FILLER                PIC X           VALUE '/'.       00043100
043200        10 MES-TR-WS             PIC 99          VALUE ZEROS.     00043200
043300        10 FILLER                PIC X           VALUE '/'.       00043300
043500        10 ANO-TR-WS             PIC 9999        VALUE ZEROS.     00043500
030110                                                                  00030110
030120     05 SALDO-MEDIO-APLIC-WS     PIC 9(13)V99     VALUE ZEROS.    00030120
030130     05 ANO-MES-APLIC-WS         PIC 9(06)        VALUE ZEROS.    00030130
030140     05 ANO-MES-APLIC-WS-RED REDEFINES ANO-MES-APLIC-WS.          00030140
030150        10 ANO-APLIC-WS          PIC 9(04).                       00030150
030160        10 MES-APLIC-WS          PIC 9(02).                       00030160
030170                                                                  00030170
030180      05 CPF-CGC-WS               PIC 9(15)        VALUE ZEROS.   00030180
030190      05 CPF-CGC-WS-RED REDEFINES CPF-CGC-WS.                     00030190
030200         10 NR-CGC-WS.                                            00030200
030210            15 NUM-CGC-WS         PIC 9(09).                      00030210
030220            15 FILIAL-WS          PIC 9(04).                      00030220
030230         10 NR-CPF-WS REDEFINES NR-CGC-WS.                        00030230
030240            15 NUM-CPF-WS         PIC 9(13).                      00030240
030250         10 CONTROLE-WS           PIC 9(02).                      00030250
030260                                                                  00030260
030180      05 CPF-CGC-AUX              PIC 9(15)        VALUE ZEROS.   00030180
030190      05 CPF-CGC-AUX-RED REDEFINES CPF-CGC-AUX.                   00030190
030210         10 NUM-CGC-AUX           PIC 9(09).                      00030210
030220         10 FILIAL-AUX            PIC 9(04).                      00030220
030250         10 CONTROLE-AUX          PIC 9(02).                      00030250
030260                                                                  00030260
030270     05 TAXAS-D01-WS.                                             00030270
030280        10 TX-JUROS-INSUF-D01-WS PIC 9(16)V99    COMP-3 VALUE 0.  00030280
030310        10 TX-IOC-JURID-D01-WS   PIC 9(14)V9999  COMP-3 VALUE 0.  00030310
030320        10 TX-IOC-FISICA-D01-WS  PIC 9(14)V9999  COMP-3 VALUE 0.  00030320
030330        10 MVR-D01-WS            PIC 9(16)V99    COMP-3 VALUE 0.  00030330
030340        10 OTN-D01-WS            PIC 9(16)V99    COMP-3 VALUE 0.  00030340
030350     05 BTN-D01-WS               PIC 9(10)V9(8)  COMP-3 VALUE 0.  00030350
030360                                                                  00030360
030410     05 VALOR-TAXAS-WS.                                           00030410
030420        10 TX-JUROS-WS           PIC 9(3)V99     COMP-3.          00030420
030450        10 TX-IOF-JURID-WS       PIC 9V9999      COMP-3.          00030450
030460        10 TX-IOF-FISICA-WS      PIC 9V9999      COMP-3.          00030460
030470        10 TX-PERMAN-WS          PIC 9(3)V99     COMP-3.          00030470
030480        10 MVR-WS                PIC S9(9)V99    COMP-3.          00030480
030490        10 VR-ORTN-ANT-WS        PIC 9(9)V99     COMP-3.          00030490
030500        10 VR-ORTN-ATL-WS        PIC 9(9)V99     COMP-3.          00030500
030510        10 VRMIN-WS              PIC S999V99     COMP-3.          00030510
030520     05 TX-ENCARGOS-CONTERRANEO-WS                                00030520
030530                                 PIC 99V9(5) VALUE ZEROS COMP-3.  00030530
030540     05 TX-ENCARGOS-FERIADO-WS                                    00030540
030550                                PIC 9(11)V9(5) VALUE ZEROS COMP-3.00030550
030560     05  POS-RELATIVA-WS         PIC S9(05)  VALUE +0.            00030560
030570     05  POS-RELATIVA-WS-RED REDEFINES POS-RELATIVA-WS.           00030570
030580         10  POS-RELATIVA1-WS    PIC 9(04).                       00030580
030590         10  POS-RELATIVA2-WS    PIC 9(01).                       00030590
030600     05 CHAVE-MENOR.                                              00030600
030610        10 COD-AG-CH-MENOR       PIC 9(5)        COMP-3.          00030610
030620        10 CONTA-CH-MENOR        PIC 9(9)        COMP-3.          00030620
030630        10 TPREG-CH-MENOR        PIC 9.                           00030630
030640                                                                  00030640
030650     05 CHAVE-F10-WS.                                             00030650
030660        10 COD-AG-CH-F10         PIC 9(5)        COMP-3.          00030660
030690        10 CONTA-CH-F10          PIC 9(9)        COMP-3.          00030690
030700        10 TPREG-CH-F10          PIC 9.                           00030700
030710                                                                  00030710
030720                                                                  00030720
030730     05 CHAVE-D07-WS.                                             00030730
030740        10 COD-AG-CH-D07         PIC 9(5)        COMP-3.          00030740
030770        10 CONTA-CH-D07          PIC 9(9)        COMP-3.          00030770
030780        10 TPREG-CH-D07          PIC 9.                           00030780
030790                                                                  00030790
030800                                                                  00030800
030810     05  COD-AG-ANT-F10-WS       PIC 9(05) COMP-3 VALUE 0.        00030810
030820     05  COD-AG-ANT-D07-WS       PIC 9(05) COMP-3 VALUE 0.        00030820
030830     05  SEQ-D04-WS              PIC 9999     VALUE 0.            00030830
030840     05  SEQ-ANT-D04-WS          PIC 9999     VALUE 0.            00030840
030850     05  SEQ-POS-REL-WS          PIC S9(05)   VALUE +0.           00030850
030860     05  SALDO-DEP-WS            PIC S9(13)V99 VALUE +0.          00030860
030870                                                                  00030870
030880     05 DATA-D07-WS.                                              00030880
030890        10 DIA-D07-WS            PIC 99.                          00030890
030900        10 MES-D07-WS            PIC 99.                          00030900
030910        10 ANO-D07-WS            PIC 99.                          00030910
030920     05 DATA-D07-RED-WS REDEFINES DATA-D07-WS                     00030920
030930                                 PIC 9(6).                        00030930
030940                                                                  00030940
030950     05 ANO-D07-AUX-WS           PIC 9999       VALUE ZEROS.      00030950
030960*.............................................................    00030960
030970*..DATA  USADA  NA IDENTIFICACAO DO CANCELAMENTO ANTECIPADO DO    00030970
030980*..CHEQUE ESPECIAL, CHEQUE EMPRESA, CONTA EMPRESARIAL             00030980
030990*.............................................................    00030990
031000     05 DATA-D07-INV.                                             00031000
031010        10 ANO-D07-INV           PIC 9999.                        00031010
031020        10 MES-D07-INV           PIC 99.                          00031020
031030        10 DIA-D07-INV           PIC 99.                          00031030
031040     05 DATA-D07-RED-INV REDEFINES DATA-D07-INV                   00031040
031050                                 PIC 9(8).                        00031050
031060*.............................................................    00031060
031070                                                                  00031070
031080     05 DATA-F10-WS.                                              00031080
031090        10 DIA-F10-WS            PIC 99.                          00031090
031100        10 MES-F10-WS            PIC 99.                          00031100
031110        10 ANO-F10-WS            PIC 99.                          00031110
031120     05 DATA-F10-RED-WS REDEFINES DATA-F10-WS                     00031120
031130                                 PIC 9(6).                        00031130
031140                                                                  00031140
031210     05 DATA-AUX.                                                 00031210
031220        10 DIA-AUX               PIC 99.                          00031220
031230        10 MES-AUX               PIC 99.                          00031230
031240        10 ANO-AUX               PIC 99.                          00031240
031250     05 DATA-AUX-RED REDEFINES DATA-AUX                           00031250
031260                                 PIC 9(6).                        00031260
031270     05 DATA-AUX-Y2.                                              00031270
031280        10 DIA-AUX-Y2            PIC 99.                          00031280
031290        10 MES-AUX-Y2            PIC 99.                          00031290
031300        10 ANO-AUX-Y2            PIC 99.                          00031300
031310     05 DATA-AUX-Y2-RED REDEFINES DATA-AUX-Y2                     00031310
031320                                 PIC 9(6).                        00031320
031330     05 DATA-AUX-Y2-INV.                                          00031330
031340        10 ANO-AUX-Y2-INV        PIC 9999.                        00031340
031350        10 MES-AUX-Y2-INV        PIC 99.                          00031350
031360        10 DIA-AUX-Y2-INV        PIC 99.                          00031360
031370     05 DATA-AUX-Y2-INV-RED REDEFINES DATA-AUX-Y2-INV             00031370
031380                                 PIC 9(8).                        00031380
031390     05 DATA-MOVIM.                                               00031390
031400        10 DIA-MOVIM             PIC 99.                          00031400
031410        10 MES-MOVIM             PIC 99.                          00031410
031420        10 ANO-MOVIM             PIC 99.                          00031420
031430     05 DATA-MOVIM-RED REDEFINES DATA-MOVIM                       00031430
031440                                 PIC 9(6).                        00031440
                                                                        00031450
           05 DATA-MOVIM-07B           PIC 9(06) VALUE ZEROS.
           05 DATA-MOVIM-07B-RED REDEFINES DATA-MOVIM-07B.
              10 DIA-MOVIM-07B         PIC 9(02).
              10 MES-MOVIM-07B         PIC 9(02).
              10 ANO-MOVIM-07B         PIC 9(02).

031460     05 DATA-INVERTIDA.                                           00031460
031470        10 ANO-INV               PIC 9999.                        00031470
031480        10 MES-INV               PIC 99.                          00031480
031490        10 DIA-INV               PIC 99.                          00031490
031500     05 DATA-INVERTIDA-RED REDEFINES DATA-INVERTIDA               00031500
031510                                 PIC 9(8).                        00031510
031520     05 DATA-EXT-WS.                                              00031520
031530        10 ANO-EXT-WS            PIC 9999.                        00031530
031540        10 MES-EXT-WS            PIC 99.                          00031540
031550        10 DIA-EXT-WS            PIC 99.                          00031550
031560     05 DATA-EXT-RED-WS REDEFINES DATA-EXT-WS                     00031560
031570                                 PIC 9(8).                        00031570
031580                                                                  00031580
031590     05 DATA-CORRENTE-WS.                                         00031590
031600        10 ANO-CORRENTE-WS       PIC 99.                          00031600
031610        10 MES-CORRENTE-WS       PIC 99.                          00031610
031620        10 DIA-CORRENTE-WS       PIC 99.                          00031620
031630                                                                  00031630
031640     05 DATA-HOJE-WS.                                             00031640
031650        10 DIA-HOJE-WS           PIC 99.                          00031650
031660        10 MES-HOJE-WS           PIC 99.                          00031660
031670        10 ANO-HOJE-WS           PIC 99.                          00031670
031680                                                                  00031680
031690     05 DATA-ANT-MST-WS  COMP-3  PIC 9(6)        VALUE ZEROS.     00031690
031700                                                                  00031700
031750     05 NUM-ANOS-BISSEXTOS       PIC S9(5) COMP-3 VALUE ZEROS.    00031750
031760     05 ANO-WS1                  PIC 9(4)         VALUE ZEROS.    00031760
031770     05 ANO-WS1-RED REDEFINES ANO-WS1.                            00031770
031780        10 SS-WS1                PIC 99.                          00031780
031790        10 AA-WS1                PIC 99.                          00031790
031800                                                                  00031800
031810     05 DATA-WS.                                                  00031810
031820        10 DIA-WS                PIC 99.                          00031820
031830        10 MES-WS                PIC 99.                          00031830
031840        10 ANO-WS                PIC 99.                          00031840
031850     05 DATA-RED-WS REDEFINES DATA-WS                             00031850
031860                                 PIC 9(6).                        00031860
031870                                                                  00031870
031880     05 DIAS-CORRIDOS.                                            00031880
031890        10 DIAS-DATA-MENOR       PIC S9(10) COMP-3 VALUE ZEROS.   00031890
031900        10 DIAS-DATA-MAIOR       PIC S9(10) COMP-3 VALUE ZEROS.   00031900
031910        10 DIAS-TRANSF-WS        PIC S9(10) COMP-3 VALUE ZEROS.   00031910
031920                                                                  00031920
031930     05 DATA-MENOR.                                               00031930
031940        10 DIA-MENOR             PIC 99.                          00031940
031950        10 MES-MENOR             PIC 99.                          00031950
031960        10 ANO-MENOR             PIC 99.                          00031960
031970     05 DATA-MENOR-RED REDEFINES DATA-MENOR                       00031970
031980                                 PIC 9(6).                        00031980
031990     05 ANO-MENOR-Y2             PIC 9999.                        00031990
032000                                                                  00032000
032010     05 DATA-MAIOR.                                               00032010
032020        10 DIA-MAIOR             PIC 99.                          00032020
032030        10 MES-MAIOR             PIC 99.                          00032030
032040        10 ANO-MAIOR             PIC 99.                          00032040
032050     05 DATA-MAIOR-RED REDEFINES DATA-MAIOR                       00032050
032060                                 PIC 9(6).                        00032060
032070     05 ANO-MAIOR-Y2             PIC 9999.                        00032070
032080     05  DATA-MOV-WS             PIC 9(06)      VALUE 0.          00032080
032090     05  DATA-MOV-WS-RED REDEFINES DATA-MOV-WS.                   00032090
032100         10  DIA-MOV-WS          PIC 9(02).                       00032100
032110         10  MES-MOV-WS          PIC 9(02).                       00032110
032120         10  ANO-MOV-WS          PIC 9(02).                       00032120
           05 DATA-MOV-6-WS           PIC 9(06)     VALUE 0.            00032080
           05 DATA-MOV-6-WS-R  REDEFINES DATA-MOV-6-WS.                 00032090
              10  ANO-MOV-6-WS        PIC 9(02).                        00032120
              10  MES-MOV-6-WS        PIC 9(02).                        00032120
              10  DIA-MOV-6-WS        PIC 9(02).                        00032120
           05 DATA-MOV-INV-WS         PIC 9(08)     VALUE 0.            00032080
           05 DATA-MOV-INV-WS-RED REDEFINES DATA-MOV-INV-WS.            00032090
              10 ANOMES-MOV-INV-WS.
                 15  ANO-MOV-INV-WS   PIC 9(04).                        00032120
                 15  MES-MOV-INV-WS   PIC 9(02).                        00032100
              10  DIA-MOV-INV-WS      PIC 9(02).                        00032110
           05 DATA-ADIANT-RED-6-WS    PIC 9(06)      VALUE 0.
           05 DATA-ADIANT-RED-6-WS-R  REDEFINES DATA-ADIANT-RED-6-WS.   00032090
              10  DIA-ADIANT-RED-6-WS PIC 9(02).                        00032120
              10  MES-ADIANT-RED-6-WS PIC 9(02).                        00032100
              10  ANO-ADIANT-RED-6-WS PIC 9(02).                        00032110
           05 DATA-ADIANT-RED-INV-WS  PIC 9(08)      VALUE 0.
           05 DATA-ADIANT-RED-INV-WS-R REDEFINES DATA-ADIANT-RED-INV-WS.00032090
              10  ANOMES-ADIANT-RED-INV-WS.
                  15  ANO-ADIANT-RED-INV-WS PIC 9(04).                  00032110
                  15  MES-ADIANT-RED-INV-WS PIC 9(02).                  00032100
              10  DIA-ADIANT-RED-INV-WS PIC 9(02).                      00032120
           05 EMP-VENC-RED-6-WS         PIC 9(06)     VALUE 0.          00032080
           05 EMP-VENC-RED-6-WS-R REDEFINES EMP-VENC-RED-6-WS.          00032090
              10 DIA-EMP-VENC-RED-6-WS  PIC 9(02).
              10 MES-EMP-VENC-RED-6-WS  PIC 9(02).
              10 ANO-EMP-VENC-RED-6-WS  PIC 9(02).
           05 EMP-VENC-RED-INV-WS       PIC 9(08)      VALUE 0.
           05 EMP-VENC-RED-INV-WS-R     REDEFINES EMP-VENC-RED-INV-WS.  00032090
              10  ANOMES-EMP-VENC-RED-INV-WS.
                  15  ANO-EMP-VENC-RED-INV-WS PIC 9(04).                00032110
                  15  MES-EMP-VENC-RED-INV-WS PIC 9(02).                00032100
              10  DIA-EMP-VENC-RED-INV-WS     PIC 9(02).                00032120

           05  DATA-VENC-EMP-WS         PIC 9(08)      VALUE 0.
           05  DATA-VENC-EMP-WS-R       REDEFINES DATA-VENC-EMP-WS.
               10 DIA-VENC-EMP-WS       PIC 9(02).
               10 MES-VENC-EMP-WS       PIC 9(02).
               10 ANO-VENC-EMP-WS       PIC 9(04).

           05  DATA-VENC-EMP-INV-WS     PIC 9(08)      VALUE 0.
           05  DATA-VENC-EMP-WS-R       REDEFINES DATA-VENC-EMP-INV-WS.
               10 ANO-VENC-EMP-INV-WS   PIC 9(04).
               10 MES-VENC-EMP-INV-WS   PIC 9(02).
               10 DIA-VENC-EMP-INV-WS   PIC 9(02).

           05  DATA-VENC-EMP-INV-31-WS  PIC 9(08)      VALUE 0.
           05  DATA-VENC-EMP-WS-R  REDEFINES DATA-VENC-EMP-INV-31-WS.
               10 ANO-VENC-EMP-INV-31-WS   PIC 9(04).
               10 MES-VENC-EMP-INV-31-WS   PIC 9(02).
               10 DIA-VENC-EMP-INV-31-WS   PIC 9(02).

           05  EMP-VENC-D07-WS          PIC 9(06)      VALUE 0.
           05  EMP-VENC-D07-WS-R        REDEFINES EMP-VENC-D07-WS.
               10 DIA-VENC-D07-WS       PIC 9(02).
               10 MES-VENC-D07-WS       PIC 9(02).
               10 ANO-VENC-D07-WS       PIC 9(02).

           05  EMP-VENC-D07-8-WS        PIC 9(08)      VALUE 0.
           05  EMP-VENC-D07-WS-R        REDEFINES EMP-VENC-D07-8-WS.
               10 DIA-VENC-D07-8-WS     PIC 9(02).
               10 MES-VENC-D07-8-WS     PIC 9(02).
               10 ANO-VENC-D07-8-WS     PIC 9(04).

           05  EMP-VENC-D07-8-INV-WS    PIC 9(08)      VALUE 0.
           05  EMP-VENC-D07-WS-R        REDEFINES EMP-VENC-D07-8-INV-WS.
               10 ANO-VENC-D07-8-INV-WS     PIC 9(04).
               10 MES-VENC-D07-8-INV-WS     PIC 9(02).
               10 DIA-VENC-D07-8-INV-WS     PIC 9(02).

032130     05  DATA-FUNDO-WS           PIC 9(08)      VALUE 0.          00032130
032140     05  DATA-FUNDO-WS-RED REDEFINES DATA-FUNDO-WS.               00032140
032150         10  ANO-FUNDO-WS        PIC 9(04).                       00032150
032160         10  MES-FUNDO-WS        PIC 9(02).                       00032160
032170         10  DIA-FUNDO-WS        PIC 9(02).                       00032170
032180     05  DATA-EVT-WS             PIC 9(06)      VALUE 0.          00032180
032190     05  DATA-EVT-WS-RED REDEFINES DATA-EVT-WS.                   00032190
032200         10  DIA-EVT-WS          PIC 99.                          00032200
032210         10  MES-EVT-WS          PIC 99.                          00032210
032220         10  ANO-EVT-WS          PIC 99.                          00032220
032230     05  DATA-REC-WS             PIC 9(06)      VALUE 0.          00032230
032240     05  DATA-REC-WS-RED REDEFINES DATA-REC-WS.                   00032240
032250         10  ANO-REC-WS          PIC 99.                          00032250
032260         10  MES-REC-WS          PIC 99.                          00032260
032270         10  DIA-REC-WS          PIC 99.                          00032270
032280     05  DATA-REC-Y2-WS          PIC 9(08)      VALUE 0.          00032280
032290     05  DATA-REC-Y2-WS-RED REDEFINES DATA-REC-Y2-WS.             00032290
032300         10  ANO-REC-Y2-WS       PIC 9999.                        00032300
032310         10  MES-REC-Y2-WS       PIC 99.                          00032310
032320         10  DIA-REC-Y2-WS       PIC 99.                          00032320
032330     05  DATA-TELEX-WS           PIC 9(06)      VALUE 0.          00032330
032340     05  DATA-TELEX-WS-RED REDEFINES DATA-TELEX-WS.               00032340
032350         10  DIA-TELEX-WS        PIC 9(02).                       00032350
032360         10  MES-TELEX-WS        PIC 9(02).                       00032360
032370         10  ANO-TELEX-WS        PIC 9(02).                       00032370
032380     05  DATA-TELEX-INV-WS       PIC 9(06)      VALUE 0.          00032380
032390     05  DATA-TELEX-INV-RED REDEFINES DATA-TELEX-INV-WS.          00032390
032400         10  ANO-TELEX-INV-WS    PIC 99.                          00032400
032410         10  MES-TELEX-INV-WS    PIC 99.                          00032410
032420         10  DIA-TELEX-INV-WS    PIC 99.                          00032420
032430                                                                  00032430
           05 DTU-VEN-LIM-WS           PIC 9(06) VALUE ZEROS.
           05 DTU-VEN-LIM-WS-R         REDEFINES DTU-VEN-LIM-WS.
              10 DIAU-VEN-LIM-WS       PIC 9(02).
              10 MESU-VEN-LIM-WS       PIC 9(02).
              10 ANOU-VEN-LIM-WS       PIC 9(02).

           05 DTU-IVEN-CTR-WS          PIC 9(06) VALUE ZEROS.
           05 DTU-IVEN-CTR-WS-R        REDEFINES DTU-IVEN-CTR-WS.
              10 ANOU-IVEN-LIM-WS      PIC 9(02).
              10 MESU-IVEN-LIM-WS      PIC 9(02).
              10 DIAU-IVEN-LIM-WS      PIC 9(02).
032480                                                                  00032480
032490     05 DATA-CONTRATO-WS.                                         00032490
032500        10 DIA-CONTR-WS          PIC 99.                          00032500
032510        10 MES-CONTR-WS          PIC 99.                          00032510
032520        10 ANO-CONTR-WS          PIC 99.                          00032520
032530     05 DATA-CONTRATO-RED-WS REDEFINES DATA-CONTRATO-WS           00032530
032540                                 PIC 9(6).                        00032540
032550                                                                  00032550
032560     05 DATA-CONTRATO-INV.                                        00032560
032570        10 ANO-CONTR-INV         PIC 99.                          00032570
032580        10 MES-CONTR-INV         PIC 99.                          00032580
032590        10 DIA-CONTR-INV         PIC 99.                          00032590
032600     05 DATA-CONTRATO-INV-RED REDEFINES DATA-CONTRATO-INV         00032600
032610                                 PIC 9(6).                        00032610
032620                                                                  00032620
032630     05 DATA-MOV-LISTAO-WS       PIC 9(6)            VALUE ZEROS. 00032630
032640     05 DATA-MOV-LISTAO-RED-WS REDEFINES DATA-MOV-LISTAO-WS.      00032640
032650        10 DIA-MOV-LISTAO-WS     PIC 99.                          00032650
032660        10 MES-MOV-LISTAO-WS     PIC 99.                          00032660
032670        10 ANO-MOV-LISTAO-WS     PIC 99.                          00032670
032680                                                                  00032680
032690     05  DATA-LISTAO1-WS.                                         00032690
032700         10  DIA-MES-LISTAO1-WS PIC 99V99             VALUE ZEROS.00032700
032710         10  ANO-LISTAO1-WS     PIC 9999              VALUE ZEROS.00032710
032750                                                                  00032750
032760     05 DATA-LISTAO-WS           PIC 9(8)             VALUE ZEROS.00032760
032770     05 DATA-LISTAO-RED REDEFINES DATA-LISTAO-WS.                 00032770
032780        10 DIA-LISTAO-WS         PIC 99.                          00032780
032790        10 MES-LISTAO-WS         PIC 99.                          00032790
032800        10 ANO-LISTAO-WS         PIC 9999.                        00032800
032810                                                                  00032810
032820     05 DATA-PROX-WS             PIC 9(8)            VALUE ZEROS. 00032820
032830     05 DATA-MOV-PROX-RED-WS REDEFINES DATA-PROX-WS.              00032830
032840        10 DIA-PROX-WS           PIC 99.                          00032840
032850        10 MES-PROX-WS           PIC 99.                          00032850
032860        10 ANO-PROX-WS           PIC 9999.                        00032860
032870                                                                  00032870
032880     05 PARAMETROS-ACDAYS-WS.                                     00032880
032890         10 DATA-ULT-MOV-WS      PIC 9(6)        VALUE ZEROS.     00032890
032900         10 FILLER REDEFINES DATA-ULT-MOV-WS.                     00032900
032910            15 DIA-ULT-MOV-WS    PIC 99.                          00032910
032920            15 MES-ULT-MOV-WS    PIC 99.                          00032920
032930            15 ANO-ULT-MOV-WS    PIC 99.                          00032930
032940         10 DATA-RODADA-WS       PIC 9(6)        VALUE ZEROS.     00032940
032950         10 FILER REDEFINES DATA-RODADA-WS.                       00032950
032960            15 DIA-RODADA-WS     PIC 99.                          00032960
032970            15 MES-RODADA-WS     PIC 99.                          00032970
032980            15 ANO-RODADA-WS     PIC 99.                          00032980
032990         10 NUM-DIAS-WS          PIC S9(07) COMP-3 VALUE ZEROS.   00032990
033000                                                                  00033000
033010     05 DATA-VENCIM-WS.                                           00033010
033020        10 DIA-VENCIM-WS         PIC 99            VALUE ZEROS.   00033020
033030        10 MES-VENCIM-WS         PIC 99            VALUE ZEROS.   00033030
033040        10 ANO-VENCIM-WS         PIC 99            VALUE ZEROS.   00033040
033050     05 DATA-VENCIM-RED-WS REDEFINES DATA-VENCIM-WS               00033050
033060                                 PIC 9(6).                        00033060
033070                                                                  00033070
033080     05 DATA-VENCIM-INV.                                          00033080
033090        10 ANO-VENCIM-INV        PIC 9999          VALUE ZEROS.   00033090
033100        10 MES-VENCIM-INV        PIC 99            VALUE ZEROS.   00033100
033110        10 DIA-VENCIM-INV        PIC 99            VALUE ZEROS.   00033110
033120     05 DATA-VENCIM-INV-RED-WS REDEFINES DATA-VENCIM-INV          00033120
033130                                 PIC 9(8).                        00033130
033140                                                                  00033140
           05 DATA-RODADA-PROC-WS.                                      00033142
              10 DIA-RODADA-PROC-WS      PIC 99            VALUE ZEROS. 00033143
              10 MES-RODADA-PROC-WS      PIC 99            VALUE ZEROS. 00033144
              10 ANO-RODADA-PROC-WS      PIC 9999          VALUE ZEROS. 00033145
              10 ANO-RODADA-PROC-WS-RED REDEFINES ANO-RODADA-PROC-WS.   00033146
                 15 SS-RODADA-PROC-WS    PIC 99.                        00033147
                 15 AA-RODADA-PROC-WS    PIC 99.                        00033148
           05 DATA-RODADA-PROC-RED-WS REDEFINES DATA-RODADA-PROC-WS
                                      PIC 9(8).
           05 DATA-PROX-PROC-WS.                                        00033150
              10 DIA-PROX-PROC-WS      PIC 99            VALUE ZEROS.   00033151
              10 MES-PROX-PROC-WS      PIC 99            VALUE ZEROS.   00033152
              10 ANO-PROX-PROC-WS      PIC 9999          VALUE ZEROS.   00033153
              10 ANO-PROX-PROC-WS-RED REDEFINES ANO-PROX-PROC-WS.       00033154
                 15 SS-PROX-PROC-WS    PIC 99.                          00033155
                 15 AA-PROX-PROC-WS    PIC 99.                          00033156
           05 DATA-PROX-PROC-RED-WS REDEFINES DATA-PROX-PROC-WS         00033157
                                      PIC 9(8).
                                                                        00033159
033150     05 DATA-PROX-VENC-WS.                                        00033181
033160        10 DIA-PROX-VENC-WS      PIC 99            VALUE ZEROS.   00033182
033170        10 MES-PROX-VENC-WS      PIC 99            VALUE ZEROS.   00033183
033180        10 ANO-PROX-VENC-WS      PIC 9999          VALUE ZEROS.   00033184
033190        10 ANO-PROX-VENC-WS-RED REDEFINES ANO-PROX-VENC-WS.       00033190
033200           15 SS-PROX-VENC-WS    PIC 99.                          00033200
033210           15 AA-PROX-VENC-WS    PIC 99.                          00033210
033220     05 DATA-PROX-VENC-RED-WS REDEFINES DATA-PROX-VENC-WS         00033220
033230                                 PIC 9(8).                        00033230
033240                                                                  00033240
033250     05 DATA-ATL-ANTERIOR-AG-WS.                                  00033250
033260        10 DIA-ATL-ANT-AG-WS     PIC 99             VALUE ZEROS.  00033260
033270        10 MES-ATL-ANT-AG-WS     PIC 99             VALUE ZEROS.  00033270
033280        10 ANO-ATL-ANT-AG-WS     PIC 99             VALUE ZEROS.  00033280
033290     05 DATA-ATL-ANTERIOR-AG-RED-WS REDEFINES                     00033290
033300        DATA-ATL-ANTERIOR-AG-WS  PIC 9(6).                        00033300
033310                                                                  00033310
033320     05 DATA-ATL-ANT-AG-WS.                                       00033320
033330        10 DD-ATL-ANT-AG-WS     PIC 99             VALUE ZEROS.   00033330
033340        10 MM-ATL-ANT-AG-WS     PIC 99             VALUE ZEROS.   00033340
033350        10 SS-AA-ATL-ANT-AG-WS.                                   00033350
033360           15 SS-ATL-ANT-AG-WS  PIC 99             VALUE ZEROS.   00033360
033370           15 AA-ATL-ANT-AG-WS  PIC 99             VALUE ZEROS.   00033370
033380     05 DATA-ATL-ANT-AG-RED-WS REDEFINES                          00033380
033390        DATA-ATL-ANT-AG-WS      PIC 9(8).                         00033390
033400                                                                  00033400
033410     05 DTA-PRIMEIRO-FERIADO-WS  PIC 9(6)           VALUE ZEROS.  00033410
033420                                                                  00033420
           05 DT-INICIO-ISENCAO-IOF    PIC 9(08) VALUE ZEROS.
           05 DT-INIC-ISENCAO-IOF-R    REDEFINES DT-INICIO-ISENCAO-IOF.
              10 ANO-INIC-ISENTA-IOF   PIC 9(04).
              10 MES-INIC-ISENTA-IOF   PIC 9(02).
              10 DIA-INIC-ISENTA-IOF   PIC 9(02).

           05 DT-FIM-ISENCAO-IOF       PIC 9(08) VALUE ZEROS.
           05 DT-FIM-ISENCAO-IOF-R     REDEFINES DT-FIM-ISENCAO-IOF.
              10 ANO-FIM-ISENTA-IOF    PIC 9(04).
              10 MES-FIM-ISENTA-IOF    PIC 9(02).
              10 DIA-FIM-ISENTA-IOF    PIC 9(02).

           05 DT-OPERACAO-IOF          PIC 9(08)  VALUE ZEROS.
           05 DT-OPERACAO-IOF-RD REDEFINES DT-OPERACAO-IOF.
              10 ANO-OPER-IOF          PIC 9(04).
              10 MES-OPER-IOF          PIC 9(02).
              10 DIA-OPER-IOF          PIC 9(02).

           05 DT-MOV-ATUAL-IOF         PIC 9(08)  VALUE ZEROS.
           05 DT-MOV-ATU-IOF-RD REDEFINES DT-MOV-ATUAL-IOF.
              10 ANO-MOVATU-IOF        PIC 9(04).
              10 MES-MOVATU-IOF        PIC 9(02).
              10 ANO-MOVATU-IOF        PIC 9(02).

           05 DT-ULT-MOV-IOF           PIC 9(08)  VALUE ZEROS.
           05 DT-ULT-MOV-IOF-RD REDEFINES DT-ULT-MOV-IOF.
              10 ANO-ULTMOV-IOF        PIC 9(04).
              10 MES-ULTMOV-IOF        PIC 9(02).
              10 DIA-ULTMOV-IOF        PIC 9(02).

033430     05 CLASSE-TAB-WS            PIC 9           VALUE ZEROS.     00033430
033440        88 PRIMEIRA-CLASSE                       VALUE 1.         00033440
033450        88 SEGUNDA-CLASSE                        VALUE 2.         00033450
033460        88 TERCEIRA-CLASSE                       VALUE 3.         00033460
033470        88 QUARTA-CLASSE                         VALUE 4.         00033470
033480        88 QUINTA-CLASSE                         VALUE 5.         00033480
033490        88 SEXTA-CLASSE                          VALUE 6.         00033490
033500        88 CLASSE-ESPECIAL                       VALUE 7.         00033500
033510        88 DIRECAO-GERAL                         VALUE 9.         00033510
033520                                                                  00033520
033530     05 RG-WS                     PIC X(15).                      00033530
033540     05 TB-NUM-RG REDEFINES RG-WS PIC X(01) OCCURS 15 TIMES.      00033540
033550     05 TAB-DE-AGENCIAS.                                          00033550
ZTABAG        10 TAB-AGN-CLASSE OCCURS 998 TIMES.                       00033560
033570           15 AGENCIA-TAB        PIC 99999.                       00033570
033580           15 CLASSE-TAB         PIC 9.                           00033580
033590*    .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-                       00033590
033600 01  INDEXADORES.                                                 00033600
033610*    .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-                       00033610
033620     05 IND1                     PIC 99          VALUE ZEROS.     00033620
033630     05 IND-DIA                  PIC 99          VALUE ZEROS.     00033630
033640     05 IND-MENS-FICHA           PIC 99          VALUE ZEROS.     00033640
033640     05 IND-DBLO                 PIC 99          VALUE ZEROS.     00033640
033650     05 IND-FICHA-RECOLHER       PIC 99          VALUE ZEROS.     00033650
033650     05 IND-EXT-MOV              PIC 99          VALUE ZEROS.     00033650
033660*    05 IND-ATL-TRAILLER         PIC 99          VALUE ZEROS.     00033660
033670*    05 IND-RAZAO                PIC 99          VALUE ZEROS.     00033670
033680*    05 IND-ACUM-TRAILLER        PIC 99          VALUE ZEROS.     00033680
250412     05 IND-ATL-TRAILLER         PIC 999         VALUE ZEROS.
250412     05 IND-RAZAO                PIC 999         VALUE ZEROS.
250412     05 IND-ACUM-TRAILLER        PIC 999         VALUE ZEROS.
033690     05 IND-PROTOCOLO            PIC 99          VALUE ZEROS.     00033690
BOSSA      05 IND-COMPULSO             PIC 999         VALUE ZEROS.     00033700
033710     05 IND-MOV                  PIC 99999       VALUE ZEROS.     00033710
033720     05 IND-MOV-WS               PIC 99999       VALUE ZEROS.     00033720
033730     05 IND-TAB                  PIC 99          VALUE ZEROS.     00033730
033740     05 IND-NUM                  PIC 99          VALUE ZEROS.     00033740
033750     05 IND-ACUM-OCR             PIC 99          VALUE ZEROS.     00033750
033760     05 IND-BLOQUEIO-1           PIC 99          VALUE ZEROS.     00033760
033770     05 IND-BLOQUEIO-2           PIC 99          VALUE ZEROS.     00033770
033780     05 IND-TAB-D04              PIC 999         VALUE 0.         00033780
033790     05 IND-GRAVA-D04            PIC 999         VALUE 0.         00033790
033800     05 IND-TAB-AGN              PIC 999         VALUE ZEROS.     00033800
033810     05 IND-MOVTOS               PIC 99999       VALUE ZEROS.     00033810
033820     05 IND-AUX                  PIC 99999       VALUE ZEROS.     00033820
033830     05 IND-COD-TAXA             PIC 9           VALUE ZEROS.     00033830
033840     05 IND-SEMESTR              PIC 9           VALUE ZEROS.     00033840
033860*    ......................................                       00033860

033880*    .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-                       00033880
033900 01  TABELA-ERRO-WS.                                              00033900
033910     05  FILLER          PIC X(20) VALUE '0002ERRO FILE-STATUS'.  00033910
033920     05  FILLER          PIC X(20) VALUE '0004ERRO PARAMETRO  '.  00033920
033930     05  FILLER          PIC X(20) VALUE '0008ERRO PROC. ARQS.'.  00033930
033940     05  FILLER          PIC X(20) VALUE '0012ERRO PROCESSAMEN'.  00033940
033950     05  FILLER          PIC X(20) VALUE '0016ERRO SORT       '.  00033950
033960     05  FILLER          PIC X(20) VALUE '0018ERRO SEGMENT    '.  00033960
033970 01  TABELA-ERRO-RED-WS REDEFINES TABELA-ERRO-WS.                 00033970
033980     05  CAMPOS-RETORNO-WS OCCURS 6 TIMES.                        00033980
033990         10  COD-RETORNO-WS PIC 9(04).                            00033990
034000         10  MEN-RETORNO-WS PIC X(16).                            00034000
034010                                                                  00034010
034020**-------------------   COMENTARIOS    ------------------------** 00034020
034030**  O CODIGO DE RETORNO 0008 EH PARA O PROCESSAMENTO DE INVALID** 00034030
034040**  KEY DOS ANTIGOS ARQUIVOS SAM EXISTENTES NO CONTA CORRENTE  ** 00034040
034050**-------------------------------------------------------------** 00034050
034060 01  TABELAS.                                                     00034060
034190                                                                  00034190
034200     05 TABELA-MENS-FICHA.                                        00034200
034210        10 FILLER                PIC X(11)       VALUE            00034210
034220            'SLD DEV BLO'.                                        00034220
034230        10 FILLER                PIC X(11)       VALUE            00034230
034240            'SLD DEVEDOR'.                                        00034240
034250        10 FILLER                PIC X(11)       VALUE            00034250
034260            'EXCESSO    '.                                        00034260
034270        10 FILLER                PIC X(11)       VALUE            00034270
034280            'VENCIDA    '.                                        00034280
034290        10 FILLER                PIC X(11)       VALUE            00034290
034300            'EXCES/VENC '.                                        00034300
034310        10 FILLER                PIC X(11)       VALUE            00034310
034320            'SEM MOVIM  '.                                        00034320
034330        10 FILLER                PIC X(11)       VALUE            00034330
034340            'EXCES REGUL'.                                        00034340
034350        10 FILLER                PIC X(11)       VALUE            00034350
034360            'INSUF REGUL'.                                        00034360
034370        10 FILLER                PIC X(11)       VALUE            00034370
034380            'IMPLANTACAO'.                                        00034380
034390                                                                  00034390
034400     05 TABELA-MENS-FICHA-RED REDEFINES TABELA-MENS-FICHA.        00034400
034410        10 MENS-FICHA-TAB OCCURS 9 TIMES                          00034410
034420                                 PIC X(11).                       00034420
034580*    ......................................                       00034580
034770                                                                  00034770
034780     05 TABELA-DIAS-MES.                                          00034780
034790        10 FILLER                PIC 99          VALUE 31.        00034790
034800        10 FILLER                PIC 99          VALUE 28.        00034800
034810        10 FILLER                PIC 99          VALUE 31.        00034810
034820        10 FILLER                PIC 99          VALUE 30.        00034820
034830        10 FILLER                PIC 99          VALUE 31.        00034830
034840        10 FILLER                PIC 99          VALUE 30.        00034840
034850        10 FILLER                PIC 99          VALUE 31.        00034850
034860        10 FILLER                PIC 99          VALUE 31.        00034860
034870        10 FILLER                PIC 99          VALUE 30.        00034870
034880        10 FILLER                PIC 99          VALUE 31.        00034880
034890        10 FILLER                PIC 99          VALUE 30.        00034890
034900        10 FILLER                PIC 99          VALUE 31.        00034900
034910                                                                  00034910
034920     05 TABELA-MES-RED REDEFINES TABELA-DIAS-MES.                 00034920
034930        10 NUM-DIAS-MES-TAB OCCURS 12 TIMES                       00034930
034940                                 PIC 99.                          00034940
034950*    ......................................                       00034950

034970*    *********************************************                00034970
034980                                                                  00034980
034990     05 TABELA-ACUM-MOVTO.                                        00034990
035000*       10 TPCTB-TAB-ACUM-MVTO OCCURS 99 TIMES.                   00035000
250412        10 TPCTB-TAB-ACUM-MVTO OCCURS 999 TIMES.
035010           15 ACUM-QDE-CRED-TAB  PIC 9(5)        COMP-3.          00035010
035020           15 ACUM-VR-CRED-TAB   PIC S9(15)V99   COMP-3.          00035020
035030           15 ACUM-QDE-DEB-TAB   PIC 9(5)        COMP-3.          00035030
035040           15 ACUM-VR-DEB-TAB    PIC S9(15)V99   COMP-3.          00035040
035050     05 TABELA-ACUM-DEB-CRED REDEFINES TABELA-ACUM-MOVTO.         00035050
035060        10 Z-ACUM-QDE-CRED-TAB   PIC  9(5)       COMP-3.          00035060
035070        10 Z-ACUM-VR-CRED-TAB    PIC S9(15)V99   COMP-3.          00035070
035080        10 Z-ACUM-QDE-DEB-TAB    PIC  9(5)       COMP-3.          00035080
035090        10 Z-ACUM-VR-DEB-TAB     PIC S9(15)V99   COMP-3.          00035090
035100*       10 Z-RESTO-TAB-DEB-CRED  PIC X(2352).                     00035100
250412        10 Z-RESTO-TAB-DEB-CRED  PIC X(23952).
035110                                                                  00035110
035120*    ***********************************************              00035120
035140     05 TABELA-ACUM-SALDOS.                                       00035140
035150*       10 TPCTB-TAB-ACUM-SLDO OCCURS 99 TIMES.                   00035150
250412        10 TPCTB-TAB-ACUM-SLDO OCCURS 999 TIMES.
035160           15 ACUM-QDE-ATL-TAB   PIC 9(5)        COMP-3.          00035160
035170           15 ACUM-SLD-ATL-TAB   PIC S9(15)V99   COMP-3.          00035170
035180           15 ACUM-QDE-ANT-TAB   PIC 9(5)        COMP-3.          00035180
035190           15 ACUM-SLD-ANT-TAB   PIC S9(15)V99   COMP-3.          00035190
035200     05 TABELA-ACUM-SALDO REDEFINES TABELA-ACUM-SALDOS.           00035200
035210        10 Z-ACUM-QDE-ATL-TAB    PIC 9(5)        COMP-3.          00035210
035220        10 Z-ACUM-SLD-ATL-TAB    PIC S9(15)V99   COMP-3.          00035220
035230        10 Z-ACUM-QDE-ANT-TAB    PIC 9(5)        COMP-3.          00035230
035240        10 Z-ACUM-SLD-ANT-TAB    PIC S9(15)V99   COMP-3.          00035240
035250*       10 Z-RESTO-TAB-ACUM      PIC X(2352).                     00035250
240512        10 Z-RESTO-TAB-ACUM      PIC X(23952).
035260                                                                  00035260
035270*    ***********************************************              00035270
035280                                                                  00035280
035290     05 TABELA-ACUM-QDE-OCR.                                      00035290
035300        10 ACUM-TPOCR-TAB OCCURS 36 TIMES                         00035300
035310                                 PIC 9(5)        COMP-3.          00035310
035320     05 TAB-ACUM-TPOCR REDEFINES TABELA-ACUM-QDE-OCR.             00035320
035330        10 Z-ACUM-TPOCR-TAB      PIC 9(5)        COMP-3.          00035330
035340        10 Z-RESTO-ACUM-TPOCR    PIC X(105).                      00035340
035350                                                                  00035350
035360*    ***********************************************              00035360
035370                                                                  00035370
035380     05 TABELA-COD-OCR.                                           00035380
035390        10 FILLER                PIC 9(4)        VALUE 0101.      00035390
035400        10 FILLER                PIC 9(4)        VALUE 0802.      00035400
035410        10 FILLER                PIC 9(4)        VALUE 1003.      00035410
035420        10 FILLER                PIC 9(4)        VALUE 1204.      00035420
035430        10 FILLER                PIC 9(4)        VALUE 1405.      00035430
035440        10 FILLER                PIC 9(4)        VALUE 1606.      00035440
035450        10 FILLER                PIC 9(4)        VALUE 1807.      00035450
035460        10 FILLER                PIC 9(4)        VALUE 1908.      00035460
035470        10 FILLER                PIC 9(4)        VALUE 2009.      00035470
035480        10 FILLER                PIC 9(4)        VALUE 2210.      00035480
035490        10 FILLER                PIC 9(4)        VALUE 2411.      00035490
035500        10 FILLER                PIC 9(4)        VALUE 2612.      00035500
035510        10 FILLER                PIC 9(4)        VALUE 2813.      00035510
035520        10 FILLER                PIC 9(4)        VALUE 3014.      00035520
035530        10 FILLER                PIC 9(4)        VALUE 3215.      00035530
035540        10 FILLER                PIC 9(4)        VALUE 3316.      00035540
035550        10 FILLER                PIC 9(4)        VALUE 3417.      00035550
035560        10 FILLER                PIC 9(4)        VALUE 3518.      00035560
035570        10 FILLER                PIC 9(4)        VALUE 3619.      00035570
035580        10 FILLER                PIC 9(4)        VALUE 3720.      00035580
035590        10 FILLER                PIC 9(4)        VALUE 3821.      00035590
035600        10 FILLER                PIC 9(4)        VALUE 3922.      00035600
035610        10 FILLER                PIC 9(4)        VALUE 4023.      00035610
035620        10 FILLER                PIC 9(4)        VALUE 4124.      00035620
035630        10 FILLER                PIC 9(4)        VALUE 4225.      00035630
035640        10 FILLER                PIC 9(4)        VALUE 4326.      00035640
035650        10 FILLER                PIC 9(4)        VALUE 4427.      00035650
035660        10 FILLER                PIC 9(4)        VALUE 4528.      00035660
035670        10 FILLER                PIC 9(4)        VALUE 4629.      00035670
035680        10 FILLER                PIC 9(4)        VALUE 4730.      00035680
035690        10 FILLER                PIC 9(4)        VALUE 4831.      00035690
035700        10 FILLER                PIC 9(4)        VALUE 4932.      00035700
035710        10 FILLER                PIC 9(4)        VALUE 5033.      00035710
035720        10 FILLER                PIC 9(4)        VALUE 5234.      00035720
035730        10 FILLER                PIC 9(4)        VALUE 5435.      00035730
035740        10 FILLER                PIC 9(4)        VALUE 5536.      00035740
035750                                                                  00035750
035760     05 TABELA-COD-OCR-RED REDEFINES TABELA-COD-OCR.              00035760
035770        10 COD-OCR-TAB OCCURS 36 TIMES INDEXED BY IND-OCR.        00035770
035780           15 COD-OCR-REAL-TAB   PIC 99.                          00035780
035790           15 COD-OCR-CONV-TAB   PIC 99.                          00035790
035800*                                                                 00035800
ZTABAG     05 TABELA-D04 OCCURS 998 TIMES.                              00035810
035820        10 COD-AG-TAB              PIC 9(05)     COMP-3.          00035820
035830        10 DT-POS-MST-ANT-TAB      PIC 9(06)     COMP-3.          00035830
035840        10 SALDO-MST-ANT-TAB       PIC S9(15)V99 COMP-3.          00035840
035850        10 SEQ-MST-ANT-TAB         PIC 9(04)     COMP-3.          00035850
035860        10 DT-COR-MST-ANT-TAB      PIC 9(06)     COMP-3.          00035860
035870        10 HR-COR-MST-ANT-TAB      PIC 9(06)     COMP-3.          00035870
035880        10 QDE-AGENCIA-ANT-TAB     PIC 9(03)     COMP-3.          00035880
035890        10 REG-EXTRATO-ANT-TAB     PIC 9(09)     COMP-3.          00035890
035900        10 REG-CORRENTISTA-ANT-TAB PIC 9(09)     COMP-3.          00035900
035910        10 DT-POS-MST-ATL-TAB      PIC 9(06)     COMP-3.          00035910
035920        10 SALDO-MST-ATL-TAB       PIC S9(15)V99 COMP-3.          00035920
035930        10 SEQ-MST-ATL-TAB         PIC 9(04)     COMP-3.          00035930
035940        10 DT-COR-MST-ATL-TAB      PIC 9(06)     COMP-3.          00035940
035950        10 HR-COR-MST-ATL-TAB      PIC 9(06)     COMP-3.          00035950
035960        10 QDE-AGENCIA-ATL-TAB     PIC 9(03)     COMP-3.          00035960
035970        10 REG-EXTRATO-ATL-TAB     PIC 9(09)     COMP-3.          00035970
035980        10 REG-CORRENTISTA-ATL-TAB PIC 9(09)     COMP-3.          00035980
035990*                                                                 00035990
036000 01  TABELA-DE-MOVIMENTOS.                                        00036000
036010     05 MOVIMENTOS.                                               00036010
036020        10 TAB-MOVTOS OCCURS 16000 TIMES.                         00036020
036030           15 MOV-LOTE-TAB         PIC 99.                        00036030
036040           15 MOV-HIST-TAB         PIC 9(5)      COMP-3.          00036040
036050           15 MOV-REF-TAB          PIC 9(6)      COMP-3.          00036050
036060           15 MOV-VR-TAB           PIC S9(13)V99 COMP-3.          00036060
036070     05 ZERA-MOVIMENTOS REDEFINES MOVIMENTOS.                     00036070
036080        10 ZERA-MOV-LOTE-TAB       PIC 99.                        00036080
036090        10 ZERA-MOV-HIST-TAB       PIC 9(05)     COMP-3.          00036090
036100        10 ZERA-MOV-REF-TAB        PIC 9(6)      COMP-3.          00036100
036110        10 ZERA-MOV-VR-TAB         PIC S9(13)V99 COMP-3.          00036110
036160        10 ZERA-RESTO-MOVTOS.                                     00036160
036170           15 ZERA-RESTO-MOVTOS-1  PIC X(67998).                  00036170
036180           15 ZERA-RESTO-MOVTOS-2  PIC X(67995).                  00036180
036190           15 ZERA-RESTO-MOVTOS-3  PIC X(67995).                  00036190
036200           15 ZERA-RESTO-MOVTOS-4  PIC X(67995).                  00036200
      * Book tabela de fundos
           COPY B048FNDI.

       01  CONTA-FUNDOS-WS.
           05 CC-CONTA-WS                PIC 9(09)     VALUE ZEROS.
           05 DG-CONTA-WS                PIC 9(01)     VALUE ZEROS.

036310*    ......................................                       00036310
036330*    .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
036340 01  SWITCHES.
036350*    .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
036360     05 SW-ERRO-75               PIC 9           VALUE ZEROS.
036370        88 ERRO-75                               VALUE 1.
036360     05 SW-TEM-APLIC             PIC 9           VALUE ZEROS.
036370        88 TEM-APLIC                             VALUE 1.
036380     05 SW-TEM-T048NM            PIC 9           VALUE ZEROS.
036390        88 TEM-T048NM                            VALUE 1.
036400     05 SW-FIM-T048NM            PIC 9           VALUE ZEROS.
036410        88 FIM-T048NM                            VALUE 1.
036420     05 SW-FIM-CONTAS            PIC 9           VALUE 0.
036430        88 FIM-CONTAS                            VALUE 1.
036440     05 SW-FIM-CLIENTE           PIC 9           VALUE 0.
036450        88 FIM-CLIENTE                           VALUE 1.
036460     05 SW-ACHA-HIST             PIC 9           VALUE ZEROS.
036470        88 ACHOU-HIST                            VALUE 1.
      *    05 SW-TEM-HIST-515          PIC 9           VALUE ZEROS.
      *       88 TEM-HIST-515                          VALUE 1.
036480     05 SW-TEM-HIST-387          PIC 9           VALUE ZEROS.
036490        88 TEM-HIST-387                          VALUE 1.
036500     05 SW-TEM-HIST-71-373       PIC 9           VALUE ZEROS.
036510        88 TEM-HIST-71-373                       VALUE 1.
036520     05 SW-CONTABILIZA-392       PIC 9           VALUE ZEROS.
036530        88 NAO-CONTABILIZOU-392                  VALUE ZEROS.
036520     05 SW-CONTABILIZA-383       PIC 9           VALUE ZEROS.
036530        88 NAO-CONTABILIZOU-383                  VALUE ZEROS.
036540     05 SW-FIM-FUNDOS            PIC 9           VALUE ZEROS.
036550        88 FIM-FUNDOS                            VALUE 1.
           05 SW-FUNDOS-FND            PIC 9           VALUE ZEROS.     00036540
              88 FUNDOS-FND                            VALUE 1.         00036550
036560     05 SW-PCORR-WS              PIC 9           VALUE 0.         00036560
036570        88 TEM-POUP-CORR                         VALUE 1.         00036570
036580     05 SW-QUEBRA-CONTA-ESP      PIC 9           VALUE 0.
036590        88 QUEBROU-CONTA-ESP                     VALUE 1.
036600     05 SW-CRED-DEB-ESP          PIC 9           VALUE 0.
036610        88 HA-CRED-DEB-ESP                       VALUE 1.
036620     05 SW-SEGURO-WS             PIC 9           VALUE 0.
036630        88 ALTERACAO-SEGURO                      VALUE 1.
036640     05 SW-SALDO-ZERADO          PIC 9           VALUE 0.
036650        88 SALDO-ZERADO                          VALUE 1.
036660     05 SW-INCLUE-D-SEM-SICAD    PIC 9           VALUE 0.
036670        88 INCLUSAO-D-SEM-SICAD                  VALUE 1.
036680     05 SW-CONSISTENCIA          PIC 9           VALUE 0.
036690        88 CONSISTENCIA-OK                       VALUE 0.
036700     05 SW-MOVIMENTACAO          PIC 9           VALUE 0.
036710        88 HA-MOVIMENTACAO                       VALUE 1.
036720     05 SW-INDICA-GR-CRE-DEB     PIC 9           VALUE 0.
036730        88 HA-GR-CRE-DEB                         VALUE 1.
036740     05 SW-OCR-GR-DIFERENCA      PIC 9           VALUE 0.
036750        88 OCR-GR-DIFERENCA                      VALUE 1.
036760     05 SW-RECUSA-AC-NUMEROS     PIC 9           VALUE 0.
036770        88 RECUSA-AC-NUMEROS                     VALUE 1.
036780     05 SW-EXISTE-CAMPO-A        PIC 9           VALUE 0.
036790        88 EXISTE-CAMPO-A                        VALUE 1.
036800     05 SW-EXISTE-CAMPO-B        PIC 9           VALUE 0.
036810        88 EXISTE-CAMPO-B                        VALUE 1.
036820     05 SW-EXISTE-CAMPO-C        PIC 9           VALUE 0.
036830        88 EXISTE-CAMPO-C                        VALUE 1.
036840     05 SW-EXISTE-CAMPO-D        PIC 9           VALUE 0.
036850        88 EXISTE-CAMPO-D                        VALUE 1.
036860     05 SW-INICIO-MES            PIC 9           VALUE 0.
036870        88 INICIO-MES                            VALUE 1.
036880     05 SW-INICIO-ANO            PIC 9           VALUE ZERO.
036890        88 INICIO-ANO                            VALUE 2.
036900     05 SW-INEXISTE-MOV          PIC 9           VALUE 0.
036910        88 INEXISTE-MOV                          VALUE 1.
036920     05 SW-GRAVACAO              PIC 9           VALUE 0.
036930        88 NAO-GRAVA                             VALUE 1.
036940     05 SW-ERRO-GRAV-TELEX       PIC 9           VALUE 0.
036950        88 ERRO-GRAVACAO-TELEX                   VALUE 1.
036960     05 SW-F10                   PIC 9           VALUE ZERO.
036970     05 SW-SICAD                 PIC 9           VALUE 0.
036980        88 SICAD-NOK                             VALUE 1.
036990        88 SICAD-OK                              VALUE 0.
037000     05 SW-GERA-FICHA            PIC 9           VALUE 0.
037010        88 GERA-FICHA                            VALUE 1.
037020     05 SW-GERA-BLOQUEADO        PIC 9           VALUE 0.
037030        88 GERA-BLOQUEADO                        VALUE 1.
037040     05 SW-EXCLUI-CONTA          PIC 9           VALUE 0.
037050        88 EXCLUI-CONTA                          VALUE 1.
037060     05 SW-IMPLANTACAO           PIC 9           VALUE ZEROS.
037070        88 IMPLANTACAO                           VALUE 1.
037080     05 SW-OCR-ESP               PIC 9           VALUE 0.
037090        88 OCR-ESP                               VALUE 1.
037100     05 SW-CALCULAR-NUMEROS      PIC 9           VALUE 0.
037110        88 CALCULAR-NUMEROS                      VALUE 1.
037120     05 SW-CANCELOU-EMPRESTIMO   PIC 9           VALUE ZERO.
037130        88 CANCELOU-EMPRESTIMO                   VALUE 1.
037140     05 SW-INSUF-EXCESSO-REAL    PIC 9           VALUE ZERO.
037150        88 INSUF-EXCESSO-REAL                    VALUE 2.
037160     05 SW-REGULARIZA-INSUF      PIC 9           VALUE 0.
037170        88 REGULARIZA-INSUF                      VALUE 1.
037180        88 REGULARIZOU-INSUF                     VALUE 2.
037190     05 SW-CH-PERSONAL           PIC 9           VALUE 0.
037200        88 NAO-HA-CONTA                          VALUE 1.
037210     05 SW-FIM-PROCESSAMENTO     PIC 9           VALUE 0.
037220        88 FIM-PROCESSAMENTO                     VALUE 1.
037230     05 SW-PRIMEIRA-LEITURA-F10  PIC 9           VALUE 0.
037240        88 PRIMEIRA-LEITURA-F10                  VALUE 1.
037250     05 SW-PRIMEIRA-LEITURA-D07  PIC 9           VALUE 0.
037260        88 PRIMEIRA-LEITURA-D07                  VALUE 1.
037270     05 SW-Abertura-ArqCtasUpdate      PIC 9     VALUE 0.
037280        88 FLAG-ArqContasUpdate-Aberto           VALUE 1.
037290     05 SW-ABERTO-D07B           PIC 9           VALUE 0.
037300        88 ABERTO-D07B                           VALUE 1.
037310     05 SW-ABERTO-D83            PIC 9           VALUE 0.
037320        88 ABERTO-D83                            VALUE 1.
037330     05 SW-ABERTO-D128           PIC 9           VALUE 0.
037340        88 ABERTO-D128                           VALUE 1.
037350     05 SW-Abertura-ArqAgencias     PIC 9          VALUE 0.
037360        88 FLAG-ArqAgencias-Aberto                 VALUE 1.
037370     05 SW-Abertura-ArqExtMensal    PIC 9          VALUE 0.
037380        88 FLAG-ArqExtMesal-Aberto                 VALUE 1.
037390     05 SW-ABRIU-D04819            PIC 9           VALUE 0.
037400        88 ABRIU-D04819                            VALUE 1.
037410     05 SW-ABRIU-D04807            PIC 9           VALUE 0.
037420        88 ABRIU-D04807                            VALUE 1.
037430     05 SW-ABRIU-D0480701          PIC 9           VALUE 0.
037440        88 ABRIU-D0480701                          VALUE 1.
037450     05 SW-ABRIU-D04810            PIC 9           VALUE 0.
037460        88 ABRIU-D04810                            VALUE 1.
037470     05 SW-ABRIU-D04811            PIC 9           VALUE 0.
037480        88 ABRIU-D04811                            VALUE 1.
037490     05 SW-ABRIU-D15901            PIC 9           VALUE 0.
037500        88 ABRIU-D15901                            VALUE 1.
037510     05 SW-ABRIU-D04815            PIC 9           VALUE 0.
037520        88 ABRIU-D04815                            VALUE 1.
037530     05 SW-ABRIU-D27030            PIC 9           VALUE 0.
037540        88 ABRIU-D27030                            VALUE 1.
037570     05 SW-ABRIU-D86042            PIC 9           VALUE 0.
037580        88 ABRIU-D86042                            VALUE 1.
037590     05 SW-ABRIU-D30201            PIC 9           VALUE 0.
037600        88 ABRIU-D30201                            VALUE 1.
037610     05 SW-Abertura-ArqContasBase  PIC 9           VALUE 0.
037620        88 FLAG-ArqContasBase-Aberto               VALUE 1.
037630     05 SW-Abertura-TabUtils            PIC 9      VALUE 0.
037640        88 FLAG-TabUtils-Aberta                    VALUE 1.
037650     05 SW-ABRIU-D048CAN           PIC 9           VALUE 0.
037660        88 ABRIU-D048CAN                           VALUE 1.
037670     05 SW-ABRIU-D13002            PIC 9           VALUE 0.
037680        88 ABRIU-D13002                            VALUE 1.
037690     05 SW-DESBLOQUEIO             PIC 9           VALUE 0.
037700        88 HOUVE-DESBLOQUEIO                       VALUE 1.
037710        88 HOUVE-ESTORNO                           VALUE 2.
037720     05 SW-ACHOU-ITAH              PIC 9           VALUE 0.
037730        88 ACHOU-ITAH-DO-DIA                       VALUE 1.
037740        88 ACHOU-ITAH-DO-DIA-SEGUINTE              VALUE 2.
037750     05 SW-ACHOU-ITAF              PIC 9           VALUE 0.
037760        88 ACHOU-ITAF-DO-DIA                       VALUE 1.
037770        88 ACHOU-ITAF-DO-DIA-SEGUINTE              VALUE 2.
037780     05 SW-ACHOU-BTNF              PIC 9           VALUE 0.
037790        88 ACHOU-BTNF-DO-DIA                       VALUE 1.
037800        88 ACHOU-BTNF-DO-DIA-SEGUINTE              VALUE 2.
037810     05 SW-ERRO-TBTX               PIC 9           VALUE 0.
037820        88 HOUVE-ERRO-TBTX                         VALUE 1.
037830     05 SW-RETORNO-SUBROT          PIC 9           VALUE 0.
037840        88 RETORNO-SUBROT-OK                       VALUE 1.
037850     05 SW-INSUF-EXTINTA           PIC 9           VALUE 0.
037860        88 INSUFICIENCIA-EXTINTA                   VALUE 1.
037870     05 SW-EXCESSO-EXTINTO         PIC 9           VALUE 0.
037880        88 EXCESSO-EXTINTO                         VALUE 1.
037890     05 SW-CONTRATO-VENCIDO        PIC 9           VALUE 0.
037900        88 CONTRATO-VENCIDO                        VALUE 1.
037910     05 SW-FIM-CALCULO-PRAZO       PIC 9           VALUE 0.
037920        88 FIM-CALCULO-PRAZO                       VALUE 1.
037930     05 SW-ANO-BISSEXTO            PIC 9           VALUE 0.
037940        88 ANO-BISSEXTO                            VALUE 1.
037950     05 SW-HA-FERIADO              PIC 9           VALUE 0.
037960        88 HA-FERIADO                              VALUE 1.
037970     05 SW-FIM-FERIADOS            PIC 9           VALUE 0.
037980        88 FIM-FERIADOS                          VALUE 1.
037990     05 SW-PESQUISA-PRIMEIRO-FERIADO PIC 9       VALUE 0.
038000        88 PESQUISA-PRIMEIRO-FERIADO             VALUE 1.
038010     05 SW-FIM-PESQ-TAXAS        PIC 9           VALUE 0.
038020        88 FIM-PESQ-TAXAS                        VALUE 1.
038030     05 SW-ERRO-FERIADO-TBTX     PIC 9           VALUE 0.
038040        88 HOUVE-ERRO-FERIADO-TBTX               VALUE 1.
038050     05 SW-ENCONTROU-TAXA        PIC 9           VALUE 0.
038060        88 ENCONTROU-TAXA                        VALUE 1.
038070     05 SW-ENCONTROU-D13002      PIC 9           VALUE 0.
038080        88 ENCONTROU-CONTA                        VALUE 1.
038090     05 SW-HOUVE-OCORR-14        PIC 9           VALUE 0.
038100        88 HOUVE-OCORR-14                        VALUE 1.
038110     05 SW-CHEQUE-TB             PIC 9           VALUE 0.
038120        88 CHEQUE-TRANSF-BANCARIA                VALUE 1.
038130     05 SW-CHEQUE-NORMAL         PIC 9           VALUE 0.
038140        88 CHEQUE-NORMAL                         VALUE 1.
038150     05 SW-FIM-ARQ               PIC 9           VALUE 0.
038160        88 FIM-ARQUIVO                           VALUE 1.
038170     05 SW-FIM-WS                PIC 9           VALUE 0.
038180        88 FINAL-ARQUIVO                         VALUE 1.
ACMF       05 CH-ISENTO-IOF            PIC X(01)       VALUE SPACE.
ACMF          88 ISENTO-IOF            VALUE 'S'.
           05 SW-OPER-ISENTA-IOF       PIC 9(01)       VALUE ZEROS.
              88 OPER-ISENTA-IOF                       VALUE 1.
              88 OPER-NAO-ISENTA-IOF                   VALUE 0.
038190*    ......................................                       00038190
038210                                                                  00038210
038220 LINKAGE SECTION.                                                 00038220
038230 01  PARAMETRO-LK.                                                00038230
038240     05 TAMANHO-LK               PIC S999 COMP.                   00038240
038250     05 OPCAO-PARAM-LK           PIC XX.                          00038250
038260        88 CCATLZA               VALUE 'CC'.                      00038260
038270        88 EXATLZA               VALUE 'EX'.                      00038270
038250     05 IOF-PARAM-LK             PIC X(06).                       00038250
038260        88 COBRA-IOF             VALUE 'IOFSIM', '      '.        00038260
038270        88 NAO-COBRA-IOF         VALUE 'IOFNAO'.                  00038270
038280                                                                  00038280
038290*----------------------------------------------------------------*00038290
038300*                                                                 00038300
038310 PROCEDURE DIVISION USING PARAMETRO-LK.                           00038310
038320*                                                                 00038320
038330*----------------------------------------------------------------*00038330
038340*                                                                 00038340
038350 00-CONTROLE.                                                     00038350
           MOVE     FUNCTION  WHEN-COMPILED TO  W-DATA-COMPILACAO.
           DISPLAY '+------------------------------------------------+'.
           DISPLAY '|   P04808 - ATUALIZACAO DE SALDOS DE CONTAS     |'.
           DISPLAY '|   CORRENTES.                                   |'.
           DISPLAY '|           COMPILACAO DO PROGRAMA               |'.
           DISPLAY '|           D A T A   -    H O R A               |'.
           DISPLAY '|         '
                   W-DIA-COMP  '/'  W-MES-COMP  '/'  W-ANO-COMP
                   '  -   ' W-HOR-COMP ':' W-MIN-COMP ':' W-SEG-COMP
                   '               |'.
           DISPLAY '+------------------------------------------------+'.

038370     IF CCATLZA OR EXATLZA                                        00038370
038380        NEXT SENTENCE                                             00038380
038390     ELSE                                                         00038390
038400        MOVE 04     TO FILE-STATUS-WS                             00038400
038410        MOVE 'P04808 - PARAMETRO INCONSISTENTE' TO                00038410
038420                       MENSAGEM-ERRO-WS                           00038420
038430        PERFORM 999-99-ROT-ERRO.                                  00038430
038440                                                                  00038440
           IF  COBRA-IOF
               MOVE ZEROS TO DT-INICIO-ISENCAO-IOF
                             DT-FIM-ISENCAO-IOF
           ELSE
               IF  NAO-COBRA-IOF
                   MOVE 20200403 TO DT-INICIO-ISENCAO-IOF
                   MOVE 20201231 TO DT-FIM-ISENCAO-IOF
               ELSE
                   MOVE 04     TO FILE-STATUS-WS
                   MOVE 'P04808 - PARAMETRO INCONSISTENTE' TO
                             MENSAGEM-ERRO-WS
                   PERFORM 999-99-ROT-ERRO
               END-IF
           END-IF
038440                                                                  00038440
038450     PERFORM 05-INICIALIZACAO.                                    00038450
038460                                                                  00038460
038470     PERFORM 35-PROCESSA-AGENCIA                                  00038470
038480         UNTIL FIM-PROCESSAMENTO.                                 00038480
038490                                                                  00038490
038500     MOVE 1 TO COD-AG-D04.                                        00038500
038510     READ ArqAgencias.                                            00038510
038520     IF  STATUS-D04-WS NOT EQUAL '00'                             00038520
038530         MOVE STATUS-D04-WS TO FILE-STATUS-WS                     00038530
038540         MOVE 'P04808 ERRO LEITURA NO ArqAgencias'                00038540
038550             TO MENSAGEM-ERRO-WS                                  00038550
038560         PERFORM 999-99-ROT-ERRO.                                 00038560
038570     MOVE 1                    TO COD-AG-D04.                     00038570
038580     MOVE DATA-MOV-WS          TO DT-POS-MST-ATL-D04.             00038580
038590     MOVE SEQ-D04-WS           TO SEQ-MST-ATL-D04                 00038590
038600     MOVE DATA-EVT-WS          TO DT-COR-MST-ATL-D04.             00038600
038610     ACCEPT HR-COR-MST-ATL-D04 FROM TIME.                         00038610
038620     MOVE ACUM-QDE-AGENCIA     TO QDE-AGENCIA-ATL-D04.            00038620
038630     MOVE ACUM-REG-EXTRATO     TO REG-EXTRATO-ATL-D04.            00038630
038640     MOVE ACUM-REG-CORRENTISTA TO REG-CORRENTISTA-ATL-D04.        00038640
038650     MOVE SPACES               TO ESP-D04.                        00038650
038660     MOVE 'OK'                 TO COD-ERRO-D04.                   00038660
038670     MOVE ACUM-SALD-ATL-D04-WS TO SALDO-MST-ATL-D04.              00038670
038680     REWRITE REG-D04.                                             00038680
038690     IF  STATUS-D04-WS NOT EQUAL '00'                             00038690
038700         MOVE STATUS-D04-WS TO FILE-STATUS-WS                     00038700
038710         MOVE 'P04808 ERRO GRAVACAO NO ArqAgencias'
038720             TO MENSAGEM-ERRO-WS
038730         PERFORM 999-99-ROT-ERRO.
038740
038750     MOVE 0 TO IND-GRAVA-D04.
038760     PERFORM 850-GRAVA-D04 IND-TAB-D04 TIMES.
038770
038780     CLOSE ArqContasBase.
038790     IF FS-ArqContasBase NOT EQUAL '00'
038800         MOVE FS-ArqContasBase TO FILE-STATUS-WS
038810         MOVE '**P04808-ERRO NO FECHAMENTO DO D04808 **'
038820             TO MENSAGEM-ERRO-WS
038830         PERFORM 999-99-ROT-ERRO.
038840     MOVE 0 TO SW-Abertura-ArqContasBase.

038850     CLOSE ArqAgencias.
038860     IF STATUS-D04-WS NOT EQUAL '00'
038870         MOVE STATUS-D04-WS TO FILE-STATUS-WS
038880         MOVE '**P04808-ERRO NO FECHAMENTO DO ArqAgencias**'
038890             TO MENSAGEM-ERRO-WS
038900         PERFORM 999-99-ROT-ERRO.
038910     CLOSE ArqExtMensal.
038920     IF ST-ArqExtMensal NOT EQUAL '00'
038930         MOVE ST-ArqExtMensal TO FILE-STATUS-WS
038940         MOVE '**P04808-ERRO NO FECHAMENTO DO TabUtils**'
038950             TO MENSAGEM-ERRO-WS
038960         PERFORM 999-99-ROT-ERRO.
038970     MOVE 0 TO SW-Abertura-ArqAgencias.
038980     CLOSE D04807.
038990     MOVE 0 TO SW-ABRIU-D04807.
039000     CLOSE D0480701.
039010     MOVE 0 TO SW-ABRIU-D0480701.
039020     CLOSE D04811.
039030     MOVE 0 TO SW-ABRIU-D04811.
039040     CLOSE D04810 D04810S.
039050     MOVE 0 TO SW-ABRIU-D04810.
039060     CLOSE ArqContasUpdate.
039070     IF STATUS-ARQ-UPDT-WS NOT EQUAL '00'
039080         MOVE STATUS-ARQ-UPDT-WS TO FILE-STATUS-WS
039090         MOVE '**P04808-ERRO NO FECHAMENTO DO ArqContasUpdate **'
039100             TO MENSAGEM-ERRO-WS
039110         PERFORM 999-99-ROT-ERRO.
039120     MOVE 0 TO SW-Abertura-ArqCtasUpdate.
039130
039140     IF ABERTO-D83                                                00039140
039150        CLOSE D04883.                                             00039150
039160                                                                  00039160
039170     IF ABERTO-D07B                                               00039170
039180        CLOSE D04807B.                                            00039180
039190                                                                  00039190
039200     IF ABERTO-D128                                               00039200
039210        CLOSE D12802.                                             00039210
039220                                                                  00039220
039230     CLOSE D048CAN.                                               00039230
039240     IF STATUS-CAN-WS NOT EQUAL '00'                              00039240
039250         MOVE STATUS-CAN-WS TO FILE-STATUS-WS                     00039250
039260         MOVE '**P04808-ERRO NO FECHAMENTO DO D048CAN **'         00039260
039270             TO MENSAGEM-ERRO-WS                                  00039270
039280         PERFORM 999-99-ROT-ERRO.                                 00039280
039290                                                                  00039290
039300     CLOSE D15901.                                                00039300
039310     IF STATUS-D15901 NOT EQUAL '00'                              00039310
039320         MOVE STATUS-D15901 TO FILE-STATUS-WS                     00039320
039330         MOVE '**P04808-ERRO NO FECHAMENTO DO D15901 **'          00039330
039340             TO MENSAGEM-ERRO-WS                                  00039340
039350         PERFORM 999-99-ROT-ERRO.                                 00039350
039360                                                                  00039360
039370     CLOSE D04815.                                                00039370
039380     IF STATUS-D04815-WS NOT EQUAL '00'                           00039380
039390         MOVE STATUS-D04815-WS TO FILE-STATUS-WS                  00039390
039400         MOVE '**P04808-ERRO NO FECHAMENTO DO D04815 **'          00039400
039410             TO MENSAGEM-ERRO-WS                                  00039410
039420         PERFORM 999-99-ROT-ERRO.                                 00039420
039430                                                                  00039430
039440     CLOSE D13002.                                                00039440
039450     IF STATUS-D02-WS NOT EQUAL '00'                              00039450
039460         MOVE STATUS-D02-WS TO FILE-STATUS-WS                     00039460
039470         MOVE '**P04808-ERRO NO FECHAMENTO DO D13002 **'          00039470
039480             TO MENSAGEM-ERRO-WS                                  00039480
039490         PERFORM 999-99-ROT-ERRO.                                 00039490
039500                                                                  00039500
039510     CLOSE D27030.                                                00039510
039520     IF STATUS-D27030-WS NOT EQUAL '00'                           00039520
039530         MOVE STATUS-D27030-WS TO FILE-STATUS-WS                  00039530
039540         MOVE '**P04808-ERRO NO FECHAMENTO DO D27030 **'          00039540
039550             TO MENSAGEM-ERRO-WS                                  00039550
039560         PERFORM 999-99-ROT-ERRO.                                 00039560
039570     MOVE 0 TO SW-ABRIU-D27030.                                   00039570
039580                                                                  00039580
039670     CLOSE D86042.                                                00039670
039680     IF FS-D42 NOT EQUAL '00'                                     00039680
039690         MOVE FS-D42 TO FILE-STATUS-WS                            00039690
039700         MOVE '**P04808-ERRO NO FECHAMENTO DO D86042 **'          00039700
039710             TO MENSAGEM-ERRO-WS                                  00039710
039720         PERFORM 999-99-ROT-ERRO.                                 00039720
039730     MOVE 0 TO SW-ABRIU-D86042.                                   00039730
039740                                                                  00039740
039750     CLOSE D30201.                                                00039750
039760     IF STATUS-D302-WS NOT EQUAL '00'                             00039760
039770         MOVE STATUS-D302-WS TO FILE-STATUS-WS                    00039770
039780         MOVE '**P04808-ERRO NO FECHAMENTO DO D30201 **'          00039780
039790             TO MENSAGEM-ERRO-WS                                  00039790
039800         PERFORM 999-99-ROT-ERRO.                                 00039800
039810     MOVE 0 TO SW-ABRIU-D30201.                                   00039810
039820                                                                  00039820
039860     CLOSE D27028.                                                00039860
039870     IF FS-D27028 NOT EQUAL '00'                                  00039870
039880        MOVE FS-D27028      TO FILE-STATUS-WS                     00039880
039890        MOVE 'P04808 - ERRO NO FECHAMENTO DO D27028 **'           00039890
039900                            TO MENSAGEM-ERRO-WS                   00039900
039910        PERFORM 999-99-ROT-ERRO.                                  00039910
039920                                                                  00039920
039930     CLOSE D86041.                                                00039930
039940     IF FS-D86041 NOT EQUAL '00'                                  00039940
039950        MOVE FS-D86041      TO FILE-STATUS-WS                     00039950
039960        MOVE 'P04808 - ERRO NO FECHAMENTO DO D86041 **'           00039960
039970                            TO MENSAGEM-ERRO-WS                   00039970
039980        PERFORM 999-99-ROT-ERRO.                                  00039980
039990                                                                  00039990
040070     CLOSE D15903.                                                00040070
040080     IF FS-D15903 NOT EQUAL '00'                                  00040080
040090        MOVE     FS-D15903  TO FILE-STATUS-WS                     00040090
040100        MOVE 'P04808 - ERRO NO FECHAMENTO DO D15903 **'           00040100
040110                            TO MENSAGEM-ERRO-WS                   00040110
040120        PERFORM 999-99-ROT-ERRO.                                  00040120
040130                                                                  00040130
040140     CLOSE D19401.                                                00040140
040150     IF FS-D19401 NOT EQUAL '00'                                  00040150
040160        MOVE     FS-D19401  TO FILE-STATUS-WS                     00040160
040170        MOVE 'P04808 - ERRO NO FECHAMENTO DO D19401 **'           00040170
040180                            TO MENSAGEM-ERRO-WS                   00040180
040190        PERFORM 999-99-ROT-ERRO.                                  00040190
040200                                                                  00040200
040230     GOBACK.                                                      00040230
040240                                                                  00040240
040250*----------------------------------------------------------------*00040250
040260 05-INICIALIZACAO.                                                00040260
040270*                                                                 00040270
040280     MOVE ZEROS TO IND-TAB-AGN                                    00040280
040290                   EXTRA-EXTRA-WS                                 00040290
040300                   IND-MOVTOS                                     00040300
                         SLD-DEVOL-WS
                         VLR-CRED-BAIXA-ATV-WS
                         JUR-DEVOL-1DIA-WS
                         IOF-DEVOL-1DIA-WS
                         JUR-MENSAL-1DIA-WS
                         IOF-MENSAL-1DIA-WS
ZTABAG     PERFORM 07-05-LIMPA-TAB-AGN 998 TIMES.                       00040310
040320     PERFORM 999-31-LIMPA-TAB-MOVTOS.                             00040320
040330     MOVE ZEROS TO IND-MOVTOS.                                    00040330
040340     PERFORM 10-05-ABERTURA.                                      00040340
040350                                                                  00040350
           MOVE SPACES TO REG-EXTRATO-D10.
040360     INITIALIZE REG-EXTRATO-D10.                                  00040360
040370     PERFORM 20-05-LEITURAS-INICIAIS.                             00040370
040380                                                                  00040380
      * Carga tabela de fundos
           CALL 'P0480400' USING TABELA-FND.

      * Carga tabela de parametros
           PERFORM CARREGA-PARM.
040390*----------------------------------------------------------------*00040390
040400 07-05-LIMPA-TAB-AGN.                                             00040400
040410                                                                  00040410
040420     ADD 1 TO IND-TAB-AGN.                                        00040420
040430     MOVE ZEROS TO AGENCIA-TAB (IND-TAB-AGN)                      00040430
040440                   CLASSE-TAB (IND-TAB-AGN).                      00040440
040450*----------------------------------------------------------------*00040450
040460 10-05-ABERTURA.                                                  00040460
040470*
040480     PERFORM 11-10-ABRE-ARQ-AGENCIAS UNTIL
040490          FLAG-ArqAgencias-Aberto.
040500     PERFORM 12-10-ABRE-ARQ-CTAS-UPDATE UNTIL
040510          FLAG-ArqContasUpdate-Aberto.
040520     PERFORM 13-10-ABRE-ARQ-CTAS-BASE.
040530                                                                  00040530
040540     OPEN OUTPUT D04810 D04810S.                                  00040540
040550     MOVE 1 TO SW-ABRIU-D04810.                                   00040550
040560                                                                  00040560
040570     OPEN INPUT D04807.                                           00040570
040580     MOVE 1 TO SW-ABRIU-D04807.                                   00040580
040590                                                                  00040590
040600     OPEN OUTPUT D0480701.                                        00040600
040610     MOVE 1 TO SW-ABRIU-D0480701.                                 00040610
040620                                                                  00040620
040630     OPEN OUTPUT D04811.                                          00040630
040640     MOVE 1 TO SW-ABRIU-D04811.                                   00040640
040650                                                                  00040650
040660     OPEN OUTPUT D04883.                                          00040660
040670     MOVE 1 TO SW-ABERTO-D83.                                     00040670
040680                                                                  00040680
040690     OPEN OUTPUT D04807B.                                         00040690
040700     MOVE 1 TO SW-ABERTO-D07B.                                    00040700
040720                                                                  00040720
040730     OPEN OUTPUT D12802.                                          00040730
040740     MOVE 1 TO SW-ABERTO-D128.                                    00040740
040750                                                                  00040750
040760     OPEN I-O D048CAN.                                            00040760
040770     IF  STATUS-CAN-WS EQUAL '00' OR '97'                         00040770
040780         MOVE 1 TO SW-ABRIU-D048CAN                               00040780
040790     ELSE                                                         00040790
040800        MOVE STATUS-CAN-WS TO FILE-STATUS-WS                      00040800
040810        MOVE 'P04808 ERRO DE ABERTURA D048CAN **'                 00040810
040820             TO MENSAGEM-ERRO-WS                                  00040820
040830        PERFORM 999-99-ROT-ERRO.                                  00040830
040840                                                                  00040840
040850     OPEN INPUT D13002.                                           00040850
040860     IF  STATUS-D02-WS EQUAL '00' OR '97'                         00040860
040870         MOVE 1 TO SW-ABRIU-D13002                                00040870
040880     ELSE                                                         00040880
040890        MOVE STATUS-D02-WS TO FILE-STATUS-WS                      00040890
040900        MOVE 'P04808 ERRO DE ABERTURA D13002 **'                  00040900
040910             TO MENSAGEM-ERRO-WS                                  00040910
040920        PERFORM 999-99-ROT-ERRO.                                  00040920
040930                                                                  00040930
040940     OPEN INPUT D15901.                                           00040940
040950     IF  STATUS-D15901 EQUAL '00' OR '97'                         00040950
040960         MOVE 1 TO SW-ABRIU-D15901                                00040960
040970     ELSE                                                         00040970
040980        MOVE STATUS-D15901 TO FILE-STATUS-WS                      00040980
040990        MOVE 'P04808 ERRO DE ABERTURA D15901 **'                  00040990
041000             TO MENSAGEM-ERRO-WS                                  00041000
041010        PERFORM 999-99-ROT-ERRO.                                  00041010
041020                                                                  00041020
041030     OPEN INPUT D04815.                                           00041030
041040     IF  STATUS-D04815-WS EQUAL '00' OR '97'                      00041040
041050         MOVE 1 TO SW-ABRIU-D04815                                00041050
041060     ELSE                                                         00041060
041070        MOVE STATUS-D04815-WS TO FILE-STATUS-WS                   00041070
041080        MOVE 'P04808 ERRO DE ABERTURA D04815 **'                  00041080
041090             TO MENSAGEM-ERRO-WS                                  00041090
041100        PERFORM 999-99-ROT-ERRO.                                  00041100
041110                                                                  00041110
041120     OPEN INPUT D27030.                                           00041120
041130     IF  STATUS-D27030-WS EQUAL '00' OR '97'                      00041130
041140         MOVE 1 TO SW-ABRIU-D27030                                00041140
041150     ELSE                                                         00041150
041160        MOVE STATUS-D27030-WS TO FILE-STATUS-WS                   00041160
041170        MOVE 'P04808 ERRO DE ABERTURA D27030 **'                  00041170
041180             TO MENSAGEM-ERRO-WS                                  00041180
041190        PERFORM 999-99-ROT-ERRO.                                  00041190
041200                                                                  00041200
041300     OPEN INPUT D86042.                                           00041300
041310     IF  FS-D42 EQUAL '00' OR '97'                                00041310
041320         MOVE 1 TO SW-ABRIU-D86042                                00041320
041330     ELSE                                                         00041330
041340        MOVE FS-D42 TO FILE-STATUS-WS                             00041340
041350        MOVE 'P04808 ERRO DE ABERTURA D86042 **'                  00041350
041360             TO MENSAGEM-ERRO-WS                                  00041360
041370        PERFORM 999-99-ROT-ERRO.                                  00041370
041380                                                                  00041380
041390     OPEN INPUT D30201.                                           00041390
041400     IF  STATUS-D302-WS EQUAL '00' OR '97'                        00041400
041410         MOVE 1 TO SW-ABRIU-D30201                                00041410
041420     ELSE                                                         00041420
041430        MOVE STATUS-D302-WS TO FILE-STATUS-WS                     00041430
041440        MOVE 'P04808 ERRO DE ABERTURA D30201 **'                  00041440
041450             TO MENSAGEM-ERRO-WS                                  00041450
041460        PERFORM 999-99-ROT-ERRO.                                  00041460
041470
041480     OPEN INPUT ArqExtMensal.
041490     IF  ST-ArqExtMensal EQUAL '00' OR '97'
041500         MOVE 1 TO SW-Abertura-ArqExtMensal
041510     ELSE
041520        MOVE ST-ArqExtMensal TO FILE-STATUS-WS
041530        MOVE 'P04808 ERRO DE ABERTURA TabUtils **'
041540             TO MENSAGEM-ERRO-WS                                  00041540
041550        PERFORM 999-99-ROT-ERRO.                                  00041550
041560     MOVE 9999         TO SEQUENCIAL-EXT.                         00041560
041570     MOVE 002          TO CH-AG-EXT.                              00041570
041580     MOVE ZEROS        TO CH-CONTA-EXT.                           00041580
041590     MOVE ZEROS        TO CH-DIGITO-EXT.                          00041590
041600     MOVE 1            TO CH-TIPOREG-EXT.                         00041600
041610     MOVE ZEROS        TO CH-SEQUENCIAL-EXT.                      00041610
041620     READ ArqExtMensal.
041630     IF ST-ArqExtMensal NOT = '00'
041640        MOVE ST-ArqExtMensal TO FILE-STATUS-WS
041650        MOVE 'P04896 - ERRO NA PRIMEIRA LEITURA TabUtils' TO
041660                          MENSAGEM-ERRO-WS
041670        PERFORM 999-99-ROT-ERRO.                                  00041670
041680     MOVE HF-DATA-ATL-EXT TO DATA-RED-WS.                         00041680
041690     MOVE 01 TO DIA-EXT-WS.                                       00041690
041700     MOVE MES-WS TO MES-EXT-WS.                                   00041700
041710     CALL 'M0952000' USING ANO-WS ANO-EXT-WS.                     00041710
041720                                                                  00041720
041730     ACCEPT DATA-CORRENTE-WS FROM DATE.                           00041730
041740                                                                  00041740
041750     MOVE DIA-CORRENTE-WS  TO DIA-HOJE-WS.                        00041750
041760     MOVE MES-CORRENTE-WS  TO MES-HOJE-WS.                        00041760
041770     MOVE ANO-CORRENTE-WS  TO ANO-HOJE-WS.                        00041770
041780     MOVE DIA-HOJE-WS      TO ANO-EVT-WS DIA-AUX.                 00041780
041790     MOVE MES-HOJE-WS      TO MES-EVT-WS MES-AUX.                 00041790
041800     MOVE ANO-HOJE-WS      TO DIA-EVT-WS ANO-AUX.                 00041800
041810                                                                  00041810
041820     MOVE ZEROS TO CONTA-CH-D07 CONTA-CH-F10                      00041820
041830                   CH-TIPOREG-WS.                                 00041830
041840                                                                  00041840
041850     OPEN INPUT D27028.                                           00041850
041860     IF FS-D27028 NOT EQUAL '00' AND '97'                         00041860
041870        MOVE FS-D27028   TO FILE-STATUS-WS                        00041870
041880        MOVE 'P04808 - ERRO NA ABERTURA D27028 **'                00041880
041890                         TO MENSAGEM-ERRO-WS                      00041890
041900        PERFORM 999-99-ROT-ERRO.                                  00041900
041910                                                                  00041910
041920     OPEN INPUT D86041.                                           00041920
041930     IF FS-D86041 NOT EQUAL '00' AND '97'                         00041930
041940        MOVE FS-D86041   TO FILE-STATUS-WS                        00041940
041950        MOVE 'P04808 - ERRO NA ABERTURA D86041 **'                00041950
041960                         TO MENSAGEM-ERRO-WS                      00041960
041970        PERFORM 999-99-ROT-ERRO.                                  00041970
041980                                                                  00041980
042060     OPEN INPUT D15903.                                           00042060
042070     IF FS-D15903 NOT EQUAL '00' AND '97'                         00042070
042080        MOVE FS-D15903   TO FILE-STATUS-WS                        00042080
042090        MOVE 'P04808 - ERRO NA ABERTURA D15903 **'                00042090
042100                         TO MENSAGEM-ERRO-WS                      00042100
042110        PERFORM 999-99-ROT-ERRO.                                  00042110
042120                                                                  00042120
042130     OPEN INPUT D19401.                                           00042130
042140     IF FS-D19401 NOT EQUAL '00' AND '97'                         00042140
042150        MOVE FS-D19401   TO FILE-STATUS-WS                        00042150
042160        MOVE 'P04808 - ERRO NA ABERTURA D19401 **'                00042160
042170                         TO MENSAGEM-ERRO-WS                      00042170
042180        PERFORM 999-99-ROT-ERRO.                                  00042180
042190                                                                  00042190
042210*----------------------------------------------------------------*00042210
042220 11-10-ABRE-ARQ-AGENCIAS.
042230                                                                  00042230
042240     OPEN I-O ArqAgencias.
042250
042260     IF  STATUS-D04-WS EQUAL '93'
042270         CALL 'M095DLAY' USING INTERVALO-WS
042280     ELSE
042290        IF STATUS-D04-WS EQUAL '00' OR '97'
042300           MOVE 1 TO SW-Abertura-ArqAgencias
042310        ELSE
042320           MOVE STATUS-D04-WS TO FILE-STATUS-WS
042330           MOVE 'P04808 ERRO DE ABERTURA DO ArqAgencias**'
042340                                    TO MENSAGEM-ERRO-WS
042350           PERFORM 999-99-ROT-ERRO.
042360
042370*----------------------------------------------------------------*
042380 12-10-ABRE-ARQ-CTAS-UPDATE.
042390*
042400     OPEN EXTEND ArqContasUpdate.
042410     IF  STATUS-ARQ-UPDT-WS EQUAL '93'
042420         CALL 'M095DLAY' USING INTERVALO-WS
042430     ELSE
042440     IF  STATUS-ARQ-UPDT-WS EQUAL '00' OR '97'
042450         MOVE 1 TO SW-Abertura-ArqCtasUpdate
042460     ELSE
042470     MOVE STATUS-ARQ-UPDT-WS TO FILE-STATUS-WS
042480     MOVE 'P04808 ERRO DE ABERTURA DO ArqContasUpdate **'
042490         TO MENSAGEM-ERRO-WS
042500     PERFORM 999-99-ROT-ERRO.
042510*----------------------------------------------------------------*
042520 13-10-ABRE-ARQ-CTAS-BASE.
042530*
042540     OPEN INPUT ArqContasBase.
042550     IF  FS-ArqContasBase EQUAL '00' OR '97'
042560         MOVE 1 TO SW-Abertura-ArqContasBase
042570     ELSE                                                         00042570
042580     MOVE FS-ArqContasBase TO FILE-STATUS-WS                      00042580
042590     MOVE 'P04808 ERRO DE ABERTURA DO D04808 **'                  00042590
042600         TO MENSAGEM-ERRO-WS                                      00042600
042610     PERFORM 999-99-ROT-ERRO.                                     00042610
042620*                                                                 00042620
042640*----------------------------------------------------------------*00042640
042650 20-05-LEITURAS-INICIAIS.                                         00042650
042660*                                                                 00042660
042670     PERFORM 22-20-LEITURA-HEADER-D04.                            00042670
042680                                                                  00042680
042690     MOVE 1 TO SW-PRIMEIRA-LEITURA-F10.                           00042690
042700                                                                  00042700
042710     MOVE 0 TO ACUM-REG-AG-ANT.                                   00042710
042720                                                                  00042720
042730     MOVE 1 TO SW-PRIMEIRA-LEITURA-D07.                           00042730
042740                                                                  00042740
042750     PERFORM 220-35-LEITURA-D07.                                  00042750
042760                                                                  00042760
042770     MOVE CH-DATA-D07 TO DATA-RODADA-WS                           00042770
                               DATA-MOV-WS.
042790     MOVE DIA-MOV-WS  TO DIA-REC-WS.                              00042790
042800     MOVE MES-MOV-WS  TO MES-REC-WS.                              00042800
042810     MOVE ANO-MOV-WS  TO ANO-REC-WS.                              00042810
042820     MOVE DATA-REC-WS TO DATA-MOV-WS.                             00042820
           MOVE DIA-RODADA-WS TO DIA-RODADA-PROC-WS                     00042823
           MOVE MES-RODADA-WS TO MES-RODADA-PROC-WS                     00042824
           MOVE ANO-RODADA-WS TO AA-RODADA-PROC-WS                      00042825
           CALL 'M0952000' USING ANO-RODADA-WS ANO-RODADA-PROC-WS.
042830                                                                  00042854
042840     MOVE 0 TO SW-PRIMEIRA-LEITURA-D07.                           00042855
042850                                                                  00042856
042860     IF CHAVE-D07-WS = HIGH-VALUE                                 00042860
042870         PERFORM 999-05-FIM-ANORMAL.                              00042870
042880*                                                                 00042880
042890     PERFORM 999-97-ABRE-TAB-UTILS.
042900
042910     PERFORM 999-36-PROCESSA-ARQ-TAXA.
042920     MOVE 0 TO SW-FIM-PROCESSAMENTO.
042930
042940     PERFORM 999-98-FECHA-TAB-UTILS.

042950*----------------------------------------------------------------*
      *  VERIFICAR PROCESSAMENTO DURANTE PERIODO ISENCAO IOF, PARA LIGAR
      *  FLAG E VALIDA-LA EM TODOS OS CALCULOS IOF DO PROGRAMA.
042950*----------------------------------------------------------------*
           PERFORM 99-VER-SE-OPER-ISENTA-IOF.

042950*----------------------------------------------------------------*
042960 22-20-LEITURA-HEADER-D04.
042970*
042980     MOVE 1 TO COD-AG-D04.
042990     READ ArqAgencias.
043000     IF  STATUS-D04-WS NOT EQUAL '00'
043010         MOVE STATUS-D04-WS TO FILE-STATUS-WS
043020         MOVE 'P04808 ERRO DE LEITURA DO ArqAgencias' TO
043030                   MENSAGEM-ERRO-WS
043040         PERFORM 999-99-ROT-ERRO.                                 00043040
043050     MOVE SEQ-MST-ATL-D04 TO SEQ-D04-WS.                          00043050
043060     MOVE QDE-AGENCIA-ATL-D04     TO ACUM-QDE-AGENCIA.            00043060
043070     MOVE REG-EXTRATO-ATL-D04     TO ACUM-REG-EXTRATO.            00043070
043080     MOVE REG-CORRENTISTA-ATL-D04 TO ACUM-REG-CORRENTISTA.        00043080
043090     MOVE SALDO-MST-ATL-D04       TO ACUM-SALD-ATL-D04-WS.        00043090
043100                                                                  00043100
043130*----------------------------------------------------------------*00043130
DOCINI****F* P04808/35-PROCESSA-AGENCIA
DOCTXT* OBJETIVO
DOCTXT*   Dar inicio ao processamento de uma determinada agencia.
DOCTXT*   O arquivo de transacoes deve ter sido ordenado de acordo com
DOCTXT*   as agencias para que o algoritmo de balance line funcione.
DOCTXT* FLUXO
DOCTXT*   O paragrafo deve ser executado sempre que se finalizarem as
DOCTXT*   contas e transacoes referentes a uma agencia. Dentre as acoes
DOCTXT*   deste paragrafo, destaca-se:
DOCTXT*   * Recuperacao do dia da semana;
DOCTXT*   * Calculo do dia util anterior para efeito de devolucao de
DOCTXT*     encargos;
DOCTXT*   * Atualizacao do arquivo de agencias (D04804) com os
DOCTXT*     contadores de registros e hora de atualizacao;
DOCTXT*   * Calculo do proximo dia util para a agencia sendo processada
DOCTXT*   * Primeira leitura do arquivo de contas (D04808) para a
DOCTXT*     agencia sendo processada;
DOCTXT*   * Execucao do algoritmo de balance line para processamento
DOCTXT*     das contas e de suas transacoes.
DOCEND******
043140 35-PROCESSA-AGENCIA.                                             00043140
043150*                                                                 00043150
043160     PERFORM 999-45-DIA-SEMANA.                                   00043160
043170     MOVE 1 TO SW-PRIMEIRA-LEITURA-F10                            00043170
043180               SW-PRIMEIRA-LEITURA-D07.                           00043180
043190     MOVE 1 TO COD-AG-D04.                                        00043190
043200     READ ArqAgencias.
043210     IF  STATUS-D04-WS NOT EQUAL '00'
043220         MOVE STATUS-D04-WS TO FILE-STATUS-WS
043230         MOVE 'P04808 ERRO LEITURA NO ArqAgencias'
043240                 TO MENSAGEM-ERRO-WS                              00043240
043250         PERFORM 999-99-ROT-ERRO.                                 00043250

           MOVE DT-POS-MST-ANT-D04     TO DT-ULT-AG-WS
           PERFORM 999-64-CALC-DIA-UTIL-ANT-DEVOL

043260     MOVE CH-DATA-D07 TO DATA-MOV-WS.                             00043260
043270     MOVE DIA-MOV-WS  TO DIA-REC-WS DIA-PROC-WS.                  00043270
043280     MOVE MES-MOV-WS  TO MES-REC-WS.                              00043280
043290     MOVE ANO-MOV-WS  TO ANO-REC-WS.                              00043290
043300     MOVE DATA-REC-WS TO DATA-MOV-WS.                             00043300
           MOVE ANO-INV         TO ANO-APLIC-WS
           IF MES-MOV-WS = 01
174440        MOVE NUM-DIAS-MES-TAB (12) TO ULT-DIA-MES-ANT-WS          00174440
174450     ELSE                                                         00174450
              MOVE NUM-DIAS-MES-TAB (MES-MOV-WS - 1) TO
174460                                           ULT-DIA-MES-ANT-WS     00174460
           END-IF.
043310     ADD 1                     TO SEQ-D04-WS.                     00043310
043320     MOVE 1                    TO COD-AG-D04.                     00043320
043330     MOVE DATA-MOV-WS          TO DT-POS-MST-ATL-D04.             00043330
043340     MOVE SEQ-D04-WS           TO SEQ-MST-ATL-D04                 00043340
043350     MOVE DATA-EVT-WS          TO DT-COR-MST-ATL-D04.             00043350
043360     ACCEPT HR-COR-MST-ATL-D04 FROM TIME.                         00043360
043370     MOVE ACUM-QDE-AGENCIA     TO QDE-AGENCIA-ATL-D04.            00043370
043380     MOVE ACUM-REG-EXTRATO     TO REG-EXTRATO-ATL-D04.            00043380
043390     MOVE ACUM-REG-CORRENTISTA TO REG-CORRENTISTA-ATL-D04.        00043390
043400     MOVE ACUM-SALD-ATL-D04-WS TO SALDO-MST-ATL-D04.              00043400
043410     MOVE 'OK'                 TO COD-ERRO-D04.                   00043410
043420     MOVE SPACES               TO ESP-D04.                        00043420
043430     REWRITE REG-D04.                                             00043430
043440     IF  STATUS-D04-WS NOT EQUAL '00'                             00043440
043450         MOVE STATUS-D04-WS TO FILE-STATUS-WS
043460         MOVE 'P04808 ERRO GRAVACAO NO ArqAgencias' TO
                    MENSAGEM-ERRO-WS
043470         PERFORM 999-99-ROT-ERRO.
043480     MOVE CH-CODAG-D07 TO COD-AG-D04.

           DISPLAY 'PROCESSANDO AGENCIA ' CH-CODAG-D07 ' ' DT-ULT-AG-WS
             ' ' DATA-SIEF-DEVOL-WS
                                                                        00043491
           PERFORM 99-CALCULA-PROX-DIA-UTIL                             00043493
           PERFORM 99-CALCULA-QTD-DIAS-CORRIDOS                         00043495
                                                                        00043497
043500     READ ArqAgencias.
043510     IF  STATUS-D04-WS NOT EQUAL '00'
043520         MOVE STATUS-D04-WS TO FILE-STATUS-WS
043530         MOVE '***P04808 ERRO NA LEITURA DO ArqAgencias'
043540                  TO MENSAGEM-ERRO-WS
043550         PERFORM  999-99-ROT-ERRO.
043560     MOVE 0 TO SEQ-POS-REL-WS.
043570     MOVE CH-CODAG-D07 TO COD-AG-ANT-D07-WS.
043580     MOVE SEQ-MST-ANT-D04 TO SEQUENCIAL-F10-ANT.
043590     MOVE CH-CODAG-D07 TO CH-AG-F10.
043600     MOVE 0            TO CH-CONTA-F10.
043610     MOVE '0'          TO CH-DIGITO-F10.
043620     MOVE 1            TO CH-TIPOREG-F10.
043630     MOVE 0            TO CH-SEQUENCIAL-F10.
043640     START ArqContasBase.
043650     IF  FS-ArqContasBase NOT EQUAL '00'
043660         MOVE FS-ArqContasBase TO FILE-STATUS-WS
043670         MOVE '***P04808 ERRO NO START DO D04808 '
043680                    TO MENSAGEM-ERRO-WS
043690         PERFORM  999-99-ROT-ERRO.
043700     PERFORM 60-35-LEITURA-F10.
043710
043720     MOVE SEQUENCIAL-F10-ANT TO SEQ-ANT-D04-WS.
043730     MOVE CH-AG-F10          TO COD-AG-ANT-F10-WS.
043740     PERFORM 35-32-BALANCE-LINE UNTIL
043750              CHAVE-MENOR = HIGH-VALUE.
043760
043770     MOVE ZEROS TO CHAVE-MENOR CHAVE-F10-WS.
043780     IF  NOT FIM-PROCESSAMENTO
043790         MOVE CH-CODAG-D07 TO COD-AG-CH-D07 AGENCIA-D07-WS
043800         MOVE CH-CONTA-D07 TO CONTA-CH-D07                        00043800
043810         IF GRADE-D07                                             00043810
043820            MOVE 1 TO TPREG-CH-D07                                00043820
043830         ELSE                                                     00043830
043840             MOVE 5 TO TPREG-CH-D07.                              00043840
043850     ADD 1                   TO IND-TAB-D04.                      00043850
043860     MOVE COD-AG-ANT-F10-WS  TO COD-AG-TAB (IND-TAB-D04).         00043860
043870     MOVE DT-POS-MST-ANT-D04 TO DT-POS-MST-ANT-TAB (IND-TAB-D04). 00043870
043880     MOVE SALDO-MST-ANT-D04  TO SALDO-MST-ANT-TAB (IND-TAB-D04).  00043880
043890     MOVE DT-COR-MST-ANT-D04 TO DT-COR-MST-ANT-TAB (IND-TAB-D04). 00043890
043900     MOVE HR-COR-MST-ANT-D04 TO HR-COR-MST-ANT-TAB (IND-TAB-D04). 00043900
043910     ACCEPT HR-COR-MST-ATL-TAB (IND-TAB-D04) FROM TIME.           00043910
043920     MOVE QDE-AGENCIA-ANT-D04 TO                                  00043920
043930                     QDE-AGENCIA-ANT-TAB (IND-TAB-D04).           00043930
043940     MOVE REG-EXTRATO-ANT-D04 TO                                  00043940
043950                      REG-EXTRATO-ANT-TAB (IND-TAB-D04).          00043950
043960     MOVE REG-CORRENTISTA-ANT-D04 TO                              00043960
043970                      REG-CORRENTISTA-ANT-TAB (IND-TAB-D04).      00043970
043980     MOVE DATA-MOV-WS       TO DT-POS-MST-ATL-TAB (IND-TAB-D04).  00043980
043990     MOVE DATA-EVT-WS       TO DT-COR-MST-ATL-TAB (IND-TAB-D04).  00043990
044000     MOVE SEQ-D04-WS        TO SEQ-MST-ATL-TAB (IND-TAB-D04).     00044000
044010     MOVE SEQ-ANT-D04-WS    TO SEQ-MST-ANT-TAB (IND-TAB-D04).     00044010
044020     MOVE ACUM-SALDO-DEP-WS TO SALDO-MST-ATL-TAB (IND-TAB-D04).   00044020
044030     MOVE CONT-QDE-AGENCIA  TO QDE-AGENCIA-ATL-TAB (IND-TAB-D04). 00044030
044040     MOVE CONT-REG-EXTRATO  TO REG-EXTRATO-ATL-TAB (IND-TAB-D04). 00044040
044050     MOVE CONT-REG-CORRENTISTA TO                                 00044050
044060                           REG-CORRENTISTA-ATL-TAB (IND-TAB-D04). 00044060
044070     ADD SALDO-MST-ANT-D04 TO ACUM-SALD-ANT-D04-WS.               00044070
044080     ADD SALDO-MST-ATL-TAB (IND-TAB-D04) TO ACUM-SALD-ATL-D04-WS. 00044080
044090     ADD CONT-REG-EXTRATO     TO ACUM-REG-EXTRATO.                00044090
044100     ADD CONT-REG-CORRENTISTA TO ACUM-REG-CORRENTISTA.            00044100
044110     ADD CONT-QDE-AGENCIA     TO ACUM-QDE-AGENCIA.                00044110
044120     MOVE 0 TO CONT-REG-EXTRATO CONT-REG-CORRENTISTA              00044120
044130               CONT-QDE-AGENCIA.                                  00044130
044140     MOVE 0 TO ACUM-SALDO-DEP-WS.                                 00044140
044150                                                                  00044150
044160*----------------------------------------------------------------*00044160
DOCINI****F* P04808/35-32-BALANCE-LINE
DOCTXT* OBJETIVO
DOCTXT*   Identificar o arquivo para o qual a chave do balance line
DOCTXT*   deve apontar.
DOCTXT* OBSERVACOES
DOCTXT*   O algoritmo de balance line tenta optimizar o tempo de
DOCTXT*   de execucao atraves de selecao dos dados de entradas para
DOCTXT*   processamento. Para isso, eh necessario que os arquivos
DOCTXT*   estejam ordenados conforme uma chave comum. Neste caso, os
DOCTXT*   arquivos foram previamente ordenados com base na seguinte
DOCTXT*   chave:
DOCTXT*     CHAVE-BALANCE-LINE
DOCTXT*         CODIGO-AGENCIA
DOCTXT*         CONTA-CORRENTE
DOCTXT*         TIPO-REGISTRO  -> Registro de Guia ou Transacao
DOCTXT*   Dessa forma, o algoritmo consegue processar sequencialmente n
DOCTXT*   arquivos de entrada, para este caso, temos o arquivo de
DOCTXT*   contas, o arquivo de agencias e o arquivo de transacoes.
DOCTXT*   O arquivo de agencia dita o inicio do algoritmo, fazendo com
DOCTXT*   que a chave do balance line aponte para a agencia sendo
DOCTXT*   processada.
DOCTXT*   A estrutura de dados referentes aos grupos de itens
DOCTXT*   CHAVE-MENOR, CHAVE-F10-WS e CHAVE-D07-WS eh igual e com base
DOCTXT*   nas atribuicoes durante a execucao, o programa decide qual
DOCTXT*   arquivo deve ler. De uma forma geral obedece a regra:
DOCTXT*   Para cada agencia->Leia uma conta->Leia todas as transacoes
DOCTXT*   daquela conta. Caso a conta nao exista (a chave da transacao
DOCTXT*   eh maior que a chave da conta), entao devemos criar uma conta
DOCTXT*   a classificar, visto que nao recebemos transacoes para contas
DOCTXT*   inexistentes e  se uma transacao eh para uma conta menor que
DOCTXT*   a conta sendo processada, entao a conta ainda nao existe.
DOCTXT*
DOCEND******
044170 35-32-BALANCE-LINE.                                              00044170
044180*                                                                 00044180
044190     IF CHAVE-F10-WS LESS CHAVE-D07-WS                            00044190
044200         MOVE CHAVE-F10-WS TO CHAVE-MENOR                         00044200
044210     ELSE                                                         00044210
044220         MOVE CHAVE-D07-WS TO CHAVE-MENOR.                        00044220
044230                                                                  00044230
044240     IF CHAVE-MENOR NOT = HIGH-VALUE                              00044240
044250         PERFORM 35-35-SELECIONA-PERNA.                           00044250
044260                                                                  00044260
044270*----------------------------------------------------------------*00044270
DOCINI****F* P04808/35-35-SELECIONA-PERNA
DOCTXT* OBJETIVO
DOCTXT*   Continuacao do algoritmo de balance line. Seleciona acao a ser
DOCTXT*   tomada: Ler conta ou processar transacoes de uma conta.
DOCTXT*   Ao final, salva o estado final da conta sendo processada no
DOCTXT*   arquivo D04809, que contenha o estado final das contas apos
DOCTXT*   o processamento.
DOCTXT*   O processamento das transacoes acontece ate que uma transacao
DOCTXT*   da proxima conta seja lida.
DOCEND******
044280 35-35-SELECIONA-PERNA.                                           00044280
044290                                                                  00044290
           MOVE 0 TO MOSTRA-DISPLAY-WS

044300     IF CHAVE-F10-WS = CHAVE-MENOR                                00044300
044310         PERFORM 40-35-PERNA-F10.                                 00044310
044330     PERFORM 70-35-PERNA-D07                                      00044330
044340         UNTIL CHAVE-D07-WS GREATER CHAVE-MENOR.                  00044340
044350                                                                  00044350
044360     PERFORM 38-35-PERNA-GRAVACAO.                                00044360
044370                                                                  00044370
044380*----------------------------------------------------------------*00044380
044390 38-35-PERNA-GRAVACAO.                                            00044390

044410     IF REG-EXT-WS AND INICIO-MES                                 00044410
044420         MOVE 1 TO SW-GRAVACAO.                                   00044420

044440     IF NAO-GRAVA                                                 00044440
044450         MOVE ZEROS TO SW-GRAVACAO SW-F10 SEQ-EXT-WS              00044450
044460     ELSE                                                         00044460
               MOVE ZEROS              TO JUR-DEVOL-1DIA-WS
               MOVE ZEROS              TO IOF-DEVOL-1DIA-WS
               IF SLD-DEVOL-WS       GREATER ZEROS AND
                  LIMITE-ANTERIOR-WS GREATER ZEROS
                  PERFORM 999-100-PERCENT-UTILIZ-DEVOL
                  PERFORM 243-38-CALCULO-JUROS-DEVOL
                  IF CTA-EMPRESARIAL OR CH-EMPRESA
                     MOVE CPF-CGC-RED-WS   TO CPF-CGC-AUX
                     MOVE SPACES           TO CH-ISENTO-IOF
                     PERFORM 99-VERIFICA-ISENCAO-IOF
                     IF ISENTO-IOF
                        NEXT SENTENCE
                     ELSE
                        PERFORM 243-38-CALCULO-IOF-DEVOL
                     END-IF
                  ELSE
                     PERFORM 243-38-CALCULO-IOF-DEVOL
                  END-IF
               ELSE
094390            MOVE ZEROS TO VLR-JUROS-DEVOL-PF-WS                   00094390
094400                          VLR-JUROS-DEVOL-PJ-WS                   00094400
094400                          VLR-JUROS-DEVOL-PJ-PP-WS                00094400
094410                          VLR-JUROS-DEVOL-CE-WS                   00094410
               END-IF
      * Aplicar regras de validacao apenas para funcionarios e bolsistas
      * Tipo-Pessoa = E ou W.
               IF  TP-PESSOA-RED-WS = 'W' OR 'E'
                   PERFORM ALTERA-CADASTRO-FUNCIONARIO
               END-IF
044470         PERFORM 235-35-PROCESSA-GRAVACAO                         00044470
           END-IF.
044480                                                                  00044480
044510*----------------------------------------------------------------*00044510
044520 40-35-PERNA-F10.                                                 00044520
044530     MOVE 1 TO SW-F10 SW-CALCULAR-NUMEROS.                        00044530
044540     MOVE ZEROS TO INDICA-WS.                                     00044540
           INITIALIZE REG-EXTRATO-WS

           IF REG-COR-F10
              MOVE SALDO-ANTERIOR-F10 TO SLD-ANT-ANTERIOR-WS

              IF SLD-ANT-ANTERIOR-WS < ZEROS
                 MOVE SLD-ANT-ANTERIOR-WS TO SLD-DEV-ANT-WS
              ELSE
                 MOVE ZEROS               TO SLD-DEV-ANT-WS
              END-IF

              MOVE EMP-VENC-F10       TO DATA-RED-DEVOL-WS
134070        MOVE DIA-DEVOL-WS       TO DIA-AUX-Y2-INV-DEVOL           00134070
134080        MOVE MES-DEVOL-WS       TO MES-AUX-Y2-INV-DEVOL           00134080
134090        CALL 'M0952000' USING ANO-DEVOL-WS ANO-AUX-Y2-INV-DEVOL.  00134090

044550     MOVE REG-TRAILLER-AG-F10 TO REG-TRAILLER-AG-RED-WS           00044550
044560                                 REG-EXTRATO-WS.                  00044560
044570     IF HEAD-AG-WS                                                00044570
044580        MOVE HF-DATA-ATL-WS TO DATA-MENOR-RED                     00044580
044590                               DATA-ATL-ANTERIOR-AG-RED-WS        00044590
044600        MOVE HAG-INDICADOR-WS TO INDICA-IMPLA-WS                  00044600
044610        MOVE HAG-INDICA-LISTAO-RED-WS TO LISTAO-WS                00044610
044620******************      SPREAD       *******************          00044620
044630        MOVE HAG-VRMIN-RED-WS         TO DIAS-UTEIS-SPREAD-WS     00044630
044650******************      SPREAD       *******************          00044650
044660        PERFORM 999-65-TESTA-SE-HOUVE-FERIADO                     00044660
044670        PERFORM 999-50-CALCULO-PROXIMA-DATA                       00044670
044680        PERFORM 40A-35-TESTA-INDICA-LISTAO.                       00044680

044690     IF REG-COR-WS                                                00044690
              PERFORM 999-120-ACESSA-V048CCAD
044700        IF CONTA-A-CLASS                                          00044700
044710           IF NOME-RED-WS EQUAL SPACES                            00044710
044720              IF (SLD-DEP-RED-WS EQUAL ZEROS) AND                 00044720
044730*                (CH-CONTA-WS NOT EQUAL 89998) AND                00044730
044740*                (CH-CONTA-WS NOT EQUAL 89999) AND                00044740
044750                 (CH-CONTA-WS NOT EQUAL 90388)                    00044750
044760                 MOVE 0 TO SW-SALDO-ZERADO                        00044760
044770                 MOVE SPACES TO ENDERECO-WS                       00044770
044780                 MOVE ZEROS TO GR-DIFERENCA                       00044780
044790                 PERFORM 195-35-CANCELA-CONTA-CORRENTE.           00044790
044800                                                                  00044800
045030*----------------------------------------------------             00045030
045040     IF REG-COR-WS                                                00045040
               MOVE ZEROS TO SALDO-BLOQUEADO-WS
                             SALDO-ANTERIOR-BLOQUEADO-WS
045050         MOVE INDICACOES-WS TO INDICA-WS                          00045050
045060         PERFORM 41-40-ACUMULA-RAP-MENSAL                         00045060
045070         PERFORM 42-35-GUARDA-SALDO-ANTERIOR                      00045070
045080         PERFORM 42-35-COMPOE-SPREAD-ANT                          00045080
045090*        PERFORM 56-35-TESTA-CAPITALIZ-IOC-FER                    00045090
045100         PERFORM 56-35-GUARDA-SALDO-DEV-ANT                       00045100
045110         PERFORM 999-39-VERIFICA-SLD-DECORR                       00045110
045120         PERFORM 57-35-TESTA-SLD-DEV-LIM                          00045120
045130         PERFORM 40B-35-VERIFICA-MOVIMENTO                        00045130
045140         ADD EMP-NUM-EXCED-FUNC-RED-WS TO EMP-NUM-RED-WS          00045140
045150         PERFORM 41A-35-TESTE-ADIANTAMENTOS                       00045150
045160         MOVE ZEROS TO CRED-ANTECIP-WS                            00045160
045170         MOVE ZEROS TO EXT-COD-MENS-WS                            00045170
045180                       VALOR-ACUM-ADIANT-RED-WS                   00045180
045190                       EMP-NUM-EXCED-FUNC-RED-WS                  00045190
045200         MOVE SPACES TO INDICADOR-JUROS-WS                        00045200
045210         PERFORM 42-35-CALCULA-INSUF-ANTERIOR                     00045210
045220         PERFORM 42-36-ACUMULA-ATL-DIAS-PARAL                     00045220
045230         MOVE 1 TO IND-BLOQUEIO-1                                 00045230
045240         MOVE ZERO TO IND-BLOQUEIO-2                              00045240
045250         MOVE ZEROS TO DISPON-WS                                  00045250
045260         PERFORM 176-35-CONTROLA-REMANEJA-SMED                    00045260
045290       MOVE QDE-CHQ-COMP-INTERNA-RED-WS TO QDE-CHQ-COMP-INTERNA-WS00045290
045300       MOVE QDE-CHQ-PG-CAIXA-RED-WS     TO QDE-CHQ-PG-CAIXA-WS    00045300
045310       MOVE QDE-CHQ-AVULSO-RED-WS       TO QDE-CHQ-AVULSO-WS      00045310
045320       MOVE QDE-SAQ-CARTAO-CAIXA-RED-WS TO QDE-SAQ-CARTAO-CAIXA-WS00045320
045330       MOVE QDE-SAQ-CARTAO-RED-WS       TO QDE-SAQ-CARTAO-WS      00045330
045340       MOVE QDE-SAQ-BCO24HS-RED-WS      TO QDE-SAQ-BCO24HS-WS     00045340
045350       MOVE QDE-SAQ-BB-RED-WS           TO QDE-SAQ-BB-WS          00045350
045360       MOVE QDE-SAQ-RVA-RED-WS          TO QDE-SAQ-RVA-WS         00045360
045380         MOVE QDE-SAQUE-CARTAO-DO-MES-RED-WS TO                   00045380
045390                                         QDE-SAQUE-CASH-WS        00045390
045400         MOVE QDE-CHQ-PROCES-RED-WS TO QDE-CHQ-PROCES-WS          00045400
045410         MOVE QDE-SAQ-CARTAO-CTASAL-RED-WS TO                     00045410
045420              QDE-SAQ-CARTAO-CTASAL-WS                            00045420

045430         PERFORM 175-35-REMANEJA-BLOQUEIOS                        00045430
045440               UNTIL IND-BLOQUEIO-1 = 21                          00045440
      ******************************************************************
      * NESTE MOMENTO, TODOS OS SALDOS BLOQUEADOS JA FORAM
      *                                            REMANEJADOS.
      * GUARDE O SALDO BLOQUEADO PARA USO NA APROPRIACAO DE RAP, SE
      * NECESSARIO.
               COMPUTE SALDO-BLOQUEADO-WS =
                    ( SLD-BLO-RED-WS ( 1 ) + SLD-BLO-RED-WS ( 2 ) +
                      SLD-BLO-RED-WS ( 3 ) + SLD-BLO-RED-WS ( 4 ) +
                      SLD-BLO-RED-WS ( 5 ) + SLD-BLO-RED-WS ( 6 ) +
                      SLD-BLO-RED-WS ( 7 ) + SLD-BLO-RED-WS ( 8 ) +
                      SLD-BLO-RED-WS ( 9 ) + SLD-BLO-RED-WS ( 10 ) +
                      SLD-BLO-RED-WS ( 11 ) + SLD-BLO-RED-WS ( 12 ) +
                      SLD-BLO-RED-WS ( 13 ) + SLD-BLO-RED-WS ( 14 ) +
                      SLD-BLO-RED-WS ( 15 ) + SLD-BLO-RED-WS ( 16 ) +
                      SLD-BLO-RED-WS ( 17 ) + SLD-BLO-RED-WS ( 18 ) +
                      SLD-BLO-RED-WS ( 19 ) + SLD-BLO-RED-WS ( 20 ) +
                      SLD-BLO-RED-WS ( 21 ) )
      ******************************************************************
045450         MOVE E-RUA-RED-WS      TO RUA-WS                         00045450
045460         MOVE E-BAIR-RED-WS     TO BAIR-WS                        00045460
045470         MOVE COD-POSTAL-RED-WS TO CEP-WS                         00045470
045480         MOVE E-CID-RED-WS      TO CID-WS                         00045480
045490         MOVE E-EST-RED-WS      TO EST-WS                         00045490
045500         MOVE E-FONE-RED-WS     TO FONE-WS                        00045500
045510         MOVE EMP-DATA-RED-WS   TO DATA-CONTRATO-RED-WS           00045510
045520         MOVE DIA-CONTR-WS      TO DIA-CONTR-INV                  00045520
045530         MOVE MES-CONTR-WS      TO MES-CONTR-INV                  00045530
045540         MOVE ANO-CONTR-WS      TO ANO-CONTR-INV                  00045540
045550         MOVE EMP-VENC-RED-WS   TO DATA-VENCIM-RED-WS             00045550
045560         PERFORM 41B-35-TESTE-VENC-CONTRATO                       00045560
045570         MOVE EMP-LIM-RED-WS TO LIMITE-ANTERIOR-WS                00045570
045580     ELSE                                                         00045580
045590         IF REG-EXT-WS                                            00045590
                  MOVE EXT-AG-WS      TO AGE-EXT-WS
045600            MOVE EXT-CONTA-WS   TO CONTA-EXT-WS                   00045600
045610            MOVE EXT-SEQ-WS     TO SEQ-EXT-WS                     00045610
045620            MOVE REG-EXTRATO-WS TO EXTRA-EXTRA-WS.                00045620
045630                                                                  00045630
045650     IF AGENCIA-F10-WS = AGENCIA-D07-WS                           00045650
045660         PERFORM 60-35-LEITURA-F10                                00045660
045670     ELSE                                                         00045670
045680         IF CHAVE-F10-WS NOT = HIGH-VALUE                         00045680
045690             PERFORM 45-35-TESTA-CASAMENTO.                       00045690
045700                                                                  00045700
045710*----------------------------------------------------------------*00045710
045720  40A-35-TESTA-INDICA-LISTAO.                                     00045720
045730                                                                  00045730
045740     IF  SEXTA                                                    00045740
045750         MOVE 2 TO HAG-INDICA-LISTAO-RED-WS                       00045750
045760     ELSE                                                         00045760
045770         IF SEGUNDA                                               00045770
045780            IF  HAG-INDICA-LISTAO-RED-WS NOT EQUAL 2              00045780
045790                MOVE 3 TO HAG-INDICA-LISTAO-RED-WS                00045790
045800            ELSE                                                  00045800
045810                ADD 1 TO HAG-INDICA-LISTAO-RED-WS                 00045810
045820         ELSE                                                     00045820
045830             IF  TERCA                                            00045830
045840                 IF  HAG-INDICA-LISTAO-RED-WS NOT EQUAL 3         00045840
045850                     MOVE 4 TO HAG-INDICA-LISTAO-RED-WS           00045850
045860                 ELSE                                             00045860
045870                     ADD 1 TO HAG-INDICA-LISTAO-RED-WS            00045870
045880             ELSE                                                 00045880
045890                 IF  QUARTA                                       00045890
045900                     IF  HAG-INDICA-LISTAO-RED-WS NOT EQUAL 4     00045900
045910                         MOVE 5 TO HAG-INDICA-LISTAO-RED-WS       00045910
045920                     ELSE                                         00045920
045930                         ADD 1 TO HAG-INDICA-LISTAO-RED-WS        00045930
045940                 ELSE                                             00045940
045950                     IF  QUINTA                                   00045950
045960                         IF  HAG-INDICA-LISTAO-RED-WS NOT EQUAL 5 00045960
045970                             MOVE 1 TO HAG-INDICA-LISTAO-RED-WS   00045970
045980                         ELSE                                     00045980
045990                             ADD 1 TO HAG-INDICA-LISTAO-RED-WS.   00045990
046000                                                                  00046000
046010*----------------------------------------------------------------*00046010
046020  40B-35-VERIFICA-MOVIMENTO.                                      00046020
046030                                                                  00046030
046040      IF  MOVIMENTACAO-RED-WS EQUAL 1                             00046040
046050          MOVE 1 TO SW-GERA-FICHA                                 00046050
046060                    SW-MOVIMENTACAO.                              00046060
046070                                                                  00046070
046080*----------------------------------------------------------------*00046080
DOCINI****F* P04808/41-40-ACUMULA-RAP-MENSAL
DOCTXT* OBJETIVO
DOCTXT*   Rotina executada durante a leitura da conta, eh a primeira de
DOCTXT*   chamada durante a leitura da conta (apos salvar dados da conta
DOCTXT*   para comparacao).
DOCTXT*   A rotina so e efetivamente executada se for o inicio de mes,
DOCTXT*   primeiro dia util.
DOCTXT*   1 - Verifica se cheque vencido;
DOCTXT*   2
DOCTXT*
DOCTXT*
DOCEND******
        41-40-ACUMULA-RAP-MENSAL.
046100                                                                  00046100
046110     IF INICIO-MES                                                00046110
046120        PERFORM 999-110-CALCULA-DIAS-VENCIDO.                     00046120
046130                                                                  00046130
046140     IF INICIO-MES                                                00046140
046150      IF QDE-DIAS-VENC-WS GREATER 59                              00046150
046160       IF EMP-LIM-RED-WS GREATER THAN ZEROS                       00046160
046170        COMPUTE RAP-RED-WS = RAP-RED-WS + JUROS-DIARIOS-WS        00046170
046180       ELSE                                                       00046180
046190        IF INS-NJUR-REAL-RED-WS NOT EQUAL ZEROS AND               00046190
046200           VALOR-ACUM-ADIANT-RED-WS NOT EQUAL ZEROS AND           00046200
046210           SLD-DEP-RED-WS LESS THAN ZEROS                         00046210
                 IF RAP-RED-WS LESS THAN ZEROS
                    COMPUTE RAP-RED-WS = RAP-RED-WS * (-1)
                 END-IF
046220           COMPUTE RAP-RED-WS = RAP-RED-WS + INS-NJUR-REAL-RED-WS.00046220
046230                                                                  00046230

046240*----------------------------------------------------------------*00046240
046250  41A-35-TESTE-ADIANTAMENTOS.                                     00046250
046260                                                                  00046260
046270      IF  VALOR-ACUM-ADIANT-RED-WS EQUAL ZEROS                    00046270
046280          IF SALDO-ANTERIOR-INS NOT < ZEROS                       00046280
046290             MOVE ZEROS TO DATA-ADIANT-RED-WS.                    00046290
046300                                                                  00046300
046310      MOVE VALOR-ACUM-ADIANT-RED-WS TO SLD-DEP-ANT                00046310
046320                                       VR-ADIANT-ANT-WS.          00046320
046330                                                                  00046330
046340*----------------------------------------------------------------*00046340
046350  41B-35-TESTE-VENC-CONTRATO.                                     00046350
046360                                                                  00046360
046370      IF  DATA-VENCIM-RED-WS GREATER ZEROS                        00046370
046380          MOVE DIA-VENCIM-WS     TO DIA-VENCIM-INV                00046380
046390          MOVE MES-VENCIM-WS     TO MES-VENCIM-INV                00046390
046400          CALL 'M0952000' USING ANO-VENCIM-WS ANO-VENCIM-INV      00046400
046410          MOVE DIA-REC-WS TO DIA-REC-Y2-WS                        00046410
046420          MOVE MES-REC-WS TO MES-REC-Y2-WS                        00046420
046430          CALL 'M0952000' USING ANO-REC-WS ANO-REC-Y2-WS          00046430
046440          IF  DATA-REC-Y2-WS NOT LESS DATA-VENCIM-INV-RED-WS      00046440
046450              PERFORM 41C-35-CALCULO-NEXT-VENCIMENTO              00046450
046460              MOVE 1 TO SW-CONTRATO-VENCIDO.                      00046460
046470                                                                  00046470
046480*----------------------------------------------------------------*00046480
046490  41C-35-CALCULO-NEXT-VENCIMENTO.                                 00046490
046500                                                                  00046500
046510     IF  MES-VENCIM-WS EQUAL 2                                    00046510
046520         CALL 'M0952000' USING ANO-VENCIM-WS ANO-AUX-WS           00046520
046530         PERFORM 999-33C-TESTA-ANO-BISSEXTO                       00046530
046540         IF  ANO-BISSEXTO                                         00046540
046550             COMPUTE DIFERENCA-DIAS-WS = 29 - DIA-VENCIM-WS       00046550
046560         ELSE                                                     00046560
046570             COMPUTE DIFERENCA-DIAS-WS = 28 - DIA-VENCIM-WS       00046570
046580     ELSE                                                         00046580
046590         COMPUTE DIFERENCA-DIAS-WS =                              00046590
046600                                 NUM-DIAS-MES-TAB (MES-VENCIM-WS) 00046600
046610                                 - DIA-VENCIM-WS.                 00046610

046620     MOVE ZEROS TO SW-ANO-BISSEXTO.                               00046620
046630     MOVE MES-VENCIM-WS TO MES-PROX-VENC-WS.                      00046630
046640     CALL 'M0952000' USING ANO-VENCIM-WS ANO-PROX-VENC-WS.        00046640
046650     IF  DIFERENCA-DIAS-WS NOT EQUAL ZEROS                        00046650
046660         MOVE DIFERENCA-DIAS-WS TO PRAZO-WS                       00046660
046670         PERFORM 41D-35-CALCULO-NEXT-VENCIM 5 TIMES               00046670
046680     ELSE                                                         00046680
046690         PERFORM 41D-35-CALCULO-NEXT-VENCIM 6 TIMES.              00046690

046700     COMPUTE DIFERENCA-DIAS-WS = PRAZO-WS - 180.                  00046700
046710     IF  DIFERENCA-DIAS-WS LESS ZEROS                             00046710
046720         PERFORM 41D-35-CALCULO-NEXT-VENCIM                       00046720
046730         MULTIPLY -1 BY DIFERENCA-DIAS-WS                         00046730
046740         MOVE DIFERENCA-DIAS-WS TO DIA-PROX-VENC-WS               00046740
046750     ELSE                                                         00046750
046760         COMPUTE DIA-PROX-VENC-WS =                               00046760
046770                 NUM-DIAS-MES-TAB (MES-PROX-VENC-WS) -            00046770
046780                 DIFERENCA-DIAS-WS.                               00046780

046790     MOVE ZEROS TO DIFERENCA-DIAS-WS PRAZO-WS.                    00046790
046800                                                                  00046800
046810*----------------------------------------------------------------*00046810
046820 41D-35-CALCULO-NEXT-VENCIM.                                      00046820
046830                                                                  00046830
046840     IF  MES-PROX-VENC-WS = 12                                    00046840
046850         MOVE 1 TO MES-PROX-VENC-WS                               00046850
046860         ADD  1 TO ANO-PROX-VENC-WS                               00046860
046870     ELSE                                                         00046870
046880         ADD 1 TO MES-PROX-VENC-WS.                               00046880

046890     IF  MES-PROX-VENC-WS EQUAL 2                                 00046890
046900         MOVE ANO-PROX-VENC-WS TO ANO-AUX-WS                      00046900
046910         PERFORM 999-33C-TESTA-ANO-BISSEXTO                       00046910
046920         IF  ANO-BISSEXTO                                         00046920
046930             COMPUTE PRAZO-WS = PRAZO-WS + 29                     00046930
046940         ELSE                                                     00046940
046950             COMPUTE PRAZO-WS = PRAZO-WS + 28                     00046950
046960     ELSE                                                         00046960
046970         COMPUTE PRAZO-WS = PRAZO-WS +                            00046970
046980                            NUM-DIAS-MES-TAB (MES-PROX-VENC-WS).  00046980

046990     MOVE ZEROS TO SW-ANO-BISSEXTO.                               00046990
047000                                                                  00047000
047010*----------------------------------------------------------------*00047010
047020 42-35-GUARDA-SALDO-ANTERIOR.                                     00047020

      * VARIAVEL USADA A FIM DE DETERMINAR EVENTOS DE APROPRIACAO DE RAP
      * O CANCELAMENTO PODE INDICAR SE A RAP PERTENCIA AO CHEQUE
      * ESPECIAL CONTRATADO OU SE EH DE UM ADIANTAMENTO A DEPOSITANTES.
           IF EMP-LIM-RED-WS EQUAL ZEROS
              MOVE 0 TO STATUS-CHQ-ESP-ANT-WS
           ELSE
              MOVE 1 TO STATUS-CHQ-ESP-ANT-WS
           END-IF

047040     IF SLD-EMP-RED-WS LESS ZEROS
047050        MOVE SLD-EMP-RED-WS TO SALDO-ANTERIOR-RED-WS              00047050
047060     ELSE                                                         00047060
047070        MOVE SLD-DEP-RED-WS TO SALDO-ANTERIOR-RED-WS              00047070
047080                                                                  00047080
           COMPUTE SALDO-ANTERIOR-BLOQUEADO-WS =
047110             ( SLD-BLO-RED-WS ( 1 ) + SLD-BLO-RED-WS ( 2 ) +      00047110
047120               SLD-BLO-RED-WS ( 3 ) + SLD-BLO-RED-WS ( 4 ) +      00047120
047130               SLD-BLO-RED-WS ( 5 ) + SLD-BLO-RED-WS ( 6 ) +      00047130
047140               SLD-BLO-RED-WS ( 7 ) + SLD-BLO-RED-WS ( 8 ) +      00047140
047150               SLD-BLO-RED-WS ( 9 ) + SLD-BLO-RED-WS ( 10 ) +     00047150
047160               SLD-BLO-RED-WS ( 11 ) + SLD-BLO-RED-WS ( 12 ) +    00047160
047170               SLD-BLO-RED-WS ( 13 ) + SLD-BLO-RED-WS ( 14 ) +    00047170
047180               SLD-BLO-RED-WS ( 15 ) + SLD-BLO-RED-WS ( 16 ) +    00047180
047190               SLD-BLO-RED-WS ( 17 ) + SLD-BLO-RED-WS ( 18 ) +    00047190
047200               SLD-BLO-RED-WS ( 19 ) + SLD-BLO-RED-WS ( 20 ) +    00047200
047210               SLD-BLO-RED-WS ( 21 ) ).                           00047210

047090     COMPUTE SALDO-ANTERIOR-INS =
                   SALDO-ANTERIOR-RED-WS - SALDO-ANTERIOR-BLOQUEADO-WS.
047080                                                                  00047080
047220*----------------------------------------------------------------*00047220
047230 42-35-CALCULA-INSUF-ANTERIOR.                                    00047230
047240*                                                                 00047240
047310     MOVE ZEROS TO INSUF-ANT INSUF-PARIOC-WS.                     00047310
047320                                                                  00047320
047330     IF EMP-LIM-RED-WS GREATER ZERO                               00047330
047340        MOVE EMP-TAXA-JUR-RED-WS TO TX-ENCARGOS-CONTERRANEO-WS    00047340
047350         IF SLD-EMP-RED-WS LESS ZERO                              00047350
047360             MOVE SLD-EMP-RED-WS TO SLD-ANT DI-SLD-ANT-WS         00047360
047370             MOVE 'E' TO TPSLD-ANT DI-TPSLD-ANT-WS                00047370
047380         ELSE                                                     00047380
047390             MOVE SLD-DEP-RED-WS TO SLD-ANT DI-SLD-ANT-WS         00047390
047400             MOVE 'D' TO TPSLD-ANT DI-TPSLD-ANT-WS                00047400
047410     ELSE                                                         00047410
047420         MOVE SLD-DEP-RED-WS TO SLD-ANT DI-SLD-ANT-WS             00047420
047430         MOVE 'D' TO TPSLD-ANT DI-TPSLD-ANT-WS                    00047430
047440         COMPUTE TOTAL-SLD-BLO-WS =    (SLD-BLO-RED-WS (1)  +     00047440
047450                  SLD-BLO-RED-WS (2)  + SLD-BLO-RED-WS (3)  +     00047450
047460                  SLD-BLO-RED-WS (4)  + SLD-BLO-RED-WS (5)  +     00047460
047470                  SLD-BLO-RED-WS (6)  + SLD-BLO-RED-WS (7)  +     00047470
047480                  SLD-BLO-RED-WS (8)  + SLD-BLO-RED-WS (9)  +     00047480
047490                  SLD-BLO-RED-WS (10) + SLD-BLO-RED-WS (11) +     00047490
047500                  SLD-BLO-RED-WS (12) + SLD-BLO-RED-WS (13) +     00047500
047510                  SLD-BLO-RED-WS (14) + SLD-BLO-RED-WS (15) +     00047510
047520                  SLD-BLO-RED-WS (16) + SLD-BLO-RED-WS (17) +     00047520
047530                  SLD-BLO-RED-WS (18) + SLD-BLO-RED-WS (19) +     00047530
047540                  SLD-BLO-RED-WS (20) + SLD-BLO-RED-WS (21))      00047540

047550         COMPUTE INSUFICIENCIA-WS = SLD-DEP-RED-WS -              00047550
047560                                    TOTAL-SLD-BLO-WS              00047560
047570         IF INSUFICIENCIA-WS LESS ZERO                            00047570
047580            COMPUTE MVR-CALC-WS = MVR-WS * 0                      00047580
047590            MOVE INSUFICIENCIA-WS TO INSUF-ANT.                   00047590
047600                                                                  00047600
047610         IF INSUFICIENCIA-WS LESS MVR-CALC-WS                     00047610
                  PERFORM 99-TESTA-DATAS-INSUF
                  IF DATA-MOV-INV-WS NOT GREATER DATA-ADIANT-RED-INV-WS
047620               PERFORM 46-35-COMPOE-NUM-INSUF.                    00047620
047630*----------------------------------------------------------------*00047630
047640 42-35-COMPOE-SPREAD-ANT.                                         00047640
047650                                                                  00047650
047660******************      SPREAD       *******************          00047660
047670     IF CTA-EMPRESARIAL                                           00047670
047680        IF EMP-TAXA-JUR-RED-WS GREATER 05,000                     00047680
047690           MOVE 05,000 TO EMP-TAXA-JUR-RED-WS.                    00047690
047700                                                                  00047700
047710     IF CTA-EMPRESARIAL                                           00047710
047720        COMPUTE TAXA-SPREAD-WS = (((EMP-TAXA-JUR-RED-WS / 100) +  00047720
047730                           1) ** (1 / DIAS-UTEIS-SPREAD-WS)) - 1. 00047730
047740                                                                  00047740
047750*----------------------------------------------------------------*00047750
047760 45-35-TESTA-CASAMENTO.                                           00047760
047770*                                                                 00047770
047780     IF CH-AG-WS GREATER AGENCIA-D07-WS                           00047780
047790         IF CHAVE-D07-WS = HIGH-VALUE                             00047790
047800             PERFORM 50-35-INEXISTE-MOVIMENTO                     00047800
047810                 UNTIL CHAVE-F10-WS = HIGH-VALUE                  00047810
047820         ELSE                                                     00047820
047830             PERFORM 55-35-INEXISTE-MESTRE                        00047830
047840     ELSE                                                         00047840
047850         IF HEAD-AG-WS                                            00047850
047860           PERFORM 50-35-INEXISTE-MOVIMENTO                       00047860
047870             UNTIL AGENCIA-F10-WS = AGENCIA-D07-WS                00047870
047880           MOVE 1 TO SW-GRAVACAO                                  00047880
047890         ELSE                                                     00047890
047900             PERFORM 60-35-LEITURA-F10.                           00047900
047910*----------------------------------------------------------------*00047910
047920 42-36-ACUMULA-ATL-DIAS-PARAL.                                    00047920
047930*                                                                 00047930
047940     IF TP-PESSOA-RED-WS = 'V'                                    00047940
047950        MOVE ZEROS TO ATL-DIAS-PARAL-RED-WS                       00047950
047960     ELSE                                                         00047960
047970        ADD DIAS-PARAL-WS TO ATL-DIAS-PARAL-RED-WS.               00047970
047980*----------------------------------------------------------------*00047980
047990 46-35-COMPOE-NUM-INSUF.                                          00047990
048000                                                                  00048000
048010     IF  (SLD-DEP-RED-WS LESS 0)                                  00048010
048020     AND (TOTAL-SLD-BLO-WS NOT < 0)                               00048020
               IF  OPER-NAO-ISENTA-IOF
048030             COMPUTE INS-NIOF-REAL-RED-WS =                       00048030
048040                 (VALOR-ACUM-ADIANT-RED-WS * DIAS-PARAL-WS) +     00048040
048050                           INS-NIOF-REAL-RED-WS                   00048050
               END-IF
048060     END-IF.                                                      00048060
048120                                                                  00048120
048220*----------------------------------------------------------------*00048220
048230 50-35-INEXISTE-MOVIMENTO.                                        00048230
048250                                                                  00048250
048260     IF  CH-TIPOREG-F10 = 1                                       00048260
048270         MOVE REG-HEADER-AG-F10 TO REG-HEADER-AG-RED-WS           00048270
048280     ELSE                                                         00048280
048290     IF  CH-TIPOREG-F10 = 4                                       00048290
               INITIALIZE REG-EXTRATO-WS
048300         MOVE REG-EXTRATO-F10   TO REG-EXTRATO-WS                 00048300
048310     ELSE                                                         00048310
048320     IF  CH-TIPOREG-F10 = 5                                       00048320
               INITIALIZE REG-CORRENT-RED-WS
048330         MOVE REG-CORRENT-F10   TO REG-CORRENT-RED-WS             00048330
048340         PERFORM 999-39-VERIFICA-SLD-DECORR                       00048340
048350         PERFORM 57-35-TESTA-SLD-DEV-LIM                          00048350
048360         PERFORM 999-39-VERIFICA-SLD-DECORR                       00048360
048370         IF EMP-LIM-RED-WS GREATER ZEROS                          00048370
048380            IF SLD-DEV-NUM-WS LESS ZEROS OR                       00048380
048390               JUROS-DIARIOS-WS NOT EQUAL ZEROS                   00048390
048400               PERFORM 999-100-PERCENTUAL-UTILIZACAO              00048400
048410               PERFORM 243-35-CALCULO-JUROS-DIARIOS               00048410
048420               MOVE ZEROS TO SLD-DEV-NUM-WS                       00048420
048430            ELSE                                                  00048430
048440               MOVE ZEROS TO SLD-DEV-NUM-WS                       00048440
048450         ELSE                                                     00048450
048460            MOVE ZEROS TO SLD-DEV-NUM-WS                          00048460
048470     ELSE                                                         00048470
048480     IF  CH-TIPOREG-F10 = 8                                       00048480
048490         MOVE REG-TRAILLER-AG-F10 TO REG-TRAILLER-AG-RED-WS.      00048490
048500                                                                  00048500
048510     IF  HEAD-AG-F10                                              00048510
048520         MOVE ZERO TO HAG-INDICADOR-WS.                           00048520
048530                                                                  00048530
048540     PERFORM 999-10-GRAVA-F10.                                    00048540
048550                                                                  00048550
048560     PERFORM 60-35-LEITURA-F10.                                   00048560
048570                                                                  00048570
048580     IF CH-AG-WS LESS AGENCIA-D07-WS                              00048580
048590         IF CHAVE-F10-WS = HIGH-VALUE                             00048590
048600             PERFORM 55-35-INEXISTE-MESTRE.                       00048600
048610*----------------------------------------------------------------*00048610
048620 55-35-INEXISTE-MESTRE.                                           00048620
048630*                                                                 00048630
048650     DISPLAY '**P04808-CANCELADO. AGENCIA ' CH-CODAG-D07 'INEXISTE00048650
048660-            ' NA MST*********************'                       00048660
048670     MOVE COD-RETORNO-WS (4) TO RETURN-CODE                       00048670
048680     DISPLAY 'RETURN CODE EH ...' COD-RETORNO-WS (4)              00048680
048690     DISPLAY 'MENSAGEM DE RETORNO  EH ... ' MEN-RETORNO-WS (4)    00048690
048700     GOBACK.                                                      00048700
048710                                                                  00048710
048720*----------------------------------------------------------------*00048720
048730 56-35-GUARDA-SALDO-DEV-ANT.                                      00048730
048740*                                                                 00048740
048750     MOVE SLD-EMP-RED-WS TO SALDO-EMP-ANT-WS.                     00048750
048760                                                                  00048760
048770     COMPUTE SLD-DEV-NUM-ANT-WS =                                 00048770
048780                  SLD-EMP-RED-WS +                                00048780
048790                  SLD-DEP-RED-WS -                                00048790
048800                 (SLD-BLO-RED-WS (1) + SLD-BLO-RED-WS (2) +       00048800
048810                  SLD-BLO-RED-WS (3) + SLD-BLO-RED-WS (4) +       00048810
048820                  SLD-BLO-RED-WS (5) + SLD-BLO-RED-WS (6) +       00048820
048830                  SLD-BLO-RED-WS (7) + SLD-BLO-RED-WS (8) +       00048830
048840                  SLD-BLO-RED-WS (9) + SLD-BLO-RED-WS (10) +      00048840
048850                  SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +     00048850
048860                  SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +     00048860
048870                  SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +     00048870
048880                  SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +     00048880
048890                  SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +     00048890
048900                  SLD-BLO-RED-WS (21)).                           00048900

           MOVE SLD-DEV-NUM-ANT-WS TO  SLD-DEV-ANT-DEVOL-WS.
048910
048920*----------------------------------------------------------------*
048930 57-35-TESTA-SLD-DEV-LIM.
048940*
048950     IF HA-FERIADO
048960        COMPUTE TAXA-SPREAD-WS =
048970               TAXA-SPREAD-WS * QTDE-DIAS-FERIADO-WS
048980        IF EMP-LIM-RED-WS GREATER ZEROS
048990           IF SLD-DEV-NUM-WS LESS ZEROS
049000           OR JUROS-DIARIOS-WS NOT EQUAL ZEROS
049010              COMPUTE FATOR-VEZES-SPREAD =
049020                      FATOR-JUR-CAP-CE-WS * TAXA-SPREAD-WS
049030              COMPUTE FATOR-JUROS-CTA-EMPRES-WS =
049040                      FATOR-JUR-CAP-CE-WS + TAXA-SPREAD-WS +
049050                      FATOR-VEZES-SPREAD
049060       MOVE FATOR-EXCESSO-CAP-PF-WS TO FATOR-EXCESSO-PFISICA-WS
049070       MOVE FATOR-EXCESSO-CAP-PJ-WS TO FATOR-EXCESSO-PJURIDICA-WS
049080       MOVE FATOR-EXCESSO-CAP-CE-WS TO FATOR-EXCESSO-CTA-EMPRES-WS
049090              PERFORM 999-105-PERCENTUAL-UTIL-CAP
049100              PERFORM 243-35-CALCULO-JUROS-DIARIOS
049110              COMPUTE FATOR-VEZES-SPREAD =
049120                      FATOR-JUR-CE-WS * TAXA-SPREAD-WS
049130              COMPUTE FATOR-JUROS-CTA-EMPRES-WS =
049140                      FATOR-JUR-CE-WS + TAXA-SPREAD-WS +
049150                      FATOR-VEZES-SPREAD
049160           MOVE FATOR-EXCESSO-PF-WS TO FATOR-EXCESSO-PFISICA-WS
049170           MOVE FATOR-EXCESSO-PJ-WS TO FATOR-EXCESSO-PJURIDICA-WS
049180           MOVE FATOR-EXCESSO-CE-WS TO FATOR-EXCESSO-CTA-EMPRES-WS
049190           ELSE
049200              COMPUTE FATOR-VEZES-SPREAD =
049210                      FATOR-JUR-CE-WS * TAXA-SPREAD-WS
049220              COMPUTE FATOR-JUROS-CTA-EMPRES-WS =
049230                      FATOR-JUR-CE-WS + TAXA-SPREAD-WS +
049240                      FATOR-VEZES-SPREAD
049250           MOVE FATOR-EXCESSO-PF-WS TO FATOR-EXCESSO-PFISICA-WS
049260           MOVE FATOR-EXCESSO-PJ-WS TO FATOR-EXCESSO-PJURIDICA-WS
049270           MOVE FATOR-EXCESSO-CE-WS TO FATOR-EXCESSO-CTA-EMPRES-WS
                 END-IF
049280        ELSE
049290           COMPUTE FATOR-VEZES-SPREAD =
049300                   FATOR-JUR-CE-WS * TAXA-SPREAD-WS
049310           COMPUTE FATOR-JUROS-CTA-EMPRES-WS =
049320                   FATOR-JUR-CE-WS + TAXA-SPREAD-WS +
049330                   FATOR-VEZES-SPREAD
049340           MOVE FATOR-EXCESSO-PF-WS TO FATOR-EXCESSO-PFISICA-WS
049350           MOVE FATOR-EXCESSO-PJ-WS TO FATOR-EXCESSO-PJURIDICA-WS
049360           MOVE FATOR-EXCESSO-CE-WS TO FATOR-EXCESSO-CTA-EMPRES-WS
              END-IF
           ELSE
              IF EMP-LIM-RED-WS GREATER ZEROS
                 COMPUTE FATOR-VEZES-SPREAD =
                         FATOR-JUR-CE-WS * TAXA-SPREAD-WS
                 COMPUTE FATOR-JUROS-CTA-EMPRES-WS =
                         FATOR-JUR-CE-WS + TAXA-SPREAD-WS +
                         FATOR-VEZES-SPREAD
              END-IF
           END-IF

049370     MOVE ZEROS TO SLD-DEV-NUM-WS.
049380
049400*----------------------------------------------------------------*
049410 60-35-LEITURA-F10.
049420*
049430     READ ArqContasBase NEXT RECORD.
049440
049460     IF  PRIMEIRA-LEITURA-F10
049470         MOVE CH-AG-F10 TO COD-AG-ANT-F10-WS
049480         MOVE 0 TO SW-PRIMEIRA-LEITURA-F10.
049490
049500     IF  FS-ArqContasBase EQUAL '10'
049510         MOVE HIGH-VALUE TO CHAVE-F10-WS
049520     ELSE
049530     IF  FS-ArqContasBase NOT EQUAL '00'
049540         MOVE FS-ArqContasBase TO FILE-STATUS-WS
049550         MOVE '**P04808 ERRO DE LEITURA NO D04808 **'
049560                     TO MENSAGEM-ERRO-WS
049570         PERFORM 999-99-ROT-ERRO
049580     ELSE
049590     IF  (CH-AG-F10 NOT = COD-AG-ANT-F10-WS)
049600         MOVE HIGH-VALUE TO CHAVE-F10-WS.
049610     IF CHAVE-F10-WS NOT = HIGH-VALUE
049620         PERFORM 65-35-CHAVE-F10.
049630
049640*----------------------------------------------------------------*
049650 65-35-CHAVE-F10.                                                 00049650
049660*                                                                 00049660
049670     MOVE CH-AG-F10      TO COD-AG-CH-F10.                        00049670
049680     MOVE CH-CONTA-F10   TO CONTA-CH-F10.                         00049680
049690     MOVE CH-TIPOREG-F10 TO TPREG-CH-F10.                         00049690
049700*                                                                 00049700
049710     IF CH-AG-F10 GREATER AGENCIA-F10-WS                          00049710
049720         MOVE CH-AG-F10  TO AGENCIA-F10-WS.                       00049720
049730*                                                                 00049730
049740     IF REG-EXT-F10 OR REG-COR-F10                                00049740
049750        ADD 1            TO ACUM-REG-AG-ANT.                      00049750
049760                                                                  00049760
049770     IF REG-COR-F10                                               00049770
049780         MOVE ZEROS      TO CRED-ANTECIP-WS.                      00049780

049790*----------------------------------------------------------------*00049790
049800 70-35-PERNA-D07.                                                 00049800
049810*                                                                 00049810
049830     IF  (CH-CODAG-D07 NOT = COD-AG-D07-ANT)                      00049830
049840     AND (CH-TPREG-D07 NOT = 0)                                   00049840
049850         DISPLAY '**REGISTRO TIPO 0 INEXISTENTE NO ARQUIVO D04807'00049850
049860         DISPLAY '**DADOS REGISTRO = ' CH-TPREG-D07 ' '           00049860
049870                    CH-CODAG-D07 ' ' CONTA-D07 ' ' DV-CONTA-D07.  00049870
049890*                                                                 00049890
049900     MOVE 1 TO MOVIMENTACAO-RED-WS.                               00049900

           PERFORM 999-120-ACESSA-V048CCAD.

049920     IF SW-F10 = 1                                                00049920
049930         PERFORM  75-35-ATUALIZACAO                               00049930
049940     ELSE                                                         00049940
049950         PERFORM  78-35-INCLUSAO.                                 00049950
049960                                                                  00049960
049970     PERFORM 220-35-LEITURA-D07.                                  00049970

050000*----------------------------------------------------------------*00050000
050010 75-35-ATUALIZACAO.                                               00050010
050020*                                                                 00050020
050030     MOVE 1 TO SW-GERA-FICHA.                                     00050030
050040     ADD  1 TO ACUM-OUTROS.                                       00050040
050050                                                                  00050050
050060     IF TRANS-D07                                                 00050060
050070        MOVE 1 TO SW-MOVIMENTACAO                                 00050070
050080                  MOVIMENTACAO-RED-WS                             00050080
      *ACUMULAR MOVIMENTO QUE ESTAO BLOQUEADOS PARA CALCULO DO SALDO
      *BLOQUEADO NO DIA.
           MOVE CH-HIST-D07 TO HISTS-MOVTO-BLOQ-WS
           IF   HISTS-MOVTO-BLOQ
                ADD TR-VALOR-D07  TO TOTAL-MOVTO-BLOQ-WS
           END-IF
050090        PERFORM 148-35-TESTA-TRANS-SELIC                          00050090
050100     ELSE                                                         00050100
050110        IF CAD-EMP-D07                                            00050110
050120           MOVE ZEROS TO SW-CONTRATO-VENCIDO                      00050120
050130           PERFORM 120-35-CADASTRO-EMP                            00050130
050140        ELSE                                                      00050140
050150           IF CAD-SENHA-D07                                       00050150
050160              PERFORM 123-35-CAD-SENHA                            00050160
050170           ELSE                                                   00050170
050180              IF CAD-CC-D07                                       00050180
050190                 ADD 1    TO ALTERACAO-WS                         00050190
050210                 PERFORM 95-35-CADASTRO-CC                        00050210
050220              ELSE                                                00050220
050230                 IF ESPEC-D07                                     00050230
050240                    PERFORM 170-35-ESPECIAIS                      00050240
050250                 ELSE                                             00050250
050260                    IF AC-EC-D07                                  00050260
050270                       MOVE 1 TO SW-MOVIMENTACAO                  00050270
050280                                 MOVIMENTACAO-RED-WS              00050280
050290                       PERFORM 130-35-ACERTO-EXT-CONTABIL         00050290
050300                    ELSE                                          00050300
050310                       IF AC-NUM-D07                              00050310
050320                        IF EMP-LIM-RED-WS EQUAL ZEROS             00050320
050330                           PERFORM 137-35-ACERTO-JUR-IOF-INS      00050330
050340                        ELSE                                      00050340
050350                          IF AC-N-ADD-SUBT-D07 = 'I' OR 'J'       00050350
050360                             MOVE ZEROS TO SW-GERA-FICHA          00050360
050370                             PERFORM 134-35-PESQ-MOVIMENTACAO     00050370
050380                             PERFORM 136-35-ACERTO-JUROS          00050380
050390                          ELSE                                    00050390
050400                             IF AC-N-ADD-SUBT-D07 = 'B' OR 'T'    00050400
050410                                MOVE ZEROS TO SW-GERA-FICHA       00050410
050420                                PERFORM 134-35-PESQ-MOVIMENTACAO  00050420
050430                                PERFORM 136A-35-ACERTO-VALOR-IOC  00050430
050440                             ELSE                                 00050440
050450                                PERFORM 134-35-PESQ-MOVIMENTACAO  00050450
050460                                PERFORM 135-35-ACERTO-NUMEROS     00050460
050470                       ELSE                                       00050470
050480                           PERFORM 80-35-INICIA-AGENCIA.          00050480
050490                                                                  00050490
050500     IF REG-COR-WS                                                00050500
050510        IF CONTA-A-CLASS                                          00050510
050520           IF NOME-RED-WS EQUAL SPACES                            00050520
050530              IF (SLD-DEP-RED-WS EQUAL ZEROS) AND                 00050530
050560                 (CH-CONTA-WS NOT EQUAL 90388)                    00050560
050570                 MOVE 0 TO SW-SALDO-ZERADO                        00050570
050580                 MOVE SPACES TO ENDERECO-WS                       00050580
050590                 MOVE ZEROS  TO GR-DIFERENCA                      00050590
050600                 PERFORM 195-35-CANCELA-CONTA-CORRENTE.           00050600
050610                                                                  00050610
050860*----------------------------------------------------------------*00050860
050870 78-35-INCLUSAO.                                                  00050870
050880*                                                                 00050880
050890     PERFORM 215-35-COMPOE-REG-MESTRE.                            00050890
050900                                                                  00050900
050910     MOVE ZERO TO SW-GRAVACAO.                                    00050910
050920                                                                  00050920
050930     IF CAD-CC-D07                                                00050930
050940        ADD 1                    TO INCLUSAO-WS                   00050940
050960        MOVE 1                   TO MOVIMENTACAO-RED-WS           00050960
050970        PERFORM 92-35-TESTA-CADASTRO                              00050970
050980     ELSE                                                         00050980
050990        ADD 1 TO ACUM-OUTROS                                      00050990
051000        IF TRANS-D07                                              00051000
051010           MOVE 1                TO SW-IMPLANTACAO                00051010
051010                                    SW-GERA-FICHA SW-F10          00051010
051020                                    MOVIMENTACAO-RED-WS           00051020
051030           PERFORM 148-35-TESTA-TRANS-SELIC                       00051030
051040           MOVE 42               TO C-CC-COD-MENS-D10             00051040
051050           PERFORM 545-35-OCR-CAD-CC                              00051050
051060        ELSE                                                      00051060
051070           IF AC-EC-D07                                           00051070
051080              MOVE 1             TO SW-IMPLANTACAO                00051080
051080                                    SW-GERA-FICHA SW-F10          00051080
051090                                    MOVIMENTACAO-RED-WS           00051090
051100              PERFORM 130-35-ACERTO-EXT-CONTABIL                  00051100
051110              MOVE 42            TO C-CC-COD-MENS-D10             00051110
051120              PERFORM 545-35-OCR-CAD-CC                           00051120
051130           ELSE                                                   00051130
051140              MOVE 1             TO SW-GRAVACAO                   00051140
051150              IF ESPEC-D07                                        00051150
051160                 IF CH-N-LOTE-D07 = 95 OR 96                      00051160
051170                    MOVE 39      TO C-CC-COD-MENS-D10             00051170
051180                    PERFORM 545-35-OCR-CAD-CC                     00051180
051190                 ELSE                                             00051190
051200                    IF CH-N-LOTE-D07 = 99                         00051200
051210                       MOVE 2    TO PER-ORIGEM-COMANDO-D10        00051210
051220                       MOVE 0    TO PER-NATUREZA-COMANDO-D10      00051220
051230                       MOVE ES-QT-CH-D07 TO PER-QTDE-D10          00051230
051240                       MOVE 41   TO PER-COD-MENS-D10              00051240
051250                       MOVE 1    TO SW-CH-PERSONAL                00051250
051260*********** IPMF ****************                                 00051260
051270                       PERFORM 80-35-TESTA-CHEQUE-TB              00051270
051280*********************************                                 00051280
051290                       PERFORM 548-35-OCR-CH-PERSON               00051290
051300                       PERFORM 79-35-PREPARA-TOTALIZADOR-PERS     00051300
051310                    ELSE                                          00051310
051320                       MOVE 41   TO C-CC-COD-MENS-D10             00051320
051330                       PERFORM 545-35-OCR-CAD-CC                  00051330
051340              ELSE                                                00051340
051350                 IF AC-NUM-D07                                    00051350
                          MOVE SPACES  TO REG-AC-NUM-D10
                          INITIALIZE REG-AC-NUM-D10
051360                    MOVE 1       TO SW-RECUSA-AC-NUMEROS          00051360
051370                    MOVE 40      TO AC-N-COD-MENS-D10             00051370
051380                    PERFORM 560-35-INICIA-OCR-AC-NUMEROS          00051380
051390                 ELSE                                             00051390
051400                    IF CAD-EMP-D07                                00051400
051410                       MOVE 28   TO C-EMP-COD-MENS-D10            00051410
051420                       PERFORM 555-35-OCR-CAD-EMP                 00051420
051430                    ELSE                                          00051430
051440                       ADD -1    TO ACUM-OUTROS.                  00051440
051450                                                                  00051450
051460*----------------------------------------------------------------*00051460
051470 79-35-PREPARA-TOTALIZADOR-PERS.                                  00051470
051480                                                                  00051480
051490     MOVE 9       TO PER-ORIGEM-COMANDO-D10.                      00051490
051500     MOVE ZEROS   TO PER-NATUREZA-COMANDO-D10                     00051500
051510                     PER-QTDE-D10.                                00051510
051520     MOVE 41      TO PER-COD-MENS-D10.                            00051520
051530     MOVE 1       TO SW-CH-PERSONAL.                              00051530
051540************** IPMF ****************                              00051540
051550     PERFORM 80-35-TESTA-CHEQUE-TB.                               00051550
051560************************************                              00051560
051570     PERFORM 548-35-OCR-CH-PERSON.                                00051570
051580     MOVE ZEROS TO SW-HOUVE-OCORR-14                              00051580
051590                   COD-MSG-OCORR-TALON-WS.                        00051590
051600                                                                  00051600
051610*----------------------------------------------------------------*00051610
051620************** IPMF ****************                              00051620
051630 80-35-TESTA-CHEQUE-TB.                                           00051630
051640                                                                  00051640
051650     IF ES-INDICADOR-CH-D07 = 2 OR 8                              00051650
051660        MOVE 1 TO SW-CHEQUE-TB                                    00051660
051670     ELSE                                                         00051670
051680        MOVE 1 TO SW-CHEQUE-NORMAL.                               00051680
051690************************************                              00051690
051700                                                                  00051700
051740*----------------------------------------------------------------*00051740
051750 80-35-INICIA-AGENCIA.                                            00051750
051760*                                                                 00051760
051770     ADD -1 TO ACUM-OUTROS                                        00051770
051780                                                                  00051780
051790     IF CH-CODAG-D07 NOT = COD-AG-D07-ANT                         00051790
051800         MOVE ZEROS TO IND-TAB                                    00051800
051810         PERFORM 90-35-ZERA-TABELAS                               00051810
051820         PERFORM 999-25-ZERA-FH-RECOLHER-WS 10 TIMES              00051820
051830         MOVE ZEROS TO IND-FICHA-RECOLHER                         00051830
051840         PERFORM 85-35-ATL-HEAD-AGENCIA                           00051840
051850         PERFORM 500-35-OCR-HEAD-AGENCIA                          00051850
051860         MOVE CH-CODAG-D07 TO COD-AG-D07-ANT.                     00051860
051870*----------------------------------------------------------------*00051870
051880 85-35-ATL-HEAD-AGENCIA.                                          00051880
051890                                                                  00051890
051910     MOVE ZEROS TO ACUM-CH-NPROC.                                 00051910
051920     MOVE 1 TO HAG-INDICADOR-WS.                                  00051920
051930     MOVE HF-DATA-ATL-WS TO DATA-AUX-RED.                         00051930
051940     MOVE CH-DATA-D07 TO DATA-D07-RED-WS.                         00051940
051950     CALL 'M0952000' USING ANO-D07-WS ANO-D07-INV.                00051950
051960     MOVE MES-D07-WS  TO MES-D07-INV.                             00051960
051970     MOVE DIA-D07-WS  TO DIA-D07-INV.                             00051970
051980                                                                  00051980
051990     PERFORM 275-35-INVERTE-DATAS.                                00051990
052000                                                                  00052000
052010     IF DATA-INVERTIDA GREATER DATA-AUX-Y2-INV-RED                00052010
052020         NEXT SENTENCE                                            00052020
052030     ELSE                                                         00052030
052040         DISPLAY '**P04808-CANCELADO. DATA MOVTO MENOR/IGUAL DATA 00052040
052050-                'MESTRE*****************'                        00052050
052060         MOVE COD-RETORNO-WS (4) TO RETURN-CODE                   00052060
052070         DISPLAY 'RETURN CODE EH ... ' COD-RETORNO-WS (4)         00052070
052080         DISPLAY 'MENSAGEM DE RETORNO EH .. ' MEN-RETORNO-WS (4)  00052080
052090         GOBACK.                                                  00052090

052100     MOVE HF-DATA-ANT-WS TO DATA-ANT-MST-WS.                      00052100
052110                                                                  00052110
052120     MOVE HF-DATA-ATL-WS TO                                       00052120
052130                       HF-DATA-ANT-WS  DATA-F10-RED-WS            00052130
052140                                       DATA-MENOR-RED.            00052140
052150     MOVE CH-DATA-D07 TO                                          00052150
052160                      HF-DATA-ATL-WS   DATA-D07-RED-WS            00052160
052170                                       DATA-MAIOR-RED.            00052170
052180                                                                  00052180
052190     MOVE 100 TO DIVISOR-IOF.                                     00052190
052200     MOVE MES-D07-WS TO MES-WS.                                   00052200
052210                                                                  00052210
052220     CALL 'M0952000' USING ANO-D07-WS ANO-AUX-WS.                 00052220
052230                                                                  00052230
052240     IF MES-WS = 2                                                00052240
052250         DIVIDE ANO-AUX-WS BY 4 GIVING NUM-ANOS-BISSEXTOS         00052250
052260              REMAINDER RESTO.                                    00052260
052270     CALL 'M0952000' USING ANO-F10-WS ANO-AUX-Y2-WS.              00052270
052280     IF ANO-AUX-WS = ANO-AUX-Y2-WS AND MES-F10-WS LESS MES-D07-WS 00052280
052290         MOVE 1 TO SW-INICIO-MES                                  00052290
052300     ELSE                                                         00052300
052310         IF ANO-AUX-WS GREATER ANO-AUX-Y2-WS AND MES-D07-WS = 01  00052310
052320             MOVE 1 TO SW-INICIO-MES                              00052320
052330             MOVE 2 TO SW-INICIO-ANO                              00052330
052340         ELSE                                                     00052340
052350             MOVE ZERO TO SW-INICIO-MES SW-INICIO-ANO.            00052350

052360     IF INICIO-MES OR INICIO-ANO                                  00052360
052370        PERFORM 999-44-ABRE-D04819 UNTIL ABRIU-D04819             00052370
052380        PERFORM 999-43-CONTROLA-PERSONALIZACAO                    00052380
052390        PERFORM 999-41-APURA-GR-DEB-CRED.                         00052390

052400     IF IMPLANTA-AGENCIA                                          00052400
052410*       MOVE 0 TO INDICA-IMPLA-WS                                 00052410
052420        PERFORM 999-41-APURA-GR-DEB-CRED.                         00052420

052430     IF TX-JUROS-INSUF-D01-WS GREATER ZEROS                       00052430
052440        MOVE TX-JUROS-INSUF-D01-WS TO HAG-TX-JUROS-RED-WS.        00052440
052450     IF TX-IOC-JURID-D01-WS GREATER ZEROS                         00052450
052460        MOVE TX-IOC-JURID-D01-WS TO HAG-TX-IOF-JURID-RED-WS.      00052460
052470     IF TX-IOC-FISICA-D01-WS GREATER ZEROS                        00052470
052480        MOVE TX-IOC-FISICA-D01-WS TO HAG-TX-IOF-FISICA-RED-WS.    00052480
052490     IF MVR-D01-WS GREATER ZEROS                                  00052490
052500        MOVE MVR-D01-WS TO HAG-MVR-RED-WS.                        00052500
052510     IF OTN-D01-WS GREATER ZEROS                                  00052510
052520        MOVE OTN-D01-WS TO HAG-ORTN-ATL-RED-WS.                   00052520

052530     IF GR-CRED-DEB-FIS-WS GREATER ZEROS                          00052530
052540        MOVE GR-CRED-DEB-FIS-WS TO HAG-GR-DEB-PFIS-RED-WS         00052540
052550                                   HAG-GR-CRED-PFIS-RED-WS        00052550
052560                                   HAG-GR-DIF-SLD-PFIS-RED-WS     00052560
052570        MOVE ZEROS TO GR-CRED-DEB-FIS-WS.                         00052570

052580     IF GR-CRED-DEB-JUR-WS GREATER ZEROS                          00052580
052590        MOVE GR-CRED-DEB-JUR-WS TO HAG-GR-DEB-PJUR-RED-WS         00052590
052600                                   HAG-GR-CRED-PJUR-RED-WS        00052600
052610                                   HAG-GR-DIF-SLD-PJUR-RED-WS     00052610
052620        MOVE ZEROS TO GR-CRED-DEB-JUR-WS.                         00052620

052630     MOVE HAG-PARAMETROS-RED-WS TO  PARAMETROS-WS.
052640     MOVE HAG-VALOR-TAXAS-RED-WS TO  VALOR-TAXAS-WS.
052650     MOVE ZEROS TO IND-ACUM-TRAILLER IND-RAZAO IND-PROTOCOLO.
052660     MOVE HF-SEQUENC-ATL-WS TO HF-SEQUENC-ANT-WS.
052670     ADD 1 TO HF-SEQUENC-ATL-WS.
052680
052690     PERFORM 800-05-CALCULA-NUM-DIAS.
052700
052710     MOVE DIAS-TRANSF-WS TO DIAS-PARAL-WS.
052720     COMPUTE VARIACAO-OTNF-WS = (OTNF-ATL-WS - OTNF-ANT-WS) *
052730             100 / OTNF-ANT-WS.
052740
052750     IF INICIO-MES OR IMPLANTA-AGENCIA
052760        MOVE 0 TO INDICA-IMPLA-WS
052770        MOVE HAG-DIAS-UTEIS-RED-WS TO DIAS-UTEIS-WS
052780        MOVE ZEROS TO HAG-DIAS-UTEIS-RED-WS
052790******************      SPREAD       *******************
052800        PERFORM 999-52-DIAS-NAO-UTEIS
052810        MOVE ZEROS TO SW-FIM-PROCESSAMENTO
052820        IF MES-WS = 2
052830           CALL 'M0952000' USING ANO-D07-WS ANO-AUX-WS
052840           PERFORM 999-33C-TESTA-ANO-BISSEXTO
052850           IF ANO-BISSEXTO
052860              COMPUTE DIAS-UTEIS-SPREAD-WS =
052870                     NUM-DIAS-MES-TAB (MES-WS) - DIAS-NAO-UTEIS-WS
052880                      + 1
052890              MOVE DIAS-UTEIS-SPREAD-WS TO HAG-VRMIN-RED-WS
052900           ELSE
052910              COMPUTE DIAS-UTEIS-SPREAD-WS =
052920                     NUM-DIAS-MES-TAB (MES-WS) - DIAS-NAO-UTEIS-WS
052930              MOVE DIAS-UTEIS-SPREAD-WS TO HAG-VRMIN-RED-WS
052940        ELSE
052950            COMPUTE DIAS-UTEIS-SPREAD-WS =
052960                    NUM-DIAS-MES-TAB (MES-WS) - DIAS-NAO-UTEIS-WS
052970            MOVE DIAS-UTEIS-SPREAD-WS TO HAG-VRMIN-RED-WS
052980     ELSE
052990*       MOVE 20  TO HAG-VRMIN-RED-WS
053000        MOVE HAG-VRMIN-RED-WS TO DIAS-UTEIS-SPREAD-WS.
053010
053020     IF DATA-ATL-ANTERIOR-AG-RED-WS EQUAL CH-DATA-D07
053030        ADD 1 TO HAG-DIAS-UTEIS-RED-WS.
053040
053090*----------------------------------------------------------------*
053100 90-35-ZERA-TABELAS.                                              00053100
053110*                                                                 00053110
053120     MOVE ZEROS TO Z-ACUM-QDE-ATL-TAB                             00053120
053130                   Z-ACUM-SLD-ATL-TAB                             00053130
053140                   Z-ACUM-QDE-ANT-TAB                             00053140
053150                   Z-ACUM-SLD-ANT-TAB                             00053150
053160     MOVE TABELA-ACUM-SALDO TO Z-RESTO-TAB-ACUM.                  00053160
053170                                                                  00053170
053180     MOVE ZEROS TO Z-ACUM-QDE-CRED-TAB                            00053180
053190                   Z-ACUM-VR-CRED-TAB                             00053190
053200                   Z-ACUM-QDE-DEB-TAB                             00053200
053210                   Z-ACUM-VR-DEB-TAB                              00053210
053220     MOVE TABELA-ACUM-DEB-CRED TO Z-RESTO-TAB-DEB-CRED.           00053220
053230                                                                  00053230
053240     MOVE ZEROS TO Z-ACUM-TPOCR-TAB.                              00053240
053250     MOVE TAB-ACUM-TPOCR TO Z-RESTO-ACUM-TPOCR.                   00053250

053270*----------------------------------------------------------------*00053270
053280 92-35-TESTA-CADASTRO.                                            00053280
053290*                                                                 00053290
053300     ADD 1 TO ACUM-CAD-CC.                                        00053300
053310     MOVE 1 TO SW-GERA-FICHA SW-F10 SW-IMPLANTACAO.               00053310
053320     MOVE 22 TO C-CC-COD-MENS-D10.                                00053320
053330     MOVE SPACES TO C-CC-TPSLD-ANT-D10 ENDERECO-WS.               00053330
053340                                                                  00053340
053350     IF C-CC-CAMPO-A-D07 = 'A' AND                                00053350
053360        C-CC-CAMPO-B-D07 = 'B' AND                                00053360
053370        C-CC-CAMPO-C-D07 = 'C'                                    00053370
053380        IF C-CC-CAMPO-D-D07 = 'D'                                 00053380
053390           MOVE 2 TO TIPO-CAD-02DD                                00053390
053400*....                                                             00053400
053410           MOVE 84 TO TPCONTAB-RED-WS                             00053410
053420*....                                                             00053420
053430           PERFORM 115-35-REG2-ATL-CORRENTISTA                    00053430
053440        ELSE                                                      00053440
053450           MOVE 2 TO TIPO-CAD-02DD                                00053450
053460           MOVE 84 TO TPCONTAB-RED-WS                             00053460
053470           PERFORM 115-35-REG2-ATL-CORRENTISTA                    00053470
053480           PERFORM 216-35-INCLUI-CTA-CLASSIF-D128                 00053480
053490           MOVE 56 TO C-CC-COD-MENS-D10                           00053490
053500     ELSE                                                         00053500
053510        IF C-CC-CAMPO-D-D07 = 'D'                                 00053510
053520           MOVE 2 TO TIPO-CAD-02DD                                00053520
053530           MOVE 54 TO C-CC-COD-MENS-D10                           00053530
053540           MOVE 1 TO SW-INCLUE-D-SEM-SICAD                        00053540
053550           PERFORM 115-35-REG2-ATL-CORRENTISTA                    00053550
053560           MOVE ZEROS   TO CEP-WS FONE-WS                         00053560
053570           MOVE ALL '*' TO NOME-RED-WS                            00053570
053580                           CONT-NOME-RED-WS                       00053580
053590                           E-CID-RED-WS  CID-WS                   00053590
053600                           E-EST-RED-WS  EST-WS                   00053600
053610                           E-RUA-RED-WS  RUA-WS                   00053610
053620                           E-BAIR-RED-WS BAIR-WS                  00053620
053630        ELSE                                                      00053630
053640          MOVE ZERO TO SW-F10 SW-IMPLANTACAO                      00053640
053650          MOVE 1 TO SW-GRAVACAO                                   00053650
053660          MOVE 11 TO C-CC-COD-MENS-D10.                           00053660
053670                                                                  00053670
053680     PERFORM 545-35-OCR-CAD-CC.                                   00053680
053690     PERFORM 124-124-GRAVA-D0480701.                              00053690

053710*----------------------------------------------------------------*00053710
053720 95-35-CADASTRO-CC.                                               00053720
053730*                                                                 00053730
053750     MOVE 23 TO C-CC-COD-MENS-D10.                                00053750
053760                                                                  00053760
053770     IF C-CC-CAMPO-D-D07 = 'D'                                    00053770
053780        IF TPCONTAB-RED-WS NOT = C-CC-TPCONTAB-D07                00053780
053790           PERFORM 96-95-MUDANCA-TIPO-CONTABIL                    00053790
053800        ELSE                                                      00053800
053810           PERFORM 134-35-PESQ-MOVIMENTACAO                       00053810
053820           PERFORM 545-35-OCR-CAD-CC                              00053820
053830           MOVE 3 TO TIPO-CAD-02DD                                00053830
053840           MOVE 24 TO C-CC-COD-MENS-D10                           00053840
053850           PERFORM 115-35-REG2-ATL-CORRENTISTA                    00053850
053860           PERFORM 545-35-OCR-CAD-CC                              00053860
053870     ELSE                                                         00053870
053880         PERFORM 134-35-PESQ-MOVIMENTACAO                         00053880
053890         PERFORM 545-35-OCR-CAD-CC                                00053890
053900         MOVE 24 TO C-CC-COD-MENS-D10                             00053900
053910         PERFORM 115-35-REG2-ATL-CORRENTISTA                      00053910
053920         PERFORM 545-35-OCR-CAD-CC.                               00053920
053930                                                                  00053930
053940     ADD  1 TO ACUM-CAD-CC.                                       00053940
053950     ADD -1 TO ACUM-OUTROS.                                       00053950
053960     PERFORM 124-124-GRAVA-D0480701.                              00053960
053970                                                                  00053970
053980*----------------------------------------------------------------*00053980
053990 96-95-MUDANCA-TIPO-CONTABIL.                                     00053990
054000                                                                  00054000
054010     PERFORM 545-35-OCR-CAD-CC.                                   00054010
054020     PERFORM  115-35-REG2-ATL-CORRENTISTA.                        00054020
054030     IF (CONSISTENCIA-OK AND                                      00054030
054040         C-CC-PARTE-D-D07 NOT EQUAL SPACES)                       00054040
              MOVE SPACES TO REG-AC-EXT-CONTAB-D10
              INITIALIZE REG-AC-EXT-CONTAB-D10
054050        PERFORM 105-35-REG2-ACUMULA                               00054050
054060        MOVE 'C' TO DI-AC-CAD-WS AC-EC-CAD-WS                     00054060
054070                                 ESP-AC-CAD-WS                    00054070
054080        MOVE 1 TO CH-SEQUENC-D10                                  00054080
054090        MOVE ZERO TO DI-MOV-LOTE-WS                               00054090
054100        MOVE 14 TO DI-MOV-HIST-WS                                 00054100
054110        PERFORM  520-35-OCR-DIARIO-CC                             00054110
054120        MOVE 14 TO AC-EC-MOV-HIST-D10                             00054120
054130        PERFORM  540-35-OCR-ACERTO-EXT-CONTABIL                   00054130
              MOVE SPACES TO REG-AC-EXT-CONTAB-D10
              INITIALIZE REG-AC-EXT-CONTAB-D10
054140        PERFORM  110-35-REG2-ESPECIAIS                            00054140
054150        MOVE 5 TO EXT-COD-MENS-WS                                 00054150
054160        MOVE 11 TO EXT-COD-MENS-D10                               00054160
054170        MOVE 89 TO DI-MOV-HIST-WS                                 00054170
054180        MOVE 3 TO TIPO-CAD-02DD                                   00054180
054190        MOVE 24 TO C-CC-COD-MENS-D10                              00054190
054200        PERFORM  545-35-OCR-CAD-CC                                00054200
054210        MOVE 2 TO CH-SEQUENC-D10                                  00054210
054220        PERFORM  520-35-OCR-DIARIO-CC                             00054220
054230        MOVE 89 TO AC-EC-MOV-HIST-D10                             00054230
054240        PERFORM  540-35-OCR-ACERTO-EXT-CONTABIL                   00054240
054250     ELSE                                                         00054250
054260        PERFORM  545-35-OCR-CAD-CC.                               00054260
054270                                                                  00054270
054300*----------------------------------------------------------------*00054300
054310 105-35-REG2-ACUMULA.                                             00054310
054320*                                                                 00054320
054330     IF SLD-DEP-RED-WS GREATER ZERO                               00054330
054340         ADD SLD-DEP-RED-WS TO ACUM-VR-CRED-TAB                   00054340
054350                                  (C-CC-TPCONTAB-D07)             00054350
054360         ADD 1 TO ACUM-QDE-CRED-TAB (C-CC-TPCONTAB-D07)           00054360
054370        ADD SLD-DEP-RED-WS TO ACUM-VR-DEB-TAB                     00054370
054380                                  (TPCONTAB-RED-WS)               00054380
054390        ADD 1 TO ACUM-QDE-DEB-TAB (TPCONTAB-RED-WS)               00054390
054400     ELSE                                                         00054400
054410        ADD 1 TO ACUM-QDE-DEB-TAB (C-CC-TPCONTAB-D07)             00054410
054420        ADD 1 TO ACUM-QDE-CRED-TAB (TPCONTAB-RED-WS)              00054420
054430        COMPUTE ACUM-VR-DEB-TAB (C-CC-TPCONTAB-D07) =             00054430
054440               (SLD-DEP-RED-WS * -1) + ACUM-VR-DEB-TAB            00054440
054450               (C-CC-TPCONTAB-D07)                                00054450
054460        COMPUTE ACUM-VR-CRED-TAB (TPCONTAB-RED-WS) =              00054460
054470           (SLD-DEP-RED-WS * -1) + ACUM-VR-CRED-TAB               00054470
054480                     (TPCONTAB-RED-WS).                           00054480

054510*----------------------------------------------------------------*00054510
054520 110-35-REG2-ESPECIAIS.                                           00054520
054530*                                                                 00054530
054540     MOVE SLD-DEP-RED-WS TO DI-MOV-VR-WS SALDO-VR-ABSOLUTO.       00054540
054550     MOVE 'D' TO TPSLD-ANT.                                       00054550
054560                                                                  00054560
054570     IF SLD-DEP-RED-WS LESS ZEROS                                 00054570
054580         IF JURIDICA OR PESSOA-K OR (CTA-DIGITAL AND P-JURIDICAS) 00054580
054590             IF SALDO-VR-ABSOLUTO GREATER GR-DEB-PJUR-WS          00054590
054600                 MOVE 1 TO SW-OCR-GR-DIFERENCA                    00054600
054610                 PERFORM 530-35-OCR-ESPECIAIS                     00054610
054620             ELSE                                                 00054620
054630                 NEXT SENTENCE                                    00054630
054640         ELSE                                                     00054640
054650             IF SALDO-VR-ABSOLUTO GREATER GR-DEB-PFIS-WS          00054650
054660                 MOVE 1 TO SW-OCR-GR-DIFERENCA                    00054660
054670                 PERFORM 530-35-OCR-ESPECIAIS                     00054670
054680             ELSE                                                 00054680
054690                 NEXT SENTENCE                                    00054690
054700     ELSE                                                         00054700
054710         IF JURIDICA OR PESSOA-K OR (CTA-DIGITAL AND P-JURIDICAS) 00054710
054720             IF SLD-DEP-RED-WS GREATER GR-CRED-PJUR-WS            00054720
054730                 MOVE 1 TO SW-OCR-GR-DIFERENCA                    00054730
054740                 PERFORM 530-35-OCR-ESPECIAIS                     00054740
054750             ELSE                                                 00054750
054760                 NEXT SENTENCE                                    00054760
054770         ELSE                                                     00054770
054780             IF SLD-DEP-RED-WS GREATER GR-CRED-PFIS-WS            00054780
054790                 MOVE 1 TO SW-OCR-GR-DIFERENCA                    00054790
054800                 PERFORM 530-35-OCR-ESPECIAIS.                    00054800

054810*----------------------------------------------------------------*00054810
054820 115-35-REG2-ATL-CORRENTISTA.                                     00054820
054830*                                                                 00054830
054850     IF C-CC-CAMPO-A-D07 = 'A'                                    00054850
054860        IF E-EST-RED-WS EQUAL '**'                                00054860
054870           PERFORM 115A-CONSISTENCIA-ABC.                         00054870
054880                                                                  00054880
054890     IF C-CC-CAMPO-A-D07 = 'A'                                    00054890
054900        MOVE C-CC-CPF-CGC-D07    TO CPF-CGC-RED-WS                00054900
054910                                    NUM-CPF-CGC-WS                00054910
054920        MOVE C-CC-ID-CPF-CGC-D07 TO ID-CPF-CGC-RED-WS             00054920
054930        PERFORM 117-115-PREPARA-CPF-CGC-D83                       00054930
054940        MOVE C-CC-CID-D07        TO E-CID-RED-WS CIDADE-D83-WS    00054940
054950                                    CID-WS                        00054950
054960        MOVE C-CC-EST-D07        TO E-EST-RED-WS ESTADO-D83-WS    00054960
054970                                    EST-WS                        00054970
054980        MOVE C-CC-RUA-D07        TO E-RUA-RED-WS RUA-D83-WS       00054980
054990                                    RUA-WS                        00054990
055000        MOVE C-CC-FONE-D07       TO E-FONE-RED-WS FONE-WS         00055000
055010                                    FONE-D83-WS                   00055010
055020        MOVE CH-CODAG-D07        TO COD-AG-D83-WS                 00055020
055040        MOVE CONTA-D07           TO CONTA-D83-WS                  00055040
055060        MOVE DV-CONTA-D07        TO DIGITO-D83-WS                 00055060
055080        MOVE CH-DATA-D07         TO ATL-ULT-DT-RED-WS             00055080
055110        MOVE CALC-SMED-RED-WS    TO CALC-SMED-D83-WS              00055110
055140        MOVE 1                   TO SW-EXISTE-CAMPO-A.            00055140
055150                                                                  00055150
055160     IF C-CC-CAMPO-B-D07 = 'B'                                    00055160
055170        MOVE C-CC-CD-CLI-D07     TO CD-CLI-RED-WS                 00055170
055180        MOVE C-CC-BAIRRO-D07     TO E-BAIR-RED-WS BAIRRO-D83-WS   00055180
055190                                    BAIR-WS                       00055190
055200        MOVE C-CC-CEP-D07        TO COD-POSTAL-RED-WS CEP-D83-WS  00055200
055210                                    CEP-WS                        00055210
055220        MOVE CONTA-D07           TO CONTA-D83-WS                  00055220
055240        MOVE DV-CONTA-D07        TO DIGITO-D83-WS                 00055240
055260        MOVE CH-CODAG-D07        TO COD-AG-D83-WS                 00055260
055310        MOVE CALC-SMED-RED-WS    TO CALC-SMED-D83-WS              00055310
055330        MOVE 1                   TO SW-EXISTE-CAMPO-B.            00055330
055340                                                                  00055340
055350     IF C-CC-CAMPO-C-D07 = 'C'                                    00055350
055360        MOVE CONTA-D07           TO CONTA-D83-WS                  00055360
055380        MOVE DV-CONTA-D07        TO DIGITO-D83-WS                 00055380
055400        MOVE CH-CODAG-D07        TO COD-AG-D83-WS                 00055400
055420        MOVE CH-DATA-D07         TO ATL-ULT-DT-RED-WS             00055420
055450        MOVE CALC-SMED-RED-WS    TO CALC-SMED-D83-WS              00055450
055480        MOVE 1                   TO SW-EXISTE-CAMPO-C             00055480
055490        MOVE ZEROS               TO SW-FIM-T048NM SW-TEM-T048NM   00055490
055500        PERFORM 119-115-PESQUISA-T048NMCT                         00055500
055510                UNTIL FIM-T048NM OR TEM-T048NM                    00055510
055520        PERFORM 116-115-TESTA-GERA-EXTR-TELEX                     00055520
055530        IF  TEM-T048NM                                            00055530
055540        AND ID-SIT-CTA-COR = 0                                    00055540
055550        AND ID-ST-CAD = 0                                         00055550
055560            MOVE NM-CTA-COR OF DCLV048NMCT TO                     00055560
055570                            NOME-RED-WS NOME-D83-WS               00055570
055580            MOVE CP-NM-CTA-COR OF DCLV048NMCT TO                  00055580
055590                           CONT-NOME-RED-WS CONT-NOME-D83-WS      00055590
055600        ELSE                                                      00055600
055610            MOVE C-CC-NOME-D07   TO NOME-RED-WS NOME-D83-WS       00055610
055630            MOVE C-CC-CONT-NOME-D07 TO CONT-NOME-RED-WS           00055630
055640                                       CONT-NOME-D83-WS.          00055640
055650                                                                  00055650
055660     IF C-CC-CAMPO-D-D07 = 'D'                                    00055660
055670        PERFORM 118-115-ATUALIZA-CAD-D.                           00055670
055680                                                                  00055680
055690     IF NOT EXISTE-CAMPO-A                                        00055690
055700        MOVE ZEROS TO CGC-CPF-D83-WS                              00055700
055720                      BARRA-CGC-D83-WS                            00055720
055740                      CONTR-CGC-CPF-D83-WS                        00055740
055760        MOVE ZEROS  TO FONE-D83-WS.                               00055760
055780                                                                  00055780
055790     IF NOT EXISTE-CAMPO-B                                        00055790
055800        MOVE ZEROS TO  CEP-D83-WS.                                00055800
055820                                                                  00055820
055830     IF NOT EXISTE-CAMPO-D                                        00055830
055840        MOVE ZEROS TO TIPO-CONTABIL-D83-WS                        00055840
055850                      COD-TJUR-WS                                 00055850
055870                      ALIQ-IRESTL-WS                              00055870
055890        MOVE SPACES TO INDICA-CTAREMUN-WS                         00055890
055900                       INDICA-TRIB-WS.                            00055900
055910                                                                  00055910
055970     IF EXISTE-CAMPO-A OR EXISTE-CAMPO-B OR EXISTE-CAMPO-C OR     00055970
055980        EXISTE-CAMPO-D                                            00055980
055990        MOVE ZEROS TO SW-EXISTE-CAMPO-A                           00055990
056000                      SW-EXISTE-CAMPO-B                           00056000
056010                      SW-EXISTE-CAMPO-C                           00056010
056020                      SW-EXISTE-CAMPO-D.                          00056020
056030                                                                  00056030
056040*----------------------------------------------------------------*
056050 115A-CONSISTENCIA-ABC.
056060
056070      IF C-CC-ID-CPF-CGC-D07 EQUAL 1
056080         IF (TPCONTAB-RED-WS EQUAL 01) AND (FISICA OR CTA-DIGITAL)
056090            NEXT SENTENCE
056100         ELSE
056110         IF (TPCONTAB-RED-WS EQUAL 03) AND FISICA-LIGADAS
056120            NEXT SENTENCE
056130         ELSE
BOSSA            IF (TPCONTAB-RED-WS EQUAL 11 OR 20 OR 21 OR 22 OR
056150              24 OR 42 OR 70 OR 79 OR 73 OR 74 OR 75) AND PESSOA-N
056160              NEXT SENTENCE
056170           ELSE
056180             IF (TPCONTAB-RED-WS EQUAL 43 OR 58) AND
056190                (TP-PESSOA-RED-WS EQUAL 'F')
056200                NEXT SENTENCE
056210             ELSE
056220                MOVE 2 TO TIPO-CAD-02DD
056230                MOVE 84 TO TPCONTAB-RED-WS
056240                PERFORM 216-35-INCLUI-CTA-CLASSIF-D128
056250                MOVE 55 TO C-CC-COD-MENS-D10.
056260
056270      IF C-CC-ID-CPF-CGC-D07 EQUAL 2
056280         IF  (TPCONTAB-RED-WS EQUAL 02 OR 04 OR 72)
               AND (JURIDICA OR CTA-DIGITAL)
056290            NEXT SENTENCE
056300         ELSE
056310          IF (TPCONTAB-RED-WS EQUAL 05 OR 06 OR 07 OR 08 OR 09 OR
056320            10 OR 12 OR 13 OR 14 OR 15 OR 16 OR 17 OR
056330**          18 OR 19 OR 20 OR 23 OR 26 OR 27 OR 28 OR 33 OR 34 OR
100112            18 OR 19 OR 20 OR 23 OR 26 OR 27 OR 28 OR       34 OR
056340            35 OR 36 OR 37 OR 38 OR 39 OR
056350            45 OR 46 OR 47 OR 48 OR 49 OR 51 OR 52 OR 53 OR
056360            54 OR 55 OR 56 OR 57 OR 59 OR 71 OR 76 OR 80) AND
056370            PESSOA-K
056380              NEXT SENTENCE
056390          ELSE
BOSSA            IF (TPCONTAB-RED-WS EQUAL 11 OR 21 OR 24 OR 30 OR
100112                                                 31 OR 33 OR
056410                                     42 OR 70 OR 77 OR 79) AND
056420              (TP-PESSOA-RED-WS EQUAL 'K')
056430               NEXT SENTENCE
056440            ELSE
056450              IF (TPCONTAB-RED-WS EQUAL 43 OR 58) AND
056460                 (TP-PESSOA-RED-WS EQUAL 'J')
056470                  NEXT SENTENCE
056480              ELSE
056490                  MOVE 2 TO TIPO-CAD-02DD
056500                  MOVE 84 TO TPCONTAB-RED-WS
056510                  PERFORM 216-35-INCLUI-CTA-CLASSIF-D128
056520                  MOVE 55 TO C-CC-COD-MENS-D10.
056530
056540*----------------------------------------------------------------*
056550 116-115-TESTA-GERA-EXTR-TELEX.
056560
056570      IF C-CC-NOME-D07 NOT EQUAL SPACES
056580         MOVE CONTA-D07     TO CONTA-CAD-02DD
056590         MOVE DV-CONTA-D07  TO DIGITO-CAD-02DD
056600         MOVE SPACES        TO NOME-CLI2-CAD-02DD
056610         MOVE ZEROS         TO DTVENC-CHBNB-02DD
056620                               LIMITE-CHBNB-02DD
056630                               DTCONTR-CHBNB-02DD
056640         IF  TEM-T048NM
056650         AND ID-SIT-CTA-COR = 0
056660         AND ID-ST-CAD = 0
056670             MOVE NM-CTA-COR OF DCLV048NMCT TO NOME-CLI-CAD-02DD
056680             PERFORM 999-34-GRAVA-DISCO-TELEX
056690         ELSE
056700             MOVE C-CC-NOME-D07 TO NOME-CLI-CAD-02DD
056710             PERFORM 999-34-GRAVA-DISCO-TELEX.
056720
056730      IF C-CC-CONT-NOME-D07 NOT EQUAL SPACES
056740         MOVE 3 TO TIPO-CAD-02DD
056750         MOVE CONTA-D07 TO CONTA-CAD-02DD
056760         MOVE DV-CONTA-D07 TO DIGITO-CAD-02DD
056770         MOVE SPACES TO NOME-CLI-CAD-02DD
056780         MOVE ZEROS TO DTVENC-CHBNB-02DD
056790                       LIMITE-CHBNB-02DD
056800                       DTCONTR-CHBNB-02DD
056810         IF  TEM-T048NM
056820         AND ID-SIT-CTA-COR = 0
056830         AND ID-ST-CAD = 0
056840           MOVE CP-NM-CTA-COR OF DCLV048NMCT TO NOME-CLI2-CAD-02DD
056850           PERFORM 999-34-GRAVA-DISCO-TELEX
056860         ELSE
056870           MOVE C-CC-CONT-NOME-D07 TO NOME-CLI2-CAD-02DD
056880           PERFORM 999-34-GRAVA-DISCO-TELEX.
056890
056900*----------------------------------------------------------------*00056900
056910 117-115-PREPARA-CPF-CGC-D83.                                     00056910
056920                                                                  00056920
056930      IF C-CC-ID-CPF-CGC-D07 EQUAL '2'                            00056930
056940         MOVE CGC-WS       TO CGC-CPF-D83-WS                      00056940
056960         MOVE BARRA-CGC-WS TO BARRA-CGC-D83-WS                    00056960
056980         MOVE CONTR-CGC-WS TO CONTR-CGC-CPF-D83-WS                00056980
057000      ELSE                                                        00057000
057010      IF C-CC-ID-CPF-CGC-D07 EQUAL '1'                            00057010
057020         MOVE CPF-WS       TO CGC-CPF-D83-WS                      00057020
057040         MOVE BARRA-CPF-WS TO BARRA-CGC-D83-WS                    00057040
057060         MOVE CONTR-CPF-WS TO CONTR-CGC-CPF-D83-WS.               00057060
057080                                                                  00057080
057090*----------------------------------------------------------------*00057090
057100 118-115-ATUALIZA-CAD-D.                                          00057100
057110                                                                  00057110
057120     MOVE CH-DATA-D07            TO ATL-ULT-DT-RED-WS             00057120
057130     MOVE ZEROS                  TO SW-CONSISTENCIA               00057130
057140                                                                  00057140
057150     MOVE ZEROS                  TO TIPO-CONTABIL-D83-WS          00057150
057170     MOVE SPACES                 TO TIPO-PESSOA-D83-WS            00057170
057270     MOVE ZEROS                  TO ISENCAO-IPMF-D83-WS           00057270
057320                                                                  00057320
057330     IF INCLUSAO-D-SEM-SICAD                                      00057330
057340        MOVE ZEROS TO SW-INCLUE-D-SEM-SICAD                       00057340
057350     ELSE                                                         00057350
057360        PERFORM 119-CONSISTENCIA.                                 00057360

057450     IF CONSISTENCIA-OK                                           00057450
057460        IF C-CC-PARTE-D-D07 NOT EQUAL SPACES
                 IF ((C-CC-TPPESSOA-D07 = 'V' OR 'G' OR '<' OR '>')
                 OR  (CONTA-EMPRESARIAL-D07 AND NOT PESSOA-MPE-D07)
                 OR   CONTA-INVESTIMENTO-D07
                 OR   CONTA-SALARIO-D07)
057500              MOVE INDICACOES-WS TO INDICA-WS
057510              MOVE 1             TO FORNECER-TALAO-WS
057520              MOVE INDICA-WS     TO INDICACOES-WS.                00057520
057530                                                                  00057530
057540     IF CONSISTENCIA-OK                                           00057540
057550        IF C-CC-PARTE-D-D07 NOT EQUAL SPACES                      00057550
057560           IF C-CC-GRUPO-TARIFA-D07 = 1                           00057560
057570              MOVE INDICACOES-WS TO INDICA-WS                     00057570
057580              IF FORNECER-TALAO-WS = 0                            00057580
057590                 MOVE 1          TO FORNECER-TALAO-WS             00057590
057600                 MOVE INDICA-WS  TO INDICACOES-WS.                00057600
057610                                                                  00057610
057630*    IF CONSISTENCIA-OK                                           00057630
057640*     IF C-CC-PARTE-D-D07 NOT EQUAL SPACES                        00057640
057650*       MOVE C-CC-OPCAO-PC-D07         TO OPCAO-PC-RED-WS         00057650
057660*       IF C-CC-OPCAO-PC-D07 EQUAL 'N'                            00057660
057670*          MOVE ZEROS                  TO DT-OPCAO-PC-RED-WS      00057670
057680*       ELSE                                                      00057680
057690*         IF C-CC-OPCAO-PC-D07 EQUAL 'S' AND                      00057690
057700*            DT-OPCAO-PC-RED-WS EQUAL ZEROS                       00057700
057710*            MOVE CH-DATA-D07          TO DT-OPCAO-PC-RED-WS.     00057710
057720                                                                  00057720
057880     IF CONSISTENCIA-OK                                           00057880
057890      IF C-CC-PARTE-D-D07 NOT EQUAL SPACES                        00057890
057900         IF TP-PESSOA-RED-WS = 'G' AND C-CC-TPPESSOA-D07 NOT = 'G'00057900
057910            MOVE SPACES TO REG-D10S                               00057910
057920            MOVE CH-CODAG-D07 TO AGN-D10S                         00057920
057930            MOVE CONTA-D07    TO CTA-D10S                         00057930
057940            MOVE DV-CONTA-D07 TO DIG-D10S                         00057940
057950            MOVE CH-DATA-D07  TO DT-OCOR-D10S                     00057950
057960            MOVE DT-BLOQ-DESBLOQ-RED-WS TO DT-BLOQ-D10S           00057960
057970            MOVE SLD-DEP-RED-WS TO SALDO-D10S                     00057970
057980            MOVE 01 TO COD-OCOR-D10S                              00057980
057990            WRITE REG-D10S                                        00057990
058000              INVALID KEY                                         00058000
058010               DISPLAY '**P04808-CANCEL.AREA INSUF.P/D04810S**'   00058010
058020               MOVE COD-RETORNO-WS (3) TO RETURN-CODE             00058020
058030               DISPLAY 'RETURN CODE EH...' COD-RETORNO-WS (3)     00058030
058040               DISPLAY 'MENSAGEM RETORNO EH...' MEN-RETORNO-WS(3) 00058040
058050               GOBACK.                                            00058050
058060                                                                  00058060
058070     IF CONSISTENCIA-OK                                           00058070
058080      IF C-CC-PARTE-D-D07 NOT EQUAL SPACES                        00058080
058090        MOVE 1 TO SW-EXISTE-CAMPO-D                               00058090
058100        MOVE C-CC-TPCONTAB-D07   TO TPCONTAB-RED-WS               00058100
058110                                    TIPO-CONTABIL-D83-WS          00058110
058130        MOVE ZEROS TO IND-COMPULSO                                00058130

      *       ESSA TABELA NO  DE AGENCIAS EMBORA SEJA 998 TIMES
BOSSA         PERFORM 118-ISENTA-COMPULSORIO 998 TIMES                  00058140
058150        MOVE C-CC-TPPESSOA-D07   TO TP-PESSOA-RED-WS              00058150
058160                                    TIPO-PESSOA-D83-WS            00058160
058180      ELSE                                                        00058180
058190        MOVE TPCONTAB-RED-WS     TO TIPO-CONTABIL-D83-WS          00058190
058210        MOVE TP-PESSOA-RED-WS    TO TIPO-PESSOA-D83-WS            00058210
058230     ELSE                                                         00058230
058240        MOVE SPACES              TO C-CC-PARTE-D-D07              00058240
058250        MOVE 57                  TO C-CC-COD-MENS-D10.            00058250
058260                                                                  00058260
058270     IF C-CC-PARTE-D-D07 NOT EQUAL SPACES                         00058270
058280      MOVE C-CC-TXPERM-D07           TO TX-PERM-RED-WS            00058280
058290      MOVE C-CC-SMED-D07             TO CALC-SMED-RED-WS          00058290
058300                                        CALC-SMED-D83-WS          00058300
058320      MOVE C-CC-EXTRATO-ESPE-D07     TO EXTRATO-ESPECIAL-RED-WS   00058320
058330      MOVE C-CC-CLIENTE-PREFEREN-D07 TO CLIENTE-PREFEREN-RED-WS   00058330
058340      MOVE C-CC-TP-TALAO-D07         TO TP-TALAO-RED-WS           00058340
058350      MOVE C-CC-COD-POSTO-D07        TO COD-POSTO-RED-WS          00058350
058360      MOVE C-CC-COD-TJUR-D07         TO COD-TJUR-WS               00058360
058380      MOVE C-CC-INDICA-CTAREMUN-D07  TO INDICA-CTAREMUN-WS        00058380
058400      MOVE C-CC-INDICA-TRIB-D07      TO INDICA-TRIB-WS            00058400
058420      MOVE C-CC-ALIQ-IRESTL-D07      TO ALIQ-IRESTL-WS            00058420
058440      MOVE C-CC-ISENCAO-IPMF-D07     TO ISENCAO-IPMF-RED-WS       00058440
058450                                        ISENCAO-IPMF-D83-WS       00058450
058470      MOVE C-CC-AVISO-LANC-D07       TO AVISO-LANC-RED-WS         00058470
058480*     MOVE C-CC-OPCAO-PC-D07         TO OPCAO-PC-RED-WS           00058480
058490      MOVE C-CC-MANIFESTACAO-IN89-D07 TO MANIFESTACAO-RED-WS      00058490
058500                                                                  00058500
058580      MOVE C-CC-CD-CLI-COTIT-D07     TO CD-CLI-COTIT-RED-WS       00058580
058600      MOVE C-CC-IND-ALT-COTIT-D07    TO IND-ALT-COTIT-RED-WS      00058600
058640      MOVE C-CC-INI-ISENCAO-D07      TO INI-LIMINAR-RED-WS        00058640
058650      MOVE C-CC-FIM-ISENCAO-D07      TO FIM-LIMINAR-RED-WS        00058650
058660                                                                  00058660
            IF C-CC-GRUPO-TARIFA-D07 NOT EQUAL ZEROS
               IF NR-GP-TAR OF DCLV048CCAD EQUAL ZEROS
                  MOVE CH-DATA-D07   TO ADESAO-WS
                  MOVE DIA-ADESAO-WS TO DIA-DB2
                  MOVE MES-ADESAO-WS TO MES-DB2
                  CALL 'M0952000' USING ANO-ADESAO-WS, ANO-DB2
                  MOVE DATA-DB2      TO DT-ADS-GP-TAR OF DCLV048CCAD
                  MOVE C-CC-GRUPO-TARIFA-D07
                                     TO NR-GP-TAR     OF DCLV048CCAD
               ELSE
                  IF C-CC-GRUPO-TARIFA-D07 NOT EQUAL
                                        NR-GP-TAR OF DCLV048CCAD
                     MOVE CH-DATA-D07   TO ADESAO-WS
                     MOVE DIA-ADESAO-WS TO DIA-DB2
                     MOVE MES-ADESAO-WS TO MES-DB2
                     CALL 'M0952000' USING ANO-ADESAO-WS, ANO-DB2
                     MOVE DATA-DB2      TO DT-ADS-GP-TAR OF DCLV048CCAD
                     MOVE C-CC-GRUPO-TARIFA-D07
                                        TO NR-GP-TAR     OF DCLV048CCAD.

            IF C-CC-GRUPO-TARIFA-D07 EQUAL ZEROS
               IF NR-GP-TAR OF DCLV048CCAD NOT EQUAL ZEROS
                  MOVE CH-DATA-D07   TO ADESAO-WS
                  MOVE DIA-ADESAO-WS TO DIA-DB2
                  MOVE MES-ADESAO-WS TO MES-DB2
                  CALL 'M0952000' USING ANO-ADESAO-WS, ANO-DB2
                  MOVE DATA-DB2      TO DT-ADS-GP-TAR OF DCLV048CCAD
                  MOVE C-CC-GRUPO-TARIFA-D07
                                     TO NR-GP-TAR     OF DCLV048CCAD.

      ******************************************************************
058770*    IF C-CC-GRUPO-TARIFA-D07 NOT EQUAL ZEROS                     00058770
058780*       IF GRUPO-TARIFA-RED-WS EQUAL ZEROS                        00058780
058790*          MOVE CH-DATA-D07 TO ADESAO-GRUPO-TARIFA-RED-WS         00058790
058800*          MOVE C-CC-GRUPO-TARIFA-D07 TO GRUPO-TARIFA-RED-WS      00058800
058810*       ELSE                                                      00058810
058820*         IF C-CC-GRUPO-TARIFA-D07 NOT EQUAL GRUPO-TARIFA-RED-WS  00058820
058830*            MOVE CH-DATA-D07 TO ADESAO-GRUPO-TARIFA-RED-WS       00058830
058840*            MOVE C-CC-GRUPO-TARIFA-D07 TO GRUPO-TARIFA-RED-WS.   00058840
058850*                                                                 00058850
058860*    IF C-CC-GRUPO-TARIFA-D07 EQUAL ZEROS                         00058860
058870*       IF GRUPO-TARIFA-RED-WS NOT EQUAL ZEROS                    00058870
058880*          MOVE ZEROS TO ADESAO-GRUPO-TARIFA-RED-WS               00058880
058890*          MOVE C-CC-GRUPO-TARIFA-D07 TO GRUPO-TARIFA-RED-WS.     00058890
      ******************************************************************
058900                                                                  00058900
058950     MOVE CONTA-D07                 TO CONTA-D83-WS               00058950
058970     MOVE DV-CONTA-D07              TO DIGITO-D83-WS              00058970
058990     MOVE CH-CODAG-D07              TO COD-AG-D83-WS.             00058990
059020                                                                  00059020
059720*----------------------------------------------------------------*00059720
059730 118-ISENTA-COMPULSORIO.                                          00059730
059740*                                                                 00059740
059750     ADD 1 TO IND-COMPULSO.                                       00059750
059760     IF TPCONTAB-RED-WS = COD-CONTABIL-TAB (IND-COMPULSO)         00059760
059770        MOVE ISENTA-COMPULSO-TAB (IND-COMPULSO) TO                00059770
059780             ISENTA-COMPULSO-RED-WS.                              00059780
059790                                                                  00059790
059800*----------------------------------------------------------------*00059800
059810 119-CONSISTENCIA.                                                00059810
059820                                                                  00059820
059830     IF C-CC-TPCONTAB-D07 EQUAL 01 OR 03                          00059830
059840     AND PESSOA-FISICA-D07                                        00059840
059850        PERFORM 119A-CONSISTE-CPF                                 00059850
059860     ELSE                                                         00059860
059870       IF C-CC-TPCONTAB-D07 EQUAL 02 OR 04 OR 72                  00059870
059880       AND PESSOA-JURIDICA-D07                                    00059880
059890          PERFORM 119B-CONSISTE-CGC                               00059890
059900       ELSE                                                       00059900
059910          PERFORM 119C-CONSISTE-OUTROS.                           00059910
059920                                                                  00059920
059930*..............................................................   00059930
059940* REJEITAR A ALTERACAO DO GRUPO TIPO CONTABIL PARA OUTRO GRUPO    00059940
059950*..............................................................   00059950

           IF TPCONTAB-RED-WS = 21 OR 23 OR 24 OR 52 OR 53 OR 71 OR 72
              IF C-CC-TPCONTAB-D07 NOT = 21 AND 23 AND 24 AND 52 AND 53
                                            AND 71 AND 72
                 MOVE 1 TO SW-CONSISTENCIA
              END-IF
           END-IF.

059930*..............................................................   00059930
059940* REJEITAR A ALTERACAO DO TIPO CONTABIL QUANDO TIVER EMPRESTIMO   00059940
059950*..............................................................   00059950
059960                                                                  00059960
059970     IF EMP-LIM-RED-WS NOT EQUAL ZEROS                            00059970
059980        IF C-CC-TPCONTAB-D07 EQUAL 01 OR 02                       00059980
                 IF C-CC-TPPESSOA-D07 EQUAL '>'
060010              MOVE 1 TO SW-CONSISTENCIA
                 END-IF
060000        ELSE                                                      00060000
060010           MOVE 1 TO SW-CONSISTENCIA                              00060010
              END-IF
           END-IF
060020                                                                  00060020
060080     IF C-CC-TPPESSOA-D07 = 'B'                                   00060080
060090        MOVE CH-CODAG-D07 TO AGENCIA-D302                         00060090
060100        MOVE CONTA-D07    TO CONTA-D302                           00060100
060110        MOVE DV-CONTA-D07 TO DG-D302                              00060110
060120        READ D30201                                               00060120
060130        IF STATUS-D302-WS EQUAL '23'                              00060130
060140           IF DATA-IMPLANTA-RED-WS NOT = DATA-D07-RED-WS          00060140
060150              MOVE 'F' TO C-CC-TPPESSOA-D07.                      00060150
060160                                                                  00060160
060170     IF C-CC-TPPESSOA-D07 = 'A' OR 'D' OR 'H' OR                  00060170
060180                            'C' OR 'R' OR 'S' OR 'T'              00060180
060190        PERFORM ALTERA-CADASTRO
060200        IF I048VEMP-RETORNO = CONS-VEMP-NAO-HA-VINCULO
060300           MOVE 'F' TO C-CC-TPPESSOA-D07
              END-IF
           END-IF.
060310                                                                  00060310
060320*----------------------------------------------------------------*00060320
060330 119A-CONSISTE-CPF.                                               00060330
060340                                                                  00060340
060350     IF ID-CPF-CGC-RED-WS NOT EQUAL 1                             00060350
060360      IF IMPESSOAL                                                00060360
060370         NEXT SENTENCE                                            00060370
060380      ELSE                                                        00060380
060390       IF (TPCONTAB-RED-WS EQUAL 84 AND                           00060390
060400           ID-CPF-CGC-RED-WS EQUAL 0)                             00060400
060410          NEXT SENTENCE                                           00060410
060420       ELSE                                                       00060420
060430          MOVE 1 TO SW-CONSISTENCIA.                              00060430
060440                                                                  00060440
060450*----------------------------------------------------------------*00060450
060460 119B-CONSISTE-CGC.                                               00060460
060470                                                                  00060470
060480     IF ID-CPF-CGC-RED-WS NOT EQUAL 2                             00060480
060490      IF IMPESSOAL                                                00060490
060500         NEXT SENTENCE                                            00060500
060510      ELSE                                                        00060510
060520      IF (TPCONTAB-RED-WS EQUAL 84 AND                            00060520
060530          ID-CPF-CGC-RED-WS EQUAL 0)                              00060530
060540         NEXT SENTENCE                                            00060540
060550      ELSE                                                        00060550
060560        MOVE 1 TO SW-CONSISTENCIA.                                00060560
060570                                                                  00060570
060580*----------------------------------------------------------------*00060580
060590 119C-CONSISTE-OUTROS.                                            00060590
060600                                                                  00060600
BOSSA       IF C-CC-TPCONTAB-D07 EQUAL 20 OR 73 OR 74 OR 75             00060610
060620        IF PESSOA-N-D07                                           00060620
060630           PERFORM 119A-CONSISTE-CPF                              00060630
060640        ELSE                                                      00060640
060650          IF PESSOA-K-D07                                         00060650
060660             PERFORM 119B-CONSISTE-CGC                            00060660
060670          ELSE                                                    00060670
060680            MOVE 1 TO SW-CONSISTENCIA                             00060680
060690      ELSE                                                        00060690
060700      IF C-CC-TPCONTAB-D07 EQUAL 22                               00060700
060710        IF PESSOA-N-D07                                           00060710
060720           PERFORM 119A-CONSISTE-CPF                              00060720
060730        ELSE                                                      00060730
060740            MOVE 1 TO SW-CONSISTENCIA                             00060740
060750      ELSE                                                        00060750
060760      IF C-CC-TPCONTAB-D07 EQUAL 27 OR 77 OR 30                   00060760
100112                                    OR 31 OR 33
060770          IF PESSOA-K-D07                                         00060770
060780             PERFORM 119B-CONSISTE-CGC                            00060780
060790          ELSE                                                    00060790
060800            MOVE 1 TO SW-CONSISTENCIA                             00060800
060810      ELSE                                                        00060810
060820      IF C-CC-TPCONTAB-D07 EQUAL 11 OR 21 OR 24 OR                00060820
060830*                                27 OR 29 OR 31 OR                00060830
100112                                 27 OR 29 OR
060840                                 32 OR 41 OR 42 OR                00060840
060850                                 70 OR 79                         00060850
060860        IF PESSOA-N-D07 OR PESSOA-V-D07                           00060860
060870           PERFORM 119A-CONSISTE-CPF                              00060870
060880        ELSE                                                      00060880
060890          IF PESSOA-K-D07                                         00060890
060900             PERFORM 119B-CONSISTE-CGC                            00060900
060910          ELSE                                                    00060910
060920            MOVE 1 TO SW-CONSISTENCIA                             00060920
060930      ELSE                                                        00060930
060940       IF C-CC-TPCONTAB-D07 EQUAL 43 OR 58                        00060940
060950         IF C-CC-TPPESSOA-D07 EQUAL 'F'                           00060950
060960            PERFORM 119A-CONSISTE-CPF                             00060960
060970         ELSE                                                     00060970
060980            PERFORM 119B-CONSISTE-CGC                             00060980
060990       ELSE                                                       00060990
061000         IF PESSOA-K-D07                                          00061000
061010            PERFORM 119B-CONSISTE-CGC                             00061010
061020         ELSE                                                     00061020
061030            MOVE 1 TO SW-CONSISTENCIA.                            00061030
061040                                                                  00061040
061360*----------------------------------------------------------------*00061360
061370 119E-PESQUISA-ARQ-EXT-MENSAL.
061380     MOVE 9999         TO SEQUENCIAL-EXT.
061390     MOVE CH-CODAG-D07 TO CH-AG-EXT.
061400     MOVE CONTA-D07    TO CH-CONTA-EXT.
061410     MOVE DV-CONTA-D07 TO CH-DIGITO-EXT.
061420     MOVE 4            TO CH-TIPOREG-EXT.
061430     MOVE ZEROS        TO CH-SEQUENCIAL-EXT.
061440     MOVE ZEROS        TO SW-ACHA-HIST.
061450     START ArqExtMensal KEY NOT < CHAVE-EXT.
061460     IF ST-ArqExtMensal EQUAL '23' OR '10'
061470        NEXT SENTENCE
061480     ELSE
061490     IF ST-ArqExtMensal NOT = '00'
061500        MOVE ST-ArqExtMensal TO FILE-STATUS-WS
061510        MOVE 'P04808 - ERRO NO START DO ArqExtMensal' TO
061520                          MENSAGEM-ERRO-WS
061530         PERFORM 999-99-ROT-ERRO
061540     ELSE
061550        READ ArqExtMensal NEXT
061560        PERFORM 119E-PROCESSA-EXT-MENSAL UNTIL ACHOU-HIST
061570                              OR ST-ArqExtMensal NOT = '00'
061580                              OR CH-CODAG-D07 NOT = CH-AG-EXT
061590                              OR CONTA-D07 NOT = CH-CONTA-EXT
061600                              OR DV-CONTA-D07 NOT = CH-DIGITO-EXT.

061610*----------------------------------------------------------------*
061620 119E-PROCESSA-EXT-MENSAL.
061630     IF ST-ArqExtMensal NOT = '00' AND '23' AND '10'
061640        MOVE ST-ArqExtMensal TO FILE-STATUS-WS
061650        MOVE 'P04808 - ERRO NA LEITURA DO D04801' TO
061660                          MENSAGEM-ERRO-WS
061670        PERFORM 999-99-ROT-ERRO.
061680     IF CH-TIPOREG-EXT = 4
061690        MOVE ZEROS TO IND-MOV
061700        PERFORM 119E-PROCESSA-EXT UNTIL IND-MOV = EXT-MOV-NUM-EXT
061710     ELSE
061720     IF CH-TIPOREG-EXT = 5
061730        MOVE ZEROS TO IND-MOV
061740        PERFORM 119E-PROCESSA-COR UNTIL IND-MOV = MOV-NUM-EXT.
061750     READ ArqExtMensal NEXT.
061760
061770*----------------------------------------------------------------*
061780 119E-PROCESSA-EXT.
061790     ADD 1 TO IND-MOV.
061800     IF EXT-HIST-EXT(IND-MOV) = 178 OR 070 OR 085 OR 093
061810        IF C-CC-TPPESSOA-D07 = 'D' OR 'C' OR 'R' OR 'S' OR 'T'
061820           MOVE 1 TO SW-ACHA-HIST
061830        ELSE
061840           NEXT SENTENCE
061850     ELSE
061860     IF EXT-HIST-EXT(IND-MOV) = 161 OR 164 OR 176 OR 165 OR 197 OR
061870                                160 OR 270 OR 097 OR 088 OR 198 OR
061880                                083
061890        IF C-CC-TPPESSOA-D07 = 'H' OR 'A' OR 'C'
061900           MOVE 1 TO SW-ACHA-HIST.
061910
061920*----------------------------------------------------------------*
061930 119E-PROCESSA-COR.

061940     ADD 1 TO IND-MOV.
061950     IF HIST-MOV-EXT(IND-MOV) = 178 OR 070 OR 085 OR 093
061960        IF C-CC-TPPESSOA-D07 = 'D' OR 'C' OR 'R' OR 'S' OR 'T'
061970           MOVE 1 TO SW-ACHA-HIST
061980        ELSE
061990           NEXT SENTENCE
062000     ELSE
062010     IF HIST-MOV-EXT(IND-MOV) = 161 OR 164 OR 176 OR 165 OR 197 OR
062020                                160 OR 270 OR 097 OR 088 OR 198 OR
062030                                083
062040        IF C-CC-TPPESSOA-D07 = 'H' OR 'A' OR 'C'
062050           MOVE 1 TO SW-ACHA-HIST.
062060
062070*----------------------------------------------------------------*
062080 119-115-PESQUISA-T048NMCT.                                       00062080
062090                                                                  00062090
062100     MOVE CH-CODAG-D07 TO CD-AG      OF DCLV048NMCT.              00062100
062110     MOVE CONTA-D07    TO NR-CTA-COR OF DCLV048NMCT.              00062110
062120                                                                  00062120
062130     EXEC SQL                                                     00062130
062140          SELECT *                                                00062140
062150          INTO :DCLV048NMCT:IND-V048NMCT                          00062150
062160          FROM  V048NMCT                                          00062160
062170          WHERE CD_AG      = :DCLV048NMCT.CD-AG                   00062170
062180          AND   NR_CTA_COR = :DCLV048NMCT.NR-CTA-COR              00062180
062185          WITH UR                                                 00062185
062190     END-EXEC.                                                    00062190
062200                                                                  00062200
062210     IF SQLCODE = ZEROS                                           00062210
062220        MOVE 1 TO SW-TEM-T048NM                                   00062220
062230     ELSE                                                         00062230
062240     IF SQLCODE = NOTFOUND                                        00062240
062250        MOVE 1 TO SW-FIM-T048NM                                   00062250
062260     ELSE                                                         00062260
062270        MOVE '048NMCT'                   TO VISAO-WS              00062270
062280        MOVE '119-115-PESQUISA-T048NMCT' TO LOCAL-WS              00062280
062290        MOVE 'SELECT'                    TO TIPO-ACESSO-WS        00062290
062300        DISPLAY '********-------------------------*******'        00062300
062310        DISPLAY 'PROGRAMA SUSPENSO - ERRO ACESSO V048NMCT'        00062310
062320        DISPLAY 'AGENCIA........ ' CH-CODAG-D07                   00062320
062330        DISPLAY 'CONTA.......... ' CONTA-D07                      00062330
062340        DISPLAY '********-------------------------*******'        00062340
062350        PERFORM 99-ERRO-DB2.                                      00062350
062360                                                                  00062360
062370*----------------------------------------------------------------*00062370
062380 120-35-CADASTRO-EMP.                                             00062380
062390*
           MOVE ZEROS TO SW-ERRO-75.

062400     COMPUTE SALDO-WS = SLD-EMP-RED-WS * (-1).
062450
062460     MOVE ZEROS TO DT-VENCTO-WS
062470                   DT-VENC-MIN-WS
062480                   W091CL-DD-RES-2-3
062490                   W091CL-MM-RES-2-3
062500                   W091CL-AA-RES-2-3
062510                   W091CL-DD-INFOR-1
062520                   W091CL-MM-INFOR-1
062530                   W091CL-AA-INFOR-1.

062550     IF (C-EMP-VENC-D07 NOT EQUAL EMP-VENC-RED-WS)
062560        PERFORM 127-125-TESTA-VENCTO-CONTRATO
           ELSE
              MOVE C-EMP-VENC-D07    TO DATA-MAIOR-RED
              MOVE DIA-MAIOR         TO DD-VENCTO-WS
              MOVE MES-MAIOR         TO MM-VENCTO-WS
              CALL 'M0952000' USING ANO-MAIOR AA-VENCTO-WS.
062570
062580     MOVE DD-VENC-MIN-WS     TO DD-INFOR-2.
062590     MOVE MM-VENC-MIN-WS     TO MM-INFOR-2.
062600     MOVE AA-VENC-MIN-WS     TO AA-INFOR-2.
062610     MOVE DD-VENCTO-WS       TO DD-INFOR-1.
062620     MOVE MM-VENCTO-WS       TO MM-INFOR-1.
062630     MOVE AA-VENCTO-WS       TO AA-INFOR-1.
062640     MOVE W091CL-DD-INFOR-1  TO DD-INFOR-3.
062650     MOVE W091CL-MM-INFOR-1  TO MM-INFOR-3.
062660     MOVE W091CL-AA-INFOR-1  TO AA-INFOR-3.

062680     IF (CTA-EMPRESARIAL) AND
062690        (DT-INFOR-1 GREATER DT-INFOR-2)
062700         PERFORM 128-127-CALC-VENCTO-360-DIAS.
062710
           IF CH-EMPRESA
              MOVE C-EMP-VENC-D07  TO EMP-VENC-D07-WS
              MOVE DIA-VENC-D07-WS TO DIA-VENC-D07-8-WS
                                      DIA-VENC-D07-8-INV-WS
              MOVE MES-VENC-D07-WS TO MES-VENC-D07-8-WS
                                      MES-VENC-D07-8-INV-WS
              CALL 'M0952000' USING ANO-VENC-D07-WS
                                    ANO-VENC-D07-8-INV-WS
              PERFORM 999-60-CALC-VENCT-EMP
              PERFORM 999-60-CALC-VENCT-EMP-31-DIAS.

           IF (CH-EMPRESA)
              IF (EMP-VENC-D07-8-INV-WS LESS DATA-VENC-EMP-INV-31-WS)
              OR (EMP-VENC-D07-8-INV-WS GREATER DATA-VENC-EMP-INV-WS)
                  MOVE 75 TO C-EMP-COD-MENS-D10
                  MOVE 1  TO SW-ERRO-75
                  PERFORM 555-35-OCR-CAD-EMP
              END-IF
           ELSE
062720     IF (C-EMP-VENC-D07 NOT EQUAL EMP-VENC-RED-WS) AND
062730        (DT-INFOR-1     GREATER DT-INFOR-3)
062740         MOVE 75 TO C-EMP-COD-MENS-D10
               MOVE 1  TO SW-ERRO-75
062750         PERFORM 555-35-OCR-CAD-EMP
062760     ELSE
062770     IF (C-EMP-VENC-D07 NOT EQUAL EMP-VENC-RED-WS) AND
062780        (DT-INFOR-1     LESS DT-INFOR-2)
062790         MOVE 75 TO C-EMP-COD-MENS-D10
               MOVE 1  TO SW-ERRO-75
062800         PERFORM 555-35-OCR-CAD-EMP.

062810     IF NOT ERRO-75
062820        IF (CTA-EMPRESARIAL) AND (QT-DIAS-VENC LESS 31)
062830            MOVE 75 TO C-EMP-COD-MENS-D10
062840            PERFORM 555-35-OCR-CAD-EMP
062850        ELSE
062860        IF (CTA-EMPRESARIAL  AND C-EMP-TAXA-D07 EQUAL ZEROS)
062870           MOVE 80 TO C-EMP-COD-MENS-D10
062880           PERFORM 555-35-OCR-CAD-EMP
062890        ELSE
062900        IF (CTA-EMPRESARIAL AND C-EMP-DIA-DEBITO-D07 > 28)
062910           MOVE 76 TO C-EMP-COD-MENS-D10
062920           PERFORM 555-35-OCR-CAD-EMP
062930        ELSE
062940        IF ((C-EMP-DIA-DEBITO-D07 NOT EQUAL ZEROS AND
062950             TPCONTAB-RED-WS = 01) OR
062960            (C-EMP-DIA-DEBITO-D07 NOT EQUAL ZEROS AND
062970             CH-EMPRESA))
062980             MOVE 76 TO C-EMP-COD-MENS-D10
062990             PERFORM 555-35-OCR-CAD-EMP
063000        ELSE
063070        IF SALDO-WS GREATER THAN EMP-LIM-RED-WS
063080           MOVE 73 TO C-EMP-COD-MENS-D10
063090           PERFORM 555-35-OCR-CAD-EMP
063100        ELSE
063110        IF TP-PESSOA-RED-WS = 'V' OR 'G' OR 'W' OR '>' OR '&'
063120           MOVE 72 TO C-EMP-COD-MENS-D10
063130           PERFORM 555-35-OCR-CAD-EMP
063140        ELSE
063150        IF AD-BANCO
063160           MOVE 77 TO C-EMP-COD-MENS-D10
063170           PERFORM 555-35-OCR-CAD-EMP
063180        ELSE
063190        IF P-FISICAS
063200           IF SERVI
063210              IF LIMITE-PF-OK
063220                 PERFORM 120-35-CADASTRA-EMPRESTIMO
063230              ELSE
063240                 MOVE 13 TO C-EMP-COD-MENS-D10
063250                 PERFORM 555-35-OCR-CAD-EMP
063260           ELSE
063270           IF LIMITE-PF-OK
063280              PERFORM 120-35-CADASTRA-EMPRESTIMO
063290           ELSE
063300              MOVE 13 TO C-EMP-COD-MENS-D10
063310              PERFORM 555-35-OCR-CAD-EMP
063320        ELSE
063330        IF (CH-EMPRESA OR CH-EMPRESA-PP)
063340            IF LIMITE-PJ-OK
063350               PERFORM 120-35-CADASTRA-EMPRESTIMO
063360            ELSE
063370               MOVE 13 TO C-EMP-COD-MENS-D10
063380               PERFORM 555-35-OCR-CAD-EMP
063390        ELSE
063400        IF LIMITE-CTA-EMPR-OK
063410           PERFORM 120-35-CADASTRA-EMPRESTIMO
063420        ELSE
063430           MOVE 13 TO C-EMP-COD-MENS-D10
063440           PERFORM 555-35-OCR-CAD-EMP.
063450
063460*----------------------------------------------------------------*
063470 120-35-CADASTRA-EMPRESTIMO.                                      00063470
063480*                                                                 00063480
063490      COMPUTE DISPON-WS = (SLD-BLO-RED-WS (1)  +                  00063490
063500                   SLD-BLO-RED-WS (2)  + SLD-BLO-RED-WS (3)  +    00063500
063510                   SLD-BLO-RED-WS (4)  + SLD-BLO-RED-WS (5)  +    00063510
063520                   SLD-BLO-RED-WS (6)  + SLD-BLO-RED-WS (7)  +    00063520
063530                   SLD-BLO-RED-WS (8)  + SLD-BLO-RED-WS (9)  +    00063530
063540                   SLD-BLO-RED-WS (10) + SLD-BLO-RED-WS (11) +    00063540
063550                   SLD-BLO-RED-WS (12) + SLD-BLO-RED-WS (13) +    00063550
063560                   SLD-BLO-RED-WS (14) + SLD-BLO-RED-WS (15) +    00063560
063570                   SLD-BLO-RED-WS (16) + SLD-BLO-RED-WS (17) +    00063570
063580                   SLD-BLO-RED-WS (18) + SLD-BLO-RED-WS (19) +    00063580
063590                   SLD-BLO-RED-WS (20) + SLD-BLO-RED-WS (21)).    00063590
063600*                                                                 00063600
063610     IF EMP-LIM-RED-WS = 0                                        00063610
063620        COMPUTE SALDO-BLOQ-WS = SLD-DEP-RED-WS - DISPON-WS        00063620
063630     ELSE                                                         00063630
063640        MOVE SLD-DEP-RED-WS TO SALDO-BLOQ-WS.                     00063640
063660                                                                  00063660
063670     IF TPCONTAB-RED-WS = 01 OR 02                                00063670
063680        IF SALDO-BLOQ-WS NOT LESS 0                               00063680
063690           IF EMP-LIM-RED-WS = ZEROS                              00063690
063700*             MOVE 0 TO IMPEDE-RENOV-AUTO-RED-WS                  00063700
063710              PERFORM 121-35-TESTA-FAIXA-LIMITE                   00063710
063720              PERFORM 125-35-REG3-ATL-CORRENTISTA                 00063720
063730              MOVE 1 TO EXT-COD-MENS-D10 EXT-COD-MENS-WS          00063730
063740              MOVE 22 TO C-EMP-COD-MENS-D10                       00063740
063750              PERFORM 555-35-OCR-CAD-EMP                          00063750
063760           ELSE                                                   00063760
063770*             MOVE 0 TO IMPEDE-RENOV-AUTO-RED-WS                  00063770
063780              MOVE 23 TO C-EMP-COD-MENS-D10                       00063780
063790              PERFORM 555-35-OCR-CAD-EMP                          00063790
063800              PERFORM 121-35-TESTA-FAIXA-LIMITE                   00063800
063810              PERFORM 125-35-REG3-ATL-CORRENTISTA                 00063810
063820              MOVE 2 TO CH-SEQUENC-WS                             00063820
063830              PERFORM 121-120-MENS-CAD-EMP                        00063830
063840              PERFORM 555-35-OCR-CAD-EMP                          00063840
063850              MOVE 2 TO EXT-COD-MENS-D10 EXT-COD-MENS-WS          00063850
063860        ELSE                                                      00063860
063870           MOVE 06 TO C-EMP-COD-MENS-D10                          00063870
063880           MOVE ZEROS TO C-EMP-JUR-DEV-D10                        00063880
063890           PERFORM 555-35-OCR-CAD-EMP                             00063890
063900     ELSE                                                         00063900
063910        MOVE 45 TO C-EMP-COD-MENS-D10                             00063910
063920        MOVE ZEROS TO C-EMP-JUR-DEV-D10                           00063920
063930        PERFORM 555-35-OCR-CAD-EMP.                               00063930

063940     PERFORM  124-124-GRAVA-D0480701.                             00063940
063950     MOVE ZEROS TO DISPON-WS.                                     00063950
064240                                                                  00064240
064250*----------------------------------------------------------------*00064250
064260 121-120-MENS-CAD-EMP.                                            00064260
064270                                                                  00064270
064280     IF ALTERACAO-SEGURO                                          00064280
064290        MOVE 62 TO C-EMP-COD-MENS-D10                             00064290
064300     ELSE                                                         00064300
064310        MOVE 24 TO C-EMP-COD-MENS-D10.                            00064310
064320                                                                  00064320
064330*----------------------------------------------------------------*00064330
064340 121-35-TESTA-FAIXA-LIMITE.                                       00064340
064350                                                                  00064350
064360     IF NOT LIMITE-OK                                             00064360
064370        MOVE 13 TO C-EMP-COD-MENS-D10                             00064370
064380        PERFORM 555-35-OCR-CAD-EMP.                               00064380
064390                                                                  00064390
064400*----------------------------------------------------------------*00064400
064410* 122-35-RENOVACAO-AUTOMATICA.                                    00064410
064420*                                                                 00064420
064430*    MOVE ZEROS                 TO CH-SEQUENC-WS                  00064430
064440*    MOVE 23                    TO C-EMP-COD-MENS-D10             00064440
064450*    PERFORM 555-35-OCR-CAD-EMP                                   00064450
064460*    MOVE DATA-RODADA-WS        TO EMP-DATA-RED-WS.               00064460
064470*    MOVE DIA-PROX-VENC-WS      TO DIA-AUX-Y2.                    00064470
064480*    MOVE MES-PROX-VENC-WS      TO MES-AUX-Y2.                    00064480
064490*    MOVE AA-PROX-VENC-WS       TO ANO-AUX-Y2.                    00064490
064500*    MOVE DATA-AUX-Y2-RED       TO EMP-VENC-RED-WS.               00064500
064510*    PERFORM 125-35-REG3-ATL-CORRENTISTA                          00064510
064520*    MOVE 2                     TO CH-SEQUENC-WS                  00064520
064530*    MOVE 51                    TO C-EMP-COD-MENS-D10             00064530
064540*    PERFORM 555-35-OCR-CAD-EMP                                   00064540
064550*    MOVE 2                   TO EXT-COD-MENS-D10 EXT-COD-MENS-WS.00064550

064580*----------------------------------------------------------------*00064580
064590 123-35-CAD-SENHA.                                                00064590
064600*                                                                 00064600
064620     IF INDICACOES-D07 EQUAL 9999999                              00064620
064630        IF SENHA-REF-PRINC-D07 NOT EQUAL ZEROS                    00064630
064640           MOVE SENHA-REF-PRINC-D07 TO REF-PRINC-RED-WS           00064640
064650           MOVE CH-DATA-D07 TO ATL-ULT-DT-RED-WS                  00064650
064660        ELSE                                                      00064660
064670           IF SENHA-REF-SECON-D07 NOT EQUAL ZEROS                 00064670
064680              MOVE SENHA-REF-SECON-D07 TO REF-SECON-RED-WS        00064680
064690              MOVE CH-DATA-D07 TO ATL-ULT-DT-RED-WS               00064690
064700           ELSE                                                   00064700
064710              NEXT SENTENCE                                       00064710
064720     ELSE                                                         00064720
064730        PERFORM 123-35-FORMATA-INDICACOES.                        00064730
064740                                                                  00064740
064750*----------------------------------------------------------------*00064750
064760 123-35-FORMATA-INDICACOES.                                       00064760
064770                                                                  00064770
064780     MOVE INDICACOES-D07 TO INDICA-WS.                            00064780
064790     MOVE INDICACOES-WS  TO INDICACOES.                           00064790
064800                                                                  00064800
064810     IF IND-BLOQUEIO = 0                                          00064810
064820        IF CONTRA-ORDEM-WS = 0 OR 1                               00064820
064830           NEXT SENTENCE                                          00064830
064840        ELSE                                                      00064840
064850           MOVE 0 TO CONTRA-ORDEM-WS.                             00064850
064860                                                                  00064860
064870     IF IND-BLOQUEIO = 1                                          00064870
064880        IF CONTRA-ORDEM-WS = 1 OR 2                               00064880
064890           NEXT SENTENCE                                          00064890
064900        ELSE                                                      00064900
064910           MOVE 1 TO CONTRA-ORDEM-WS.                             00064910
064920                                                                  00064920
064930     IF IND-BLOQUEIO = 2                                          00064930
064940        IF CONTRA-ORDEM-WS = 2 OR 3                               00064940
064950           NEXT SENTENCE                                          00064950
064960        ELSE                                                      00064960
064970           MOVE 2 TO CONTRA-ORDEM-WS.                             00064970
064980                                                                  00064980
064990     IF IND-BLOQUEIO = 3                                          00064990
065000        IF CONTRA-ORDEM-WS = 3                                    00065000
065010           NEXT SENTENCE                                          00065010
065020        ELSE                                                      00065020
065030           MOVE 3 TO CONTRA-ORDEM-WS.                             00065030
065040                                                                  00065040
065050* ATUALIZA DATA PRIMEIRO BLOQUEIO                                 00065050
065060     IF (IND-BLOQUEIO = 0 AND CONTRA-ORDEM-WS = 1)                00065060
065070        MOVE CH-DATA-D07 TO DT-BLOQ-DESBLOQ-RED-WS.               00065070
065080                                                                  00065080
065090* ATUALIZA DATA PRIMEIRO DESBLOQUEIO                              00065090
065100     IF (IND-BLOQUEIO = 1 AND CONTRA-ORDEM-WS = 2)                00065100
065110      IF TP-PESSOA-RED-WS NOT = 'G'                               00065110
065120         MOVE CH-DATA-D07 TO DT-BLOQ-DESBLOQ-RED-WS               00065120
065130      ELSE                                                        00065130
065140         MOVE SPACES       TO REG-D10S                            00065140
065150         MOVE CH-CODAG-D07 TO AGN-D10S                            00065150
065160         MOVE CONTA-D07    TO CTA-D10S                            00065160
065170         MOVE DV-CONTA-D07 TO DIG-D10S                            00065170
065180         MOVE CH-DATA-D07  TO DT-OCOR-D10S                        00065180
065190         MOVE DT-BLOQ-DESBLOQ-RED-WS TO DT-BLOQ-D10S              00065190
065200         MOVE SLD-DEP-RED-WS TO SALDO-D10S                        00065200
065210         MOVE 03           TO COD-OCOR-D10S                       00065210
065220         MOVE CH-DATA-D07  TO DT-BLOQ-DESBLOQ-RED-WS              00065220
065230         WRITE REG-D10S                                           00065230
065240           INVALID KEY                                            00065240
065250             DISPLAY '**P04808-CANCEL.AREA INSUF.P/D04810S**'     00065250
065260             MOVE COD-RETORNO-WS (3) TO RETURN-CODE               00065260
065270             DISPLAY 'RETURN CODE EH...' COD-RETORNO-WS (3)       00065270
065280             DISPLAY 'MENSAGEM RETORNO EH...' MEN-RETORNO-WS(3)   00065280
065290             GOBACK.                                              00065290
065300                                                                  00065300
065310* ATUALIZA DATA SEGUNDO BLOQUEIO                                  00065310
065320     IF (IND-BLOQUEIO = 2 AND CONTRA-ORDEM-WS = 3)                00065320
065330        MOVE CH-DATA-D07 TO DT-BLOQ-DESBLOQ-RED-WS.               00065330
065340                                                                  00065340
065350     IF FORNECER-TALAO-WS = 0                                     00065350
              IF NR-GP-TAR OF DCLV048CCAD = 1                           00065360
065360*       IF GRUPO-TARIFA-RED-WS = 1                                00065360
065370            MOVE 1 TO FORNECER-TALAO-WS                           00065370
065380            MOVE INDICA-WS TO INDICACOES-WS                       00065380
065390            MOVE CH-DATA-D07 TO ATL-ULT-DT-RED-WS                 00065390
065400         ELSE                                                     00065400
065410            MOVE INDICACOES-D07 TO INDICACOES-WS                  00065410
065420            MOVE CH-DATA-D07 TO ATL-ULT-DT-RED-WS                 00065420
065430        ELSE                                                      00065430
065440          MOVE INDICACOES-D07 TO INDICACOES-WS                    00065440
065450          MOVE CH-DATA-D07 TO ATL-ULT-DT-RED-WS.                  00065450
065460                                                                  00065460
067010*----------------------------------------------------------------*00067010
       124-123-MONTA-CHAVE-D0480701.

           MOVE W-CH-TPREG-D07    TO CH-TPREG-D0701.
           MOVE W-CH-CODAG-D07    TO CH-CODAG-D0701.
           MOVE W-CH-DATA-D07     TO CH-DATA-D0701.
           MOVE W-CH-N-LOTE-D07   TO CH-N-LOTE-D0701.
           MOVE W-CH-HIST-D07     TO CH-HIST-D0701.
BOSSA      MOVE W-CONTA-D07       TO CONTA-D0701.
BOSSA      MOVE W-DV-CONTA-D07    TO DV-CONTA-D0701.

067010*----------------------------------------------------------------*00067010
067020 124-124-GRAVA-D0480701.                                          00067020
067030                                                                  00067030
067050     IF ACEITO                                                    00067050
              INITIALIZE REG-MOV-D0701
              MOVE REG-MOV-D07 TO W-REG-MOV-D07
              PERFORM 124-123-MONTA-CHAVE-D0480701
              IF GRADE-D07
                 MOVE W-RESTO-GRADE-D07 TO RESTO-GRADE-D0701
              END-IF
              IF CAD-CC-D07
                 MOVE W-PARTE-1-D07     TO PARTE-1-D0701
                 MOVE W-CC-TPCONTAB-D07 TO CC-TPCONTAB-D0701
                 MOVE W-PARTE-2-D07     TO PARTE-2-D0701
                 MOVE W-CC-TPPESSOA-D07 TO CC-TPPESSOA-D0701
                 MOVE W-PARTE-3-D07     TO PARTE-3-D0701
              END-IF
              IF CAD-EMP-D07
                 MOVE W-RESTO-CAD-EMP-D07 TO RESTO-CAD-EMP-VENC-D0701
              END-IF
              IF CAD-EMP-D07
                 MOVE W-RESTO-CAD-SENHA-D07 TO RESTO-CAD-SENHA-D0701
              END-IF
              IF AC-EC-D07
                 MOVE W-RESTO-ACE-EXTCTB-D07 TO RESTO-ACE-EXTCTB-D0701
              END-IF
              IF AC-NUM-D07
                 MOVE W-RESTO-ACE-NUMEROS-D07 TO RESTO-ACE-NUMEROS-D0701
              END-IF
              IF TRANS-D07
                 MOVE W-RESTO-TRANSACAO-D07 TO RESTO-TRANSACAO-D0701
              END-IF
              IF ESPEC-D07
                 MOVE W-RESTO-ESPECIAIS-D07 TO RESTO-TRANSACAO-D0701
              END-IF

067060*       MOVE REG-MOV-D07 TO REG-MOV-D0701                         00067060
067070        WRITE REG-MOV-D0701                                       00067070
067080        INVALID KEY                                               00067080
067090            DISPLAY '**P04808-CANCEL.AREA INSUF.P/D0480701**'     00067090
067100            MOVE COD-RETORNO-WS (3) TO RETURN-CODE                00067100
067110            DISPLAY 'RETURN CODE EH...' COD-RETORNO-WS (3)        00067110
067120            DISPLAY 'MENSAGEM RETORNO EH...' MEN-RETORNO-WS (3)   00067120
067130            GOBACK.                                               00067130
067140*                                                                 00067140
067150*----------------------------------------------------------------*00067150
067160 125-35-REG3-ATL-CORRENTISTA.                                     00067160
067170*                                                                 00067170
067180     MOVE ZEROS TO SW-SEGURO-WS.                                  00067180
067190     IF EMP-LIM-RED-WS = ZEROS                                    00067190
067200         IF INSUF-EXCESSO-RED-WS GREATER ZERO                     00067200
067210             MOVE 1 TO SW-REGULARIZA-INSUF.                       00067210
067220                                                                  00067220
067230     IF C-EMP-VENC-D07 EQUAL EMP-VENC-RED-WS AND                  00067230
067240        C-EMP-LIM-D07  EQUAL EMP-LIM-RED-WS                       00067240
067250        MOVE 1 TO SW-SEGURO-WS                                    00067250
067260        MOVE C-EMP-TAXA-D07 TO EMP-TAXA-JUR-RED-WS.               00067260
067270                                                                  00067270
067280     IF C-EMP-VENC-D07 EQUAL EMP-VENC-RED-WS AND                  00067280
067290        C-EMP-LIM-D07  EQUAL EMP-LIM-RED-WS                       00067290
067300        MOVE 1 TO SW-SEGURO-WS                                    00067300
067310        IF TPCONTAB-RED-WS EQUAL 02                               00067310
067320           MOVE 'N'              TO EMP-SEGURO-RED-WS             00067320
067330        ELSE                                                      00067330
067340           MOVE C-EMP-SEGURO-D07 TO EMP-SEGURO-RED-WS.            00067340
067350                                                                  00067350
067360     IF C-EMP-VENC-D07 EQUAL EMP-VENC-RED-WS AND                  00067360
067370        C-EMP-LIM-D07  EQUAL EMP-LIM-RED-WS                       00067370
067380        MOVE 1 TO SW-SEGURO-WS                                    00067380
067420           MOVE C-EMP-PROPOSTA-D07 TO EMP-PROPOSTA-RED-WS.        00067420
067430                                                                  00067430
067440     IF  (C-EMP-VENC-D07 NOT EQUAL EMP-VENC-RED-WS) OR            00067440
067450         (C-EMP-LIM-D07  NOT EQUAL EMP-LIM-RED-WS)                00067450
067460      IF NOT CONTRATO-VENCIDO                                     00067460
067470         MOVE CH-DATA-D07    TO EMP-DATA-RED-WS                   00067470
067480         PERFORM 126-135-TARIFA-RENOVACAO                         00067480
067490         MOVE C-EMP-TAXA-D07 TO EMP-TAXA-JUR-RED-WS               00067490
067500         IF TPCONTAB-RED-WS EQUAL 02                              00067500
067510            MOVE 'N'              TO EMP-SEGURO-RED-WS            00067510
067520         ELSE                                                     00067520
067530            MOVE C-EMP-SEGURO-D07 TO EMP-SEGURO-RED-WS.           00067530
067540                                                                  00067540
067550     IF  (C-EMP-VENC-D07 NOT EQUAL EMP-VENC-RED-WS) OR            00067550
067560         (C-EMP-LIM-D07  NOT EQUAL EMP-LIM-RED-WS)                00067560
067570       IF  NOT CONTRATO-VENCIDO                                   00067570
067580         IF NOT RECEBIVEIS                                        00067580
067590            MOVE ZEROS                TO EMP-DATA-ENC-RED-WS      00067590
067600            MOVE C-EMP-VENC-D07       TO EMP-VENC-RED-WS          00067600
067610            MOVE C-EMP-LIM-D07        TO EMP-LIM-RED-WS           00067610
067620            MOVE C-EMP-DIA-DEBITO-D07 TO DIA-DEBITO-JUROS-RED-WS  00067620
067660            MOVE C-EMP-PROPOSTA-D07   TO EMP-PROPOSTA-RED-WS.     00067660
067680                                                                  00067680
067690*--------   ANTECIPACAO RECEBIVEIS  ------------------            00067690

067700     IF  NOT CONTRATO-VENCIDO                                     00067700
067710      IF RECEBIVEIS                                               00067710
067720         MOVE ZEROS          TO EMP-DATA-ENC-RED-WS               00067720
067730         COMPUTE LIMITE-WS = (C-EMP-LIM-D07 *                     00067730
067740                              PERCENTUAL-RECEBIVEIS-WS) / 100     00067740
067750         IF C-EMP-VENC-D07 EQUAL EMP-VENC-RED-WS                  00067750
067760            ADD LIMITE-WS TO EMP-LIM-RED-WS                       00067760
067770            MOVE 1 TO SW-SEGURO-WS                                00067770
067780         ELSE                                                     00067780
067790            MOVE LIMITE-WS      TO EMP-LIM-RED-WS                 00067790
067800            MOVE C-EMP-DIA-DEBITO-D07  TO DIA-DEBITO-JUROS-RED-WS 00067800
067810            MOVE C-EMP-VENC-D07 TO EMP-VENC-RED-WS.               00067810
067820                                                                  00067820
067830     MOVE 3                 TO TIPO-CAD-02DD.                     00067830
067840     MOVE CH-CONTA-WS       TO CONTA-CAD-02DD.                    00067840
067850     MOVE CH-DIGITO-WS      TO DIGITO-CAD-02DD.                   00067850
067860     MOVE SPACES            TO NOME-CLI-CAD-02DD                  00067860
067870                               NOME-CLI2-CAD-02DD.                00067870
067880     MOVE EMP-DATA-RED-WS   TO DATA-TELEX-WS.                     00067880
067890     MOVE ANO-TELEX-WS      TO ANO-TELEX-INV-WS.                  00067890
067900     MOVE MES-TELEX-WS      TO MES-TELEX-INV-WS.                  00067900
067910     MOVE DIA-TELEX-WS      TO DIA-TELEX-INV-WS.                  00067910
067920     MOVE DATA-TELEX-INV-WS TO DTCONTR-CHBNB-02DD.                00067920
067930     MOVE EMP-VENC-RED-WS   TO DATA-TELEX-WS.                     00067930
067940     MOVE ANO-TELEX-WS      TO ANO-TELEX-INV-WS.                  00067940
067950     MOVE MES-TELEX-WS      TO MES-TELEX-INV-WS.                  00067950
067960     MOVE DIA-TELEX-WS      TO DIA-TELEX-INV-WS.                  00067960
067970     MOVE DATA-TELEX-INV-WS TO DTVENC-CHBNB-02DD.                 00067970
067980     MOVE EMP-LIM-RED-WS    TO LIMITE-CHBNB-02DD.                 00067980
067990     PERFORM 999-34-GRAVA-DISCO-TELEX.                            00067990
068000     MOVE ZEROS TO DATA-TELEX-WS DATA-TELEX-INV-WS.               00068000
068010     MOVE CH-DATA-D07       TO ATL-ULT-DT-RED-WS.                 00068010
068090                                                                  00068090
068100     MOVE ZEROS TO EXC-VEZ-CONTRATO-RED-WS.                       00068100

068130*----------------------------------------------------------------*00068130
068140 126-135-TARIFA-RENOVACAO.                                        00068140
068150                                                                  00068150
068160     IF DT-TARIF-RENOV-RED-WS EQUAL ZEROS                         00068160
068170        MOVE CH-DATA-D07 TO DT-TARIF-RENOV-RED-WS                 00068170
068180     ELSE                                                         00068180
068190     IF CTA-SALARIO                                               00068190
068200        MOVE DT-TARIF-RENOV-RED-WS TO DATA-AUX-RED                00068200
068210        MOVE 01      TO DIA-INV                                   00068210
068220        MOVE MES-AUX TO MES-INV                                   00068220
068230        CALL 'M0952000' USING ANO-AUX ANO-INV                     00068230
068240        COMPUTE MES-INV = MES-INV + 6                             00068240
068250        IF MES-INV > 12                                           00068250
068260           COMPUTE MES-INV = MES-INV - 12                         00068260
068270           COMPUTE ANO-INV = ANO-INV + 1                          00068270
068280           IF DATA-INVERTIDA-RED > DATA-D07-RED-INV               00068280
068290              MOVE 1 TO SW-SEGURO-WS                              00068290
068300           ELSE                                                   00068300
068310              MOVE CH-DATA-D07 TO DT-TARIF-RENOV-RED-WS           00068310
068320        ELSE                                                      00068320
068330        IF DATA-INVERTIDA-RED > DATA-D07-RED-INV                  00068330
068340           MOVE 1 TO SW-SEGURO-WS                                 00068340
068350        ELSE                                                      00068350
068360           MOVE CH-DATA-D07 TO DT-TARIF-RENOV-RED-WS              00068360
068370     ELSE                                                         00068370
068380        IF NOT ALTERACAO-SEGURO                                   00068380
068390           MOVE CH-DATA-D07 TO DT-TARIF-RENOV-RED-WS.             00068390

068400*----------------------------------------------------------------*00068400
DOCINI****F* P04808/127-125-TESTA-VENCTO-CONTRATO
DOCTXT* OBJETIVO
DOCTXT*   Armazena as datas minimas e padrao de vencimentos de contratos
DOCTXT*   de limite de credito.
DOCTXT*   A partir da data de movimento, calcula a data minima de
DOCTXT*   vencimento como sendo um mes adiante e armazena em
DOCTXT*   DT-VENC-MIN-WS.
DOCTXT*   A partir da data de vencimento do registro, armazena em
DOCTXT*   DATA-MAIOR a data de vencimento do contrato.
DOCEND******
068410 127-125-TESTA-VENCTO-CONTRATO.                                   00068410

068430     MOVE C-EMP-VENC-D07    TO DATA-MAIOR-RED.                    00068430
068440     MOVE DIA-MAIOR         TO DD-VENCTO-WS.                      00068440
068450     MOVE MES-MAIOR         TO MM-VENCTO-WS.                      00068450
068460     CALL 'M0952000' USING ANO-MAIOR AA-VENCTO-WS.                00068460

068470     MOVE CH-DATA-D07       TO DATA-MENOR-RED.                    00068470
068480*                                                                 00068480
068490     MOVE DATA-MENOR-RED    TO DATA-MAIOR-RED.                    00068490
068500*                                                                 00068500
068510     COMPUTE MES-MAIOR = MES-MENOR + 1.                           00068510
068520*                                                                 00068520
068530     PERFORM 128-127-OBTEM-VENCTO-EMP.                            00068530
068540     PERFORM 130-127-VALIDA-DIA-UTIL.                             00068540
068550     MOVE W091CL-DT-INFOR-1 TO DT-VENC-MIN-WS.                    00068550
068560*                                                                 00068560
068570     MOVE DATA-MENOR-RED TO DATA-MAIOR-RED.                       00068570

068580     IF CTA-EMPRESARIAL                                           00068580
068590        COMPUTE MES-MAIOR = MES-MENOR + 12                        00068590
068600     ELSE                                                         00068600
              IF CH-EMPRESA
068610           COMPUTE MES-MAIOR = MES-MENOR + 6                      00068610
              ELSE
068590           COMPUTE MES-MAIOR = MES-MENOR + 24.                    00068590
068620*                                                                 00068620
068630     PERFORM 128-127-OBTEM-VENCTO-EMP.                            00068630
068640     PERFORM 130-127-VALIDA-DIA-UTIL.                             00068640
068650*                                                                 00068650
068660*----------------------------------------------------------------*00068660
068670 128-127-OBTEM-VENCTO-EMP.                                        00068670
068680*                                                                 00068680
068690     IF MES-MAIOR > 24                                            00068690
068700        COMPUTE MES-MAIOR = MES-MAIOR - 24                        00068700
068710        COMPUTE ANO-MAIOR = ANO-MAIOR + 2                         00068710
           ELSE
068690        IF MES-MAIOR > 12
068700           COMPUTE MES-MAIOR = MES-MAIOR - 12                     00068700
068710           COMPUTE ANO-MAIOR = ANO-MAIOR + 1                      00068710
              END-IF
           END-IF.
068720*                                                                 00068720
068730     IF DIA-MAIOR > NUM-DIAS-MES-TAB(MES-MAIOR)                   00068730
068740        MOVE NUM-DIAS-MES-TAB(MES-MAIOR) TO DIA-MAIOR.            00068740
068750*                                                                 00068750
068760     DIVIDE ANO-MAIOR BY 4 GIVING QUOCIENTE-AUX-WS                00068760
068770                              REMAINDER RESTO-AUX-WS.             00068770
068780                                                                  00068780
068790     IF RESTO-AUX-WS EQUAL ZEROS                                  00068790
068800        IF MES-MAIOR = 2                                          00068800
068810           MOVE 29 TO DIA-MAIOR.                                  00068810
068820                                                                  00068820
068830*----------------------------------------------------------------*00068830
068840 128-127-CALC-VENCTO-360-DIAS.                                    00068840
068860                                                                  00068860
068870     MOVE DD-INFOR-1      TO DD-INFOR-11                          00068870
068880     MOVE MM-INFOR-1      TO MM-INFOR-11                          00068880
068890     MOVE AA-INFOR-1      TO AA-INFOR-11                          00068890
068900     MOVE DIA-MOVIM       TO DD-INFOR-22                          00068900
068910     MOVE MES-MOVIM       TO MM-INFOR-22                          00068910
068920     MOVE 20              TO SS-INFOR-22                          00068920
068930     MOVE ANO-MOVIM       TO AA-INFOR-22                          00068930
068940*                                                                 00068940
068940*--- 09 - DIAS CORRIDOS ENTRE DUAS DATAS                          00068940
068940*                                                                 00068940
068950     MOVE '09'            TO W091CL-TP-OPER.                      00068950
068960     MOVE 001             TO W091CL-CD-AG-REQ.                    00068960
068970     MOVE DT-INFOR-22     TO W091CL-DT-INFOR-1                    00068970
068980     MOVE DT-INFOR-11     TO W091CL-DT-INFOR-2                    00068980
068990     MOVE 1               TO W091CL-ST-ARQ-RES.                   00068990
069000     CALL 'P09102' USING W091CL-REGISTRO.                         00069000
069010     PERFORM 999-95-TESTE-VALIDADE-RETORNO.                       00069010
069020     IF  RETORNO-SUBROT-OK                                        00069020
069030         MOVE W091CL-QT-DD-CORR TO QT-DIAS-VENC                   00069030
069040     ELSE                                                         00069040
069050         PERFORM 999-99-ROT-ERRO.                                 00069050

069220*----------------------------------------------------------------*00069220
069230 130-127-VALIDA-DIA-UTIL.                                         00069230
069240*                                                                 00069240
069250     MOVE DIA-MAIOR    TO W091CL-DD-INFOR-1                       00069250
069260     MOVE MES-MAIOR    TO W091CL-MM-INFOR-1                       00069260
069270     CALL 'M0952000' USING ANO-MAIOR W091CL-AA-INFOR-1.           00069270
069280     MOVE '01'         TO W091CL-TP-OPER.                         00069280
069290     MOVE CH-CODAG-D07 TO W091CL-CD-AG-REQ.                       00069290
069300     MOVE 1            TO W091CL-ST-ARQ-RES.                      00069300
069310     CALL 'P09102' USING W091CL-REGISTRO.                         00069310
069320     PERFORM 999-95-TESTE-VALIDADE-RETORNO.                       00069320
069330     IF RETORNO-SUBROT-OK                                         00069330
069340        IF W091CL-VAL-RESP-1 = 'N'                                00069340
069350           NEXT SENTENCE                                          00069350
069360        ELSE                                                      00069360
069370        IF W091CL-TP-FERIADO = 'UT'                               00069370
069380           NEXT SENTENCE                                          00069380
069390        ELSE                                                      00069390
069400           PERFORM 131-130-ACHA-DIA-UTIL                          00069400
069410                   UNTIL W091CL-VAL-RESP-1 = 'N'                  00069410
069430     ELSE                                                         00069430
069440         PERFORM 999-99-ROT-ERRO.                                 00069440

069450*----------------------------------------------------------------*00069450
069460 131-130-ACHA-DIA-UTIL.                                           00069460
069470*                                                                 00069470
069480     MOVE '10'   TO W091CL-TP-OPER.                               00069480
069490     MOVE 001    TO W091CL-CD-AG-REQ                              00069490
069500                    W091CL-QT-DIA-REQ.                            00069500
069510     MOVE 1      TO W091CL-ST-ARQ-RES.                            00069510
069520     CALL 'P09102' USING W091CL-REGISTRO.                         00069520
069530     PERFORM 999-95-TESTE-VALIDADE-RETORNO.                       00069530
069540     IF  RETORNO-SUBROT-OK                                        00069540
069550         NEXT SENTENCE                                            00069550
069560     ELSE                                                         00069560
069570         PERFORM 999-99-ROT-ERRO.                                 00069570
069580*                                                                 00069580
069590     MOVE W091CL-RESP-2-3 TO W091CL-DT-INFOR-1.                   00069590
069600     MOVE '01'            TO W091CL-TP-OPER.                      00069600
069610     MOVE CH-CODAG-D07    TO W091CL-CD-AG-REQ.                    00069610
069620     MOVE 1               TO W091CL-ST-ARQ-RES.                   00069620
069630     CALL 'P09102' USING W091CL-REGISTRO.                         00069630
069640     PERFORM 999-95-TESTE-VALIDADE-RETORNO.                       00069640
069650     IF RETORNO-SUBROT-OK                                         00069650
069660        NEXT SENTENCE                                             00069660
069670     ELSE                                                         00069670
069680         PERFORM 999-99-ROT-ERRO.                                 00069680

069690*----------------------------------------------------------------*00069690
069700 130-35-ACERTO-EXT-CONTABIL.                                      00069700
069710*                                                                 00069710
      * TIPO DE REGISTRO = 5
069710*                                                                 00069710
069720     MOVE CH-DATA-D07 TO ACT-ULT-RED-WS.                          00069720
069730                                                                  00069730
069740     ADD 1 TO ACT-VEZ-RED-WS.                                     00069740
069750                                                                  00069750
069760     MOVE ACT-MOR-RED-WS TO ACT-MOR-WS1.                          00069760
069770                                                                  00069770
069780     IF AC-EC-VALOR-D07 GREATER ACT-MOR-WS1                       00069780
069790         MOVE CH-DATA-D07 TO ACT-DATA-MOR-RED-WS                  00069790
069800         IF (NATUREZA-HIST-D07 GREATER 50) OR                     00069800
069810            (NATUREZA-HIST-D07 EQUAL 0)                           00069810
069820             MOVE AC-EC-VALOR-D07 TO ACT-MOR-RED-WS               00069820
069830         ELSE                                                     00069830
069840             COMPUTE ACT-MOR-RED-WS = (AC-EC-VALOR-D07 * (-1)).   00069840
069850                                                                  00069850
069860     MOVE 'A' TO AC-EC-CAD-WS DI-AC-CAD-WS ESP-AC-CAD-WS.         00069860
069870     PERFORM 150-35-TRANSACAO.                                    00069870
           MOVE SPACES TO REG-AC-EXT-CONTAB-D10
           INITIALIZE REG-AC-EXT-CONTAB-D10
069880     PERFORM 540-35-OCR-ACERTO-EXT-CONTABIL.                      00069880
069890                                                                  00069890
069900     IF CH-HIST-D07 = 40 AND CH-N-LOTE-D07  = 50                  00069900
069910         MOVE ZEROS TO EMP-NUM-RED-WS                             00069910
069920                       EMP-NUM-EXCED-FUNC-RED-WS.                 00069920
069930                                                                  00069930
069940 134-35-PESQ-MOVIMENTACAO.                                        00069940
069950     IF NOT HA-MOVIMENTACAO                                       00069950
069960        MOVE ZEROS TO MOVIMENTACAO-RED-WS.                        00069960
069970*                                                                 00069970
069980 135-35-ACERTO-NUMEROS.                                           00069980
069990*                                                                 00069990
           MOVE SPACES TO REG-AC-NUM-D10
           INITIALIZE REG-AC-NUM-D10

070000     IF CALCULAR-NUMEROS                                          00070000
070010         PERFORM 180-35-NUM-DEVED-CREDORES.                       00070010
070020                                                                  00070020
070030     PERFORM 560-35-INICIA-OCR-AC-NUMEROS.                        00070030
070040                                                                  00070040
070050     MOVE 1 TO CH-SEQUENC-D10.                                    00070050
070060                                                                  00070060
070070     PERFORM 140-35-PROCESSA-AC-NUMEROS.                          00070070
070080                                                                  00070080
070090     PERFORM 565-35-COMPLEM-OCR-AC-NUMEROS.                       00070090
070100                                                                  00070100
070110     MOVE 2 TO CH-SEQUENC-D10.                                    00070110
070120*                                                                 00070120
070130     IF AC-N-COD-MENS-WS = 17                                     00070130
070140         COMPUTE NUM-TOTAL-FUNC-WS =                              00070140
070150                 EMP-NUM-EXCED-FUNC-RED-WS + EMP-NUM-RED-WS       00070150
070160         MOVE NUM-TOTAL-FUNC-WS TO EMP-NUM-IOF-RED-WS             00070160
070170     ELSE                                                         00070170
070180         IF AC-N-COD-MENS-WS = 19                                 00070180
070190             COMPUTE EMP-NUM-IOF-RED-WS = (AC-NUMEROS-D07 * -1) + 00070190
070200                 EMP-NUM-IOF-RED-WS                               00070200
070210         ELSE                                                     00070210
070220             IF AC-N-COD-MENS-WS = 18                             00070220
070230                 MOVE EMP-NUM-IOF-RED-WS TO NUM-DEV-VR-ABSOLUTO   00070230
070240                 IF NUM-DEV-VR-ABSOLUTO LESS AC-NUMEROS-D07       00070240
070250                     MOVE 20 TO AC-N-COD-MENS-WS                  00070250
070260                     MOVE ZERO TO EMP-NUM-IOF-RED-WS              00070260
070270                 ELSE                                             00070270
070280                     COMPUTE EMP-NUM-IOF-RED-WS =                 00070280
070290                             EMP-NUM-IOF-RED-WS + AC-NUMEROS-D07. 00070290
070300                                                                  00070300
070310     PERFORM 560-35-INICIA-OCR-AC-NUMEROS THRU                    00070310
070320             565-35-COMPLEM-OCR-AC-NUMEROS.                       00070320

070350 136-35-ACERTO-JUROS.                                             00070350
070360                                                                  00070360
070370     MOVE AC-N-ADD-SUBT-D07 TO INDICADOR-JUROS-WS.                00070370
070380                                                                  00070380
070390     IF EMP-LIM-RED-WS NOT GREATER ZEROS                          00070390
070400        MOVE 'Z' TO INDICADOR-JUROS-WS                            00070400
070410     ELSE                                                         00070410
070420        IF JUROS-DIARIOS-WS EQUAL ZEROS AND                       00070420
070430           AC-N-ADD-SUBT-D07 EQUAL 'J'                            00070430
070440           MOVE 'X' TO INDICADOR-JUROS-WS.                        00070440
070450                                                                  00070450
070460     IF EMP-LIM-RED-WS GREATER ZEROS                              00070460
070470        IF AC-N-ADD-SUBT-D07 EQUAL 'I'                            00070470
070480           COMPUTE JUROS-DIARIOS-WS = JUROS-DIARIOS-WS +          00070480
070490                      (AC-NUMEROS-D07 * (-1))                     00070490
070500        ELSE                                                      00070500
070510          IF JUROS-DIARIOS-WS NOT EQUAL ZEROS                     00070510
070520             IF AC-N-ADD-SUBT-D07 EQUAL 'J'                       00070520
070530                COMPUTE JUROS-DIARIOS-WS = JUROS-DIARIOS-WS +     00070530
070540                        AC-NUMEROS-D07                            00070540
070550                IF JUROS-DIARIOS-WS EQUAL ZEROS                   00070550
070560                   MOVE 'V' TO INDICADOR-JUROS-WS.                00070560
070570                                                                  00070570
070590     IF JUROS-DIARIOS-WS GREATER ZEROS                            00070590
070600        MOVE ZEROS TO JUROS-DIARIOS-WS                            00070600
070610        MOVE 'V' TO INDICADOR-JUROS-WS.                           00070610
070630*                                                                 00070630
070640 136A-35-ACERTO-VALOR-IOC.                                        00070640
070650                                                                  00070650
070660     IF EMP-LIM-RED-WS GREATER ZEROS                              00070660
070670        IF  NOT P-FISICAS                                         00070670
070680           COMPUTE NUM-ACERTO-IOC-WS = (AC-NUMEROS-D07 * 100) /   00070680
070690                                    TX-IOC-JURID-WS               00070690
070700           IF AC-N-ADD-SUBT-D07 EQUAL 'B'                         00070700
070710              COMPUTE IOCS-DIARIOS-EXIGIVEIS-RED-WS =             00070710
070720                   IOCS-DIARIOS-EXIGIVEIS-RED-WS +                00070720
070730                   (AC-NUMEROS-D07 * (-1))                        00070730
070740              COMPUTE EMP-NUM-IOF-RED-WS = EMP-NUM-IOF-RED-WS -   00070740
070750                                        NUM-ACERTO-IOC-WS         00070750
070760           ELSE                                                   00070760
070770               IF IOCS-DIARIOS-EXIGIVEIS-RED-WS NOT EQUAL ZEROS   00070770
070780                  IF AC-N-ADD-SUBT-D07 EQUAL 'T'                  00070780
070790                     COMPUTE IOCS-DIARIOS-EXIGIVEIS-RED-WS =      00070790
070800                             IOCS-DIARIOS-EXIGIVEIS-RED-WS +      00070800
070810                             AC-NUMEROS-D07                       00070810
070820                  COMPUTE EMP-NUM-IOF-RED-WS = EMP-NUM-IOF-RED-WS 00070820
070830                                             + NUM-ACERTO-IOC-WS. 00070830

070840     IF EMP-LIM-RED-WS GREATER ZEROS                              00070840
070850        IF P-FISICAS                                              00070850
070860           COMPUTE NUM-ACERTO-IOC-WS = (AC-NUMEROS-D07 * 100) /   00070860
070870                                    TX-IOC-FISICA-WS              00070870
070880           IF AC-N-ADD-SUBT-D07 EQUAL 'B'                         00070880
070890              COMPUTE IOCS-DIARIOS-EXIGIVEIS-RED-WS =             00070890
070900                   IOCS-DIARIOS-EXIGIVEIS-RED-WS +                00070900
070910                   (AC-NUMEROS-D07 * (-1))                        00070910
070920              COMPUTE EMP-NUM-IOF-RED-WS = EMP-NUM-IOF-RED-WS -   00070920
070930                                        NUM-ACERTO-IOC-WS         00070930
070940           ELSE                                                   00070940
070950               IF IOCS-DIARIOS-EXIGIVEIS-RED-WS NOT EQUAL ZEROS   00070950
070960                  IF AC-N-ADD-SUBT-D07 EQUAL 'T'                  00070960
070970                     COMPUTE IOCS-DIARIOS-EXIGIVEIS-RED-WS =      00070970
070980                             IOCS-DIARIOS-EXIGIVEIS-RED-WS +      00070980
070990                             AC-NUMEROS-D07                       00070990
071000                  COMPUTE EMP-NUM-IOF-RED-WS = EMP-NUM-IOF-RED-WS 00071000
071010                                             + NUM-ACERTO-IOC-WS. 00071010
071020                                                                  00071020
071030     IF IOCS-DIARIOS-EXIGIVEIS-RED-WS GREATER ZEROS               00071030
071040        MOVE ZEROS TO IOCS-DIARIOS-EXIGIVEIS-RED-WS.              00071040
071050                                                                  00071050
071060     IF EMP-NUM-IOF-RED-WS GREATER ZEROS                          00071060
071070        MOVE ZEROS TO EMP-NUM-IOF-RED-WS.                         00071070
071080*                                                                 00071080
071090 137-35-ACERTO-JUR-IOF-INS.                                       00071090
071100                                                                  00071100
071110     MOVE AC-N-ADD-SUBT-D07 TO INDICADOR-JUROS-WS.                00071110
071120                                                                  00071120
071130     IF AC-N-ADD-SUBT-D07 = 'J' OR 'I'                            00071130
071140        PERFORM 137-35-ACERTO-JUROS-INS.                          00071140
071150                                                                  00071150
071160     IF AC-N-ADD-SUBT-D07 = 'B' OR 'T'                            00071160
071170        MOVE ZEROS TO INS-NIOF-REAL-RED-WS                        00071170
071190                      ACUM-BASE-IOF-ADIC-RED-WS.                  00071190
071200                                                                  00071200
071210 137-35-ACERTO-JUROS-INS.                                         00071210
071220                                                                  00071220
071230      IF INS-NJUR-REAL-RED-WS EQUAL ZEROS AND                     00071230
071240         AC-N-ADD-SUBT-D07 EQUAL 'J'                              00071240
071250         MOVE 'X' TO INDICADOR-JUROS-WS.                          00071250
071260                                                                  00071260
071270     IF AC-N-ADD-SUBT-D07 EQUAL 'I'                               00071270
071280        COMPUTE INS-NJUR-REAL-RED-WS = INS-NJUR-REAL-RED-WS +     00071280
071290                      (AC-NUMEROS-D07 * (-1))                     00071290
071300     ELSE                                                         00071300
071310       IF INS-NJUR-REAL-RED-WS NOT EQUAL ZEROS                    00071310
071320        IF AC-N-ADD-SUBT-D07 EQUAL 'J'                            00071320
071330           COMPUTE INS-NJUR-REAL-RED-WS = INS-NJUR-REAL-RED-WS +  00071330
071340                        AC-NUMEROS-D07                            00071340
071350           IF INS-NJUR-REAL-RED-WS EQUAL ZEROS                    00071350
071360              MOVE 'V' TO INDICADOR-JUROS-WS.                     00071360
071370                                                                  00071370
071380     IF INS-NJUR-REAL-RED-WS GREATER ZEROS                        00071380
071390        MOVE ZEROS TO INS-NJUR-REAL-RED-WS                        00071390
071400        MOVE 'V' TO INDICADOR-JUROS-WS.                           00071400
071410                                                                  00071410
071420 140-35-PROCESSA-AC-NUMEROS.                                      00071420
071430*                                                                 00071430
071440     IF EMP-LIM-RED-WS = ZEROS                                    00071440
071450        MOVE 21 TO AC-N-COD-MENS-WS                               00071450
071460     ELSE                                                         00071460
071470        PERFORM 145-35-REG6-ACUMULA                               00071470
071480        IF (EMP-DATA-RED-WS = DATA-D07-RED-WS) AND                00071480
071490           (EMP-NUM-RED-WS = 0 OR EMP-NUM-EXCED-FUNC-RED-WS = 0)  00071490
071500            AND (AC-N-ADD-SUBT-D07 = 'A')                         00071500
071510            MOVE 17 TO AC-N-COD-MENS-WS                           00071510
071520            COMPUTE EMP-NUM-RED-WS = AC-NUMEROS-D07 * (-1)        00071520
071530        ELSE                                                      00071530
071540           IF AC-N-ADD-SUBT-D07 = 'A'                             00071540
071550              MOVE 19 TO AC-N-COD-MENS-WS                         00071550
071560              COMPUTE EMP-NUM-RED-WS = (AC-NUMEROS-D07 * (-1))    00071560
071570                                      + EMP-NUM-RED-WS            00071570
071580           ELSE                                                   00071580
071590              MOVE EMP-NUM-RED-WS TO NUM-DEV-VR-ABSOLUTO          00071590
071600              IF AC-N-ADD-SUBT-D07 = 'S'                          00071600
071610                 MOVE 18 TO AC-N-COD-MENS-WS                      00071610
071620                 IF  AC-NUMEROS-D07 NOT GREATER                   00071620
071630                                        NUM-DEV-VR-ABSOLUTO       00071630
071640                     COMPUTE EMP-NUM-RED-WS = AC-NUMEROS-D07 +    00071640
071650                                              EMP-NUM-RED-WS      00071650
071660                 ELSE                                             00071660
071670                     MOVE ZEROS TO EMP-NUM-RED-WS                 00071670
071680                                   EMP-NUM-EXCED-FUNC-RED-WS      00071680
071690                     MOVE 20 TO AC-N-COD-MENS-WS.                 00071690
071720*                                                                 00071720
071730 145-35-REG6-ACUMULA.                                             00071730
071740*                                                                 00071740
071750     MOVE CH-DATA-D07 TO NUM-ULT-RED-WS ATL-ULT-DT-RED-WS.        00071750
071760                                                                  00071760
071770     IF AC-NUMEROS-D07 GREATER NUM-MOR-RED-WS                     00071770
071780         MOVE CH-DATA-D07 TO NUM-DATA-MOR-RED-WS                  00071780
071790         MOVE AC-NUMEROS-D07 TO NUM-MOR-RED-WS.                   00071790
071800                                                                  00071800
071810     ADD 1 TO NUM-VEZ-RED-WS.                                     00071810
071820                                                                  00071820
071830 148-35-TESTA-TRANS-SELIC.                                        00071830
071840                                                                  00071840
071850     IF CH-HIST-D07 EQUAL 01 OR 03 OR 04 OR 44                    00071850
071860        MOVE 1 TO SW-CHEQUE-NORMAL                                00071860
071870        ADD 1 TO ACUM-CH-PROCESSADOS-WS.                          00071870
071880                                                                  00071880
071890     IF CH-HIST-D07 = 99 AND                                      00071890
071900        CH-N-LOTE-D07 = 90 AND                                    00071900
071910        COD-SELIC-D07 = 1 AND                                     00071910
071920        TR-REF-D07 = 999999 AND                                   00071920
071930        TPCONTAB-RED-WS NOT EQUAL 49                              00071930
071940        ADD  TR-VALOR-D07 TO CRED-ANTECIP-WS                      00071940
071950        MOVE 1 TO SW-GERA-FICHA                                   00071950
071960     ELSE                                                         00071960
071970        PERFORM 149-35-TESTA-HIST-DESBLOQ.                        00071970
071990                                                                  00071990
072000 149-35-TESTA-HIST-DESBLOQ.                                       00072000
072010                                                                  00072010
072020     IF  DESBLOQUEIO-D07                                          00072020
072030         MOVE 1 TO SW-DESBLOQUEIO                                 00072030
072040         MOVE 07 TO HIST-DESBLOQ-WS                               00072040
072050         MOVE PRAZO-DESBLOQ-D07 TO PRAZO-DESBLOQ-WS               00072050
072060         MOVE TR-VALOR-D07 TO DESBLOQ-WS                          00072060
072070         PERFORM 151-149-ROTINA-DESBLOQUEIO                       00072070
072080     ELSE                                                         00072080
072090         IF  ESTORNO-D07                                          00072090
072100             MOVE 2 TO SW-DESBLOQUEIO                             00072100
072110             MOVE 06 TO HIST-DESBLOQ-WS                           00072110
072120             MOVE PRAZO-DESBLOQ-D07 TO PRAZO-DESBLOQ-WS           00072120
072130             MOVE TR-VALOR-D07 TO DESBLOQ-WS                      00072130
072140             PERFORM 151-149-ROTINA-DESBLOQUEIO                   00072140
072150             IF  DBLO-COD-MENS-WS EQUAL 35                        00072150
072160                 PERFORM 150-35-TRANSACAO                         00072160
072170             ELSE                                                 00072170
072180                 NEXT SENTENCE                                    00072180
072190         ELSE                                                     00072190
072200             MOVE ZEROS TO HIST-DESBLOQ-D10                       00072200
072210             PERFORM 150-35-TRANSACAO.                            00072210
072220*                                                                 00072220
072230 150-35-TRANSACAO.
072240*
072250     IF CALCULAR-NUMEROS
072260         PERFORM 180-35-NUM-DEVED-CREDORES.
072280
072290     MOVE CH-DATA-D07 TO ATL-ULT-MOV-RED-WS.
072300
072310*.................................................................
072320*  NAO NORMALIZA CONTA QDO A UNICA MOVIMENTACAO EH TAXA MANUTENCAO
072330*.................................................................
072340     IF (CH-HIST-D07 = 02) AND
072350        (CH-N-LOTE-D07 = 50) AND
072360        (TR-REF-D07 = 012106)
072370        NEXT SENTENCE
072380     ELSE
072390        MOVE ZERO TO ATL-DIAS-PARAL-RED-WS.
072400*.................................................................
072410
072420     PERFORM 155-35-REG7-ATL-CORRENTISTA.
072430
072440     PERFORM 170-35-REG7-ACUMULA.
072450
072470 151-149-ROTINA-DESBLOQUEIO.
072480
072490     IF  SLD-BLO-RED-WS (PRAZO-DESBLOQ-D07) EQUAL ZEROS
072500         MOVE 12 TO DBLO-COD-MENS-WS
072510     ELSE
072520         PERFORM 152-151-CALCULA-BLOQUEIO
072530         IF  DESBLOQUEIO-D07
072540             MOVE 34 TO DBLO-COD-MENS-WS
072550             MOVE 9            TO TIPO-CAD-02DD
072560             MOVE CH-CONTA-WS  TO CONTA-CAD-02DD
072570             MOVE CH-DIGITO-WS TO DIGITO-CAD-02DD
072580             MOVE CH-HIST-D07  TO CODHIST-MOV-02DD
072590             MOVE TR-REF-D07   TO NUMDOC-MOV-02DD
072600             MOVE DESBLOQ-WS   TO VALOR-MOV-02DD
072610             MULTIPLY -1 BY VALOR-MOV-02DD
072620             PERFORM 999-34-GRAVA-DISCO-TELEX
072630         ELSE
072640             MOVE 35 TO DBLO-COD-MENS-WS.

           MOVE SPACES TO REG-DEP-BLO-D10
           INITIALIZE REG-DEP-BLO-D10
072650     MOVE ZEROS TO DBLO-QDE-WS.                                   00072650
072660     PERFORM 535-35-OCR-DEPOSITO-BLOQUEADO.                       00072660
072680                                                                  00072680
072690  152-151-CALCULA-BLOQUEIO.                                       00072690
072710     COMPUTE BLOQUEIO-WS = SLD-BLO-RED-WS (PRAZO-DESBLOQ-D07) -   00072710
072720                           TR-VALOR-D07.                          00072720
072730                                                                  00072730
072740     IF BLOQUEIO-WS LESS THAN ZEROS                               00072740
072750        MOVE SLD-BLO-RED-WS (PRAZO-DESBLOQ-D07) TO DESBLOQ-WS     00072750
072760        MOVE ZEROS TO SLD-BLO-RED-WS (PRAZO-DESBLOQ-D07)          00072760
072770     ELSE                                                         00072770
072780        MOVE BLOQUEIO-WS TO SLD-BLO-RED-WS (PRAZO-DESBLOQ-D07).   00072780
072700                                                                  00072700
072830 155-35-REG7-ATL-CORRENTISTA.                                     00072830
072840*                                                                 00072840
072850     MOVE CH-DATA-D07 TO ATL-ULT-DT-RED-WS.                       00072850
072860     MOVE TR-REF-D07 TO DI-MOV-REF-WS.                            00072860
072870                                                                  00072870
072880     IF TRANS-D07                                                 00072880
072890         MOVE SPACES TO DI-AC-CAD-WS AC-EC-CAD-WS ESP-AC-CAD-WS.  00072890
072900                                                                  00072900
072910     ADD 1 TO MOV-NUM-RED-WS                                      00072910
072920              IND-MOVTOS.                                         00072920
072930                                                                  00072930
072940     IF IND-MOVTOS GREATER THAN 16000                             00072940
072950         DISPLAY '**P04808-CANCEL.TABELA-DE-MOVIMENTOS ESTOUROU**'00072950
072960         DISPLAY '*** AGENCIA = ' CH-AG-WS                        00072960
072970         DISPLAY '*** CONTA   = ' CH-NUM-CONTA-WS                 00072970
072980         DISPLAY '*** IND-MOV = ' IND-MOVTOS                      00072980
072990         MOVE COD-RETORNO-WS (4) TO RETURN-CODE                   00072990
073000         DISPLAY 'RETURN CODE EH ... ' COD-RETORNO-WS (4)         00073000
073010         DISPLAY 'MENSAGEM DE RETORNO EH .. ' MEN-RETORNO-WS (4)  00073010
073020         GOBACK.                                                  00073020
073030                                                                  00073030
073040     MOVE CH-N-LOTE-D07 TO MOV-LOTE-TAB    (IND-MOVTOS).          00073040
073050     MOVE DIA-D07-WS    TO DIA-MOV-RED-WS  (MOV-NUM-RED-WS).      00073050
073060     MOVE CH-HIST-D07   TO HIST-MOV-RED-WS (MOV-NUM-RED-WS)       00073060
073070                           MOV-HIST-TAB    (IND-MOVTOS).          00073070
073080     MOVE TR-REF-D07    TO REF-MOV-RED-WS  (MOV-NUM-RED-WS)       00073080
073090                           MOV-REF-TAB     (IND-MOVTOS).          00073090
073100     MOVE TR-VALOR-D07  TO VR-MOV-RED-WS   (MOV-NUM-RED-WS)       00073100
073110                           MOV-VR-TAB      (IND-MOVTOS).          00073110
073120                                                                  00073120
073130     MOVE 9            TO TIPO-CAD-02DD                           00073130
073140     MOVE CH-CONTA-WS  TO CONTA-CAD-02DD                          00073140
073150     MOVE CH-DIGITO-WS TO DIGITO-CAD-02DD                         00073150
073160     MOVE CH-HIST-D07  TO CODHIST-MOV-02DD                        00073160
073170     MOVE TR-REF-D07   TO NUMDOC-MOV-02DD                         00073170
073180     MOVE TR-VALOR-D07 TO VALOR-MOV-02DD                          00073180
073190     IF  (NATUREZA-HIST-D07 GREATER 0) AND                        00073190
073200         (NATUREZA-HIST-D07 LESS 51)                              00073200
073210         MULTIPLY -1 BY VALOR-MOV-02DD                            00073210
073220         PERFORM 999-34-GRAVA-DISCO-TELEX                         00073220
073230     ELSE                                                         00073230
073240         PERFORM 999-34-GRAVA-DISCO-TELEX.                        00073240
073250                                                                  00073250
073260     PERFORM 515-35-INICIA-OCR-DIARIO.                            00073260
073270     PERFORM 160-35-ATL-SALDOS.                                   00073270
073280                                                                  00073280
073290     MOVE 'D' TO EXT-TPSLD-RED-WS.                                00073290
073300                                                                  00073300
073310     IF EMP-LIM-RED-WS GREATER ZERO                               00073310
073320         IF SLD-DEP-RED-WS LESS ZERO                              00073320
073330             ADD SLD-DEP-RED-WS TO SLD-EMP-RED-WS                 00073330
073340             MOVE 'E' TO EXT-TPSLD-RED-WS                         00073340
073350             MOVE ZERO TO SLD-DEP-RED-WS                          00073350
073360         ELSE                                                     00073360
073370             IF SLD-EMP-RED-WS LESS ZERO                          00073370
073380                 ADD SLD-DEP-RED-WS TO SLD-EMP-RED-WS             00073380
073390                 MOVE ZERO TO SLD-DEP-RED-WS                      00073390
073400                 IF SLD-EMP-RED-WS LESS ZERO                      00073400
073410                     MOVE 'E' TO EXT-TPSLD-RED-WS                 00073410
073420                 ELSE                                             00073420
073430                     MOVE SLD-EMP-RED-WS TO SLD-DEP-RED-WS        00073430
073440                     MOVE ZERO TO SLD-EMP-RED-WS.                 00073440
073450                                                                  00073450
073650*    IF CH-HIST-D07 = 40 AND CH-N-LOTE-D07 = 50                   00073650
073660*       IF TRANS-D07                                              00073660
073670*          MOVE ZEROS TO EMP-NUM-RED-WS                           00073670
073680*                        JUROS-DIARIOS-WS                         00073680
073690*                        EMP-NUM-EXCED-FUNC-RED-WS.               00073690
073700                                                                  00073700
073710     IF CH-HIST-D07 = 9 AND CH-N-LOTE-D07 = 50                    00073710
073720        ADD DI-MOV-VR-WS         TO EMP-JCOB-RED-WS               00073720
                                          JUR-MENSAL-1DIA-WS.
073730                                                                  00073730
           IF CH-HIST-D07 = 008
              MOVE ZEROS TO EMP-NUM-IOF-RED-WS
                            IOCS-DIARIOS-EXIGIVEIS-RED-WS
              ADD DI-MOV-VR-WS         TO IOF-MENSAL-1DIA-WS
           ELSE
073740     IF CH-HIST-D07 = 37 OR 39                                    00073740
073750        PERFORM 305-35-CALCULA-JUROS-IOF                          00073750
073760        PERFORM 307-35-EVENTO-IOF                                 00073760
073770        MOVE ZEROS TO EMP-NUM-IOF-RED-WS                          00073770
073780*                     IOCS-DIARIOS-EXIGIVEIS-RED-WS               00073780
110580        COMPUTE IOCS-DIARIOS-EXIGIVEIS-RED-WS =
110580                IOCS-DIARIOS-EXIGIVEIS-RED-WS + TR-VALOR-D07
              IF IOCS-DIARIOS-EXIGIVEIS-RED-WS GREATER ZEROS
                 MOVE ZEROS TO IOCS-DIARIOS-EXIGIVEIS-RED-WS
              END-IF
073790     ELSE                                                         00073790
073800        IF CH-HIST-D07 = 38 OR 40                                 00073800
073810           PERFORM 305-35-CALCULA-JUROS-IOF                       00073810
073820           PERFORM 306-35-EVENTO-JUROS                            00073820
073830           ADD DI-MOV-VR-WS TO EMP-JCOB-RED-WS                    00073830
073840           MOVE ZEROS TO EMP-NUM-RED-WS                           00073840
073860                         EMP-NUM-EXCED-FUNC-RED-WS                00073860
073850*                        JUROS-DIARIOS-WS                         00073850
110580           COMPUTE JUROS-DIARIOS-WS =
110580                   JUROS-DIARIOS-WS + TR-VALOR-D07
                 IF JUROS-DIARIOS-WS GREATER ZEROS
                    MOVE ZEROS TO JUROS-DIARIOS-WS
                 END-IF
073870        ELSE                                                      00073870
073880          IF CH-HIST-D07 = 383                                    00073880
073890             ADD TR-VALOR-D07 TO HIST-383-WS                      00073890
073900          ELSE                                                    00073900
073910             IF CH-HIST-D07 = 384                                 00073910
073920                ADD TR-VALOR-D07 TO HIST-384-WS                   00073920
073930             ELSE                                                 00073930
073940               IF CH-HIST-D07 = 387                               00073940
073950                  MOVE 1 TO SW-TEM-HIST-387                       00073950
073960                  MOVE ZEROS TO QDE-INS-EXC-MES-RED-WS            00073960
073970                  MOVE ZEROS TO INS-NIOF-REAL-RED-WS              00073970
073980                                INS-NIOF-DECOR-RED-WS             00073980
073990                  MOVE ZEROS TO INS-NJUR-REAL-RED-WS              00073990
074000                                INS-NJUR-DECOR-RED-WS             00074000
074020                                ACUM-BASE-IOF-ADIC-RED-WS         00074020
074030               ELSE                                               00074030
074040                IF CH-HIST-D07 = 388                              00074040
074050                   PERFORM 308-35-EVENTO-ESTORNO-IOF              00074050
074060                ELSE                                              00074060
074070                  IF CH-HIST-D07 = 515                            00074070
074080                     PERFORM 309-35-EVENTO-INS-JUROS              00074080
074090                  ELSE                                            00074090
074100                    IF CH-HIST-D07 = 516                          00074100
074110                       PERFORM 310-35-EVENTO-INS-IOF              00074110
074120                    ELSE                                          00074120
074130                      IF CH-HIST-D07 = 392                        00074130
074140                         ADD TR-VALOR-D07 TO HIST-392-WS          00074140
074150                      ELSE                                        00074150
074160                        IF CH-HIST-D07 = 393                      00074160
074170                           ADD TR-VALOR-D07 TO HIST-393-WS        00074170
074180                        ELSE                                      00074180
074190                         IF CH-HIST-D07 = 020                     00074190
074200                            MOVE ZEROS TO INS-NJUR-REAL-RED-WS    00074200
074210                                          INS-NJUR-DECOR-RED-WS   00074210
074220                         ELSE                                     00074220
074230                          IF CH-HIST-D07 = 021                    00074230
074240                            MOVE ZEROS TO INS-NIOF-REAL-RED-WS    00074240
074250                                          INS-NIOF-DECOR-RED-WS   00074250
074270                                      ACUM-BASE-IOF-ADIC-RED-WS   00074270
074280                          ELSE                                    00074280
      * QUANDO HA REVERSAO DE RAP, PRECISAMOS RECALCULAR O VALOR DA RAP.
074290                           IF CH-HIST-D07 = 386 AND
                                         RAP-RED-WS NOT = ZEROS
                                     PERFORM REVERTER-RAP-386.

           PERFORM 999-96-ACESSA-V048HIST

           IF CH-HIST-D07 = HST-REVERSAO-RENDAS
           OR CH-HIST-D07 = HST-BAIXA-DO-ATIVO
              ADD TR-VALOR-D07 TO VLR-CRED-BAIXA-ATV-WS
           END-IF

074370*    IF ESTORNO-CPMF-D07
           IF (CH-HIST-D07 NOT EQUAL 566 AND 567)
               IF (CH-HIST-D07 = 071 OR 451)
074380             ADD TR-VALOR-D07 TO SLD-DEVOL-WS.

           IF (GP-FBB OF DCLV048HIST = 204)
              IF CH-HIST-D07 NOT = 386
074380           ADD TR-VALOR-D07 TO SLD-DEVOL-WS.

074390     IF CH-HIST-D07 = 071 OR 373
074400        MOVE 1 TO SW-TEM-HIST-71-373.
074530
074540     IF CALC-SMED-RED-WS EQUAL 0
074550        PERFORM 156-155-BLOQUEIA-NCAD
074560*...........................................................
074570* BLOQUEIA HISTORICOS A CREDITO EXCETO HISTORICOS RELATIVO A      00074570
074580* SALARIO DAS CONTAS AD.BANCO CONFORME AUTORIZADO POR OCIONE      00074580
074590* EM 11/03/2003                                                   00074590
074600*...........................................................      00074600
074610     ELSE                                                         00074610
074620      IF AD-BANCO                                                 00074620
074630       IF NOT LIBERADO-ADBANCO-D07 AND NOT ESTORNO-CPMF-D07       00074630
074640          PERFORM 156-155-BLOQUEIA-ADBANCO                        00074640
074650       ELSE                                                       00074650
074660        NEXT SENTENCE                                             00074660
074670      ELSE                                                        00074670
074680*...........................................................      00074680
074690       IF ((CH-CODAG-D07 = 016 AND CONTA-D07 = 6047) OR           00074690
074700           (CH-CODAG-D07 = 044 AND CONTA-D07 = 42109))            00074700
074710           NEXT SENTENCE                                          00074710
074720       ELSE                                                       00074720
074730        IF CH-HIST-D07 = 52 OR 352 OR 572 OR 668                  00074730
074740          ADD DI-MOV-VR-WS TO SLD-BLO-RED-WS (1)                  00074740
074750          ADD 1 TO DBLO-QDE-WS                                    00074750
074760          MOVE 1 TO SW-GERA-BLOQUEADO                             00074760
074770       ELSE                                                       00074770
074780        IF CH-HIST-D07 = 53 OR 353 OR 669                         00074780
074790           ADD DI-MOV-VR-WS TO SLD-BLO-RED-WS (2)                 00074790
074800           ADD 1 TO DBLO-QDE-WS                                   00074800
074810           MOVE 1 TO SW-GERA-BLOQUEADO                            00074810
074820        ELSE                                                      00074820
074830         IF CH-HIST-D07 = 54 OR 354                               00074830
074840           ADD DI-MOV-VR-WS TO SLD-BLO-RED-WS (3)                 00074840
074850           ADD 1 TO DBLO-QDE-WS                                   00074850
074860           MOVE 1 TO SW-GERA-BLOQUEADO                            00074860
074870         ELSE                                                     00074870
074880           IF CH-HIST-D07 = 55 OR 355                             00074880
074890             ADD DI-MOV-VR-WS TO SLD-BLO-RED-WS (4)               00074890
074900             ADD 1 TO DBLO-QDE-WS                                 00074900
074910             MOVE 1 TO SW-GERA-BLOQUEADO                          00074910
074920           ELSE                                                   00074920
074930             IF CH-HIST-D07 = 64 OR 356                           00074930
074940               ADD DI-MOV-VR-WS TO SLD-BLO-RED-WS (5)             00074940
074950               ADD 1 TO DBLO-QDE-WS                               00074950
074960               MOVE 1 TO SW-GERA-BLOQUEADO                        00074960
074970             ELSE                                                 00074970
074980               IF CH-HIST-D07 = 65 OR 357                         00074980
074990                 ADD DI-MOV-VR-WS TO SLD-BLO-RED-WS (6)           00074990
075000                 ADD 1 TO DBLO-QDE-WS                             00075000
075010                 MOVE 1 TO SW-GERA-BLOQUEADO                      00075010
075020               ELSE                                               00075020
075030                 IF CH-HIST-D07 = 66 OR 358                       00075030
075040                   ADD DI-MOV-VR-WS TO SLD-BLO-RED-WS (7)         00075040
075050                   ADD 1 TO DBLO-QDE-WS                           00075050
075060                   MOVE 1 TO SW-GERA-BLOQUEADO                    00075060
075070                 ELSE                                             00075070
075080                   IF CH-HIST-D07 = 67 OR 359                     00075080
075090                     ADD DI-MOV-VR-WS TO SLD-BLO-RED-WS (8)       00075090
075100                     ADD 1 TO DBLO-QDE-WS                         00075100
075110                     MOVE 1 TO SW-GERA-BLOQUEADO                  00075110
075120                   ELSE                                           00075120
075130                     IF CH-HIST-D07 = 68                          00075130
075140                       ADD DI-MOV-VR-WS TO SLD-BLO-RED-WS (20)    00075140
075150                       ADD 1 TO DBLO-QDE-WS                       00075150
075160                       MOVE 1 TO SW-GERA-BLOQUEADO.               00075160
075170                                                                  00075170
075190     PERFORM 520-35-OCR-DIARIO-CC.                                00075190
075200                                                                  00075200
075210     PERFORM 165-35-REG7-ESPECIAIS.                               00075210
075220                                                                  00075220
075230     IF MOV-NUM-RED-WS = 17                                       00075230
075250         MOVE ZEROS TO EXT-COD-MENS-D10 EXT-COD-MENS-WS           00075250
075270         PERFORM 200-35-GERA-EXTRATO-F10.                         00075270
075280                                                                  00075280
075300 156-155-BLOQUEIA-NCAD.                                           00075300
075310                                                                  00075310
075320     IF (NATUREZA-HIST-D07 GREATER 50) OR                         00075320
075330        (NATUREZA-HIST-D07 EQUAL 0)                               00075330
075340        IF NOT LIBERADO-NCAD-D07                                  00075340
075350           ADD DI-MOV-VR-WS TO SLD-BLO-RED-WS (21)                00075350
075360           ADD 1 TO DBLO-QDE-WS                                   00075360
075370           MOVE 1 TO SW-GERA-BLOQUEADO.                           00075370
075380*                                                                 00075380
075390 156-155-BLOQUEIA-ADBANCO.                                        00075390
075400                                                                  00075400
075410     IF (NATUREZA-HIST-D07 GREATER 50) OR                         00075410
075420        (NATUREZA-HIST-D07 EQUAL 0)                               00075420
075430           ADD DI-MOV-VR-WS TO SLD-BLO-RED-WS (21)                00075430
075440           ADD 1 TO DBLO-QDE-WS                                   00075440
075450           MOVE 1 TO SW-GERA-BLOQUEADO.                           00075450
075460*                                                                 00075460
DOCINI****F* P04808/160-35-ATL-SALDOS
DOCTXT* OBJETIVO
DOCTXT*   Rotina chamada sempre apos o processamento de uma transacao,
DOCTXT*   fazendo a atualizacao do saldo da conta e computando variaveis
DOCTXT*   adicionais: quantidades de saques, acumulado de adiantamento,
DOCTXT*   quantidade de cheques usados...
DOCEND******
075580 160-35-ATL-SALDOS.                                               00075580
075600* ELV - 12/04/2008                                                00075600
075610     IF (CH-HIST-D07 = 004) AND (QDE-CHQ-COMP-INTERNA-WS < 999)   00075610
075620        ADD 1 TO QDE-CHQ-COMP-INTERNA-WS.                         00075620
075630                                                                  00075630
075640     IF (CH-HIST-D07 = 044) AND (QDE-CHQ-PG-CAIXA-WS < 999)       00075640
075650        ADD 1 TO QDE-CHQ-PG-CAIXA-WS.                             00075650
075660                                                                  00075660
075670     IF (CH-HIST-D07 = 045) AND (QDE-CHQ-AVULSO-WS < 999)         00075670
075680        ADD 1 TO QDE-CHQ-AVULSO-WS.                               00075680
075690                                                                  00075690
075700     IF (CH-HIST-D07 = 703) AND (QDE-SAQ-CARTAO-CAIXA-WS < 999)   00075700
075710        ADD 1 TO QDE-SAQ-CARTAO-CAIXA-WS.                         00075710
075720                                                                  00075720
075730     IF (CH-HIST-D07 = 047) AND (QDE-SAQ-CARTAO-WS < 999)         00075730
075740        ADD 1 TO QDE-SAQ-CARTAO-WS.                               00075740
075750                                                                  00075750
075760     IF (CH-HIST-D07 = 048) AND (QDE-SAQ-BCO24HS-WS < 999)        00075760
075770        ADD 1 TO QDE-SAQ-BCO24HS-WS.                              00075770
075780                                                                  00075780
075790     IF (CH-HIST-D07 = 734) AND (QDE-SAQ-BB-WS < 999)             00075790
075800        ADD 1 TO QDE-SAQ-BB-WS.                                   00075800
075810                                                                  00075810
075820     IF (CH-HIST-D07 = 836) AND (QDE-SAQ-RVA-WS < 999)            00075820
075830        ADD 1 TO QDE-SAQ-RVA-WS.                                  00075830
075840                                                                  00075840
075850* ELV - 12/04/2008                                                00075850
075860                                                                  00075860
      * COMENTADO EM 08/10/2012
075870*     IF (CH-HIST-D07 EQUAL 047 OR 703 OR 704) AND                00075870
075880*        (VR-MOV-RED-WS(MOV-NUM-RED-WS)) < 25,01                  00075880
075890*         ADD 1 TO QDE-SAQ-CARTAO-CTASAL-WS.                      00075890
075900                                                                  00075900
075910*     IF ((CH-HIST-D07 EQUAL 001 OR 003 OR 004 OR 044) AND        00075910
075910     IF ((CH-HIST-D07 EQUAL 001 OR 003 OR 004) AND                00075910
075920         (TR-VALOR-D07 GREATER THAN 25,00      AND                00075920
075930          TR-VALOR-D07 LESS    THAN 5000,00))                     00075930
075940          ADD 1 TO QDE-CHQ-PROCES-WS.                             00075940
075950                                                                  00075950
076000     IF (NATUREZA-HIST-D07 GREATER 0) AND                         00076000
076010        (NATUREZA-HIST-D07 LESS 51)                               00076010
076020         MULTIPLY -1 BY VR-MOV-RED-WS (MOV-NUM-RED-WS).           00076020
076030                                                                  00076030
076040     MOVE VR-MOV-RED-WS (MOV-NUM-RED-WS) TO DI-MOV-VR-WS.         00076040
076050                                                                  00076050
076060     IF CH-HIST-D07 EQUAL 034 OR 021                              00076060
076070        ADD DI-MOV-VR-WS TO CPMF-WS.                              00076070
076090                                                                  00076090
076100     ADD DI-MOV-VR-WS TO GR-DIFERENCA.                            00076100
076110     ADD 1 TO QDE-GR-DIFERENCA.                                   00076110
076120                                                                  00076120
076130     COMPUTE SLD-DEP-RED-WS = SLD-DEP-RED-WS + DI-MOV-VR-WS.      00076130
076140     IF  CH-HIST-D07 EQUAL 89                                     00076140
      *    Se for um movimento de adiantamento a depositantes mova o valor
      *    da transacao para o VALOR-ACUM-ADIANT-RED-WS
076150         MOVE DI-MOV-VR-WS TO VALOR-ACUM-ADIANT-RED-WS            00076150
076160         IF  DATA-ADIANT-RED-WS EQUAL ZEROS                       00076160
076170             MOVE CH-DATA-D07 TO DATA-ADIANT-RED-WS.              00076170
076180*                                                                 00076180
076190 165-35-REG7-ESPECIAIS.                                           00076190
076200*                                                                 00076200
076210     IF (NATUREZA-HIST-D07 GREATER 50) OR                         00076210
076220        (NATUREZA-HIST-D07 EQUAL 0)                               00076220
076230         IF JURIDICA OR PESSOA-K OR (CTA-DIGITAL AND P-JURIDICAS) 00076230
076240             IF TR-VALOR-D07 LESS GR-CRED-PJUR-WS                 00076240
076250                 NEXT SENTENCE                                    00076250
076260             ELSE                                                 00076260
076270                 MOVE 1 TO SW-INDICA-GR-CRE-DEB                   00076270
076280                 PERFORM 530-35-OCR-ESPECIAIS                     00076280
076290         ELSE                                                     00076290
076300             IF TR-VALOR-D07 LESS GR-CRED-PFIS-WS                 00076300
076310                 NEXT SENTENCE                                    00076310
076320             ELSE                                                 00076320
076330                 MOVE 1 TO SW-INDICA-GR-CRE-DEB                   00076330
076340                 PERFORM 530-35-OCR-ESPECIAIS                     00076340
076350     ELSE                                                         00076350
076360         IF JURIDICA OR PESSOA-K OR (CTA-DIGITAL AND P-JURIDICAS) 00076360
076370             IF TR-VALOR-D07 LESS GR-DEB-PJUR-WS                  00076370
076380                 NEXT SENTENCE                                    00076380
076390             ELSE                                                 00076390
076400                 MOVE 1 TO SW-INDICA-GR-CRE-DEB                   00076400
076410                 PERFORM 530-35-OCR-ESPECIAIS                     00076410
076420         ELSE                                                     00076420
076430             IF TR-VALOR-D07 NOT LESS GR-DEB-PFIS-WS              00076430
076440                 MOVE 1 TO SW-INDICA-GR-CRE-DEB                   00076440
076450                 PERFORM 530-35-OCR-ESPECIAIS.                    00076450
076460                                                                  00076460
076500 170-35-REG7-ACUMULA.                                             00076500
076510*                                                                 00076510
076520     IF (NATUREZA-HIST-D07 GREATER ZERO) AND                      00076520
076530        (NATUREZA-HIST-D07 LESS 51)                               00076530
076540         ADD 1 TO ACUM-QDE-DEB-TAB (TPCONTAB-RED-WS)              00076540
076550         ADD TR-VALOR-D07 TO ACUM-VR-DEB-TAB (TPCONTAB-RED-WS)    00076550
076560     ELSE                                                         00076560
076570         ADD 1 TO ACUM-QDE-CRED-TAB (TPCONTAB-RED-WS)             00076570
076580         ADD TR-VALOR-D07 TO ACUM-VR-CRED-TAB (TPCONTAB-RED-WS).  00076580
076590*                                                                 00076590
076600 170-35-ESPECIAIS.                                                00076600

076610     IF NOT HA-MOVIMENTACAO                                       00076610
076620        MOVE ZEROS TO MOVIMENTACAO-RED-WS.                        00076620

076630     IF CH-N-LOTE-D07 = 95                                        00076630
076650        IF EMP-LIM-RED-WS GREATER ZERO                            00076650
076660           MOVE ZEROS   TO SW-CONTRATO-VENCIDO                    00076660
076670           PERFORM 190-35-CANCELA-EMPRESTIMO                      00076670
076680        ELSE                                                      00076680
076690           MOVE 21      TO C-EMP-COD-MENS-D10                     00076690
076700           MOVE ZERO    TO C-EMP-JUR-DEV-D10                      00076700
076710                           EXC-VEZ-CONTRATO-RED-WS                00076710
076720           PERFORM 555-35-OCR-CAD-EMP                             00076720
076750     ELSE                                                         00076750
076760        IF CH-N-LOTE-D07 = 96                                     00076760
076770           IF EMP-LIM-RED-WS EQUAL ZEROS                          00076770
076780              PERFORM 195-35-CANCELA-CONTA-CORRENTE               00076780
076790           ELSE                                                   00076790
076800              MOVE 38   TO C-CC-COD-MENS-D10                      00076800
076810              PERFORM 545-35-OCR-CAD-CC                           00076810
076820         ELSE                                                     00076820
076830           IF  CH-N-LOTE-D07 = 98                                 00076830
076840               PERFORM 210-35-SOLICITA-EXTRATO                    00076840
076850           ELSE                                                   00076850
076860               IF CH-N-LOTE-D07 = 99                              00076860
076870                  PERFORM 212-35-CHEQUE-PERSONALIZADO             00076870
076880               ELSE                                               00076880
076890                  IF CH-N-LOTE-D07 = 97                           00076890
076900                     MOVE CH-DATA-D07 TO ATL-ULT-DT-RED-WS        00076900
076910                     IF CH-HIST-D07 = 00                          00076910
076920                        MOVE 'GA' TO COD-GARANTIA-RED-WS          00076920
076930                     ELSE                                         00076930
076940                     IF CH-HIST-D07 = 01                          00076940
076950                        MOVE 'GB' TO COD-GARANTIA-RED-WS          00076950
076960                     ELSE                                         00076960
076970                     IF CH-HIST-D07 = 02                          00076970
076980                        MOVE 'GC' TO COD-GARANTIA-RED-WS          00076980
076990                     ELSE                                         00076990
077000                     IF CH-HIST-D07 = 03                          00077000
077010                        MOVE 'GD' TO COD-GARANTIA-RED-WS          00077010
077020                     ELSE                                         00077020
077030                     IF CH-HIST-D07 = 04                          00077030
077040                        MOVE 'GE' TO COD-GARANTIA-RED-WS          00077040
077050                     ELSE                                         00077050
077060                        IF CH-HIST-D07 = 99                       00077060
077070                           MOVE SPACES TO COD-GARANTIA-RED-WS.    00077070

077080     IF CH-N-LOTE-D07 = 95 OR 96                                  00077080
077090        IF CH-HIST-D07 = ZEROS                                    00077090
077100           PERFORM 124-124-GRAVA-D0480701.                        00077100
077120*                                                                 00077120
077130 175-35-REMANEJA-BLOQUEIOS.                                       00077130
077150*.................................................................00077150
077160*.... REMANEJA P/ OCORRENCIA 1 O VALOR DAS OCORRENCIAS DE BLOQUEIO00077160
077170*.... POR OCASIAO DA REGULARIZACAO DA CONTA (RECADASTRAMENTO) ....00077170
077180*.................................................................00077180
077190     IF CALC-SMED-RED-WS EQUAL 1                                  00077190
077200       IF IND-BLOQUEIO-1 = 1                                      00077200
077210         IF CH-CONTA-WS NOT = 89997                               00077210
077220          IF SLD-BLO-RED-WS (21) GREATER ZEROS                    00077220
077230             ADD SLD-BLO-RED-WS (21) TO SLD-BLO-RED-WS (1)        00077230
077240             MOVE ZEROS TO SLD-BLO-RED-WS (21).                   00077240
077250                                                                  00077250
077260     IF CALC-SMED-RED-WS EQUAL 1                                  00077260
077270        IF IND-BLOQUEIO-1 = 1                                     00077270
077280         IF CH-CONTA-WS = 89997                                   00077280
077290           IF (SLD-BLO-RED-WS (21) GREATER ZEROS OR               00077290
077300               SLD-BLO-RED-WS (20) GREATER ZEROS OR               00077300
077310               SLD-BLO-RED-WS (19) GREATER ZEROS OR               00077310
077320               SLD-BLO-RED-WS (18) GREATER ZEROS OR               00077320
077330               SLD-BLO-RED-WS (17) GREATER ZEROS OR               00077330
077340               SLD-BLO-RED-WS (16) GREATER ZEROS OR               00077340
077350               SLD-BLO-RED-WS (15) GREATER ZEROS OR               00077350
077360               SLD-BLO-RED-WS (14) GREATER ZEROS OR               00077360
077370               SLD-BLO-RED-WS (13) GREATER ZEROS OR               00077370
077380               SLD-BLO-RED-WS (12) GREATER ZEROS OR               00077380
077390               SLD-BLO-RED-WS (11) GREATER ZEROS OR               00077390
077400               SLD-BLO-RED-WS (10) GREATER ZEROS OR               00077400
077410               SLD-BLO-RED-WS (09) GREATER ZEROS OR               00077410
077420               SLD-BLO-RED-WS (08) GREATER ZEROS OR               00077420
077430               SLD-BLO-RED-WS (07) GREATER ZEROS OR               00077430
077440               SLD-BLO-RED-WS (06) GREATER ZEROS OR               00077440
077450               SLD-BLO-RED-WS (05) GREATER ZEROS OR               00077450
077460               SLD-BLO-RED-WS (04) GREATER ZEROS OR               00077460
077470               SLD-BLO-RED-WS (03) GREATER ZEROS OR               00077470
077480               SLD-BLO-RED-WS (02) GREATER ZEROS)                 00077480
077490              ADD SLD-BLO-RED-WS (21) TO SLD-BLO-RED-WS (1)       00077490
077500              ADD SLD-BLO-RED-WS (20) TO SLD-BLO-RED-WS (1)       00077500
077510              ADD SLD-BLO-RED-WS (19) TO SLD-BLO-RED-WS (1)       00077510
077520              ADD SLD-BLO-RED-WS (18) TO SLD-BLO-RED-WS (1)       00077520
077530              ADD SLD-BLO-RED-WS (17) TO SLD-BLO-RED-WS (1)       00077530
077540              ADD SLD-BLO-RED-WS (16) TO SLD-BLO-RED-WS (1)       00077540
077550              ADD SLD-BLO-RED-WS (15) TO SLD-BLO-RED-WS (1)       00077550
077560              ADD SLD-BLO-RED-WS (14) TO SLD-BLO-RED-WS (1)       00077560
077570              ADD SLD-BLO-RED-WS (13) TO SLD-BLO-RED-WS (1)       00077570
077580              ADD SLD-BLO-RED-WS (12) TO SLD-BLO-RED-WS (1)       00077580
077590              ADD SLD-BLO-RED-WS (11) TO SLD-BLO-RED-WS (1)       00077590
077600              ADD SLD-BLO-RED-WS (10) TO SLD-BLO-RED-WS (1)       00077600
077610              ADD SLD-BLO-RED-WS (09) TO SLD-BLO-RED-WS (1)       00077610
077620              ADD SLD-BLO-RED-WS (08) TO SLD-BLO-RED-WS (1)       00077620
077630              ADD SLD-BLO-RED-WS (07) TO SLD-BLO-RED-WS (1)       00077630
077640              ADD SLD-BLO-RED-WS (06) TO SLD-BLO-RED-WS (1)       00077640
077650              ADD SLD-BLO-RED-WS (05) TO SLD-BLO-RED-WS (1)       00077650
077660              ADD SLD-BLO-RED-WS (04) TO SLD-BLO-RED-WS (1)       00077660
077670              ADD SLD-BLO-RED-WS (03) TO SLD-BLO-RED-WS (1)       00077670
077680              ADD SLD-BLO-RED-WS (02) TO SLD-BLO-RED-WS (1)       00077680
077690              MOVE ZEROS TO SLD-BLO-RED-WS (02)                   00077690
077700              MOVE ZEROS TO SLD-BLO-RED-WS (03)                   00077700
077710              MOVE ZEROS TO SLD-BLO-RED-WS (04)                   00077710
077720              MOVE ZEROS TO SLD-BLO-RED-WS (05)                   00077720
077730              MOVE ZEROS TO SLD-BLO-RED-WS (06)                   00077730
077740              MOVE ZEROS TO SLD-BLO-RED-WS (07)                   00077740
077750              MOVE ZEROS TO SLD-BLO-RED-WS (08)                   00077750
077760              MOVE ZEROS TO SLD-BLO-RED-WS (09)                   00077760
077770              MOVE ZEROS TO SLD-BLO-RED-WS (10)                   00077770
077780              MOVE ZEROS TO SLD-BLO-RED-WS (11)                   00077780
077790              MOVE ZEROS TO SLD-BLO-RED-WS (12)                   00077790
077800              MOVE ZEROS TO SLD-BLO-RED-WS (13)                   00077800
077810              MOVE ZEROS TO SLD-BLO-RED-WS (14)                   00077810
077820              MOVE ZEROS TO SLD-BLO-RED-WS (15)                   00077820
077830              MOVE ZEROS TO SLD-BLO-RED-WS (16)                   00077830
077840              MOVE ZEROS TO SLD-BLO-RED-WS (17)                   00077840
077850              MOVE ZEROS TO SLD-BLO-RED-WS (18)                   00077850
077860              MOVE ZEROS TO SLD-BLO-RED-WS (19)                   00077860
077870              MOVE ZEROS TO SLD-BLO-RED-WS (20)                   00077870
077880              MOVE ZEROS TO SLD-BLO-RED-WS (21).                  00077880
077890*.................................................................00077890
077900*.... BLOQUEIA NA OCORRENCIA 21 O BLOQUEIO DE 1 DIA SOMENTE ......00077900
077910*.... PARA AS CONTAS NAO RECADASTRADAS                      ......00077910
077920*.................................................................00077920
077930     IF CALC-SMED-RED-WS EQUAL 0                                  00077930
077940        IF IND-BLOQUEIO-1 = 1                                     00077940
077950           IF SLD-BLO-RED-WS (1) GREATER ZEROS                    00077950
077960              ADD SLD-BLO-RED-WS (1) TO SLD-BLO-RED-WS (21)       00077960
077970              MOVE ZEROS TO SLD-BLO-RED-WS (1).                   00077970
077980*.................................................................00077980
077990     IF IND-BLOQUEIO-1 = 1                                        00077990
078000        IF SLD-BLO-RED-WS (1) GREATER ZEROS OR                    00078000
078010           SLD-BLO-RED-WS (2) GREATER ZEROS                       00078010
078020             MOVE SLD-BLO-RED-WS (1) TO VALOR-BLOQ-WS             00078020
078030             MOVE DATA-D07-RED-WS TO ATL-ULT-DT-RED-WS            00078030
078040             MOVE 1 TO SW-GERA-FICHA                              00078040
078050        ELSE                                                      00078050
078060             MOVE ZEROS TO VALOR-BLOQ-WS.                         00078060
078070                                                                  00078070
078080     ADD 1 TO IND-BLOQUEIO-1.                                     00078080
078090     ADD 1 TO IND-BLOQUEIO-2.                                     00078090
078100*.................................................................00078100
078110*.... BLOQUEIA O REMANEJAMENTO DA OCORRENCIA 21 SOMENTE     ......00078110
078120*.... PARA AS CONTAS NAO RECADASTRADAS                      ......00078120
078130*.................................................................00078130
078140     IF CALC-SMED-RED-WS EQUAL 0 AND                              00078140
078150        IND-BLOQUEIO-1 EQUAL 21 AND                               00078150
078160        SLD-BLO-RED-WS (21) = 0 AND                               00078160
078170        SLD-DEP-RED-WS GREATER THAN 0                             00078170
078180        MOVE SLD-DEP-RED-WS TO SLD-BLO-RED-WS (21)                00078180
078190        MOVE ZEROS TO SLD-BLO-RED-WS  (1)  SLD-BLO-RED-WS (2)     00078190
078200                      SLD-BLO-RED-WS  (3)  SLD-BLO-RED-WS (4)     00078200
078210                      SLD-BLO-RED-WS  (5)  SLD-BLO-RED-WS (6)     00078210
078220                      SLD-BLO-RED-WS  (7)  SLD-BLO-RED-WS (8)     00078220
078230                      SLD-BLO-RED-WS  (9)  SLD-BLO-RED-WS (10)    00078230
078240                      SLD-BLO-RED-WS (11)  SLD-BLO-RED-WS (12)    00078240
078250                      SLD-BLO-RED-WS (13)  SLD-BLO-RED-WS (14)    00078250
078260                      SLD-BLO-RED-WS (15)  SLD-BLO-RED-WS (16)    00078260
078270                      SLD-BLO-RED-WS (17)  SLD-BLO-RED-WS (18)    00078270
078280                      SLD-BLO-RED-WS (19)  SLD-BLO-RED-WS (20)    00078280
078290     ELSE                                                         00078290
078300        MOVE SLD-BLO-RED-WS (IND-BLOQUEIO-1)                      00078300
078310          TO SLD-BLO-RED-WS (IND-BLOQUEIO-2)                      00078310
078320        MOVE ZERO TO SLD-BLO-RED-WS (IND-BLOQUEIO-1)              00078320
078330        ADD SLD-BLO-RED-WS (IND-BLOQUEIO-2) TO DISPON-WS.         00078330
078340                                                                  00078340
078360 176-35-CONTROLA-REMANEJA-SMED.                                   00078360
078370                                                                  00078370
078380     MOVE SLD-DEP-RED-WS TO SLD-DEP-ANT-WS.                       00078380
078390     MOVE SLD-EMP-RED-WS TO SLD-EMP-ANT-WS.                       00078390
078400     IF INICIO-MES                                                00078400
078420         MOVE 0 TO EXTRATO-EXTRA-RED-WS                           00078420
078430                   NUM-INSUF-EXCESSO-RED-WS                       00078430
078440                   QDE-SAQUE-CARTAO-DO-MES-RED-WS                 00078440
078450                   QDE-SAQ-CARTAO-CTASAL-RED-WS                   00078450
078460                   QDE-CHQ-PROCES-RED-WS                          00078460
078470                   TARIFA-PROPORCIONAL-RED-WS                     00078470
078480         PERFORM 215A-35-ZERA-INDIC-SEMESTR                       00078480
078490         PERFORM 176A-35-ZERA-PERSON                              00078490
078500         PERFORM 335-35-REMANEJA-SMEDIO                           00078500
078510         IF MOV-NUM-RED-WS GREATER ZERO                           00078510
078520             PERFORM 330-35-ATUALIZA-FIM-MES.                     00078520
078550                                                                  00078550
078630 176A-35-ZERA-PERSON.                                             00078630
078640                                                                  00078640
078650     IF  CH-CONTA-WS EQUAL 88887                                  00078650
078660         MOVE ZEROS TO CH-PERSON-WS CH-COMUM-WS CH-ESPECIAL-WS    00078660
078670     ELSE                                                         00078670
078680         COMPUTE TALON-PEDIDOS-ACUM-RED-WS =                      00078680
078690                 (TALON-FORNECIDOS-RED-WS * -1) +                 00078690
078700                  TALON-PEDIDOS-ACUM-RED-WS                       00078700
078710         MOVE ZEROS TO TALON-FORNECIDOS-RED-WS                    00078710
078720*********** IPMF *******************************                  00078720
078730         COMPUTE CHEQUE-TB-PEDIDOS-RED-WS =                       00078730
078740                 (CHEQUE-TB-FORNECI-RED-WS * -1) +                00078740
078750                  CHEQUE-TB-PEDIDOS-RED-WS                        00078750
078760         MOVE ZEROS TO TALON-FORNECIDOS-RED-WS                    00078760
078770                       CHEQUE-TB-FORNECI-RED-WS.                  00078770
078780* NOTA RETIRAR O PONTO DE 'MOVE ZEROS TO TALON-FORNECIDOS-RED-WS',00078780
078790*      QUANDO ATIVAR OS COMANDOS EM COMENTARIO.                   00078790
078800************************************************                  00078800
078830                                                                  00078830
078920 180-35-NUM-DEVED-CREDORES.                                       00078920
078930*                                                                 00078930
078950*....OS COMANDOS INFRA CALCULAM   OS..............................00078950
078960*....NUMEROS CREDORES OU DEVEDORES, ..............................00078960
078970*....CONFORME O SALDO DA CONTA      ..............................00078970
078980                                                                  00078980
078990     MOVE ATL-ULT-MOV-RED-WS TO DATA-AUX-RED.                     00078990
079000                                                                  00079000
079010     IF MES-AUX = MES-D07-WS AND ANO-AUX = ANO-D07-WS             00079010
079020         COMPUTE DIFERENCA-DIAS-WS = (DIA-D07-WS - DIA-AUX)       00079020
079030     ELSE                                                         00079030
079040         COMPUTE DIFERENCA-DIAS-WS = (DIA-D07-WS - 1).            00079040

079060     COMPUTE SLD-DEV-NUM-WS = SLD-EMP-RED-WS + SLD-DEP-RED-WS -   00079060
079070                 (SLD-BLO-RED-WS (1) + SLD-BLO-RED-WS (2) +       00079070
079080                  SLD-BLO-RED-WS (3) + SLD-BLO-RED-WS (4) +       00079080
079090                  SLD-BLO-RED-WS (5) + SLD-BLO-RED-WS (6) +       00079090
079100                  SLD-BLO-RED-WS (7) + SLD-BLO-RED-WS (8) +       00079100
079110                  SLD-BLO-RED-WS (9) + SLD-BLO-RED-WS (10) +      00079110
079120                  SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +     00079120
079130                  SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +     00079130
079140                  SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +     00079140
079150                  SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +     00079150
079160                  SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +     00079160
079170                  SLD-BLO-RED-WS (21) + VALOR-BLOQ-WS).           00079170

079180     MOVE ZEROS TO VALOR-BLOQ-WS.                                 00079180
079190     IF EMP-LIM-RED-WS GREATER ZERO                               00079190
079200        COMPUTE NUM-SEM-BLOQ-RED-WS = NUM-SEM-BLOQ-RED-WS +       00079200
079210                (SLD-EMP-RED-WS * DIFERENCA-DIAS-WS)              00079210
079220        IF SLD-DEV-NUM-WS LESS ZERO                               00079220
079230           COMPUTE EMP-NUM-RED-WS = (SLD-DEV-NUM-WS *             00079230
079240                              DIFERENCA-DIAS-WS) + EMP-NUM-RED-WS 00079240
                 IF  OPER-ISENTA-IOF
                     MOVE DIA-AUX    TO  DIA-ULTMOV-IOF
                     MOVE MES-AUX    TO  MES-ULTMOV-IOF
                     CALL 'M0952000' USING ANO-AUX ANO-ULTMOV-IOF
                     MOVE DATA-D07-RED-INV  TO DT-MOV-ATUAL-IOF
                     MOVE DIFERENCA-DIAS-WS TO QT-DIAS-IOF
                     PERFORM 99-CALC-QT-DIAS-IOF
                     MOVE QT-DIAS-IOF  TO  DIFERENCA-DIAS-WS
                 END-IF
079250           COMPUTE EMP-NUM-IOF-RED-WS = (SLD-DEV-NUM-WS *         00079250
079260                          DIFERENCA-DIAS-WS) + EMP-NUM-IOF-RED-WS.00079260
079270                                                                  00079270
079280     MOVE DATA-D07-RED-WS TO ATL-ULT-MOV-RED-WS.                  00079280
079290                                                                  00079290
079300*.................................................................00079300
079310*  NAO NORMALIZA CONTA QDO A UNICA MOVIMENTACAO EH TAXA MANUTENCAO00079310
079320*.................................................................00079320
079330     IF (CH-HIST-D07 = 02) AND                                    00079330
079340        (CH-N-LOTE-D07 = 50) AND                                  00079340
079350        (TR-REF-D07 = 004828 OR 012106)                           00079350
079360        NEXT SENTENCE                                             00079360
079370     ELSE                                                         00079370
079380        MOVE ZERO TO ATL-DIAS-PARAL-RED-WS.                       00079380
079390*.................................................................00079390
079400                                                                  00079400
079410     MOVE ZERO TO SW-CALCULAR-NUMEROS                             00079410
079420                  SLD-DEV-NUM-WS.                                 00079420
079440*                                                                 00079440
079450 190-35-CANCELA-EMPRESTIMO.                                       00079450
079460*                                                                 00079460
079470     MOVE ZEROS TO SALDO-ATUAL-WS                                 00079470
079480     IF SLD-EMP-RED-WS LESS ZEROS                                 00079480
079490        MOVE SLD-EMP-RED-WS TO SALDO-ATUAL-WS                     00079490
079500     ELSE                                                         00079500
079510        MOVE SLD-DEP-RED-WS TO SALDO-ATUAL-WS                     00079510
           END-IF
079520                                                                  00079520
           IF TPMOV-D07 EQUAL 88
              PERFORM 190-35-CANCELA-EMPREST-AUTOM
           END-IF

079840*.................................................................00079840
079860     IF IOCS-DIARIOS-EXIGIVEIS-RED-WS EQUAL ZEROS AND             00079860
079870        JUROS-DIARIOS-WS EQUAL ZEROS AND                          00079870
079880        RAP-RED-WS EQUAL ZEROS                                    00079880
079890        IF SLD-EMP-RED-WS = ZERO                                  00079890
                 PERFORM 190-35-GERA-MOVTO-CANCEL-EMP
              ELSE
                 IF VLR-CRED-BAIXA-ATV-WS GREATER ZEROS
                    MOVE SLD-EMP-RED-WS TO SLD-DEP-RED-WS
                    MOVE ZEROS          TO SLD-EMP-RED-WS
                    PERFORM 190-35-GERA-MOVTO-CANCEL-EMP
080120           ELSE
080130              MOVE ZERO TO C-EMP-JUR-DEV-D10                      00080130
080140              MOVE 30 TO C-EMP-COD-MENS-D10                       00080140
                 END-IF
              END-IF
080150     ELSE                                                         00080150
080160        MOVE JUROS-DIARIOS-WS TO C-EMP-JUR-DEV-D10                00080160
080170        PERFORM 193-35-TESTA-COD-OCORR                            00080170
           END-IF
080180                                                                  00080180
080190     PERFORM 555-35-OCR-CAD-EMP.                                  00080190
080200                                                                  00080200
       190-35-GERA-MOVTO-CANCEL-EMP.

           MOVE SPACES                 TO REG-EXTRATO-D10
           INITIALIZE REG-EXTRATO-D10

           MOVE 1                      TO SW-CANCELOU-EMPRESTIMO
           MOVE 4                      TO EXT-COD-MENS-D10
                                          EXT-COD-MENS-WS
           MOVE 3                      TO TIPO-CAD-02DD
           MOVE CH-CONTA-WS            TO CONTA-CAD-02DD
           MOVE CH-DIGITO-WS           TO DIGITO-CAD-02DD
           MOVE SPACES                 TO NOME-CLI-CAD-02DD
                                          NOME-CLI2-CAD-02DD
           MOVE 999999                 TO DTCONTR-CHBNB-02DD
                                          DTVENC-CHBNB-02DD
           MOVE 9999999999999,99       TO LIMITE-CHBNB-02DD

           PERFORM 999-34-GRAVA-DISCO-TELEX
           PERFORM 191-190-CANCELAMENTO-ANTECIP

           MOVE ZEROS                  TO EMP-DATA-RED-WS
                                          EMP-VENC-RED-WS
                                          EMP-LIM-RED-WS
                                          EMP-TAXA-JUR-RED-WS
                                          JUROS-DIARIOS-WS
                                          DT-TARIF-RENOV-RED-WS
                                          EXC-VEZ-CONTRATO-RED-WS
                                          DIA-DEBITO-JUROS-RED-WS
                                          EMP-NUM-EXCED-FUNC-RED-WS
                                          EMP-NUM-RED-WS
                                          EMP-NUM-IOF-RED-WS

           MOVE CH-DATA-D07            TO EMP-DATA-ENC-RED-WS
           MOVE SPACES                 TO EMP-SEGURO-RED-WS.

       190-35-CANCELA-EMPREST-AUTOM.
079620                                                                  00079620
079630     IF JUROS-DIARIOS-WS EQUAL ZEROS                              00079630
079640        MOVE ZEROS TO EMP-NUM-RED-WS EMP-NUM-IOF-RED-WS           00079640
079650                      EMP-NUM-EXCED-FUNC-RED-WS.                  00079650
079660                                                                  00079660
079670     IF SLD-EMP-RED-WS = ZERO                                     00079670
079680        IF EMP-NUM-RED-WS = ZERO                                  00079680
079690            MOVE ZEROS TO EMP-NUM-IOF-RED-WS                      00079690
079700                          EMP-NUM-EXCED-FUNC-RED-WS.              00079700
079710                                                                  00079710
025020     MOVE ZEROS                         TO JUROS-DIARIOS-WS
025170                              IOCS-DIARIOS-EXIGIVEIS-RED-WS.
080230*                                                                 00080230
080240 191-190-CANCELAMENTO-ANTECIP.                                    00080240
080250                                                                  00080250
080260     IF DATA-D07-RED-INV LESS THAN DATA-VENCIM-INV-RED-WS         00080260
080270        MOVE 26 TO C-EMP-COD-MENS-D10                             00080270
080280     ELSE                                                         00080280
080290        MOVE 61 TO C-EMP-COD-MENS-D10.                            00080290
080550*                                                                 00080550
080560 193-35-TESTA-COD-OCORR.                                          00080560
080570                                                                  00080570
080580     IF (SLD-EMP-RED-WS NOT EQUAL ZEROS) AND                      00080580
080590        (JUROS-DIARIOS-WS NOT EQUAL ZEROS)                        00080590
080600        MOVE 31 TO C-EMP-COD-MENS-D10                             00080600
080610     ELSE                                                         00080610
080620      IF SLD-EMP-RED-WS NOT EQUAL ZEROS                           00080620
080630         MOVE 30 TO C-EMP-COD-MENS-D10                            00080630
080640      ELSE                                                        00080640
080650        IF (JUROS-DIARIOS-WS NOT EQUAL ZEROS) OR                  00080650
080660           (IOCS-DIARIOS-EXIGIVEIS-RED-WS NOT EQUAL ZEROS)        00080660
080660*           (EMP-NUM-IOF-RED-WS NOT EQUAL ZEROS)                  00080660
080670           MOVE 29 TO C-EMP-COD-MENS-D10                          00080670
080680        ELSE                                                      00080680
080690          IF RAP-RED-WS NOT EQUAL ZEROS                           00080690
080700             MOVE 71 TO C-EMP-COD-MENS-D10.                       00080700
080710                                                                  00080710
080720 195-35-CANCELA-CONTA-CORRENTE.                                   00080720
080730*                                                                 00080730
080740     COMPUTE NUM-TOTAL-FUNC-WS = EMP-NUM-RED-WS +                 00080740
080750                                 EMP-NUM-EXCED-FUNC-RED-WS.       00080750
080800     IF RAP-RED-WS NOT EQUAL ZEROS                                00080800
080810        MOVE 71 TO C-CC-COD-MENS-D10                              00080810
080820        PERFORM 545-35-OCR-CAD-CC                                 00080820
080830     ELSE                                                         00080830
080840      IF NUM-TOTAL-FUNC-WS NOT = ZEROS AND                        00080840
080850         SLD-EMP-RED-WS LESS ZEROS                                00080850
080860         MOVE 31 TO C-CC-COD-MENS-D10                             00080860
080870         PERFORM 545-35-OCR-CAD-CC                                00080870
080880      ELSE                                                        00080880
080890       IF SLD-EMP-RED-WS NOT = ZERO AND NUM-TOTAL-FUNC-WS = ZERO  00080890
080900          MOVE 30 TO C-CC-COD-MENS-D10                            00080900
080910          PERFORM 545-35-OCR-CAD-CC                               00080910
080920       ELSE                                                       00080920
080930        IF  NUM-TOTAL-FUNC-WS NOT = ZERO AND                      00080930
080940            SLD-EMP-RED-WS = ZEROS                                00080940
080950            MOVE 29 TO C-CC-COD-MENS-D10                          00080950
080960            PERFORM 545-35-OCR-CAD-CC                             00080960
080970        ELSE                                                      00080970
080980         IF  SLD-DEP-RED-WS NOT EQUAL ZEROS                       00080980
080990             MOVE 38 TO C-CC-COD-MENS-D10                         00080990
081000             PERFORM 545-35-OCR-CAD-CC                            00081000
081010         ELSE                                                     00081010
081020          IF SLD-DEP-RED-WS = ZEROS AND                           00081020
081030             SLD-EMP-RED-WS = ZEROS                               00081030
081040             MOVE ZEROS TO SW-PCORR-WS SW-TEM-APLIC               00081040
081050             MOVE CH-AG-WS TO AGENCIA-APLIC                       00081050
081060             MOVE CH-CONTA-WS TO CONTA-APLIC                      00081060
081070             MOVE CH-DIGITO-WS TO DIGITO-APLIC                    00081070
081080             PERFORM 199-195-ACESSA-APLICACOES                    00081080
081090             IF TEM-POUP-CORR OR TEM-APLIC                        00081090
081100                MOVE 67 TO C-CC-COD-MENS-D10                      00081100
081110                PERFORM 545-35-OCR-CAD-CC                         00081110
081120             ELSE                                                 00081120
                    MOVE SPACES TO REG-EXTRATO-D10
                    INITIALIZE REG-EXTRATO-D10
081130              IF TPCONTAB-RED-WS = 20 OR 22 OR 27                 00081130
081140                 PERFORM 200-195-ACESSA-VINC                      00081140
081150                 MOVE ZEROS TO SW-TEM-APLIC                       00081150
081160                 PERFORM 199-195-ACESSA-APLICACOES                00081160
081170                 IF TEM-APLIC                                     00081170
081180                  MOVE 67 TO C-CC-COD-MENS-D10                    00081180
081190                  PERFORM 545-35-OCR-CAD-CC                       00081190
081200                 ELSE                                             00081200
081210                  MOVE 26 TO C-CC-COD-MENS-D10                    00081210
081220                  MOVE ZERO TO SW-GERA-FICHA                      00081220
081230                               MOVIMENTACAO-RED-WS                00081230
081240                  PERFORM 545-35-OCR-CAD-CC                       00081240
081250*                                                                 00081250
081300                  MOVE ZEROS TO CD-CLI-COTIT-RED-WS               00081300
081310                  MOVE SPACE TO IND-ALT-COTIT-RED-WS              00081310
081330*                                                                 00081330
081340                  PERFORM 124-124-GRAVA-D0480701                  00081340
                        MOVE SPACES TO REG-EXTRATO-D10
                        INITIALIZE REG-EXTRATO-D10
081350                  MOVE 3 TO EXT-COD-MENS-D10                      00081350
081360                                        EXT-COD-MENS-WS           00081360
081370                  PERFORM 510-35-OCR-EXTRATO                      00081370
081380                  PERFORM 200-35-VERIFICA-SALDO-ZERADO            00081380
081390                  ADD 1 TO EXCLUSAO-WS                            00081390
081400                  MOVE 1 TO SW-EXCLUI-CONTA                       00081400
081410                  PERFORM 610-35-OCR-FICHA-RECOLHER               00081410
081420                  MOVE CH-AG-WS      TO COD-AG-D83-WS             00081420
081430                  MOVE CH-CONTA-WS   TO CONTA-D83-WS              00081430
081440                  MOVE CH-DIGITO-WS  TO DIGITO-D83-WS             00081440
081450                  MOVE ZEROS TO ENDERECO-D83-WS                   00081450
081460                                FONE-D83-WS CGC-CPF-D83-WS        00081460
081470                                BARRA-CGC-D83-WS                  00081470
081480                                CONTR-CGC-CPF-D83-WS              00081480
081490                                TIPO-CONTABIL-D83-WS              00081490
081500                                INS-NJUR-REAL-RED-WS              00081500
081510                                INS-NIOF-REAL-RED-WS              00081510
081520                                INS-NJUR-DECOR-RED-WS             00081520
081530                                INS-NIOF-DECOR-RED-WS             00081530
081550                                ACUM-BASE-IOF-ADIC-RED-WS         00081550
081560                  PERFORM 196-195-ATUALIZA-CANCELADAS             00081560
081570              ELSE                                                00081570
081580                  MOVE 26 TO C-CC-COD-MENS-D10                    00081580
081590                  MOVE ZERO TO SW-GERA-FICHA                      00081590
081600                               MOVIMENTACAO-RED-WS                00081600
081610                  PERFORM 545-35-OCR-CAD-CC                       00081610
081620*                                                                 00081620
081670                  MOVE ZEROS TO CD-CLI-COTIT-RED-WS               00081670
081680                  MOVE SPACE TO IND-ALT-COTIT-RED-WS              00081680
081700*                                                                 00081700
081710                  PERFORM 124-124-GRAVA-D0480701                  00081710
                        MOVE SPACES TO REG-EXTRATO-D10
                        INITIALIZE REG-EXTRATO-D10
081720                  MOVE 3 TO EXT-COD-MENS-D10                      00081720
081730                                        EXT-COD-MENS-WS           00081730
081740                  PERFORM 510-35-OCR-EXTRATO                      00081740
081750                  PERFORM 200-35-VERIFICA-SALDO-ZERADO            00081750
081760                  ADD 1 TO EXCLUSAO-WS                            00081760
081770                  MOVE 1 TO SW-EXCLUI-CONTA                       00081770
081780                  PERFORM 610-35-OCR-FICHA-RECOLHER               00081780
081790                  MOVE CH-AG-WS      TO COD-AG-D83-WS             00081790
081800                  MOVE CH-CONTA-WS   TO CONTA-D83-WS              00081800
081810                  MOVE CH-DIGITO-WS  TO DIGITO-D83-WS             00081810
081820                  MOVE ZEROS TO ENDERECO-D83-WS                   00081820
081830                                FONE-D83-WS CGC-CPF-D83-WS        00081830
081840                                BARRA-CGC-D83-WS                  00081840
081850                                CONTR-CGC-CPF-D83-WS              00081850
081860                                TIPO-CONTABIL-D83-WS              00081860
081870                                INS-NJUR-REAL-RED-WS              00081870
081880                                INS-NIOF-REAL-RED-WS              00081880
081890                                INS-NJUR-DECOR-RED-WS             00081890
081900                                INS-NIOF-DECOR-RED-WS             00081900
081920                                ACUM-BASE-IOF-ADIC-RED-WS         00081920
081930                  PERFORM 196-195-ATUALIZA-CANCELADAS.            00081930
081970                                                                  00081970
081980     IF SW-EXCLUI-CONTA = 1                                       00081980
081990        PERFORM SELECIONA-T048NMCT.                               00081990
082000*                                                                 00082000
082010 196-195-ATUALIZA-CANCELADAS.                                     00082010
082020*                                                                 00082020
082030     MOVE CH-AG-WS      TO COD-AGN-CAN.                           00082030
082040     MOVE CH-CONTA-WS   TO CONTA-CAN.                             00082040
082050     MOVE CH-DIGITO-WS  TO DIG-CAN.                               00082050
082060     READ D048CAN.                                                00082060
082070     IF STATUS-CAN-WS EQUAL '23'                                  00082070
082080        PERFORM 197-196-INCLUSAO-CANCELADA                        00082080
082090     ELSE                                                         00082090
082100     IF STATUS-CAN-WS EQUAL '00'                                  00082100
082110        PERFORM 198-196-ALTERACAO-CANCELADA                       00082110
082120     ELSE                                                         00082120
082130        MOVE STATUS-CAN-WS TO FILE-STATUS-WS                      00082130
082140        MOVE 'P04808 ERRO GRAVACAO D048CAN **'                    00082140
082150             TO MENSAGEM-ERRO-WS                                  00082150
082160        PERFORM 999-99-ROT-ERRO.                                  00082160
082170*                                                                 00082170
082180 197-196-INCLUSAO-CANCELADA.                                      00082180
082190*                                                                 00082190
082200     MOVE TPCONTAB-RED-WS    TO  TIPO-CONTABIL-CAN.               00082200
082210     MOVE TP-PESSOA-RED-WS   TO  TIPO-PESSOA-CAN.                 00082210
082220     MOVE DATA-MOV-WS        TO  DATA-CANCEL-CAN.                 00082220
           MOVE OPCAO-PC-RED-WS    TO  ID-POUP-CORR-CAN.
082230     WRITE REG-CAN.                                               00082230
082240     IF STATUS-CAN-WS NOT EQUAL '00'                              00082240
082250        MOVE STATUS-CAN-WS TO FILE-STATUS-WS                      00082250
082260        MOVE 'P04808 ERRO GRAVACAO D048CAN **'                    00082260
082270             TO MENSAGEM-ERRO-WS                                  00082270
082280        PERFORM 999-99-ROT-ERRO.                                  00082280
082290*                                                                 00082290
082300 198-196-ALTERACAO-CANCELADA.                                     00082300
082310*                                                                 00082310
082320     IF TPCONTAB-RED-WS EQUAL 84                                  00082320
082330        NEXT SENTENCE                                             00082330
082340     ELSE                                                         00082340
082350      MOVE TPCONTAB-RED-WS   TO  TIPO-CONTABIL-CAN                00082350
082360      MOVE TP-PESSOA-RED-WS  TO  TIPO-PESSOA-CAN                  00082360
082370      MOVE DATA-MOV-WS       TO  DATA-CANCEL-CAN                  00082370
            MOVE OPCAO-PC-RED-WS   TO  ID-POUP-CORR-CAN
082380      REWRITE REG-CAN                                             00082380
082390      IF STATUS-CAN-WS NOT EQUAL '00'                             00082390
082400         MOVE STATUS-CAN-WS TO FILE-STATUS-WS                     00082400
082410         MOVE 'P04808 ERRO GRAVACAO D048CAN **'                   00082410
082420             TO MENSAGEM-ERRO-WS                                  00082420
082430         PERFORM 999-99-ROT-ERRO.                                 00082430
082440*                                                                 00082440
082450 199-195-ACESSA-APLICACOES.                                       00082450
082460                                                                  00082460
082470     MOVE AGENCIA-APLIC TO AGENCIA-D159.                          00082470
082480     MOVE CONTA-APLIC   TO CONTA-D159.                            00082480
082490     MOVE DIGITO-APLIC  TO DIGITO-D159.                           00082490
082500     READ D15901.                                                 00082500
082510     IF STATUS-D15901 EQUAL '00'                                  00082510
082520        IF SALDO-D159 GREATER THAN ZEROS                          00082520
082530           MOVE 1 TO SW-PCORR-WS                                  00082530
082540        ELSE                                                      00082540
082550           NEXT SENTENCE                                          00082550
082560     ELSE                                                         00082560
082570      IF STATUS-D15901 EQUAL '23'                                 00082570
082580         NEXT SENTENCE                                            00082580
082590      ELSE                                                        00082590
082600         MOVE STATUS-D15901 TO FILE-STATUS-WS                     00082600
082610         MOVE 'P04808 ERRO GRAVACAO D15901 **'                    00082610
082620             TO MENSAGEM-ERRO-WS                                  00082620
082630         PERFORM 999-99-ROT-ERRO.                                 00082630
082640                                                                  00082640
082650     MOVE ZEROS TO CHAVE-D30.                                     00082650
082660     MOVE AGENCIA-APLIC TO AGENCIA-D30.                           00082660
082670     MOVE CONTA-APLIC   TO CLIENTE-D30.                           00082670
082680     START D27030 KEY EQUAL CH-PARCIAL-D30.                       00082680
082690     IF STATUS-D27030-WS NOT EQUAL '00' AND '23'                  00082690
082700        MOVE STATUS-D27030-WS TO FILE-STATUS-WS                   00082700
082710        MOVE 'P04808 ERRO GRAVACAO D27030 **'                     00082710
082720                                     TO MENSAGEM-ERRO-WS          00082720
082730        PERFORM 999-99-ROT-ERRO                                   00082730
082740     ELSE                                                         00082740
082750     IF STATUS-D27030-WS EQUAL '00'                               00082750
082760        MOVE ZEROS TO SW-FIM-FUNDOS                               00082760
082770        READ D27030 NEXT RECORD                                   00082770
082780        PERFORM 199-196-LEH-FUNDOS UNTIL TEM-APLIC OR             00082780
082790                FIM-FUNDOS OR CLIENTE-D30 NOT = CH-CONTA-WS OR    00082790
082800                AGENCIA-D30 NOT = CH-AG-WS.                       00082800
082810                                                                  00082810
082820     IF NOT TEM-APLIC                                             00082820
082830        MOVE ZEROS          TO CHAVE-D42                          00082830
082840        MOVE AGENCIA-APLIC  TO COD-AG-D42                         00082840
082850        MOVE CONTA-APLIC    TO NUM-CTACORR-D42                    00082850
082860        START D86042 KEY EQUAL CH-PARCIAL-D42                     00082860
082870        IF FS-D42  NOT EQUAL '00' AND '23'                        00082870
082880           MOVE FS-D42 TO FILE-STATUS-WS                          00082880
082890           MOVE 'ERRO START D86042' TO MENSAGEM-ERRO-WS           00082890
082900           PERFORM 999-99-ROT-ERRO                                00082900
082910        ELSE                                                      00082910
082920        IF FS-D42 = '00'                                          00082920
082930           READ D86042 NEXT RECORD                                00082930
082940           IF FS-D42 NOT = '00' AND '10' AND '23'                 00082940
082950              MOVE FS-D42 TO FILE-STATUS-WS                       00082950
082960              MOVE 'ERRO LEITURA D86042' TO MENSAGEM-ERRO-WS      00082960
082970              PERFORM 999-99-ROT-ERRO                             00082970
082980           ELSE                                                   00082980
082990           IF FS-D42 = '00'                                       00082990
083000              IF VLR-BRUTO-D42 > ZEROS                            00083000
083010                 MOVE   1     TO SW-TEM-APLIC.                    00083010
083230*                                                                 00083230
083240 199-196-LEH-FUNDOS.                                              00083240
083250                                                                  00083250
083260     IF     STATUS-D27030-WS NOT = '00' AND '10' AND '23'         00083260
083270            PERFORM 999-99-ROT-ERRO                               00083270
083280     ELSE                                                         00083280
083290           IF STATUS-D27030-WS = '10' OR '23'                     00083290
083300              MOVE 1 TO SW-FIM-FUNDOS                             00083300
083310           ELSE                                                   00083310
083320              IF STATUS-D27030-WS  = '00'                         00083320
083330                 IF SALDO-D30  > ZEROS                            00083330
083340                  MOVE DIA-RODADA-WS TO DIA-FUNDO-WS              00083340
083350                  MOVE MES-RODADA-WS TO MES-FUNDO-WS              00083350
083360                  CALL 'M0952000' USING ANO-RODADA-WS ANO-FUNDO-WS00083360
083380                     MOVE 1 TO SW-TEM-APLIC.                      00083380
083390                                                                  00083390
083400     READ   D27030 NEXT.                                          00083400
083410                                                                  00083410
083420 200-195-ACESSA-VINC.                                             00083420
083430     MOVE CH-AG-WS     TO CD-AG      OF DCLV134CCNI.              00083430
083440     MOVE CH-CONTA-WS  TO NR-CTA-COR OF DCLV134CCNI.              00083440
083450     EXEC SQL                                                     00083450
083460          SELECT CD_AG_VNC,                                       00083460
083470                 NR_CTA_VNC,                                      00083470
083480                 NR_DV_VNC                                        00083480
083490          INTO   :DCLV134CCNI.CD-AG-VNC,                          00083490
083500                 :DCLV134CCNI.NR-CTA-VNC,                         00083500
083510                 :DCLV134CCNI.NR-DV-VNC                           00083510
083520          FROM   V134CCNI                                         00083520
083530          WHERE  ID_ST_CTA  IN ('A','C')                          00083530
083540          AND    CD_AG      = :DCLV134CCNI.CD-AG                  00083540
083550          AND    NR_CTA_COR = :DCLV134CCNI.NR-CTA-COR             00083550
083560     END-EXEC.                                                    00083560
083570     IF SQLCODE = ZEROS                                           00083570
083580        MOVE CD-AG-VNC  OF DCLV134CCNI TO AGENCIA-APLIC           00083580
083590        MOVE NR-CTA-VNC OF DCLV134CCNI TO CONTA-APLIC             00083590
083600        MOVE NR-DV-VNC  OF DCLV134CCNI TO DIGITO-APLIC            00083600
083610     ELSE                                                         00083610
083620     IF SQLCODE = NOTFOUND                                        00083620
083630        MOVE ZEROS TO AGENCIA-APLIC CONTA-APLIC DIGITO-APLIC      00083630
083640     ELSE                                                         00083640
083650        MOVE '134CCNI'   TO VISAO-WS                              00083650
083660        MOVE '200-195-ACESSA-VINC'  TO LOCAL-WS                   00083660
083670        MOVE 'SELECT'    TO TIPO-ACESSO-WS                        00083670
083680        DISPLAY '********-------------------------*******'        00083680
083690        DISPLAY 'PROGRAMA SUSPENSO - ERRO ACESSO V134CCNI'        00083690
083700        DISPLAY 'AGENCIA........ '  CH-AG-WS                      00083700
083710        DISPLAY 'CONTA.......... '  CH-CONTA-WS '-' CH-DIGITO-WS  00083710
083720        DISPLAY '********-------------------------*******'        00083720
083730        PERFORM 99-ERRO-DB2.                                      00083730
083740                                                                  00083740
083750 200-35-VERIFICA-SALDO-ZERADO.                                    00083750
083760*                                                                 00083760
083770     IF SALDO-ZERADO                                              00083770
083780        MOVE 0 TO SW-SALDO-ZERADO                                 00083780
083790     ELSE                                                         00083790
083800        PERFORM 200-35-GERA-EXTRATO-F10.                          00083800
083810                                                                  00083810
083820     IF TP-PESSOA-RED-WS = 'G'                                    00083820
083830        MOVE SPACES TO REG-D10S                                   00083830
083840        MOVE CH-CODAG-D07 TO AGN-D10S                             00083840
083850        MOVE CONTA-D07    TO CTA-D10S                             00083850
083860        MOVE DV-CONTA-D07 TO DIG-D10S                             00083860
083870        MOVE CH-DATA-D07  TO DT-OCOR-D10S                         00083870
083880        MOVE DT-BLOQ-DESBLOQ-RED-WS TO DT-BLOQ-D10S               00083880
083890        MOVE SLD-DEP-RED-WS TO SALDO-D10S                         00083890
083900        MOVE 02 TO COD-OCOR-D10S                                  00083900
083910        WRITE REG-D10S                                            00083910
083920           INVALID KEY                                            00083920
083930             DISPLAY '**P04808-CANCEL.AREA INSUF.P/D04810S**'     00083930
083940             MOVE COD-RETORNO-WS (3) TO RETURN-CODE               00083940
083950             DISPLAY 'RETURN CODE EH...' COD-RETORNO-WS (3)       00083950
083960             DISPLAY 'MENSAGEM RETORNO EH...' MEN-RETORNO-WS(3)   00083960
083970             GOBACK.                                              00083970
083980*                                                                 00083980
083990 200-35-GERA-EXTRATO-F10.                                         00083990
084000*                                                                 00084000
084010     MOVE CH-AG-WS             TO EXT-AG-WS.                      00084010
084020     MOVE CH-NUM-CONTA-WS      TO EXT-NUM-CONTA-WS.               00084020
084030     MOVE 4                    TO EXT-TPREG-WS.                   00084030
084040     MOVE TPCONTAB-RED-WS      TO EXT-TPCONTAB-WS.                00084040
084050     MOVE EMP-VENC-RED-WS      TO EXT-EMP-VENC-WS.                00084050
084060     MOVE EMP-LIM-RED-WS       TO EXT-EMP-LIM-WS.                 00084060
084070     MOVE DATA-D07-RED-WS TO EXT-DATA-RED-WS.                     00084070
084080     MOVE EXTRATO-RED-WS       TO EXT-EXTRATO-WS.                 00084080
084090     MOVE EXTRATO-ESPECIAL-RED-WS TO EXT-EXTRATO-ESPECIAL-WS.     00084090
084100                                                                  00084100
250412     MOVE ZEROS                TO EXT-MOVIMENTOS-WS.
084110     MOVE MOVIMENTOS-RED-WS    TO EXT-MOVIMENTOS-WS.              00084110
084120     MOVE ZEROS                TO IND1 MOV-NUM-RED-WS.            00084120
084130                                                                  00084130
           IF ((EXT-AG-WS   NOT = AGE-EXT-WS)
           OR (EXT-CONTA-WS NOT = CONTA-EXT-WS))
               MOVE EXT-AG-WS        TO AGE-EXT-WS
084150         MOVE EXT-CONTA-WS     TO CONTA-EXT-WS                    00084150
084160         MOVE ZEROS            TO SEQ-EXT-WS.                     00084160
084170                                                                  00084170
084190     ADD 1 TO SEQ-EXT-WS.                                         00084190
084200                                                                  00084200
084210     MOVE SEQ-EXT-WS TO EXT-SEQ-WS.                               00084210
084220                                                                  00084220
084230     MOVE ZEROS TO SOMA-BLOQ-WS.                                  00084230
084240     ADD SLD-BLO-RED-WS (1)                                       00084240
084250         SLD-BLO-RED-WS (2)                                       00084250
084260         SLD-BLO-RED-WS (3)                                       00084260
084270         SLD-BLO-RED-WS (4)                                       00084270
084280         SLD-BLO-RED-WS (5)                                       00084280
084290         SLD-BLO-RED-WS (6)                                       00084290
084300         SLD-BLO-RED-WS (7)                                       00084300
084310         SLD-BLO-RED-WS (8)                                       00084310
084320         SLD-BLO-RED-WS (9)                                       00084320
084330         SLD-BLO-RED-WS (10)                                      00084330
084340         SLD-BLO-RED-WS (11)                                      00084340
084350         SLD-BLO-RED-WS (12)                                      00084350
084360         SLD-BLO-RED-WS (13)                                      00084360
084370         SLD-BLO-RED-WS (14)                                      00084370
084380         SLD-BLO-RED-WS (15)                                      00084380
084390         SLD-BLO-RED-WS (16)                                      00084390
084400         SLD-BLO-RED-WS (17)                                      00084400
084410         SLD-BLO-RED-WS (18)                                      00084410
084420         SLD-BLO-RED-WS (19)                                      00084420
084430         SLD-BLO-RED-WS (20)                                      00084430
084440         SLD-BLO-RED-WS (21) TO SOMA-BLOQ-WS.                     00084440
084450     MOVE SOMA-BLOQ-WS TO EXT-VR-BLOQ-WS.                         00084450
084460     MOVE ZEROS TO SOMA-BLOQ-WS.                                  00084460
084470                                                                  00084470
084480     IF EMP-LIM-RED-WS GREATER ZERO AND SLD-EMP-RED-WS LESS ZERO  00084480
084490         MOVE SLD-EMP-RED-WS TO EXT-SLD-RED-WS                    00084490
084500         MOVE 'E' TO EXT-TPSLD-RED-WS                             00084500
084510     ELSE                                                         00084510
084520         MOVE SLD-DEP-RED-WS TO EXT-SLD-RED-WS                    00084520
084530         MOVE 'D' TO EXT-TPSLD-RED-WS.                            00084530
084540                                                                  00084540
250412     MOVE ZERO TO IND1.
084550     PERFORM 999-30-ZERA-MOV-F10 17 TIMES.                        00084550
084560     MOVE ZEROS TO MOV-NUM-RED-WS.                                00084560
084570
084580     MOVE SEQ-D04-WS     TO CH-EXT-SEQ-WS.
084590     MOVE REG-EXTRATO-WS TO REG-EXTRATO-ARQ-UPDT
084600                            EXTRA-EXTRA-WS.
/GCVN/     WRITE REG-EXTRATO-ARQ-UPDT.
084620     IF  STATUS-ARQ-UPDT-WS NOT EQUAL '00'
084630         MOVE STATUS-ARQ-UPDT-WS TO FILE-STATUS-WS
084640         MOVE 'P04808 ERRO DE GRAVACAO NO ArqExtMensal '
084650                TO MENSAGEM-ERRO-WS
084660         PERFORM 999-99-ROT-ERRO.
084670
           INITIALIZE REG-EXTRATO-D11.
084680     ADD 1 TO CONT-REG-EXTRATO.
084690     MOVE REG-EXTRATO-WS TO REG-EXTRATO-D11.                      00084690
084700     WRITE REG-EXTRATO-D11                                        00084700
084710        INVALID KEY                                               00084710
084720        DISPLAY 'ERRO DE GRAVACAO DO D04811'                      00084720
084730        MOVE COD-RETORNO-WS (3) TO RETURN-CODE                    00084730
084740        DISPLAY 'RETURN CODE EH .. ' COD-RETORNO-WS (3)           00084740
084750        DISPLAY ' MENSAGEM DE RETORNO EH ..' MEN-RETORNO-WS (3)   00084750
084760        GOBACK.                                                   00084760
084800*                                                                 00084800
084810 210-35-SOLICITA-EXTRATO.                                         00084810
084820*                                                                 00084820
           MOVE SPACES TO REG-EXTRATO-D10.
           INITIALIZE REG-EXTRATO-D10.
084830     ADD 1 TO EXTRATO-EXTRA-RED-WS.                               00084830
084840     MOVE 5 TO EXT-COD-MENS-D10.                                  00084840
084860     IF MOV-NUM-RED-WS LESS 11 AND                                00084860
084870        EXTRA-CONTA-WS EQUAL CH-CONTA-WS                          00084870
084880        PERFORM 512-35-OCR-EXTRA-EXTRA                            00084880
              MOVE SPACES TO REG-EXTRATO-D10
              INITIALIZE REG-EXTRATO-D10
084890        MOVE 5 TO EXT-COD-MENS-D10.                               00084890
084910     PERFORM 510-35-OCR-EXTRATO.                                  00084910
084920*                                                                 00084920
084930 212-35-CHEQUE-PERSONALIZADO.                                     00084930
084940                                                                  00084940
085010     IF TPCONTAB-RED-WS = 84 OR 44 OR 21 OR 23 OR 24 OR 43 OR     00085010
085020                          71 OR 72 OR 73 OR 74 OR 75 OR 77        00085020
085030        MOVE 2                   TO PER-ORIGEM-COMANDO-D10        00085030
085040        MOVE 0                   TO PER-NATUREZA-COMANDO-D10      00085040
085050        MOVE ES-QT-CH-D07        TO PER-QTDE-D10                  00085050
085060        MOVE 52                  TO PER-COD-MENS-D10              00085060
085070        PERFORM 548-35-OCR-CH-PERSON                              00085070
085080     ELSE                                                         00085080
085090*    IF (TP-PESSOA-RED-WS EQUAL 'V' OR 'G' OR '<') OR             00085090
085100*       (FORNECER-TALAO-WS = 1) OR CTA-EMPRESARIAL OR             00085100
100112*       (TPCONTAB-RED-WS = 30 OR 31 OR 33)
           IF (TP-PESSOA-RED-WS EQUAL 'V' OR 'G' OR '<' OR '>' OR '#')
           OR (FORNECER-TALAO-WS = 1)
           OR (CTA-EMPRESARIAL AND NOT PESSOA-MPE)
           OR (TPCONTAB-RED-WS = 30 OR 31 OR 33)
085110        MOVE 2                   TO PER-ORIGEM-COMANDO-D10        00085110
085120        MOVE 0                   TO PER-NATUREZA-COMANDO-D10      00085120
085130        MOVE ES-QT-CH-D07        TO PER-QTDE-D10                  00085130
085140        MOVE 66                  TO PER-COD-MENS-D10              00085140
085150        PERFORM 548-35-OCR-CH-PERSON                              00085150
085160        MOVE 9                   TO PER-ORIGEM-COMANDO-D10        00085160
085170        MOVE 0                   TO PER-NATUREZA-COMANDO-D10      00085170
085180        MOVE ZEROS               TO PER-QTDE-D10                  00085180
085190        MOVE 66                  TO PER-COD-MENS-D10              00085190
085200        PERFORM 548-35-OCR-CH-PERSON                              00085200
085210        MOVE ZEROS               TO SW-HOUVE-OCORR-14             00085210
085220     ELSE                                                         00085220
085230     IF CPF-CGC-RED-WS = ZEROS                                    00085230
085240        MOVE 2                   TO PER-ORIGEM-COMANDO-D10        00085240
085250        MOVE 0                   TO PER-NATUREZA-COMANDO-D10      00085250
085260        MOVE ES-QT-CH-D07        TO PER-QTDE-D10                  00085260
085270        MOVE 15                  TO PER-COD-MENS-D10              00085270
085280        PERFORM 548-35-OCR-CH-PERSON                              00085280
085290     ELSE                                                         00085290
085370     IF CALC-SMED-RED-WS EQUAL ZEROS                              00085370
085380        MOVE 2                   TO PER-ORIGEM-COMANDO-D10        00085380
085390        MOVE 0                   TO PER-NATUREZA-COMANDO-D10      00085390
085400        MOVE ES-QT-CH-D07        TO PER-QTDE-D10                  00085400
085410        MOVE 58                  TO PER-COD-MENS-D10              00085410
085420        PERFORM 548-35-OCR-CH-PERSON                              00085420
085430     ELSE                                                         00085430
085440     IF DATA-IMPLANTA-RED-WS = ZEROS                              00085440
085450        MOVE 2                   TO PER-ORIGEM-COMANDO-D10        00085450
085460        MOVE 0                   TO PER-NATUREZA-COMANDO-D10      00085460
085470        MOVE ES-QT-CH-D07        TO PER-QTDE-D10                  00085470
085480        MOVE 65                  TO PER-COD-MENS-D10              00085480
085490        PERFORM 548-35-OCR-CH-PERSON                              00085490
085500        MOVE 9                   TO PER-ORIGEM-COMANDO-D10        00085500
085510        MOVE 0                   TO PER-NATUREZA-COMANDO-D10      00085510
085520        MOVE ZEROS               TO PER-QTDE-D10                  00085520
085530        MOVE 65                  TO PER-COD-MENS-D10              00085530
085540        PERFORM 548-35-OCR-CH-PERSON                              00085540
085550        MOVE ZEROS               TO SW-HOUVE-OCORR-14             00085550
085560     ELSE                                                         00085560
085570        MOVE ZEROS TO SW-SICAD                                    00085570
085580        PERFORM 999-96-ACESSA-SICAD                               00085580
085590        IF SICAD-NOK                                              00085590
085680           MOVE 2                TO PER-ORIGEM-COMANDO-D10        00085680
085690           MOVE 0                TO PER-NATUREZA-COMANDO-D10      00085690
085700           MOVE ES-QT-CH-D07     TO PER-QTDE-D10                  00085700
085710           MOVE 64               TO PER-COD-MENS-D10              00085710
085720           PERFORM 548-35-OCR-CH-PERSON                           00085720
085730           MOVE 9                TO PER-ORIGEM-COMANDO-D10        00085730
085740           MOVE 0                TO PER-NATUREZA-COMANDO-D10      00085740
085750           MOVE ZEROS            TO PER-QTDE-D10                  00085750
085760           MOVE 64               TO PER-COD-MENS-D10              00085760
085770           PERFORM 548-35-OCR-CH-PERSON                           00085770
085780           MOVE ZEROS TO SW-HOUVE-OCORR-14                        00085780
085790        ELSE                                                      00085790
085800           IF (FORMULARIO-CONTINUO AND                            00085800
085810               ES-QT-CH-D07 GREATER THAN 9)                       00085810
085820               MOVE 2            TO PER-ORIGEM-COMANDO-D10        00085820
085830               MOVE 0            TO PER-NATUREZA-COMANDO-D10      00085830
085840               MOVE ES-QT-CH-D07 TO PER-QTDE-D10                  00085840
085850               MOVE 53           TO PER-COD-MENS-D10              00085850
085860               PERFORM 548-35-OCR-CH-PERSON                       00085860
085870               MOVE 9            TO PER-ORIGEM-COMANDO-D10        00085870
085880               MOVE 0            TO PER-NATUREZA-COMANDO-D10      00085880
085890               MOVE ZEROS        TO PER-QTDE-D10                  00085890
085900               MOVE 53           TO PER-COD-MENS-D10              00085900
085910               PERFORM 548-35-OCR-CH-PERSON                       00085910
085920               MOVE ZEROS        TO SW-HOUVE-OCORR-14             00085920
085930           ELSE                                                   00085930
085940               MOVE 2            TO PER-ORIGEM-COMANDO-D10        00085940
085950               MOVE 16           TO PER-COD-MENS-D10              00085950
085960               PERFORM 213-35-VERIFICA-SLD-MEDIO                  00085960
085970               PERFORM 212A-35-TESTA-NATUREZA-COMANDO             00085970
085980               MOVE ES-QT-CH-D07 TO PER-QTDE-D10                  00085980
085990               PERFORM 548-35-OCR-CH-PERSON.                      00085990
086000                                                                  00086000
086010 212A-35-TESTA-NATUREZA-COMANDO.                                  00086010
086020                                                                  00086020
086030     IF ES-INDICADOR-CH-D07 = 1                                   00086030
086040        MOVE ZEROS TO REDUCAO-WS                                  00086040
086050        PERFORM 212B-35-PEDIDO-REDUCAO                            00086050
086060     ELSE                                                         00086060
086070********** IPMF **********************                            00086070
086080        IF ES-INDICADOR-CH-D07 = 2                                00086080
086090           MOVE 1 TO PER-NATUREZA-COMANDO-D10                     00086090
086100                                 SW-CHEQUE-TB                     00086100
086110           COMPUTE ACUM-PEDIDOS-CHEQUE-TB-WS =                    00086110
086120                   ACUM-PEDIDOS-CHEQUE-TB-WS +                    00086120
086130                   ES-QT-CH-D07                                   00086130
086140        ELSE                                                      00086140
086150           IF ES-INDICADOR-CH-D07 = 8                             00086150
086160              MOVE 1 TO SW-CHEQUE-TB                              00086160
086170              MOVE ES-QT-CH-D07 TO ES-QT-CH-WS                    00086170
086180              MOVE 9 TO PER-NATUREZA-COMANDO-D10                  00086180
086190              COMPUTE ACUM-PEDIDOS-CHEQUE-TB-WS =                 00086190
086200                      ACUM-PEDIDOS-CHEQUE-TB-WS -                 00086200
086210                      ES-QT-CH-WS                                 00086210
086220           ELSE                                                   00086220
086230**************************************                            00086230
086240              IF ES-INDICADOR-CH-D07 = 9                          00086240
086250                 MOVE 1 TO SW-CHEQUE-NORMAL                       00086250
086260                 MOVE ES-QT-CH-D07 TO ES-QT-CH-WS                 00086260
086270                 MOVE 9 TO PER-NATUREZA-COMANDO-D10               00086270
086280                 COMPUTE ACUM-PEDIDOS-TALON-CORR-WS =             00086280
086290                         ACUM-PEDIDOS-TALON-CORR-WS -             00086290
086300                         ES-QT-CH-WS.                             00086300
086320*                                                                 00086320
086330 212B-35-PEDIDO-REDUCAO.                                          00086330
086340*                                                                 00086340
086350     IF TALON-PEDIDOS-ACUM-RED-WS LESS THAN ZEROS                 00086350
086360        MOVE TALON-PEDIDOS-ACUM-RED-WS TO REDUCAO-WS              00086360
086370        IF ES-QT-CH-D07 GREATER THAN REDUCAO-WS                   00086370
086380           MOVE 1 TO PER-NATUREZA-COMANDO-D10                     00086380
086390                             SW-CHEQUE-NORMAL                     00086390
086400           MOVE 63 TO PER-COD-MENS-D10                            00086400
086410           COMPUTE ACUM-PEDIDOS-TALON-CORR-WS =                   00086410
086420                   ACUM-PEDIDOS-TALON-CORR-WS +                   00086420
086430                   ES-QT-CH-D07 + TALON-PEDIDOS-ACUM-RED-WS       00086430
086440           MOVE ZEROS TO TALON-PEDIDOS-ACUM-RED-WS                00086440
086450        ELSE                                                      00086450
086460           MOVE 1 TO PER-NATUREZA-COMANDO-D10                     00086460
086470                             SW-CHEQUE-NORMAL                     00086470
086480           MOVE 63 TO PER-COD-MENS-D10                            00086480
086490           COMPUTE TALON-PEDIDOS-ACUM-RED-WS =                    00086490
086500                   TALON-PEDIDOS-ACUM-RED-WS + ES-QT-CH-D07       00086500
086510     ELSE                                                         00086510
086520        MOVE 1 TO PER-NATUREZA-COMANDO-D10                        00086520
086530                             SW-CHEQUE-NORMAL                     00086530
086540        COMPUTE ACUM-PEDIDOS-TALON-CORR-WS =                      00086540
086550                ACUM-PEDIDOS-TALON-CORR-WS +                      00086550
086560                ES-QT-CH-D07.                                     00086560
086570                                                                  00086570
086580 213-35-VERIFICA-SLD-MEDIO.                                       00086580
086590                                                                  00086590
086600     IF  NUM-SMED-ESTE-RED-WS NOT GREATER 0                       00086600
086610         MOVE 47 TO PER-COD-MENS-D10.                             00086610
086620                                                                  00086620
086630 215-35-COMPOE-REG-MESTRE.                                        00086630
086640*                                                                 00086640
086650     MOVE SPACES TO REG-CORRENT-RED-WS DI-TPSLD-ANT-WS            00086650
                                             OPCAO-PC-RED-WS.
086660     MOVE SPACES TO ENDERECO-WS.                                  00086660
086670     MOVE ZEROS  TO IND-SEMESTR.                                  00086670
           MOVE ZEROS  TO DIA-DEBITO-JUROS-RED-WS.

           MOVE ZEROS  TO ACUM-BASE-IOF-ADIC-RED-WS

086690     PERFORM 215A-35-ZERA-INDIC-SEMESTR.                          00086690
086700     MOVE ZEROS TO TPCONTAB-RED-WS EMP-NUM-IOF-RED-WS             00086700
086720                   E-CEP-RED-WS             E-FONE-RED-WS         00086720
086730                   STATUS-PRINC-RED-WS      STATUS-SECON-RED-WS   00086730
086740                   VIA-PRINC-RED-WS         REF-PRINC-RED-WS      00086740
086750                   VIA-SECON-RED-WS         REF-SECON-RED-WS      00086750
086760                   CPF-CGC-RED-WS          EXTRATO-ESPECIAL-RED-WS00086760
086770                   TX-PERM-RED-WS           CALC-SMED-RED-WS      00086770
086780                   EMP-TAXA-JUR-RED-WS      ATL-ULT-MOV-RED-WS    00086780
086790                   ATL-DIAS-PARAL-RED-WS    SLD-DEP-RED-WS        00086790
086800                   SLD-EMP-RED-WS           NUMEROS-WS            00086800
086810                   SLD-BLO-RED-WS (1)       SLD-BLO-RED-WS (2)    00086810
086820                   SLD-BLO-RED-WS (3)       SLD-BLO-RED-WS (4)    00086820
086830                   SLD-BLO-RED-WS (5)       SLD-BLO-RED-WS (6)    00086830
086840                   SLD-BLO-RED-WS (7)       SLD-BLO-RED-WS (8)    00086840
086850                   SLD-BLO-RED-WS (9)       SLD-BLO-RED-WS (10)   00086850
086860                   SLD-BLO-RED-WS (11)      SLD-BLO-RED-WS (12)   00086860
086870                   SLD-BLO-RED-WS (13)      SLD-BLO-RED-WS (14)   00086870
086880                   SLD-BLO-RED-WS (15)      SLD-BLO-RED-WS (16)   00086880
086890                   SLD-BLO-RED-WS (17)      SLD-BLO-RED-WS (18)   00086890
086900                   SLD-BLO-RED-WS (19)      SLD-BLO-RED-WS (20)   00086900
086910                   SLD-BLO-RED-WS (21)  TX-ENCARGOS-CONTERRANEO-WS00086910
086920                   NUM-SEM-BLOQ-RED-WS  TX-ENCARGOS-FERIADO-WS    00086920
086930                   INSUF-EXCESSO-RED-WS     NUM-SMED-ESTE-RED-WS  00086930
086940                   SMED-DEV-ESTE-RED-WS     SMED-DEV-UTI1-RED-WS  00086940
086950                   SMED-DEV-UTI2-RED-WS     SMED-DEV-UTI3-RED-WS  00086950
086960                   SMED-ATL1-RED-WS         SMED-ATL2-RED-WS      00086960
086970                   SMED-ATL3-RED-WS         EMP-DATA-RED-WS       00086970
086980                   EMP-VENC-RED-WS          EMP-LIM-RED-WS        00086980
086990                   EMP-NUM-RED-WS           EMP-JCOB-RED-WS       00086990
087000                   EXT-DATA-RED-WS          EXT-SLD-RED-WS        00087000
087010                   MOVIMENTOS-RED-WS        DT-TARIF-RENOV-RED-WS 00087010
087020                   FICHA-NUM-RED-WS        MOV-NUM-RED-WS         00087020
087030                   INS-ULT-RED-WS           INS-VEZ-RED-WS        00087030
087040                   INS-MOR-RED-WS           INS-DATA-MOR-RED-WS   00087040
087050                   INS-NOVA-RED-WS          EXC-ULT-RED-WS        00087050
087060                   INS-NJUR-REAL-RED-WS     INS-NJUR-DECOR-RED-WS 00087060
087070                   INS-NIOF-REAL-RED-WS     INS-NIOF-DECOR-RED-WS 00087070
087080                   EXC-VEZ-RED-WS           EXC-MOR-RED-WS        00087080
087090                   EXC-DATA-MOR-RED-WS      EXC-NOVO-RED-WS       00087090
087100                   ACT-ULT-RED-WS           ACT-VEZ-RED-WS        00087100
087110                   ACT-MOR-RED-WS           ACT-DATA-MOR-RED-WS   00087110
087120                   NUM-ULT-RED-WS           NUM-VEZ-RED-WS        00087120
087130                   CRED-ANTECIP-WS      EMP-NUM-EXCED-FUNC-RED-WS 00087130
087140                   NUM-MOR-RED-WS           NUM-DATA-MOR-RED-WS   00087140
087150                   NUM-INSUF-EXCESSO-RED-WS INDICACOES-WS         00087150
087160                   CH-PERSON-WS             CH-COMUM-WS           00087160
087170                   CH-ESPECIAL-WS          JUROS-DIARIOS-WS       00087170
087180                   VAR-OTN-RED-WS           MOVIMENTACAO-RED-WS   00087180
087190                   COD-POSTO-RED-WS      VALOR-ACUM-ADIANT-RED-WS 00087190
087200                   EXTRATO-EXTRA-RED-WS     DATA-ADIANT-RED-WS    00087200
087210                   CONTRA-ORDEM-OPOS-RED-WS ATIVIDADE-RED-WS      00087210
087220                   IMPEDE-RENOV-AUTO-RED-WS COD-POSTAL-RED-WS     00087220
087230                   TP-TALAO-RED-WS          ID-CPF-CGC-RED-WS     00087230
087240                   CLIENTE-PREFEREN-RED-WS      SMED-ATL4-RED-WS  00087240
087250                   VALOR-MEDIO-LIMITE-RED-WS    SMED-ATL5-RED-WS  00087250
087260                   RAP-RED-WS                   SMED-ATL6-RED-WS  00087260
087270                   IOCS-DIARIOS-EXIGIVEIS-RED-WS IND-SEMESTR      00087270
087280                   IOCS-DIARIOS-DISPENS-RED-WS ISENCAO-IPMF-RED-WS00087280
087290                   QDE-INS-EXC-MES-RED-WS CHEQUE-TB-FORNECI-RED-WS00087290
087300                   TAXA-APLICADA-RED-WS   CHEQUE-TB-RESIDUO-RED-WS00087300
087310                   JUROS-DO-DIA-RED-WS    CHEQUE-TB-PEDIDOS-RED-WS00087310
087320                   GANHO-POTENCIAL-DIARIO-WS SLD-DEV-NUM-ANT-WS   00087320
                         SLD-DEV-ANT-DEVOL-WS
087330                   EXC-VEZ-CONTRATO-RED-WS EMP-DATA-ENC-RED-WS    00087330
087340                   QDE-CHQS-DEV-MES-RED-WS EMP-PROPOSTA-RED-WS    00087340
087350                   QDE-SAQUE-CARTAO-DO-MES-RED-WS                 00087350
087360                   DT-OPCAO-PC-RED-WS SALDO-ANTERIOR-RED-WS       00087360
087370                   INI-LIMINAR-RED-WS FIM-LIMINAR-RED-WS          00087370
087380                   FATOR-ACUMULADO-RED-WS DIAS-UTEIS-UTIL-RED-WS  00087380
087390                   TARIFA-PROPORCIONAL-RED-WS                     00087390
087400                   QDE-SAQ-CARTAO-CTASAL-RED-WS                   00087400
087410                   QDE-CHQ-PROCES-RED-WS                          00087410
087450                   CD-CLI-COTIT-RED-WS                            00087450
087480                   GRUPO-TARIFA-RED-WS ADESAO-GRUPO-TARIFA-RED-WS 00087480
087490                   DT-BLOQ-DESBLOQ-RED-WS CD-CLI-RED-WS.          00087490
087500*                                                                 00087500
087520     MOVE SPACE TO IND-ALT-COTIT-RED-WS.                          00087520
087550     MOVE 1     TO CALC-SMED-RED-WS.                              00087550
087560     MOVE ZEROS TO IND-MOV-WS.                                    00087560
087570     PERFORM 215B-35-ZERA-MOVIMENTOS 17 TIMES.                    00087570
087580     MOVE CH-CODAG-D07 TO CH-AG-WS.                               00087580
087590     MOVE CONTA-D07    TO CH-CONTA-WS.                            00087590
087600     MOVE DV-CONTA-D07 TO CH-DIGITO-WS.                           00087600
087610     MOVE  5  TO CH-TIPOREG-WS.                                   00087610
087620     MOVE ZEROS TO CH-SEQUENCIAL-WS DI-SLD-ANT-WS.                00087620
087630     MOVE CH-DATA-D07 TO DATA-IMPLANTA-RED-WS                     00087630
087640                         ATL-ULT-DT-RED-WS                        00087640
087650                         FICHA-DATA-RED-WS.                       00087650
087660                                                                  00087660
087670     MOVE 84 TO TPCONTAB-RED-WS.                                  00087670
087680     MOVE 'N' TO ISENTA-COMPULSO-RED-WS.                          00087680
087690     IF TRANS-D07                                                 00087690
087700         PERFORM 216-35-INCLUI-CTA-CLASSIF-D128                   00087700
087710     ELSE                                                         00087710
087720       IF AC-EC-D07                                               00087720
087730         PERFORM 216-35-INCLUI-CTA-CLASSIF-D128                   00087730
087740         MOVE CH-DATA-D07 TO ACT-DATA-MOR-RED-WS                  00087740
087750         MOVE ZEROS TO ACT-VEZ-RED-WS ACT-MOR-RED-WS.             00087750
087760                                                                  00087760
087770 215A-35-ZERA-INDIC-SEMESTR.                                      00087770
087780*                                                                 00087780
087850     MOVE ZEROS  TO  QDE-CHQ-COMP-INTERNA-RED-WS                  00087850
087860                     QDE-CHQ-PG-CAIXA-RED-WS                      00087860
087880                     QDE-CHQ-AVULSO-RED-WS                        00087880
087890                     QDE-SAQ-CARTAO-CAIXA-RED-WS                  00087890
087900                     QDE-SAQ-CARTAO-RED-WS                        00087900
087910                     QDE-SAQ-BCO24HS-RED-WS                       00087910
087920                     QDE-SAQ-BB-RED-WS                            00087920
087930                     QDE-SAQ-RVA-RED-WS.                          00087930
087960                                                                  00087960
087970 215B-35-ZERA-MOVIMENTOS.                                         00087970
087980                                                                  00087980
087990     ADD 1 TO IND-MOV-WS.                                         00087990
088000     MOVE ZEROS TO DIA-MOV-RED-WS  (IND-MOV-WS)                   00088000
088010                   HIST-MOV-RED-WS (IND-MOV-WS)                   00088010
088020                   REF-MOV-RED-WS  (IND-MOV-WS)                   00088020
088030                   VR-MOV-RED-WS   (IND-MOV-WS).                  00088030
088040                                                                  00088040
088050 216-35-INCLUI-CTA-CLASSIF-D128.                                  00088050
088060                                                                  00088060
088070     MOVE 2 TO TIPO-CAD-02DD.                                     00088070
088080     MOVE CH-CONTA-WS  TO CONTA-CAD-02DD.                         00088080
088090     MOVE CH-DIGITO-WS TO DIGITO-CAD-02DD.                        00088090
088100     MOVE SPACES       TO NOME-CLI-CAD-02DD                       00088100
088110                          NOME-CLI2-CAD-02DD.                     00088110
088120     MOVE ZEROS        TO DTCONTR-CHBNB-02DD                      00088120
088130                          DTVENC-CHBNB-02DD                       00088130
088140                          LIMITE-CHBNB-02DD.                      00088140
088150     PERFORM 999-34-GRAVA-DISCO-TELEX.                            00088150
088190*                                                                 00088190
088200 220-35-LEITURA-D07.                                              00088200
088210*                                                                 00088210
088220     READ D04807                                                  00088220
088230         AT END                                                   00088230
088240              MOVE HIGH-VALUE TO CHAVE-D07-WS                     00088240
088250              MOVE 1 TO SW-FIM-PROCESSAMENTO.                     00088250
088260                                                                  00088260
088270     IF  PRIMEIRA-LEITURA-D07                                     00088270
088280         MOVE CH-CODAG-D07 TO COD-AG-ANT-D07-WS                   00088280
088290         MOVE 0 TO SW-PRIMEIRA-LEITURA-D07.                       00088290
088300                                                                  00088300
088310     IF  NOT FIM-PROCESSAMENTO                                    00088310
088320         IF  CH-CODAG-D07 NOT EQUAL COD-AG-ANT-D07-WS             00088320
088330             MOVE HIGH-VALUE TO CHAVE-D07-WS.                     00088330
088340                                                                  00088340
088350     IF CHAVE-D07-WS NOT = HIGH-VALUE                             00088350
088360         PERFORM 225-35-CHAVE-D07.                                00088360
088370*                                                                 00088370
088380 225-35-CHAVE-D07.                                                00088380
088390*                                                                 00088390
088410     MOVE CH-CODAG-D07 TO COD-AG-CH-D07 AGENCIA-D07-WS.           00088410
088420     MOVE CH-CONTA-D07 TO CONTA-CH-D07.                           00088420
088430                                                                  00088430
088440     IF GRADE-D07                                                 00088440
088450         MOVE 1 TO TPREG-CH-D07                                   00088450
088460         MOVE CH-DATA-D07 TO DATA-MOVIM-RED                       00088460
088470     ELSE                                                         00088470
088480         MOVE 5 TO TPREG-CH-D07.                                  00088480
088520*                                                                 00088520
088530 235-35-PROCESSA-GRAVACAO.                                        00088530
088540*                                                                 00088540
046110     IF INICIO-MES                                                00046110
              IF REG-COR-WS
                 IF JUR-MENSAL-1DIA-WS GREATER ZEROS
                 OR IOF-MENSAL-1DIA-WS GREATER ZEROS
                    PERFORM 999-35A-GERA-ESTORNO-JRIOF-MES
                 END-IF
              END-IF
           END-IF

088550     IF REG-COR-WS                                                00088550
088560* ELV - 12/04/2008                                                00088560
088570       MOVE QDE-CHQ-COMP-INTERNA-WS TO QDE-CHQ-COMP-INTERNA-RED-WS00088570
088580       MOVE QDE-CHQ-PG-CAIXA-WS     TO QDE-CHQ-PG-CAIXA-RED-WS    00088580
088590       MOVE QDE-CHQ-AVULSO-WS       TO QDE-CHQ-AVULSO-RED-WS      00088590
088600       MOVE QDE-SAQ-CARTAO-CAIXA-WS TO QDE-SAQ-CARTAO-CAIXA-RED-WS00088600
088610       MOVE QDE-SAQ-CARTAO-WS       TO QDE-SAQ-CARTAO-RED-WS      00088610
088620       MOVE QDE-SAQ-BCO24HS-WS      TO QDE-SAQ-BCO24HS-RED-WS     00088620
088630       MOVE QDE-SAQ-BB-WS           TO QDE-SAQ-BB-RED-WS          00088630
088640       MOVE QDE-SAQ-RVA-WS          TO QDE-SAQ-RVA-RED-WS         00088640
088650* ELV - 12/04/2008                                                00088650
088660       MOVE QDE-SAQUE-CASH-WS TO QDE-SAQUE-CARTAO-DO-MES-RED-WS   00088660
088670       MOVE QDE-CHQ-PROCES-WS TO QDE-CHQ-PROCES-RED-WS            00088670
088680       MOVE QDE-SAQ-CARTAO-CTASAL-WS TO                           00088680
088690            QDE-SAQ-CARTAO-CTASAL-RED-WS.                         00088690
088700                                                                  00088700
088710     IF  REG-COR-WS                                               00088710
088720         MOVE ZEROS        TO SLD-DISP-S159-WS                    00088720

088730         MOVE CH-AG-WS     TO AGENCIA-D159                        00088730
088740         MOVE CH-CONTA-WS  TO CONTA-D159                          00088740
088750         MOVE CH-DIGITO-WS TO DIGITO-D159                         00088750
088760         READ D15901                                              00088760
088770         IF STATUS-D15901 EQUAL '00'                              00088770
088780            IF SALDO-D159 GREATER ZEROS                           00088780
088790               COMPUTE SLD-DISP-S159-WS = SALDO-D159 -            00088790
088800                      (BLOQ-1-D159 + BLOQ-2-D159 + BLOQ-3-D159 +  00088800
088810                       BLOQ-4-D159 + BLOQ-5-D159 + BLOQ-6-D159 +  00088810
088820                       BLOQ-7-D159 + BLOQ-8-D159)                 00088820
088830               IF SLD-DISP-S159-WS LESS THAN ZEROS                00088830
088840                  MOVE ZEROS TO SLD-DISP-S159-WS                  00088840
088850               ELSE                                               00088850
088860                  NEXT SENTENCE                                   00088860
088870            ELSE                                                  00088870
088880               MOVE ZEROS TO SLD-DISP-S159-WS                     00088880
088890         ELSE                                                     00088890
088900           IF STATUS-D15901 EQUAL '23'                            00088900
088910              MOVE ZEROS TO SLD-DISP-S159-WS                      00088910
088920           ELSE                                                   00088920
088930              MOVE STATUS-D15901 TO FILE-STATUS-WS                00088930
088940              MOVE 'P04808 ERRO GRAVACAO D15901 **'               00088940
088950                                 TO MENSAGEM-ERRO-WS              00088950
088960              PERFORM 999-99-ROT-ERRO.                            00088960
088970                                                                  00088970
088980     IF  REG-COR-WS AND RECEBIVEIS                                00088980
088990         PERFORM 236-235-ACESSA-D13002.                           00088990
089000                                                                  00089000
089010     IF  REG-COR-WS AND                                           00089010
089020         TPCONTAB-RED-WS EQUAL 49                                 00089020
089030         PERFORM 999-12-CALCULO-CM-REINV.                         00089030
089040                                                                  00089040
089050     IF  REG-COR-WS                                               00089050
089060         PERFORM 237-35-ATUALIZA-NUM-CREDORES                     00089060
089070         IF  CH-CONTA-WS NOT EQUAL 88887                          00089070
089080             PERFORM 244-35-TESTA-TALON-AUTOMATICO                00089080
089090         ELSE                                                     00089090
089100             IF  HOUVE-OCORR-14                                   00089100
089110                 MOVE 9 TO PER-ORIGEM-COMANDO-D10                 00089110
089120                 MOVE 1 TO PER-NATUREZA-COMANDO-D10               00089120
089130                 MOVE ACUM-TALON-CTA-88887-WS TO PER-QTDE-D10     00089130
089140                 MOVE COD-MSG-OCORR-TALON-WS  TO PER-COD-MENS-D10 00089140
089150                 PERFORM 548-35-OCR-CH-PERSON                     00089150
089160                 MOVE ZEROS TO SW-HOUVE-OCORR-14                  00089160
089170                               COD-MSG-OCORR-TALON-WS             00089170
089180                               ACUM-TALON-CTA-88887-WS.           00089180
089190                                                                  00089190
089200******************      SPREAD       *******************          00089200
089210     IF REG-COR-WS                                                00089210
089220     IF CTA-EMPRESARIAL                                           00089220
089230        IF EMP-TAXA-JUR-RED-WS GREATER 05,000                     00089230
089240           MOVE 05,000 TO EMP-TAXA-JUR-RED-WS.                    00089240

089250     IF REG-COR-WS                                                00089250
089260        IF CTA-EMPRESARIAL                                        00089260
089270        COMPUTE TAXA-SPREAD-WS = (((EMP-TAXA-JUR-RED-WS / 100) +  00089270
089280                           1) ** (1 / DIAS-UTEIS-SPREAD-WS)) - 1. 00089280

089290********************************************************          00089290

      ****************** CANCELAR VENCIDO MAIS 15 DIAS *******
      **QUASE A MESMA ROTINA CANCELA-EMPRESTIMO
      ********************************************************
           IF REG-COR-WS
              IF CTA-DIGITAL AND P-JURIDICAS
                 NEXT SENTENCE
              END-IF
              IF  (CTA-EMPRESARIAL OR CH-EMPRESA OR CHEQUE-ESPECIAL)
              AND (CONTRATO-VENCIDO)
                 PERFORM 999-110-CALCULA-DIAS-VENCIDO
                 IF QDE-DIAS-VENC-WS GREATER 15
                    IF IOCS-DIARIOS-EXIGIVEIS-RED-WS EQUAL ZEROS
                    AND JUROS-DIARIOS-WS EQUAL ZEROS
                    AND RAP-RED-WS EQUAL ZEROS
                      IF SLD-EMP-RED-WS EQUAL ZEROS
                         MOVE SPACES       TO REG-EXTRATO-D10
                         INITIALIZE REG-EXTRATO-D10
                         MOVE 1            TO SW-CANCELOU-EMPRESTIMO
                         MOVE 4            TO EXT-COD-MENS-D10
                                              EXT-COD-MENS-WS
                         MOVE ZEROS        TO EMP-DATA-RED-WS
                                              EMP-VENC-RED-WS
                                              EMP-LIM-RED-WS
                                              EMP-TAXA-JUR-RED-WS
                                              JUROS-DIARIOS-WS
                                              DT-TARIF-RENOV-RED-WS
                                              EXC-VEZ-CONTRATO-RED-WS
                                              DIA-DEBITO-JUROS-RED-WS
                                              EMP-NUM-EXCED-FUNC-RED-WS
                                              EMP-NUM-RED-WS
                                              EMP-NUM-IOF-RED-WS
                         MOVE CH-DATA-D07  TO EMP-DATA-ENC-RED-WS
                         MOVE SPACES       TO EMP-SEGURO-RED-WS
                         MOVE 81           TO C-EMP-COD-MENS-D10
                         PERFORM 555-35-OCR-CAD-EMP.
      ********************************************************
089300                                                                  00089300
089310     IF  IMPLANTACAO                                              00089310
089320         IF GERA-FICHA                                            00089320
089330             MOVE 9 TO IND-MENS-FICHA                             00089330
089340             PERFORM 505-35-OCR-FICHA-CC                          00089340
089350             IF REG-COR-WS                                        00089350
089360                 PERFORM 260-35-TRANSFERENCIA                     00089360
                       PERFORM TRATA-RAP
089370                 PERFORM 270-35-INSUF-EXCESSO-VENCIM              00089370
089380                 PERFORM 315-35-ACUMULA-SALDOS                    00089380
089390                 PERFORM 242-TESTA-OCR-FICHA-BLOQUEIO             00089390
089400                 PERFORM 999-39-VERIFICA-SLD-DECORR               00089400
089410                 IF EMP-LIM-RED-WS GREATER ZEROS                  00089410
089420                    IF  SLD-DEV-NUM-WS LESS ZEROS OR              00089420
089430                        JUROS-DIARIOS-WS NOT EQUAL ZEROS          00089430
089440                        PERFORM 999-100-PERCENTUAL-UTILIZACAO     00089440
089450                        PERFORM 243-35-CALCULO-JUROS-DIARIOS      00089450
089460                        PERFORM 243A-35-TESTA-SE-CALCULA-IOC      00089460
089470                        MOVE ZEROS TO SLD-DEV-NUM-WS              00089470
089480                    ELSE                                          00089480
089490                        MOVE ZEROS TO SLD-DEV-NUM-WS              00089490
089500                 ELSE                                             00089500
089510                    MOVE ZEROS TO SLD-DEV-NUM-WS                  00089510
089520             ELSE                                                 00089520
089530                 NEXT SENTENCE                                    00089530
089540         ELSE                                                     00089540
089550             MOVE ZERO TO SW-IMPLANTACAO                          00089550
089560     ELSE                                                         00089560
089570         IF REG-COR-WS                                            00089570
089580             PERFORM 260-35-TRANSFERENCIA                         00089580
                   PERFORM TRATA-RAP
089590             PERFORM 270-35-INSUF-EXCESSO-VENCIM                  00089590
089600             PERFORM 315-35-ACUMULA-SALDOS                        00089600
089610             PERFORM 242-TESTA-OCR-FICHA-BLOQUEIO                 00089610
089620             PERFORM 999-39-VERIFICA-SLD-DECORR                   00089620
089630             IF EMP-LIM-RED-WS GREATER ZEROS                      00089630
089640                IF  SLD-DEV-NUM-WS LESS ZEROS OR                  00089640
089650                    JUROS-DIARIOS-WS NOT EQUAL ZEROS              00089650
089660                    PERFORM 999-100-PERCENTUAL-UTILIZACAO         00089660
089670                    PERFORM 243-35-CALCULO-JUROS-DIARIOS          00089670
089680                    PERFORM 243A-35-TESTA-SE-CALCULA-IOC          00089680
089690                    MOVE ZEROS TO SLD-DEV-NUM-WS                  00089690
089700                ELSE                                              00089700
089710                    MOVE ZEROS TO SLD-DEV-NUM-WS                  00089710
089720             ELSE                                                 00089720
089730                MOVE ZEROS TO SLD-DEV-NUM-WS                      00089730
089740         ELSE                                                     00089740
089750             IF TRAIL-AG-WS                                       00089750
089760                PERFORM 240-35-ENCERRA-AGENCIA.                   00089760
089770                                                                  00089770
089780     IF REG-COR-WS                                                00089780
089790        PERFORM 238-235-GANHO-POTENCIAL.                          00089790
089800                                                                  00089800
089810     IF REG-COR-WS                                                00089810
089820        IF HA-CRED-DEB-ESP                                        00089820
089830           MOVE 1 TO SW-QUEBRA-CONTA-ESP                          00089830
089840           PERFORM 530-35-OCR-ESPECIAIS                           00089840
089850           MOVE ZEROS TO SW-CRED-DEB-ESP SW-QUEBRA-CONTA-ESP.     00089850
089860                                                                  00089860
089870     IF REG-COR-WS                                                00089870
089880        IF  SLD-DEP-RED-WS NOT = 0 OR                             00089880
089890            SLD-EMP-RED-WS NOT = 0                                00089890
089900            MOVE ZERO TO SW-EXCLUI-CONTA.                         00089900
089910                                                                  00089910
      *AMORTIZACAO DE JUROS DE LIMITE QUANDO NAO HA SALDO DE RAP.
      *CONTABILIZACAO ATRAVES DE EVENTO DE RENDAS EFETIVAS.
089920     IF REG-COR-WS AND NAO-CONTABILIZOU-383                       00089920
089940       IF HIST-383-WS NOT EQUAL ZEROS                             00089940
089950         PERFORM 236-235C-EVENTO-ESTORNO-JUROS.                   00089950
089970                                                                  00089970
090320     IF REG-COR-WS                                                00090320
090330       MOVE ZEROS TO SALDO-ATUAL-WS                               00090330
090340       IF SLD-EMP-RED-WS LESS ZEROS                               00090340
090350          MOVE SLD-EMP-RED-WS TO SALDO-ATUAL-WS                   00090350
090360       ELSE                                                       00090360
090370          MOVE SLD-DEP-RED-WS TO SALDO-ATUAL-WS.                  00090370
      ******************************************************************
      * TRATAMENTO DE RENDAS A APROPRIAR.
      *     IF REG-COR-WS
      *         PERFORM TRATA-RAP
      *     END-IF.
      ******************************************************************
           IF REG-COR-WS
                   AND HIST-392-WS NOT EQUAL ZEROS
                   AND NAO-CONTABILIZOU-392
              MOVE HIST-392-WS TO VALOR-D83
              MOVE 00843       TO EVENTO-D83
              MOVE 5           TO DIG-EVENTO-D83
              MOVE 2           TO LANCTO-D83
              MOVE 1           TO SW-CONTABILIZA-392
              PERFORM 999-35-GRAVA-D04883
           END-IF.

100112     IF  REG-COR-WS AND TPCONTAB-RED-WS EQUAL 30
               PERFORM 999-12-CALCULO-CM-JUDICIAL.

BOSSA***--------------------------------------------------------------***BOSSA
BOSSA***            PRECATORIOS                                       ***BOSSA
BOSSA***--------------------------------------------------------------***BOSSA
100112*    IF  REG-COR-WS AND (TPCONTAB-RED-WS EQUAL 31 OR 33)
100112*        PERFORM 999-12-CALCULO-JUR-CM-PREC.
BOSSA***--------------------------------------------------------------***BOSSA

091380     IF  EXCLUI-CONTA                                             00091380
               DISPLAY 'EXCLUI CONTA '
091390         MOVE ZERO TO SW-EXCLUI-CONTA SW-F10                      00091390
091400         MOVE 1            TO TIPO-CAD-02DD                       00091400
091410         MOVE CH-CONTA-WS  TO CONTA-CAD-02DD                      00091410
091420         MOVE CH-DIGITO-WS TO DIGITO-CAD-02DD                     00091420
091430         MOVE NOME-RED-WS  TO NOME-CLI-CAD-02DD                   00091430
091440         MOVE SPACES       TO NOME-CLI2-CAD-02DD                  00091440
091450         MOVE ZEROS        TO DTCONTR-CHBNB-02DD                  00091450
091460                              DTVENC-CHBNB-02DD                   00091460
091470                              LIMITE-CHBNB-02DD                   00091470
091480         PERFORM 999-34-GRAVA-DISCO-TELEX                         00091480
091490         MOVE ZEROS TO IND-MOVTOS                                 00091490
091500         PERFORM 999-31-LIMPA-TAB-MOVTOS                          00091500
091510         MOVE ZEROS TO IND-MOVTOS                                 00091510
091520     ELSE                                                         00091520
091530         PERFORM 999-10-GRAVA-F10.                                00091530
091540                                                                  00091540
091550     MOVE ZEROS TO CPMF-WS                                        00091550
091580            SW-TEM-HIST-387
091580*           SW-TEM-HIST-515
                  SW-TEM-HIST-71-373 AMORTIZACAO-WS
                  SW-CONTABILIZA-392 HIST-392-WS HIST-393-WS
091590            SW-CONTABILIZA-383 HIST-383-WS HIST-384-WS            00091590
091600            SALDO-ANTERIOR-INS SALDO-ATUAL-INS SLD-DEVOL-WS       00091600
                  VLR-CRED-BAIXA-ATV-WS
                  JUR-DEVOL-1DIA-WS  IOF-DEVOL-1DIA-WS
                  JUR-MENSAL-1DIA-WS IOF-MENSAL-1DIA-WS
                  TOTAL-MOVTO-BLOQ-WS
091610            STATUS-CHQ-ESP-ANT-WS.
091620* ELV - 12/04/2008                                                00091620
091630     MOVE ZEROS TO QDE-CHQ-COMP-INTERNA-WS                        00091630
091640                   QDE-CHQ-PG-CAIXA-WS                            00091640
091650                   QDE-CHQ-AVULSO-WS                              00091650
                         QDE-CHQ-PROCES-WS
091660                   QDE-SAQ-CARTAO-CAIXA-WS                        00091660
091670                   QDE-SAQ-CARTAO-WS                              00091670
091680                   QDE-SAQ-BCO24HS-WS                             00091680
091690                   QDE-SAQ-BB-WS                                  00091690
091700                   QDE-SAQ-RVA-WS                                 00091700
                         QDE-SAQ-CARTAO-CTASAL-WS
                         QDE-SAQUE-CASH-WS.
091710* ELV - 12/04/2008                                                00091710

DOCINI****F* P04808/TRATA-RAP
DOCTXT* OBJETIVO
DOCTXT*   Esta rotina tem por finalidade o tratamento da RAP (rendas a
DOCTXT*   apropriar).
DOCTXT*   Mais especificamente, esta rotina faz apropriacao e
DOCTXT*   amortizacao de rap. Tratamento reescrito em 12/08/2016 a fim
DOCTXT*   de reduzir ou zerar os problemas relativos a apropriacao de
DOCTXT*   RAP.
DOCTXT*
DOCEND******
       TRATA-RAP.
      *INICIALIZACAO DE VARIAVEIS USADAS LOCALMENTE
           MOVE ZEROS TO AMORTIZACAO-WS
                         RAP-POS-WS
                         SLD-ATL-SBLOQ-WS
                         SLD-ANT-SBLOQ-WS
                         SLD-ATL-SBLOQ-COM-SLDDEVOL-WS
                         SLD-ANT-SBLOQ-COM-SLDDEVOL-WS
                         SALDO-ATUAL-WS                                 00090330
           IF SLD-EMP-RED-WS LESS ZEROS                                 00090340
              MOVE SLD-EMP-RED-WS TO SALDO-ATUAL-WS                     00090350
           ELSE                                                         00090360
              MOVE SLD-DEP-RED-WS TO SALDO-ATUAL-WS                     00090370
           END-IF

           IF (RAP-RED-WS NOT = 0)
               IF EXISTIA-CHQ
      *TRATAMENTO DE HISTORICOS ESPECIFICOS DE ATUALIZACAO DE RAP
      *HISTORICO 383-ESTORNO DE JUROS - COMPOSICAO DE DIVIDA
                   IF HIST-383-WS NOT = 0
      *TRATAR NESTE MOMENTO A RAP COMO UM VALOR POSITIVO PARA COMPARACAO
      *COM OS VALORES DE TRANSACAO 383
                       IF RAP-RED-WS < 0
                           COMPUTE RAP-POS-WS = (-1) * RAP-RED-WS
                       ELSE
                           COMPUTE RAP-POS-WS = RAP-RED-WS
                       END-IF

      *COMPARACAO DE VALORES ENTRE A RAP E O CREDITO DE ESTORNO
                       IF HIST-383-WS > RAP-POS-WS
      *CONTABILIZAR O EXCEDENTE SOBRE A RAP
      *DISPENSA ENCARGOS QUE ULTRAPASSAREM MONTANTE RAP S/UTILIZACAO
      *CH.ESPECIAL/CH.EMPRESA/CTA.EMPRESARIAL
                           COMPUTE VALOR-D83 = HIST-383-WS - RAP-POS-WS
                           MOVE 04991       TO EVENTO-D83
                           MOVE 3           TO DIG-EVENTO-D83
                           MOVE 1           TO LANCTO-D83
                           PERFORM 999-35-GRAVA-D04883

                           COMPUTE VALOR-D83 = RAP-POS-WS
                           COMPUTE RAP-RED-WS = 0
                       ELSE
                           COMPUTE VALOR-D83 = HIST-383-WS
                           COMPUTE RAP-RED-WS = RAP-RED-WS + HIST-383-WS
                       END-IF
      *AMORTIZACAO DE JUROS(RENDAS A APROPRIAR) S/UTILIZACAO DE
      *CH.ESPECIAL/CH.EMPRESA/CTA.EMPRESARIAL
                       MOVE 04989       TO EVENTO-D83
                       MOVE 1           TO DIG-EVENTO-D83
                       MOVE 2           TO LANCTO-D83
                       PERFORM 999-35-GRAVA-D04883

                       COMPUTE RAP-POS-WS = 0
                       MOVE 1  TO  SW-CONTABILIZA-383
                   END-IF
      *TRATAMENTO HISTORICO 384 - DESEMBOLSO-COMPOSICAO DE DIVIDA.
                   IF HIST-384-WS NOT = 0
                       MOVE RAP-RED-WS  TO VALOR-D83
                       MOVE 04993       TO EVENTO-D83
                       MOVE 0           TO DIG-EVENTO-D83
                       MOVE 1           TO LANCTO-D83
                       MOVE ZEROS       TO RAP-RED-WS
                       PERFORM 999-35-GRAVA-D04883
                   END-IF
               ELSE
      *TRATAMENTO HISTORICO 393 - COMPOSICAO DE DIVIDA PARA
      *INSUFICIENCIA DE FUNDOS - ADIANTAMENTO A DEPOSITANTES.
                   IF NAO-EXISTIA-CHQ AND HIST-393-WS NOT = 0
                       MOVE RAP-RED-WS  TO VALOR-D83
                       MOVE 05107       TO EVENTO-D83
                       MOVE 1           TO DIG-EVENTO-D83
                       MOVE 1           TO LANCTO-D83
                       MOVE ZEROS       TO RAP-RED-WS
                       PERFORM 999-35-GRAVA-D04883
                   END-IF
               END-IF
           END-IF.

      *TRATAMENTO HISTORICO 392 - ESTORNO DE JUROS SOBRE
      *INSUFICIENCIA DE FUNDOS - ADIANTAMENTO A DEPOSITANTES.

           IF  RAP-RED-WS EQUAL ZEROS
               IF  EMP-LIM-RED-WS EQUAL ZEROS
                   IF   HIST-392-WS NOT EQUAL ZEROS
                        MOVE HIST-392-WS   TO  VALOR-D83
                        MOVE 00843         TO  EVENTO-D83
                        MOVE 5             TO  DIG-EVENTO-D83
                        MOVE 2             TO  LANCTO-D83
                        MOVE 1             TO  SW-CONTABILIZA-392
                        PERFORM 999-35-GRAVA-D04883
                   END-IF
               END-IF
           END-IF

           IF  RAP-RED-WS NOT EQUAL ZEROS
               IF  EMP-LIM-RED-WS EQUAL ZEROS
                   IF  HIST-392-WS NOT EQUAL ZEROS
                       COMPUTE W-RAP-WS = RAP-RED-WS * (-1)
                       MOVE 1           TO SW-CONTABILIZA-392
                       IF  HIST-392-WS NOT LESS THAN W-RAP-WS
                           PERFORM 292-235E-COMPOSICAO-INS
                       ELSE
                           PERFORM 292-235E-COMPOSICAO-INS2
                       END-IF
                   END-IF
               END-IF
           END-IF

      *COMO HOUVE TRATAMENTO DE HISTORICOS ESPECIFICOS EH POSSIVEL QUE
      *A RAP JA TENHA SIDO ZERADA.
           IF (RAP-RED-WS NOT = 0)
      *1 - COMPUTAR SALDO ATUAL SEM DEPOSITOS BLOQUEADOS-F10
      *2 - VERIFICAR SE EXISTE SALDO DEVEDOR A FIM DE REVERTER A RAP EM
      *    CASO CONTRARIO.
      * OS SALDOS ABAIXO SAO USADOS PARA EFEITO DE VERIFICAO DE REDUCAO
      * DE SALDO DEVEDOR
      * COMPUTAR SALDO SEM BLOQUEIO
               COMPUTE SLD-ATL-SBLOQ-WS = SALDO-ATUAL-WS
                                        - SALDO-BLOQUEADO-WS
                                        - TOTAL-MOVTO-BLOQ-WS

      * COMPUTAR SALDO ANTERIOR SEM BLOQUEIO
               COMPUTE SLD-ANT-SBLOQ-WS = SALDO-ANTERIOR-RED-WS -
                                          SALDO-ANTERIOR-BLOQUEADO-WS

      * A CONTABILIZACAO DEVE SER FEITA DE FORMA DIFERENTE PARA
      * INSUFICIENCIA DE FUNDOS OU PARA LIMITE DE CREDITO:
      * SE A RAP ACUMULADA PERTENCE A UM CHEQUE ESPECIAL, ELA DEVE SER
      * APROPRIADA COMO RAP DE CHEQUE ESPECIAL.
      * SE NAO HA EMPRESTIMO (EMP-LIM = 0) E NAO HA CANCELAMENTO DE
      * CHEQUE ESPECIAL NO DIA PARA AQUELA CONTA, ENTAO A RAP EH DE UMA
      * INSUFICIENCIA.
               IF ((EMP-LIM-RED-WS = 0)
                       AND (NAO-EXISTIA-CHQ))
                   MOVE 05106             TO EVENTO-D83
                   MOVE 3                 TO DIG-EVENTO-D83
               ELSE
                   MOVE 04990             TO EVENTO-D83
                   MOVE 5                 TO DIG-EVENTO-D83
               END-IF
               MOVE 1                     TO LANCTO-D83

      * REGRA ABSOLUTA PARA APROPRIACAO DE RAP EH DE QUE QUANDO O SALDO
      * ATUALIZADO FOR MAIOR OU IGUAL A ZERO, NAO DEVE EXISTIR RAP SEM
      * APROPRIACAO.
               IF (SLD-ATL-SBLOQ-WS >=  0)
                   MOVE RAP-RED-WS            TO VALOR-D83
                   MOVE ZEROS                 TO RAP-RED-WS
                   PERFORM 999-35-GRAVA-D04883
               ELSE

      * EM CASO DE REDUCAO DE SALDO DEVEDOR COM RELACAO AO DIA ANTERIOR,
      * AMORTIZAMOS A RAP. AMORTIZACAO EH SEMPRE POSITIVA.
      * SOH PODEMOS CONSIDERAR CREDITOS VALIDOS (NAO PROVENIENTES DE
      * DEVOLUCOES) PARA EFEITO DE AMORTIZACAO. ALEM DE NAO CONSIDERAR
      * SALDOS BLOQUEADOS.
                   COMPUTE SLD-ATL-SBLOQ-COM-SLDDEVOL-WS =
                           SLD-ATL-SBLOQ-WS - SLD-DEVOL-WS

      * DEVOLUCOES ANTERIORES JA DEDUZIDAS
                   COMPUTE SLD-ANT-SBLOQ-COM-SLDDEVOL-WS =
                           SLD-ANT-SBLOQ-WS

                   IF SLD-ANT-SBLOQ-COM-SLDDEVOL-WS < 0
                           AND SLD-ATL-SBLOQ-COM-SLDDEVOL-WS >
                               SLD-ANT-SBLOQ-COM-SLDDEVOL-WS

                      COMPUTE AMORTIZACAO-WS =
                              SLD-ATL-SBLOQ-COM-SLDDEVOL-WS -
                              SLD-ANT-SBLOQ-COM-SLDDEVOL-WS
                   ELSE
      *SE NAO HOUVE REDUCAO DE SALDO DEVEDOR, MAS O SALDO ATUAL EH
      *MAIOR QUE O SALDO DE RAP, ENTAO AMORTIZAMOS A RAP NO VALOR DA
      *DIFERENCA.
                       IF RAP-RED-WS < SLD-ATL-SBLOQ-COM-SLDDEVOL-WS
                           IF RAP-RED-WS < 0
                               COMPUTE RAP-POS-WS = (-1) * RAP-RED-WS
                           ELSE
                               COMPUTE RAP-POS-WS = RAP-RED-WS
                           END-IF
      *SABEMOS COM CERTEZA QUE O SALDO ATUAL EH NEGATIVO E QUE A RAP
      *EH MENOR QUE O SALDO ATUAL, ENTAO AO INVERTER O SINAL DA RAP
      *ELA SE TORNA MAIOR QUE O SALDO ATUAL NEGATIVO.
                           COMPUTE AMORTIZACAO-WS = (RAP-POS-WS +
                                   SLD-ATL-SBLOQ-COM-SLDDEVOL-WS)

                           COMPUTE RAP-POS-WS = 0
      *SE O SALDO DE RAP NAO EH MENOR QUE O SALDO DEVEDOR, VERIFICAR SE
      *RECEBIDO HIST 515, PARA AMORTIZAR A RAP NO VALOR DA DIFERENCA,
      *POIS O SALDO FICOU DEVEDOR ENTRE A EXTINCAO DA INSUFICIENCIA E A
      *COBRANCA DOS ENCARGOS.
      *                ELSE
      *                     IF  TEM-HIST-515
      *                        IF RAP-RED-WS < 0
      *                           COMPUTE  RAP-POS-WS  =
      *                                    RAP-RED-WS  *   (-1)
      *                        ELSE
      *                           COMPUTE  RAP-POS-WS  =   RAP-RED-WS
      *                        END-IF
      *                        COMPUTE AMORTIZACAO-WS  =  (RAP-POS-WS +
      *                                   SLD-ATL-SBLOQ-COM-SLDDEVOL-WS)
      *                        COMPUTE RAP-POS-WS      =   0
      *                    END-IF
                       END-IF
                   END-IF
      * AQUI CALCULAMOS O QUANTO PODEMOS AMORTIZAR, ISTO EH, APROPRIAR
      * OS JUROS PODRES (RAP).
                   IF AMORTIZACAO-WS > 0
                       IF RAP-RED-WS < 0
                           COMPUTE RAP-POS-WS = (-1) * RAP-RED-WS
                       ELSE
                           COMPUTE RAP-POS-WS = RAP-RED-WS
                       END-IF

                       IF AMORTIZACAO-WS >= RAP-POS-WS
                           MOVE RAP-POS-WS     TO VALOR-D83
                           MOVE ZEROS          TO RAP-POS-WS
                       ELSE
                           MOVE AMORTIZACAO-WS TO VALOR-D83
      *                    IF  TEM-HIST-515
      *                         MOVE ZEROS      TO RAP-POS-WS
      *                    ELSE
                               COMPUTE RAP-POS-WS =
                                   RAP-POS-WS - AMORTIZACAO-WS
      *                    END-IF
                       END-IF

                       PERFORM 999-35-GRAVA-D04883

                       COMPUTE RAP-RED-WS = (-1) * RAP-POS-WS
                   END-IF

               END-IF
           END-IF.

      *PRINT-DEBUG.
      *    IF CH-CONTA-WS = 35474
      *    MOVE SALDO-ATUAL-WS TO DIS-VALOR-SINALIZ
      *    DISPLAY 'SALDO-ATUAL-WS               ...' DIS-VALOR-SINALIZ
      *
      *    MOVE SLD-DEVOL-WS TO DIS-VALOR-SINALIZ
      *    DISPLAY 'SLD-DEVOL-WS                 ...' DIS-VALOR-SINALIZ
      *
      *    MOVE SALDO-BLOQUEADO-WS TO DIS-VALOR-SINALIZ
      *    DISPLAY 'SALDO-BLOQUEADO-WS           ...' DIS-VALOR-SINALIZ
      *
      *    MOVE TOTAL-MOVTO-BLOQ-WS TO DIS-VALOR-SINALIZ
      *    DISPLAY 'TOTAL-MOVTO-BLOQ-WS          ...' DIS-VALOR-SINALIZ
      *
      *    MOVE SALDO-ANTERIOR-RED-WS TO DIS-VALOR-SINALIZ
      *    DISPLAY 'SALDO-ANTERIOR-RED-WS        ...' DIS-VALOR-SINALIZ
      *
      *    MOVE SALDO-ANTERIOR-BLOQUEADO-WS TO DIS-VALOR-SINALIZ
      *    DISPLAY 'SALDO-ANTERIOR-BLOQUEADO-WS  ...' DIS-VALOR-SINALIZ
      *
      *    MOVE SLD-ATL-SBLOQ-COM-SLDDEVOL-WS TO DIS-VALOR-SINALIZ
      *    DISPLAY 'SLD-ATL-SBLOQ-COM-SLDDEVOL-WS...' DIS-VALOR-SINALIZ
      *
      *    MOVE SLD-ATL-SBLOQ-WS TO DIS-VALOR-SINALIZ
      *    DISPLAY 'SLD-ATL-SBLOQ-WS             ...' DIS-VALOR-SINALIZ
      *
      *    MOVE SLD-ANT-SBLOQ-COM-SLDDEVOL-WS TO DIS-VALOR-SINALIZ
      *    DISPLAY 'SLD-ANT-SBLOQ-COM-SLDDEVOL-WS...' DIS-VALOR-SINALIZ
      *
      *    MOVE RAP-RED-WS TO DIS-VALOR-SINALIZ
      *    DISPLAY 'RAP-RED-WS                   ...' DIS-VALOR-SINALIZ
      *
      *    MOVE AMORTIZACAO-WS TO DIS-VALOR-SINALIZ
      *    DISPLAY 'AMORTIZACAO-WS               ...' DIS-VALOR-SINALIZ
      *
      *    MOVE HIST-383-WS TO DIS-VALOR-SINALIZ
      *    DISPLAY 'HIST-383-WS               ...' DIS-VALOR-SINALIZ
      *    END-IF.
      ******************************************************************
DOCINI****F* P04808/REVERTER-RAP-386
DOCTXT* OBJETIVO
DOCTXT*   Reverter a RAP (diminuir a RAP) quando do movimento de hist.
DOCTXT*   386 - REVERSAO DE RAP.
DOCEND******
       REVERTER-RAP-386.
      * A RAP DEVE SER SEMPRE NEGATIVA.
           IF RAP-RED-WS > ZEROS
               COMPUTE RAP-RED-WS = (-1) * RAP-RED-WS
           END-IF.

      * ABATIMENTO DA RAP.
           COMPUTE RAP-RED-WS = RAP-RED-WS + TR-VALOR-D07.
           IF RAP-RED-WS > ZEROS
               COMPUTE RAP-RED-WS = 0
           END-IF.
      ******************************************************************
       999-12-CALCULO-CM-JUDICIAL.

           IF SLD-DEP-RED-WS GREATER ZEROS
              COMPUTE CM-JUDIC-WS ROUNDED = VR-SELIC-DIA-WS *
                                            SLD-DEP-RED-WS
              MOVE CM-JUDIC-WS TO CRED-ANTECIP-WS.

170576***************************************************************** 00170576
       999-12-CALCULO-JUR-CM-PREC.

           IF SLD-DEP-RED-WS GREATER ZEROS
              COMPUTE CM-JUDIC-WS ROUNDED =
                      ((SLD-DEP-RED-WS * VR-TR-DIA-PREC-WS) / 100)
              COMPUTE JUR-JUDIC-WS ROUNDED =
                    ((SLD-DEP-RED-WS + CM-JUDIC-WS) *
                    ((1,005 ** (1 / QTD-DIAS-UTEIS-MES-WS)) - 1))
              COMPUTE CRED-ANTECIP-WS = CM-JUDIC-WS + JUR-JUDIC-WS.
170576***************************************************************** 00170576

091730 236-235-ACESSA-D13002.                                           00091730
091740                                                                  00091740
091750     MOVE CH-AG-WS         TO COD-AGENCIA-D02.                    00091750
091760     MOVE CH-CONTA-WS         TO NUM-CONTA-RED-WS.                00091760
091760     MOVE CH-DIGITO-WS        TO DIG-CONTA-RED-WS.                00091760
091760     MOVE CH-NUM-CONTA-RED-WS TO CONTA-CORRENTE-D02.              00091760
091770     MOVE DATA-D07-RED-INV TO DATA-VENCIMENTO-D02.                00091770
091780     MOVE ZEROS            TO NUM-ODC-D02.                        00091780
091790     START D13002 KEY NOT LESS CHAVE-D02.                         00091790
091800     IF  STATUS-D02-WS EQUAL '23'                                 00091800
091810         MOVE 1 TO SW-ENCONTROU-D13002                            00091810
091820     ELSE                                                         00091820
091830      IF  STATUS-D02-WS NOT EQUAL '00'                            00091830
091840          MOVE STATUS-D02-WS TO FILE-STATUS-WS                    00091840
091850          MOVE '***P04808 ERRO NO START DO D13002 '               00091850
091860                    TO MENSAGEM-ERRO-WS                           00091860
091870          PERFORM  999-99-ROT-ERRO                                00091870
091880      ELSE                                                        00091880
091890         MOVE ZEROS TO SW-ENCONTROU-D13002.                       00091890
091900                                                                  00091900
091910     PERFORM 236-235A-LEH-D13002 UNTIL ENCONTROU-CONTA.           00091910
091920                                                                  00091920
091930 236-235A-LEH-D13002.                                             00091930
091940                                                                  00091940
091950     READ D13002 NEXT RECORD.                                     00091950
091960     IF  STATUS-D02-WS EQUAL '10'                                 00091960
091970         MOVE 1 TO SW-ENCONTROU-D13002                            00091970
091980     ELSE                                                         00091980
091990     IF  STATUS-D02-WS NOT EQUAL '00'                             00091990
092000         MOVE STATUS-D02-WS TO FILE-STATUS-WS                     00092000
092010         MOVE '***P04808 ERRO LEITURA D13002 '                    00092010
092020                    TO MENSAGEM-ERRO-WS                           00092020
092030         PERFORM  999-99-ROT-ERRO                                 00092030
092040     ELSE                                                         00092040
092050       IF (CH-NUM-CONTA-RED-WS NOT = CONTA-CORRENTE-D02) OR       00092050
092060          (DATA-D07-RED-INV NOT = DATA-VENCIMENTO-D02)            00092060
092070          MOVE 1 TO SW-ENCONTROU-D13002                           00092070
092080       ELSE                                                       00092080
092090        IF (CH-NUM-CONTA-RED-WS EQUAL CONTA-CORRENTE-D02 AND      00092090
092100            DATA-D07-RED-INV EQUAL DATA-VENCIMENTO-D02)           00092100
092110         IF VALOR-D02 LESS THAN EMP-LIM-RED-WS                    00092110
092120            COMPUTE LIMITE-WS = EMP-LIM-RED-WS -                  00092120
092130                                VALOR-D02                         00092130
092140            MOVE LIMITE-WS TO EMP-LIM-RED-WS                      00092140
092150            MOVE 69 TO C-EMP-COD-MENS-D10                         00092150
092160            PERFORM 555-35-OCR-CAD-EMP                            00092160
092170         ELSE                                                     00092170
092180            MOVE 68 TO C-EMP-COD-MENS-D10                         00092180
092190            PERFORM 555-35-OCR-CAD-EMP.                           00092190
092200                                                                  00092200
092380*E                                                                00092380
092390 236-235C-EVENTO-ESTORNO-JUROS.                                   00092390
092400                                                                  00092400
           MOVE 1           TO SW-CONTABILIZA-383
092410     MOVE HIST-383-WS TO VALOR-D83.                               00092410
092420     MOVE 00962       TO EVENTO-D83.                              00092420
092430     MOVE 8           TO DIG-EVENTO-D83.                          00092430
092440     MOVE 2           TO LANCTO-D83.                              00092440
092450     PERFORM 999-35-GRAVA-D04883.                                 00092450
092460                                                                  00092460
092470 237-35-ATUALIZA-NUM-CREDORES.                                    00092470
092480                                                                  00092480
092490     IF INICIO-MES                                                00092490
092500        COMPUTE QDE-DIAS-WS = DIA-D07-WS - 1                      00092500
092510        MOVE DIA-D07-WS TO DIA-IOC-RED-WS                         00092510
092520     ELSE                                                         00092520
092530        COMPUTE QDE-DIAS-WS = DIA-D07-WS - (DIA-IOC-RED-WS + 1)   00092530
092540        MOVE DIA-D07-WS TO DIA-IOC-RED-WS.                        00092540
092550                                                                  00092550
           IF  EMP-LIM-RED-WS GREATER ZERO
               IF  OPER-ISENTA-IOF
                   MOVE ATL-ULT-MOV-RED-WS TO  DATA-AUX-RED
                   MOVE DIA-AUX            TO  DIA-ULTMOV-IOF
                   MOVE MES-AUX            TO  MES-ULTMOV-IOF
                   CALL 'M0952000' USING ANO-AUX ANO-ULTMOV-IOF
                   MOVE DATA-D07-RED-INV   TO  DT-MOV-ATUAL-IOF
                   MOVE QDE-DIAS-WS        TO  QT-DIAS-IOF
                   PERFORM 99-CALC-QT-DIAS-IOF
                   MOVE QT-DIAS-IOF        TO  QDE-DIAS-WS
               END-IF
           END-IF

092560     IF SLD-DEP-RED-WS GREATER ZEROS                              00092560
092570        COMPUTE NUM-SMED-ESTE-RED-WS = SLD-DEP-RED-WS +           00092570
092580                                       NUM-SMED-ESTE-RED-WS.      00092580
092590     IF SLD-EMP-RED-WS NOT = ZEROS                                00092590
092600        COMPUTE SMED-DEV-ESTE-RED-WS = SLD-EMP-RED-WS +           00092600
092610                                       SMED-DEV-ESTE-RED-WS.      00092610
092620     COMPUTE SLD-DEV-NUM-WS = SLD-EMP-RED-WS + SLD-DEP-RED-WS -   00092620
092630             (SLD-BLO-RED-WS  (1) + SLD-BLO-RED-WS  (2) +         00092630
092640              SLD-BLO-RED-WS  (3) + SLD-BLO-RED-WS  (4) +         00092640
092650              SLD-BLO-RED-WS  (5) + SLD-BLO-RED-WS  (6) +         00092650
092660              SLD-BLO-RED-WS  (7) + SLD-BLO-RED-WS  (8) +         00092660
092670              SLD-BLO-RED-WS  (9) + SLD-BLO-RED-WS (10) +         00092670
092680              SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +         00092680
092690              SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +         00092690
092700              SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +         00092700
092710              SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +         00092710
092720              SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +         00092720
092730              SLD-BLO-RED-WS (21)).                               00092730
092740                                                                  00092740
092750 238-235-GANHO-POTENCIAL.                                         00092750
092760                                                                  00092760
092770     IF INICIO-MES OR INICIO-ANO                                  00092770
092780        MOVE ZEROS TO GANHO-POTENCIAL-DIARIO-WS.                  00092780
092790                                                                  00092790
092800     COMPUTE SLD-DEV-NUM-WS = SLD-EMP-RED-WS + SLD-DEP-RED-WS -   00092800
092810             (SLD-BLO-RED-WS  (1) + SLD-BLO-RED-WS  (2) +         00092810
092820              SLD-BLO-RED-WS  (3) + SLD-BLO-RED-WS  (4) +         00092820
092830              SLD-BLO-RED-WS  (5) + SLD-BLO-RED-WS  (6) +         00092830
092840              SLD-BLO-RED-WS  (7) + SLD-BLO-RED-WS  (8) +         00092840
092850              SLD-BLO-RED-WS  (9) + SLD-BLO-RED-WS (10) +         00092850
092860              SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +         00092860
092870              SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +         00092870
092880              SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +         00092880
092890              SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +         00092890
092900              SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +         00092900
092910              SLD-BLO-RED-WS (21)).                               00092910
092920                                                                  00092920
092930     IF SLD-DEV-NUM-WS LESS THAN ZEROS                            00092930
092940        IF EMP-LIM-RED-WS EQUAL ZEROS                             00092940
092950           PERFORM 239-238A-GANHO-ADIANTAMENTO                    00092950
092960        ELSE                                                      00092960
092970           PERFORM 239-238B-GANHO-EMPRESTIMO.                     00092970
092980                                                                  00092980
092990     MOVE ZEROS TO SLD-DEV-NUM-WS.                                00092990
093000                                                                  00093000
093010 239-238A-GANHO-ADIANTAMENTO.                                     00093010
093040                                                                  00093040
093050     IF TPCONTAB-RED-WS EQUAL 01 OR 03                            00093050
093060        COMPUTE GANHO-POTENCIAL-DIARIO-WS =                       00093060
093070                GANHO-POTENCIAL-DIARIO-WS +                       00093070
093080                (VALOR-ACUM-ADIANT-RED-WS + INS-NJUR-REAL-RED-WS +00093080
093090                 INS-NJUR-DECOR-RED-WS) *                         00093090
093100              (((VR-IAC-ANT-WS / VR-IAC-ONTEM-WS) /               00093100
093110                (1 + FATOR-JUR-CE-WS)) - 1)                       00093110
093120     ELSE                                                         00093120
093130        COMPUTE GANHO-POTENCIAL-DIARIO-WS =                       00093130
093140                GANHO-POTENCIAL-DIARIO-WS +                       00093140
093150                (VALOR-ACUM-ADIANT-RED-WS + INS-NJUR-REAL-RED-WS +00093150
093160                 INS-NJUR-DECOR-RED-WS) *                         00093160
093170              (((VR-IAC-ANT-WS / VR-IAC-ONTEM-WS) /               00093170
093180                (1 + FATOR-JUR-CE-WS)) - 1).                      00093180
093190                                                                  00093190
093210 239-238B-GANHO-EMPRESTIMO.                                       00093210
093230                                                                  00093230
093240     IF TPCONTAB-RED-WS EQUAL 01                                  00093240
093250        COMPUTE GANHO-POTENCIAL-DIARIO-WS =                       00093250
093260                GANHO-POTENCIAL-DIARIO-WS +                       00093260
093270               ((SLD-DEV-NUM-WS + JUROS-DIARIOS-WS) *             00093270
093280             (((1 + FATOR-JUROS-PFISICA-WS) /                     00093280
093290               (1 + FATOR-JUR-CE-WS))- 1))                        00093290
093300     ELSE                                                         00093300
093310        IF P-JURIDICAS                                            00093310
093320           IF CH-EMPRESA                                          00093320
093330              COMPUTE GANHO-POTENCIAL-DIARIO-WS =                 00093330
093340                      GANHO-POTENCIAL-DIARIO-WS +                 00093340
093350                    ((SLD-DEV-NUM-WS + JUROS-DIARIOS-WS) *        00093350
093360             (((1 + FATOR-JUROS-PJURIDICA-WS) /                   00093360
093370               (1 + FATOR-JUR-CE-WS))- 1))                        00093370
093380           ELSE                                                   00093380
093390           IF CH-EMPRESA-PP                                       00093390
093400              COMPUTE GANHO-POTENCIAL-DIARIO-WS =                 00093400
093410                      GANHO-POTENCIAL-DIARIO-WS +                 00093410
093420                    ((SLD-DEV-NUM-WS + JUROS-DIARIOS-WS) *        00093420
093430             (((1 + FATOR-JUROS-PJ-PP-WS) /                       00093430
093440               (1 + FATOR-JUR-CE-WS))- 1))                        00093440
093450           ELSE                                                   00093450
093460             IF CTA-EMPRESARIAL                                   00093460
093470                COMPUTE GANHO-POTENCIAL-DIARIO-WS =               00093470
093480                        GANHO-POTENCIAL-DIARIO-WS +               00093480
093490                      ((SLD-DEV-NUM-WS + JUROS-DIARIOS-WS) *      00093490
093500                        TAXA-SPREAD-WS).                          00093500
093510                                                                  00093510
093530 240-35-ENCERRA-AGENCIA.                                          00093530
093540                                                                  00093540
093550     IF  INICIO-MES OR INICIO-ANO                                 00093550
093560         MOVE ZEROS TO INCLUSAO-RED-WS                            00093560
093570                       ALTERACAO-RED-WS                           00093570
093580                       EXCLUSAO-RED-WS.                           00093580
093590     ADD INCLUSAO-WS TO INCLUSAO-RED-WS.                          00093590
093600     ADD ALTERACAO-WS TO ALTERACAO-RED-WS.                        00093600
093610     ADD EXCLUSAO-WS TO EXCLUSAO-RED-WS.                          00093610
093620     MOVE ZEROS TO IND-ATL-TRAILLER.                              00093620
093630     PERFORM 245-35-ATL-TRAILLER-AGENCIA                          00093630
093640         49 TIMES.                                                00093640
093650                                                                  00093650
093660     PERFORM  605-35-OCR-RAZAO                                    00093660
093670         49 TIMES.                                                00093670
093680                                                                  00093680
093690     IF CH-SEQUENCIAL-WS = 2                                      00093690
093700         MOVE ZEROS TO INCLUSAO-WS                                00093700
093710                       ALTERACAO-WS                               00093710
093720                       EXCLUSAO-WS                                00093720
093730                       INCLUSAO-RED-WS                            00093730
093740                       ALTERACAO-RED-WS                           00093740
093750                       EXCLUSAO-RED-WS                            00093750
093760         PERFORM 605-35-OCR-RAZAO                                 00093760
      *
               MOVE SPACES TO REG-PROTOC-D10
               INITIALIZE REG-PROTOC-D10
      *
093770         IF IND-FICHA-RECOLHER GREATER ZERO                       00093770
093780             MOVE 10 TO IND-FICHA-RECOLHER                        00093780
093790             PERFORM 610-35-OCR-FICHA-RECOLHER                    00093790
093800             PERFORM 525-35-OCR-PROTOCOLO 36 TIMES                00093800
093810             PERFORM 625-35-GRAVA-OCR-PROTOCOLO                   00093810
093820         ELSE                                                     00093820
093830             PERFORM 525-35-OCR-PROTOCOLO 36 TIMES                00093830
093840             PERFORM 625-35-GRAVA-OCR-PROTOCOLO.                  00093840
093870*                                                                 00093870
093880 242-TESTA-OCR-FICHA-BLOQUEIO.                                    00093880
093890*                                                                 00093890
093900     PERFORM 242A-TESTA-LISTAO.                                   00093900
093910     IF GERA-FICHA                                                00093910
093920        PERFORM 505-35-OCR-FICHA-CC.                              00093920
093930                                                                  00093930
093940     IF GERA-BLOQUEADO                                            00093940
              MOVE SPACES TO REG-DEP-BLO-D10
              INITIALIZE REG-DEP-BLO-D10
093950        MOVE 35 TO DBLO-COD-MENS-D10                              00093950
093960        PERFORM 535-35-OCR-DEPOSITO-BLOQUEADO.                    00093960
093970                                                                  00093970
093980 242A-TESTA-LISTAO.                                               00093980
093990                                                                  00093990
094000     IF  SEXTA                                                    00094000
094010         MOVE 1 TO SW-GERA-FICHA                                  00094010
094020         MOVE ZEROS TO MOVIMENTACAO-RED-WS                        00094020
094030     ELSE                                                         00094030
094040         IF SEGUNDA                                               00094040
094050            IF  LISTAO-WS NOT EQUAL 2                             00094050
094060                MOVE 1 TO SW-GERA-FICHA                           00094060
094070                MOVE ZEROS TO MOVIMENTACAO-RED-WS                 00094070
094080            ELSE                                                  00094080
094090                NEXT SENTENCE                                     00094090
094100         ELSE                                                     00094100
094110             IF  TERCA                                            00094110
094120                 IF  LISTAO-WS NOT EQUAL 3                        00094120
094130                     MOVE 1 TO SW-GERA-FICHA                      00094130
094140                     MOVE ZEROS TO MOVIMENTACAO-RED-WS            00094140
094150                 ELSE                                             00094150
094160                     NEXT SENTENCE                                00094160
094170             ELSE                                                 00094170
094180                 IF  QUARTA                                       00094180
094190                     IF  LISTAO-WS NOT EQUAL 4                    00094190
094200                         MOVE 1 TO SW-GERA-FICHA                  00094200
094210                         MOVE ZEROS TO MOVIMENTACAO-RED-WS        00094210
094220                     ELSE                                         00094220
094230                         NEXT SENTENCE                            00094230
094240                 ELSE                                             00094240
094250                     IF  QUINTA                                   00094250
094260                         IF  LISTAO-WS NOT EQUAL 5                00094260
094270                             MOVE 1 TO SW-GERA-FICHA              00094270
094280                             MOVE ZEROS TO MOVIMENTACAO-RED-WS    00094280
094290                         ELSE                                     00094290
094300                             NEXT SENTENCE.                       00094300
094310                                                                  00094310
094320     IF  NOT SEXTA                                                00094320
094330         IF  PROXIMO-DIA-FERIADO                                  00094330
094340             MOVE 1 TO SW-GERA-FICHA                              00094340
094350             MOVE ZEROS TO MOVIMENTACAO-RED-WS.                   00094350
094360                                                                  00094360
094370 243-35-CALCULO-JUROS-DIARIOS.                                    00094370
094380                                                                  00094380
094390     MOVE ZEROS TO ACUM-JUROS-PF-WS                               00094390
094400                   ACUM-JUROS-PJ-WS ACUM-JUROS-PJ-PP-WS           00094400
094410                   ACUM-JUROS-CE-WS.                              00094410
094420                                                                  00094420
094430*-------------------------------------------------------          00094430
094440*--- JUROS DE MORA DE 1% AO MES TRANSFORMADO AO DIA ----          00094440
094450*-------------------------------------------------------          00094450
094460                                                                  00094460
094470      COMPUTE HUM-PORCENTO-WS =(((1 / 100) + 1) ** (1 / 30)) - 1. 00094470
094490                                                                  00094490
094500     MOVE ZEROS TO FATOR-VENCIDO-WS.                              00094500
094510                                                                  00094510
094520     IF P-FISICAS                                                 00094520
094530        COMPUTE FATOR-VENCIDO-WS = (((FATOR-JUROS-PFISICA-WS      00094530
094540                      + 1) * (HUM-PORCENTO-WS + 1)) - 1)          00094540
094550     ELSE                                                         00094550
094560      IF P-JURIDICAS                                              00094560
094570       IF CH-EMPRESA                                              00094570
094580          COMPUTE FATOR-VENCIDO-WS = (((FATOR-JUROS-PJURIDICA-WS  00094580
094590                      + 1) * (HUM-PORCENTO-WS + 1)) - 1)          00094590
094600       ELSE                                                       00094600
094610       IF CH-EMPRESA-PP                                           00094610
094620          COMPUTE FATOR-VENCIDO-WS = (((FATOR-JUROS-PJ-PP-WS      00094620
094630                      + 1) * (HUM-PORCENTO-WS + 1)) - 1)          00094630
094640       ELSE                                                       00094640
094650        IF CTA-EMPRESARIAL                                        00094650
094660           COMPUTE FATOR-VENCIDO-WS = (((FATOR-JUROS-CTA-EMPRES-WS00094660
094670                      + 1) * (HUM-PORCENTO-WS + 1)) - 1).         00094670
094680                                                                  00094680
094690***************************************************************** 00094690
094700* CALCULO DOS JUROS QUANDO A CONTA NAO TEM SALDO DEVEDOR        * 00094700
094710***************************************************************** 00094710
094750                                                                  00094750
094760     IF NOT HA-FERIADO                                            00094760
094770        IF CTA-EMPRESARIAL                                        00094770
094780           COMPUTE FATOR-VEZES-SPREAD =                           00094780
094790                   FATOR-JUR-CE-WS * TAXA-SPREAD-WS               00094790
094800           COMPUTE FATOR-JUROS-CTA-EMPRES-WS =                    00094800
094810                   FATOR-JUR-CE-WS + TAXA-SPREAD-WS +             00094810
094820                   FATOR-VEZES-SPREAD.                            00094820

           IF JUROS-DIARIOS-WS GREATER ZEROS
              MULTIPLY -1 BY JUROS-DIARIOS-WS.
094830                                                                  00094830
094840     IF NOT CLIENTE-PREFEREN                                      00094840
094850     IF SLD-DEV-NUM-WS NOT LESS ZEROS AND                         00094850
094860        JUROS-DIARIOS-WS NOT EQUAL ZEROS                          00094860
094870        IF P-FISICAS                                              00094870
094880           COMPUTE DIAS-UTEIS-UTIL-RED-WS = DIAS-UTEIS-UTIL-RED-WS00094880
094890                                            + 1                   00094890
094900           COMPUTE ACUM-JUROS-PF-WS ROUNDED =                     00094900
094910                   JUROS-DIARIOS-WS * FATOR-JUROS-PFISICA-WS      00094910
094920        ELSE                                                      00094920
094930           IF P-JURIDICAS                                         00094930
094940             IF CH-EMPRESA                                        00094940
094950                COMPUTE DIAS-UTEIS-UTIL-RED-WS =                  00094950
094960                                     DIAS-UTEIS-UTIL-RED-WS + 1   00094960
094970                COMPUTE ACUM-JUROS-PJ-WS ROUNDED =                00094970
094980                         JUROS-DIARIOS-WS *                       00094980
094990                         FATOR-JUROS-PJURIDICA-WS                 00094990
095000             ELSE                                                 00095000
095010             IF CH-EMPRESA-PP                                     00095010
095020                COMPUTE DIAS-UTEIS-UTIL-RED-WS =                  00095020
095030                                     DIAS-UTEIS-UTIL-RED-WS + 1   00095030
095040                COMPUTE ACUM-JUROS-PJ-PP-WS ROUNDED =             00095040
095050                         JUROS-DIARIOS-WS *                       00095050
095060                         FATOR-JUROS-PJ-PP-WS                     00095060
095070             ELSE                                                 00095070
095080               IF CTA-EMPRESARIAL                                 00095080
095090                COMPUTE DIAS-UTEIS-UTIL-RED-WS =                  00095090
095100                                     DIAS-UTEIS-UTIL-RED-WS + 1   00095100
095110                COMPUTE ACUM-JUROS-CE-WS ROUNDED =                00095110
095120                            JUROS-DIARIOS-WS *                    00095120
095130                            FATOR-JUROS-CTA-EMPRES-WS.            00095130

095150     IF CLIENTE-PREFEREN                                          00095150
095160     IF SLD-EMP-RED-WS NOT LESS ZEROS AND                         00095160
095170        JUROS-DIARIOS-WS NOT EQUAL ZEROS                          00095170
095180        IF P-FISICAS                                              00095180
095190           COMPUTE DIAS-UTEIS-UTIL-RED-WS =                       00095190
095200                                     DIAS-UTEIS-UTIL-RED-WS + 1   00095200
095210           COMPUTE ACUM-JUROS-PF-WS ROUNDED =                     00095210
095220                                    JUROS-DIARIOS-WS *            00095220
095230                                    FATOR-JUROS-PFISICA-WS        00095230
095240        ELSE                                                      00095240
095250           IF P-JURIDICAS                                         00095250
095260              IF CH-EMPRESA                                       00095260
095270                 COMPUTE DIAS-UTEIS-UTIL-RED-WS =                 00095270
095280                                     DIAS-UTEIS-UTIL-RED-WS + 1   00095280
095290                 COMPUTE ACUM-JUROS-PJ-WS ROUNDED =               00095290
095300                         JUROS-DIARIOS-WS *                       00095300
095310                         FATOR-JUROS-PJURIDICA-WS                 00095310
095320              ELSE                                                00095320
095330              IF CH-EMPRESA-PP                                    00095330
095340                 COMPUTE DIAS-UTEIS-UTIL-RED-WS =                 00095340
095350                                     DIAS-UTEIS-UTIL-RED-WS + 1   00095350
095360                 COMPUTE ACUM-JUROS-PJ-PP-WS ROUNDED =            00095360
095370                         JUROS-DIARIOS-WS *                       00095370
095380                         FATOR-JUROS-PJ-PP-WS                     00095380
095390              ELSE                                                00095390
095400               IF CTA-EMPRESARIAL                                 00095400
095410                COMPUTE DIAS-UTEIS-UTIL-RED-WS =                  00095410
095420                                     DIAS-UTEIS-UTIL-RED-WS + 1   00095420
095430                COMPUTE ACUM-JUROS-CE-WS ROUNDED =                00095430
095440                            JUROS-DIARIOS-WS *                    00095440
095450                            FATOR-JUROS-CTA-EMPRES-WS.            00095450

095460***************************************************************** 00095460
095470* CALCULO DOS JUROS QUANDO A CONTA TEM SALDO DEVEDOR            * 00095470
095480***************************************************************** 00095480
095490                                                                  00095490
095500     IF NOT CLIENTE-PREFEREN                                      00095500
095510        COMPUTE EXCESSO-WS = EMP-LIM-RED-WS + SLD-DEV-NUM-WS      00095510
095520        IF EXCESSO-WS GREATER ZEROS                               00095520
095530           MOVE ZEROS TO EXCESSO-WS.                              00095530
095540                                                                  00095540
095550     IF NOT CLIENTE-PREFEREN                                      00095550
095560     IF SLD-DEV-NUM-WS LESS ZEROS                                 00095560
095570      MOVE EMP-VENC-RED-WS TO DATA-AUX-RED                        00095570
095580      PERFORM 275-35-INVERTE-DATAS                                00095580
095590      IF P-FISICAS                                                00095590
095600         PERFORM 245-35-CALCULO-JUROS-PF                          00095600
095610      ELSE                                                        00095610
095620         IF P-JURIDICAS                                           00095620
095630            PERFORM 245-35-CALCULO-JUROS-PJ.                      00095630
095640                                                                  00095640
095650***************************************************************** 00095650
095660* CALCULO DOS JUROS PARA CLIENTE ESPECIAL                       * 00095660
095670***************************************************************** 00095670
095680     IF CLIENTE-PREFEREN                                          00095680
095690        COMPUTE EXCESSO-WS = EMP-LIM-RED-WS + SLD-EMP-RED-WS      00095690
095700        IF EXCESSO-WS GREATER ZEROS                               00095700
095710           MOVE ZEROS TO EXCESSO-WS.                              00095710

095720     IF CLIENTE-PREFEREN                                          00095720
095730      IF SLD-EMP-RED-WS LESS ZEROS                                00095730
095740         MOVE EMP-VENC-RED-WS TO DATA-AUX-RED                     00095740
095750         PERFORM 275-35-INVERTE-DATAS                             00095750
095760         IF P-FISICAS                                             00095760
095770            PERFORM 245-35-CALCULO-JUROS-PF-CP                    00095770
095780         ELSE                                                     00095780
095790           IF P-JURIDICAS                                         00095790
095800            PERFORM 245-35-CALCULO-JUROS-PJ-CP.                   00095800
095810                                                                  00095810
095820     IF CLIENTE-PREFEREN                                          00095820
095830      COMPUTE SALDO-DEVEDOR-WS = SLD-EMP-RED-WS + JUROS-DIARIOS-WS00095830
095840     ELSE                                                         00095840
095850     IF SLD-DEV-NUM-WS NOT < ZEROS                                00095850
095860        COMPUTE SALDO-DEVEDOR-WS = JUROS-DIARIOS-WS               00095860
095870     ELSE                                                         00095870
095880     COMPUTE SALDO-DEVEDOR-WS = SLD-DEV-NUM-WS + JUROS-DIARIOS-WS.00095880
095890                                                                  00095890
095900     MOVE ZEROS TO ACUM-JUROS-AUX-WS.                             00095900
095910                                                                  00095910
095920     IF P-FISICAS                                                 00095920
095930        COMPUTE JUROS-DIARIOS-WS ROUNDED =                        00095930
095940                JUROS-DIARIOS-WS + ACUM-JUROS-PF-WS               00095940
095950        MOVE FATOR-JUROS-PFISICA-WS TO TAXA-APLICADA-RED-WS       00095950
095960        MOVE ACUM-JUROS-PF-WS TO ACUM-JUROS-AUX-WS                00095960
095970                                 JUROS-DO-DIA-RED-WS              00095970
095980     ELSE                                                         00095980
095990        IF P-JURIDICAS                                            00095990
096000           IF CH-EMPRESA                                          00096000
096010              COMPUTE JUROS-DIARIOS-WS ROUNDED =                  00096010
096020                      JUROS-DIARIOS-WS + ACUM-JUROS-PJ-WS         00096020
096030              MOVE FATOR-JUROS-PJURIDICA-WS TO                    00096030
096040                   TAXA-APLICADA-RED-WS                           00096040
096050              MOVE ACUM-JUROS-PJ-WS TO ACUM-JUROS-AUX-WS          00096050
096060                                       JUROS-DO-DIA-RED-WS        00096060
096070           ELSE                                                   00096070
096080           IF CH-EMPRESA-PP                                       00096080
096090              COMPUTE JUROS-DIARIOS-WS ROUNDED =                  00096090
096100                      JUROS-DIARIOS-WS + ACUM-JUROS-PJ-PP-WS      00096100
096110              MOVE FATOR-JUROS-PJ-PP-WS TO TAXA-APLICADA-RED-WS   00096110
096120              MOVE ACUM-JUROS-PJ-PP-WS TO ACUM-JUROS-AUX-WS       00096120
096130                                          JUROS-DO-DIA-RED-WS     00096130
096140           ELSE                                                   00096140
096150              IF CTA-EMPRESARIAL                                  00096150
096160                 COMPUTE JUROS-DIARIOS-WS ROUNDED =               00096160
096170                         JUROS-DIARIOS-WS + ACUM-JUROS-CE-WS      00096170
096180                 MOVE FATOR-JUROS-CTA-EMPRES-WS TO                00096180
096190                      TAXA-APLICADA-RED-WS                        00096190
096200                 MOVE ACUM-JUROS-CE-WS TO ACUM-JUROS-AUX-WS       00096200
096210                                          JUROS-DO-DIA-RED-WS.    00096210
096220                                                                  00096220
096230*-----------------------------------------------------------------00096230
096240* ACUMULA FATOR DIARIO PARA CALCULO DA TAXA EFETIVA DE UTILIZACAO 00096240
096250* DO CHEQUE ESPECIAL/EMPRESA/CONTA EMPRESARIAL                    00096250
096260*-----------------------------------------------------------------00096260
096270                                                                  00096270
096280     IF SALDO-DEVEDOR-WS = 0                                      00096280
096290        MOVE ZEROS TO FATOR-DIARIO-AUX-WS                         00096290
096300     ELSE                                                         00096300
096310        COMPUTE FATOR-DIARIO-AUX-WS = ACUM-JUROS-AUX-WS /         00096310
096320                                      SALDO-DEVEDOR-WS.           00096320
096330                                                                  00096330
096340     COMPUTE FATOR-ACUMULADO-RED-WS =                             00096340
096350             ((FATOR-DIARIO-AUX-WS + 1) *                         00096350
096360             ((FATOR-ACUMULADO-RED-WS / 100) + 1) - 1) * 100.     00096360
096370                                                                  00096370
096380 245-35-CALCULO-JUROS-PF.                                         00096380
096390                                                                  00096390
096400     IF DATA-AUX-Y2-INV-RED LESS DATA-INVERTIDA-RED               00096400
096410        COMPUTE DIAS-UTEIS-UTIL-RED-WS =                          00096410
096420                DIAS-UTEIS-UTIL-RED-WS + 1                        00096420
096430        IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PF-WS          00096430
096440           COMPUTE ACUM-JUROS-PF-WS ROUNDED =                     00096440
096450                           ((SLD-DEV-NUM-WS  +                    00096450
096460                            JUROS-DIARIOS-WS) *                   00096460
096470                            FATOR-VENCIDO-WS) +                   00096470
096480                            (EXCESSO-WS *                         00096480
096490                            FATOR-EXCESSO-PFISICA-WS)             00096490
096500        ELSE                                                      00096500
096510           COMPUTE ACUM-JUROS-PF-WS ROUNDED =                     00096510
096520                           ((SLD-DEV-NUM-WS  +                    00096520
096530                            JUROS-DIARIOS-WS) *                   00096530
096540                            FATOR-IAC-PF-WS) +                    00096540
096550                            (EXCESSO-WS *                         00096550
096560                            FATOR-EXCESSO-PFISICA-WS)             00096560
096570     ELSE                                                         00096570
096580         COMPUTE DIAS-UTEIS-UTIL-RED-WS =                         00096580
096590                 DIAS-UTEIS-UTIL-RED-WS + 1                       00096590
096600         COMPUTE ACUM-JUROS-PF-WS ROUNDED =                       00096600
096610                        ((SLD-DEV-NUM-WS  +                       00096610
096620                        JUROS-DIARIOS-WS) *                       00096620
096630                        FATOR-JUROS-PFISICA-WS) +                 00096630
096640                        (EXCESSO-WS * FATOR-EXCESSO-PFISICA-WS).  00096640
096650                                                                  00096650
096660 245-35-CALCULO-JUROS-PJ.                                         00096660
096670                                                                  00096670
096680     IF CH-EMPRESA                                                00096680
096690        IF DATA-AUX-Y2-INV-RED LESS DATA-INVERTIDA-RED            00096690
096700           COMPUTE DIAS-UTEIS-UTIL-RED-WS =                       00096700
096710                   DIAS-UTEIS-UTIL-RED-WS + 1                     00096710
096720           IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PJ-WS       00096720
096730              COMPUTE ACUM-JUROS-PJ-WS ROUNDED =                  00096730
096740                            ((SLD-DEV-NUM-WS  +                   00096740
096750                            JUROS-DIARIOS-WS) *                   00096750
096760                            FATOR-VENCIDO-WS) +                   00096760
096770                            (EXCESSO-WS *                         00096770
096780                            FATOR-EXCESSO-PJURIDICA-WS)           00096780
096790           ELSE                                                   00096790
096800              COMPUTE ACUM-JUROS-PJ-WS ROUNDED =                  00096800
096810                            ((SLD-DEV-NUM-WS  +                   00096810
096820                            JUROS-DIARIOS-WS) *                   00096820
096830                            FATOR-IAC-PJ-WS) +                    00096830
096840                            (EXCESSO-WS *                         00096840
096850                            FATOR-EXCESSO-PJURIDICA-WS)           00096850
096860        ELSE                                                      00096860
096870          COMPUTE DIAS-UTEIS-UTIL-RED-WS =                        00096870
096880                  DIAS-UTEIS-UTIL-RED-WS + 1                      00096880
096890          COMPUTE ACUM-JUROS-PJ-WS ROUNDED =                      00096890
096900                            ((SLD-DEV-NUM-WS  +                   00096900
096910                            JUROS-DIARIOS-WS) *                   00096910
096920                            FATOR-JUROS-PJURIDICA-WS) +           00096920
096930                            (EXCESSO-WS *                         00096930
096940                            FATOR-EXCESSO-PJURIDICA-WS).          00096940

096950     IF CH-EMPRESA-PP                                             00096950
096960        IF DATA-AUX-Y2-INV-RED LESS DATA-INVERTIDA-RED            00096960
096970           COMPUTE DIAS-UTEIS-UTIL-RED-WS =                       00096970
096980                   DIAS-UTEIS-UTIL-RED-WS + 1                     00096980
096990           IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PJ-WS       00096990
097000              COMPUTE ACUM-JUROS-PJ-PP-WS ROUNDED =               00097000
097010                            ((SLD-DEV-NUM-WS  +                   00097010
097020                            JUROS-DIARIOS-WS) *                   00097020
097030                            FATOR-VENCIDO-WS) +                   00097030
097040                            (EXCESSO-WS *                         00097040
097050                            FATOR-EXCESSO-PJURIDICA-WS)           00097050
097060           ELSE                                                   00097060
097070              COMPUTE ACUM-JUROS-PJ-PP-WS ROUNDED =               00097070
097080                            ((SLD-DEV-NUM-WS  +                   00097080
097090                            JUROS-DIARIOS-WS) *                   00097090
097100                            FATOR-IAC-PJ-WS) +                    00097100
097110                            (EXCESSO-WS *                         00097110
097120                            FATOR-EXCESSO-PJURIDICA-WS)           00097120
097130        ELSE                                                      00097130
097140          COMPUTE DIAS-UTEIS-UTIL-RED-WS =                        00097140
097150                  DIAS-UTEIS-UTIL-RED-WS + 1                      00097150
097160          COMPUTE ACUM-JUROS-PJ-PP-WS ROUNDED =                   00097160
097170                            ((SLD-DEV-NUM-WS  +                   00097170
097180                            JUROS-DIARIOS-WS) *                   00097180
097190                            FATOR-JUROS-PJ-PP-WS) +               00097190
097200                            (EXCESSO-WS *                         00097200
097210                            FATOR-EXCESSO-PJURIDICA-WS).          00097210
097220                                                                  00097220
097230      IF CTA-EMPRESARIAL                                          00097230
097240         IF DATA-AUX-Y2-INV-RED LESS DATA-INVERTIDA-RED           00097240
097250            COMPUTE DIAS-UTEIS-UTIL-RED-WS =                      00097250
097260                    DIAS-UTEIS-UTIL-RED-WS + 1                    00097260
097270            IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PJ-WS      00097270
097280               COMPUTE ACUM-JUROS-CE-WS ROUNDED =                 00097280
097290                               ((SLD-DEV-NUM-WS  +                00097290
097300                               JUROS-DIARIOS-WS) *                00097300
097310                               FATOR-VENCIDO-WS) +                00097310
097320                               (EXCESSO-WS *                      00097320
097330                               FATOR-EXCESSO-PJURIDICA-WS)        00097330
097340            ELSE                                                  00097340
097350               COMPUTE ACUM-JUROS-CE-WS ROUNDED =                 00097350
097360                               ((SLD-DEV-NUM-WS  +                00097360
097370                               JUROS-DIARIOS-WS) *                00097370
097380                               FATOR-IAC-PJ-WS) +                 00097380
097390                               (EXCESSO-WS *                      00097390
097400                               FATOR-EXCESSO-PJURIDICA-WS)        00097400
097410          ELSE                                                    00097410
097420             COMPUTE DIAS-UTEIS-UTIL-RED-WS =                     00097420
097430                     DIAS-UTEIS-UTIL-RED-WS + 1                   00097430
097440             COMPUTE ACUM-JUROS-CE-WS ROUNDED =                   00097440
097450                               ((SLD-DEV-NUM-WS  +                00097450
097460                               JUROS-DIARIOS-WS) *                00097460
097470                               FATOR-JUROS-CTA-EMPRES-WS) +       00097470
097480                               (EXCESSO-WS *                      00097480
097490                               FATOR-EXCESSO-PJURIDICA-WS).       00097490
097500                                                                  00097500
097510 245-35-CALCULO-JUROS-PF-CP.                                      00097510
097520                                                                  00097520
097530      IF DATA-AUX-Y2-INV-RED LESS DATA-INVERTIDA-RED              00097530
097540         COMPUTE DIAS-UTEIS-UTIL-RED-WS =                         00097540
097550                 DIAS-UTEIS-UTIL-RED-WS + 1                       00097550
097560       IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PF-WS           00097560
097570          COMPUTE ACUM-JUROS-PF-WS ROUNDED =                      00097570
097580                           ((SLD-EMP-RED-WS  +                    00097580
097590                            JUROS-DIARIOS-WS) *                   00097590
097600                            FATOR-VENCIDO-WS) +                   00097600
097610                            (EXCESSO-WS *                         00097610
097620                            FATOR-EXCESSO-PFISICA-WS)             00097620
097630       ELSE                                                       00097630
097640          COMPUTE ACUM-JUROS-PF-WS ROUNDED =                      00097640
097650                           ((SLD-EMP-RED-WS  +                    00097650
097660                            JUROS-DIARIOS-WS) *                   00097660
097670                            FATOR-IAC-PF-WS) +                    00097670
097680                            (EXCESSO-WS *                         00097680
097690                            FATOR-EXCESSO-PFISICA-WS)             00097690
097700      ELSE                                                        00097700
097710       COMPUTE DIAS-UTEIS-UTIL-RED-WS =                           00097710
097720                         DIAS-UTEIS-UTIL-RED-WS + 1               00097720
097730       COMPUTE ACUM-JUROS-PF-WS ROUNDED =                         00097730
097740                        ((SLD-EMP-RED-WS  +                       00097740
097750                        JUROS-DIARIOS-WS) *                       00097750
097760                        FATOR-JUROS-PFISICA-WS) +                 00097760
097770                        (EXCESSO-WS * FATOR-EXCESSO-PFISICA-WS).  00097770
097780                                                                  00097780
097790 245-35-CALCULO-JUROS-PJ-CP.                                      00097790
097800                                                                  00097800
097810     IF CH-EMPRESA                                                00097810
097820        IF DATA-AUX-Y2-INV-RED LESS DATA-INVERTIDA-RED            00097820
097830           COMPUTE DIAS-UTEIS-UTIL-RED-WS =                       00097830
097840                         DIAS-UTEIS-UTIL-RED-WS + 1               00097840
097850           IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PJ-WS       00097850
097860              COMPUTE ACUM-JUROS-PJ-WS ROUNDED =                  00097860
097870                            ((SLD-EMP-RED-WS  +                   00097870
097880                              JUROS-DIARIOS-WS) *                 00097880
097890                            FATOR-VENCIDO-WS) +                   00097890
097900                            (EXCESSO-WS *                         00097900
097910                            FATOR-EXCESSO-PJURIDICA-WS)           00097910
097920           ELSE                                                   00097920
097930              COMPUTE ACUM-JUROS-PJ-WS ROUNDED =                  00097930
097940                            ((SLD-EMP-RED-WS  +                   00097940
097950                              JUROS-DIARIOS-WS) *                 00097950
097960                            FATOR-IAC-PJ-WS) +                    00097960
097970                            (EXCESSO-WS *                         00097970
097980                            FATOR-EXCESSO-PJURIDICA-WS)           00097980
097990        ELSE                                                      00097990
098000          COMPUTE DIAS-UTEIS-UTIL-RED-WS =                        00098000
098010                         DIAS-UTEIS-UTIL-RED-WS + 1               00098010
098020          COMPUTE ACUM-JUROS-PJ-WS ROUNDED =                      00098020
098030                            ((SLD-EMP-RED-WS  +                   00098030
098040                            JUROS-DIARIOS-WS) *                   00098040
098050                            FATOR-JUROS-PJURIDICA-WS) +           00098050
098060                            (EXCESSO-WS *                         00098060
098070                            FATOR-EXCESSO-PJURIDICA-WS).          00098070
098080                                                                  00098080
098090     IF CH-EMPRESA-PP                                             00098090
098100        IF DATA-AUX-Y2-INV-RED LESS DATA-INVERTIDA-RED            00098100
098110           COMPUTE DIAS-UTEIS-UTIL-RED-WS =                       00098110
098120                         DIAS-UTEIS-UTIL-RED-WS + 1               00098120
098130           IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PJ-WS       00098130
098140              COMPUTE ACUM-JUROS-PJ-PP-WS ROUNDED =               00098140
098150                            ((SLD-EMP-RED-WS  +                   00098150
098160                              JUROS-DIARIOS-WS) *                 00098160
098170                            FATOR-VENCIDO-WS) +                   00098170
098180                            (EXCESSO-WS *                         00098180
098190                            FATOR-EXCESSO-PJURIDICA-WS)           00098190
098200           ELSE                                                   00098200
098210              COMPUTE ACUM-JUROS-PJ-PP-WS ROUNDED =               00098210
098220                            ((SLD-EMP-RED-WS  +                   00098220
098230                              JUROS-DIARIOS-WS) *                 00098230
098240                            FATOR-IAC-PJ-WS) +                    00098240
098250                            (EXCESSO-WS *                         00098250
098260                            FATOR-EXCESSO-PJURIDICA-WS)           00098260
098270        ELSE                                                      00098270
098280          COMPUTE DIAS-UTEIS-UTIL-RED-WS =                        00098280
098290                         DIAS-UTEIS-UTIL-RED-WS + 1               00098290
098300          COMPUTE ACUM-JUROS-PJ-PP-WS ROUNDED =                   00098300
098310                            ((SLD-EMP-RED-WS  +                   00098310
098320                            JUROS-DIARIOS-WS) *                   00098320
098330                            FATOR-JUROS-PJ-PP-WS) +               00098330
098340                            (EXCESSO-WS *                         00098340
098350                            FATOR-EXCESSO-PJURIDICA-WS).          00098350
098360                                                                  00098360
098370     IF CTA-EMPRESARIAL                                           00098370
098380        IF DATA-AUX-Y2-INV-RED LESS DATA-INVERTIDA-RED            00098380
098390           COMPUTE DIAS-UTEIS-UTIL-RED-WS =                       00098390
098400                        DIAS-UTEIS-UTIL-RED-WS + 1                00098400
098410           IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PJ-WS       00098410
098420              COMPUTE ACUM-JUROS-CE-WS ROUNDED =                  00098420
098430                              ((SLD-EMP-RED-WS  +                 00098430
098440                               JUROS-DIARIOS-WS) *                00098440
098450                               FATOR-VENCIDO-WS) +                00098450
098460                               (EXCESSO-WS *                      00098460
098470                               FATOR-EXCESSO-PJURIDICA-WS)        00098470
098480           ELSE                                                   00098480
098490              COMPUTE ACUM-JUROS-CE-WS ROUNDED =                  00098490
098500                               ((SLD-EMP-RED-WS  +                00098500
098510                               JUROS-DIARIOS-WS) *                00098510
098520                               FATOR-IAC-PJ-WS) +                 00098520
098530                               (EXCESSO-WS *                      00098530
098540                               FATOR-EXCESSO-PJURIDICA-WS)        00098540
098550        ELSE                                                      00098550
098560           COMPUTE DIAS-UTEIS-UTIL-RED-WS =                       00098560
098570                        DIAS-UTEIS-UTIL-RED-WS + 1                00098570
098580           COMPUTE ACUM-JUROS-CE-WS ROUNDED =                     00098580
098590                               ((SLD-EMP-RED-WS  +                00098590
098600                               JUROS-DIARIOS-WS) *                00098600
098610                               FATOR-JUROS-CTA-EMPRES-WS) +       00098610
098620                               (EXCESSO-WS *                      00098620
098630                               FATOR-EXCESSO-PJURIDICA-WS).       00098630
098640                                                                  00098640
094360************************ 2o. SPRINT ******************************00094360
094370 243-38-CALCULO-JUROS-DEVOL.                                      00094370
094380                                                                  00094380
            IF SLD-DEV-ANT-DEVOL-WS GREATER LIMITE-ANTERIOR-WS
095510         COMPUTE EXCESSO-ANT-WS = LIMITE-ANTERIOR-WS -            00095510
                                        SLD-DEV-ANT-DEVOL-WS
            ELSE
               MOVE ZEROS              TO EXCESSO-ANT-WS.

            IF SLD-DEVOL-WS GREATER SLD-DEV-ANT-DEVOL-WS
               MOVE SLD-DEV-ANT-DEVOL-WS TO SLD-DEVOL-NUM-WS
            ELSE
               MOVE SLD-DEVOL-WS   TO SLD-DEVOL-NUM-WS
            END-IF.

            IF SLD-DEVOL-WS GREATER EXCESSO-ANT-WS
               MOVE EXCESSO-ANT-WS     TO SLD-DEVOL-EXCESSO-ANT-WS
            ELSE
               MOVE SLD-DEVOL-WS   TO SLD-DEVOL-EXCESSO-ANT-WS
            END-IF.

            IF SLD-DEVOL-WS GREATER SLD-EMP-ANT-WS
               MOVE SLD-EMP-ANT-WS     TO SLD-DEVOL-EMP-ANT-WS
            ELSE
               MOVE SLD-DEVOL-WS   TO SLD-DEVOL-EMP-ANT-WS
            END-IF.

094390      MOVE ZEROS TO VLR-JUROS-DEVOL-PF-WS                         00094390
094400                    VLR-JUROS-DEVOL-PJ-WS                         00094400
094400                    VLR-JUROS-DEVOL-PJ-PP-WS                      00094400
094410                    VLR-JUROS-DEVOL-CE-WS.                        00094410
094420                                                                  00094420
094430*-------------------------------------------------------          00094430
094440*--- JUROS DE MORA DE 1% AO MES TRANSFORMADO AO DIA ----          00094440
094450*-------------------------------------------------------          00094450
094460                                                                  00094460
094470      COMPUTE HUM-PORCENTO-WS =(((1 / 100) + 1) ** (1 / 30)) - 1. 00094470
094490                                                                  00094490
094500      MOVE ZEROS TO FATOR-VENCIDO-ANT-WS.                         00094500
094510                                                                  00094510
094520      IF P-FISICAS                                                00094520
094530         COMPUTE FATOR-VENCIDO-ANT-WS =                           00094530
094530                    (((FATOR-JUROS-PFISICA-ANT-WS + 1) *          00094530
094540                      (HUM-PORCENTO-WS + 1)) - 1)                 00094540
094550      ELSE                                                        00094550
094560         IF P-JURIDICAS                                           00094560
094570            IF CH-EMPRESA                                         00094570
094580               COMPUTE FATOR-VENCIDO-ANT-WS =                     00094580
094580                   (((FATOR-JUROS-PJURIDICA-ANT-WS                00094580
094590                      + 1) * (HUM-PORCENTO-WS + 1)) - 1)          00094590
094600            ELSE                                                  00094600
094610               IF CH-EMPRESA-PP                                   00094610
094620                  COMPUTE FATOR-VENCIDO-ANT-WS =                  00094620
094620                      (((FATOR-JUROS-PJ-PP-ANT-WS                 00094620
094630                         + 1) * (HUM-PORCENTO-WS + 1)) - 1)       00094630
094640               ELSE                                               00094640
094650                  IF CTA-EMPRESARIAL                              00094650
094660                     COMPUTE FATOR-VENCIDO-ANT-WS =               00094660
094660                         (((FATOR-JUROS-CTA-EMPRES-WS             00094660
094670                            + 1) * (HUM-PORCENTO-WS + 1)) - 1)    00094670
094680                  END-IF                                          00094680
094680               END-IF                                             00094680
094680            END-IF                                                00094680
094680         END-IF                                                   00094680
094680      END-IF.                                                     00094680
094680                                                                  00094680
095460***************************************************************** 00095460
095470* CALCULO DOS JUROS QUANDO A CONTA TEM SALDO DEVEDOR            * 00095470
095480***************************************************************** 00095480
095540                                                                  00095540
095550     IF NOT CLIENTE-PREFEREN                                      00095550
095570        MOVE EMP-VENC-RED-WS TO DATA-AUX-RED                      00095570
095580        PERFORM 275-35-INVERTE-DATAS                              00095580
095590        IF P-FISICAS                                              00095590
095600           PERFORM 245-35-CALCULO-JUROS-DEVOL-PF                  00095600
095610        ELSE                                                      00095610
095620           IF P-JURIDICAS                                         00095620
095630              PERFORM 245-35-CALCULO-JUROS-DEVOL-PJ               00095630
095490           END-IF                                                 00095490
095490        END-IF                                                    00095490
095490     END-IF.                                                      00095490
095640                                                                  00095640
095650***************************************************************** 00095650
095660* CALCULO DOS JUROS PARA CLIENTE ESPECIAL                       * 00095660
095670***************************************************************** 00095670
095640                                                                  00095640
095720     IF CLIENTE-PREFEREN                                          00095720
095740        MOVE EMP-VENC-RED-WS TO DATA-AUX-RED                      00095740
095750        PERFORM 275-35-INVERTE-DATAS                              00095750
095760        IF P-FISICAS                                              00095760
095770           PERFORM 245-35-CALC-JUROS-DEVOL-PF-CP                  00095770
095780        ELSE                                                      00095780
095790           IF P-JURIDICAS                                         00095790
095800              PERFORM 245-35-CALC-JUROS-DEVOL-PJ-CP               00095800
095810           END-IF                                                 00095810
095810        END-IF                                                    00095810
095810     END-IF.                                                      00095810
095810                                                                  00095810
095920     IF P-FISICAS                                                 00095920
095930        COMPUTE JUROS-DIARIOS-WS ROUNDED =                        00095930
095940             JUROS-DIARIOS-WS + VLR-JUROS-DEVOL-PF-WS             00095940
095960        COMPUTE JUROS-DO-DIA-RED-WS ROUNDED =                     00095960
095960             JUROS-DO-DIA-RED-WS + VLR-JUROS-DEVOL-PF-WS          00095960
095980     ELSE                                                         00095980
095990        IF P-JURIDICAS                                            00095990
096000           IF CH-EMPRESA                                          00096000
096010              COMPUTE JUROS-DIARIOS-WS ROUNDED =                  00096010
096020                   JUROS-DIARIOS-WS + VLR-JUROS-DEVOL-PJ-WS       00096020
096050              COMPUTE JUROS-DO-DIA-RED-WS ROUNDED =               00096050
096050                   JUROS-DO-DIA-RED-WS + VLR-JUROS-DEVOL-PJ-WS    00096050
096070           ELSE                                                   00096070
096080              IF CH-EMPRESA-PP                                    00096080
096090                 COMPUTE JUROS-DIARIOS-WS ROUNDED =               00096090
096100                   JUROS-DIARIOS-WS + VLR-JUROS-DEVOL-PJ-PP-WS    00096100
096120                 COMPUTE JUROS-DO-DIA-RED-WS ROUNDED =            00096120
096130                   JUROS-DO-DIA-RED-WS +                          00096130
096130                   VLR-JUROS-DEVOL-PJ-PP-WS                       00096130
096140              ELSE                                                00096140
096150                 IF CTA-EMPRESARIAL                               00096150
096160                    COMPUTE JUROS-DIARIOS-WS ROUNDED =            00096160
096170                      JUROS-DIARIOS-WS + VLR-JUROS-DEVOL-CE-WS    00096170
096200                    COMPUTE JUROS-DO-DIA-RED-WS ROUNDED =         00096200
096210                      JUROS-DO-DIA-RED-WS +                       00096210
096210                      VLR-JUROS-DEVOL-CE-WS                       00096210
095810                 END-IF                                           00095810
095810              END-IF                                              00095810
095810           END-IF                                                 00095810
095810        END-IF                                                    00095810
095810     END-IF.                                                      00095810

           IF JUROS-DIARIOS-WS GREATER ZEROS
              MOVE ZEROS      TO JUROS-DIARIOS-WS.
095810                                                                  00095810
095890 245-35-CALCULO-JUROS-DEVOL-PF.                                   00095890
096390                                                                  00096390
           MOVE FATOR-IAC-PF-WS        TO FATOR-INSUF-PF-ANT-WS.

096400     IF DATA-AUX-Y2-INV-DEVOL-RED LESS DATA-INVERTIDA-DEVOL-RED   00096400
096430        IF FATOR-VENCIDO-ANT-WS GREATER THAN FATOR-INSUF-PF-ANT-WS00096430
096440           COMPUTE VLR-JUROS-DEVOL-PF-WS ROUNDED =                00096440
096450                           ((SLD-DEVOL-NUM-WS *                   00096450
096470                             FATOR-VENCIDO-ANT-WS) +              00096470
096480                            (SLD-DEVOL-EXCESSO-ANT-WS *           00096480
096490                             FATOR-EXCESSO-PF-ANT-WS))            00096490
096500        ELSE                                                      00096500
096510           COMPUTE VLR-JUROS-DEVOL-PF-WS ROUNDED =                00096510
096520                           ((SLD-DEVOL-NUM-WS *                   00096520
096540                             FATOR-INSUF-PF-ANT-WS) +             00096540
096550                            (SLD-DEVOL-EXCESSO-ANT-WS *           00096550
096560                             FATOR-EXCESSO-PF-ANT-WS))            00096560
096650        END-IF                                                    00096650
096570     ELSE                                                         00096570
096600         COMPUTE VLR-JUROS-DEVOL-PF-WS ROUNDED =                  00096600
096610                           ((SLD-DEVOL-NUM-WS *                   00096610
096630                             FATOR-JUROS-PFISICA-ANT-WS) +        00096630
096640                            (SLD-DEVOL-EXCESSO-ANT-WS *           00096640
096640                             FATOR-EXCESSO-PF-ANT-WS))            00096640
096650     END-IF.                                                      00096650
096650                                                                  00096650
           MOVE VLR-JUROS-DEVOL-PF-WS  TO JUR-DEVOL-1DIA-WS.

096650 245-35-CALCULO-JUROS-DEVOL-PJ.                                   00096650
096670                                                                  00096670
           MOVE FATOR-IAC-PJ-WS      TO FATOR-INSUF-PJ-ANT-WS.

096680     IF CH-EMPRESA                                                00096680
096690        IF DATA-AUX-Y2-INV-DEVOL-RED LESS DATA-INVERTIDA-DEVOL-RED00096690
096720           IF FATOR-VENCIDO-ANT-WS GREATER THAN                   00096720
096720                                       FATOR-INSUF-PJ-ANT-WS      00096720
096730              COMPUTE VLR-JUROS-DEVOL-PJ-WS ROUNDED =             00096730
096740                            ((SLD-DEVOL-NUM-WS  *                 00096740
096760                              FATOR-VENCIDO-ANT-WS) +             00096760
096770                             (SLD-DEVOL-EXCESSO-ANT-WS *          00096770
096780                              FATOR-EXCESSO-PJ-ANT-WS))           00096780
096790           ELSE                                                   00096790
096800              COMPUTE VLR-JUROS-DEVOL-PJ-WS ROUNDED =             00096800
096810                            ((SLD-DEVOL-NUM-WS *                  00096810
096830                              FATOR-INSUF-PJ-ANT-WS) +            00096830
096840                             (SLD-DEVOL-EXCESSO-ANT-WS *          00096840
096850                              FATOR-EXCESSO-PJ-ANT-WS))           00096850
096670           END-IF                                                 00096670
096860        ELSE                                                      00096860
096890          COMPUTE VLR-JUROS-DEVOL-PJ-WS ROUNDED =                 00096890
096900                            ((SLD-DEVOL-NUM-WS *                  00096900
096920                              FATOR-JUROS-PJURIDICA-ANT-WS) +     00096920
096930                             (SLD-DEVOL-EXCESSO-ANT-WS *          00096930
096940                              FATOR-EXCESSO-PJ-ANT-WS))           00096940
096670        END-IF                                                    00096670
              MOVE VLR-JUROS-DEVOL-PJ-WS    TO JUR-DEVOL-1DIA-WS
096670     END-IF.                                                      00096670
096670                                                                  00096670
096950     IF CH-EMPRESA-PP                                             00096950
096960        IF DATA-AUX-Y2-INV-DEVOL-RED LESS DATA-INVERTIDA-DEVOL-RED00096960
096990           IF FATOR-VENCIDO-ANT-WS GREATER THAN                   00096990
096990                                         FATOR-INSUF-PJ-ANT-WS    00096990
097000              COMPUTE VLR-JUROS-DEVOL-PJ-PP-WS ROUNDED =          00097000
097010                            ((SLD-DEVOL-NUM-WS  *                 00097010
097030                              FATOR-VENCIDO-ANT-WS) +             00097030
097040                             (SLD-DEVOL-EXCESSO-ANT-WS *          00097040
097050                              FATOR-EXCESSO-PJ-ANT-WS))           00097050
097060           ELSE                                                   00097060
097070              COMPUTE VLR-JUROS-DEVOL-PJ-PP-WS ROUNDED =          00097070
097080                            ((SLD-DEVOL-NUM-WS  *                 00097080
097100                              FATOR-INSUF-PJ-ANT-WS) +            00097100
097110                             (SLD-DEVOL-EXCESSO-ANT-WS *          00097110
097120                              FATOR-EXCESSO-PJ-ANT-WS))           00097120
097220           END-IF                                                 00097220
097130        ELSE                                                      00097130
097160           COMPUTE VLR-JUROS-DEVOL-PJ-PP-WS ROUNDED =             00097160
097170                            ((SLD-DEVOL-NUM-WS  *                 00097170
097190                              FATOR-JUROS-PJ-PP-ANT-WS) +         00097190
097200                             (SLD-DEVOL-EXCESSO-ANT-WS *          00097200
097210                              FATOR-EXCESSO-PJ-ANT-WS))           00097210
097220        END-IF                                                    00097220
              MOVE VLR-JUROS-DEVOL-PJ-PP-WS TO JUR-DEVOL-1DIA-WS
097220     END-IF.                                                      00097220
097220                                                                  00097220
097230     IF CTA-EMPRESARIAL                                           00097230
097240        IF DATA-AUX-Y2-INV-DEVOL-RED LESS DATA-INVERTIDA-DEVOL-RED00097240
097270           IF FATOR-VENCIDO-ANT-WS GREATER THAN                   00097270
097270                                         FATOR-INSUF-PJ-ANT-WS    00097270
097280              COMPUTE VLR-JUROS-DEVOL-CE-WS ROUNDED =             00097280
097290                              ((SLD-DEVOL-NUM-WS  *               00097290
097310                                FATOR-VENCIDO-ANT-WS) +           00097310
097320                               (SLD-DEVOL-EXCESSO-ANT-WS *        00097320
097330                                FATOR-EXCESSO-PJ-ANT-WS))         00097330
097340           ELSE                                                   00097340
097350              COMPUTE VLR-JUROS-DEVOL-CE-WS ROUNDED =             00097350
097360                              ((SLD-DEVOL-NUM-WS  *               00097360
097380                                FATOR-IAC-PJ-WS) +                00097380
097390                               (SLD-DEVOL-EXCESSO-ANT-WS *        00097390
097400                                FATOR-EXCESSO-PJ-ANT-WS))         00097400
097220           END-IF                                                 00097220
097410        ELSE                                                      00097410
097440           COMPUTE VLR-JUROS-DEVOL-CE-WS ROUNDED =                00097440
097450                              ((SLD-DEVOL-NUM-WS  *               00097450
097470                                FATOR-JUROS-CTA-EMPRES-WS) +      00097470
097480                               (SLD-DEVOL-EXCESSO-ANT-WS *        00097480
097490                                FATOR-EXCESSO-PJ-ANT-WS))         00097490
097220        END-IF                                                    00097220
              MOVE VLR-JUROS-DEVOL-CE-WS    TO JUR-DEVOL-1DIA-WS
097220     END-IF.                                                      00097220
097500                                                                  00097500
096650 245-35-CALC-JUROS-DEVOL-PF-CP.                                   00096650
097520                                                                  00097520
           MOVE FATOR-IAC-PF-WS        TO FATOR-INSUF-PF-ANT-WS

097530      IF DATA-AUX-Y2-INV-DEVOL-RED LESS DATA-INVERTIDA-DEVOL-RED  00097530
097560         IF FATOR-VENCIDO-ANT-WS GREATER THAN                     00097560
097560                                         FATOR-INSUF-PF-ANT-WS    00097560
097570            COMPUTE VLR-JUROS-DEVOL-PF-WS ROUNDED =               00097570
097580                               ((SLD-DEVOL-NUM-WS  *              00097580
097600                                 FATOR-VENCIDO-ANT-WS) +          00097600
097610                                (SLD-DEVOL-EXCESSO-ANT-WS *       00097610
097620                                 FATOR-EXCESSO-PF-ANT-WS))        00097620
097630         ELSE                                                     00097630
097640            COMPUTE VLR-JUROS-DEVOL-PF-WS ROUNDED =               00097640
097650                               ((SLD-DEVOL-NUM-WS  *              00097650
097670                                 FATOR-INSUF-PF-ANT-WS) +         00097670
097680                                (SLD-DEVOL-EXCESSO-ANT-WS *       00097680
097690                                 FATOR-EXCESSO-PF-ANT-WS))        00097690
097220         END-IF                                                   00097220
097700      ELSE                                                        00097700
097730         COMPUTE VLR-JUROS-DEVOL-PF-WS ROUNDED =                  00097730
097740                               ((SLD-DEVOL-NUM-WS  *              00097740
097760                                 FATOR-JUROS-PFISICA-ANT-WS) +    00097760
097770                                (SLD-DEVOL-EXCESSO-ANT-WS *       00097770
097770                                 FATOR-EXCESSO-PF-ANT-WS))        00097770
097220      END-IF                                                      00097220
097780                                                                  00097780
            MOVE VLR-JUROS-DEVOL-PF-WS    TO JUR-DEVOL-1DIA-WS.

096650 245-35-CALC-JUROS-DEVOL-PJ-CP.                                   00096650

            MOVE FATOR-IAC-PJ-WS      TO FATOR-INSUF-PJ-ANT-WS
097800                                                                  00097800
097810     IF CH-EMPRESA                                                00097810
097820        IF DATA-AUX-Y2-INV-DEVOL-RED LESS DATA-INVERTIDA-DEVOL-RED00097820
097850           IF FATOR-VENCIDO-ANT-WS GREATER THAN                   00097850
097850                                         FATOR-INSUF-PJ-ANT-WS    00097850
097860              COMPUTE VLR-JUROS-DEVOL-PJ-WS ROUNDED =             00097860
097870                            ((SLD-DEVOL-NUM-WS  *                 00097870
097890                              FATOR-VENCIDO-ANT-WS) +             00097890
097900                             (SLD-DEVOL-EXCESSO-ANT-WS *          00097900
097910                              FATOR-EXCESSO-PJ-ANT-WS))           00097910
097920           ELSE                                                   00097920
097930              COMPUTE VLR-JUROS-DEVOL-PJ-WS ROUNDED =             00097930
097940                            ((SLD-DEVOL-NUM-WS  *                 00097940
097960                              FATOR-INSUF-PJ-ANT-WS) +            00097960
097970                             (SLD-DEVOL-EXCESSO-ANT-WS *          00097970
097980                              FATOR-EXCESSO-PJ-ANT-WS))           00097980
097220           END-IF                                                 00097220
097990        ELSE                                                      00097990
098020          COMPUTE VLR-JUROS-DEVOL-PJ-WS ROUNDED =                 00098020
098030                            ((SLD-DEVOL-NUM-WS  *                 00098030
098050                              FATOR-JUROS-PJURIDICA-ANT-WS) +     00098050
098060                             (SLD-DEVOL-EXCESSO-ANT-WS *          00098060
098070                              FATOR-EXCESSO-PJ-ANT-WS))           00098070
097220        END-IF                                                    00097220
              MOVE VLR-JUROS-DEVOL-PJ-WS    TO JUR-DEVOL-1DIA-WS
097220     END-IF.                                                      00097220
098080                                                                  00098080
098090     IF CH-EMPRESA-PP                                             00098090
098100        IF DATA-AUX-Y2-INV-DEVOL-RED LESS DATA-INVERTIDA-DEVOL-RED00098100
098130           IF FATOR-VENCIDO-ANT-WS GREATER THAN                   00098130
098130                                         FATOR-INSUF-PJ-ANT-WS    00098130
098140              COMPUTE VLR-JUROS-DEVOL-PJ-PP-WS ROUNDED =          00098140
098150                            ((SLD-DEVOL-NUM-WS  *                 00098150
098170                              FATOR-VENCIDO-ANT-WS) +             00098170
098180                             (SLD-DEVOL-EXCESSO-ANT-WS *          00098180
098190                              FATOR-EXCESSO-PJ-ANT-WS))           00098190
098200           ELSE                                                   00098200
098210              COMPUTE VLR-JUROS-DEVOL-PJ-PP-WS ROUNDED =          00098210
098220                            ((SLD-DEVOL-NUM-WS  *                 00098220
098240                              FATOR-INSUF-PJ-ANT-WS) +            00098240
098250                             (SLD-DEVOL-EXCESSO-ANT-WS *          00098250
098260                              FATOR-EXCESSO-PJ-ANT-WS))           00098260
097220           END-IF                                                 00097220
098270        ELSE                                                      00098270
098300           COMPUTE VLR-JUROS-DEVOL-PJ-PP-WS ROUNDED =             00098300
098310                            ((SLD-DEVOL-NUM-WS  *                 00098310
098330                              FATOR-JUROS-PJ-PP-ANT-WS) +         00098330
098340                             (SLD-DEVOL-EXCESSO-ANT-WS *          00098340
098350                              FATOR-EXCESSO-PJ-ANT-WS))           00098350
097220        END-IF                                                    00097220
              MOVE VLR-JUROS-DEVOL-PJ-PP-WS TO JUR-DEVOL-1DIA-WS
097220     END-IF.                                                      00097220
098360                                                                  00098360
098370     IF CTA-EMPRESARIAL                                           00098370
098380        IF DATA-AUX-Y2-INV-DEVOL-RED LESS DATA-INVERTIDA-DEVOL-RED00098380
098410           IF FATOR-VENCIDO-ANT-WS GREATER THAN                   00098410
098410                                         FATOR-INSUF-PJ-ANT-WS    00098410
098420              COMPUTE VLR-JUROS-DEVOL-CE-WS ROUNDED =             00098420
098430                              ((SLD-DEVOL-NUM-WS   *              00098430
098450                                FATOR-VENCIDO-ANT-WS) +           00098450
098460                               (SLD-DEVOL-EXCESSO-ANT-WS *        00098460
098470                                FATOR-EXCESSO-PJ-ANT-WS))         00098470
098480           ELSE                                                   00098480
098490              COMPUTE VLR-JUROS-DEVOL-CE-WS ROUNDED =             00098490
098500                               ((SLD-DEVOL-NUM-WS  *              00098500
098520                                 FATOR-INSUF-PJ-ANT-WS) +         00098520
098530                                (SLD-DEVOL-EXCESSO-ANT-WS *       00098530
098540                                 FATOR-EXCESSO-PJ-ANT-WS))        00098540
097220           END-IF                                                 00097220
098550        ELSE                                                      00098550
098580           COMPUTE VLR-JUROS-DEVOL-CE-WS ROUNDED =                00098580
098590                               ((SLD-DEVOL-NUM-WS  *              00098590
098610                                 FATOR-JUROS-CTA-EMPRES-WS) +     00098610
098620                                (SLD-DEVOL-EXCESSO-ANT-WS *       00098620
098630                                 FATOR-EXCESSO-PJ-ANT-WS))        00098630
097220        END-IF                                                    00097220
              MOVE VLR-JUROS-DEVOL-CE-WS    TO JUR-DEVOL-1DIA-WS
097220     END-IF.                                                      00097220
098640                                                                  00098640
       243-38-CALCULO-IOF-DEVOL.

           IF VLR-JUROS-DEVOL-PF-WS > ZEROS
              MOVE VLR-JUROS-DEVOL-PF-WS          TO VLR-JUROS-DEVOL-WS
           ELSE
              IF VLR-JUROS-DEVOL-PJ-WS > ZEROS
                 MOVE VLR-JUROS-DEVOL-PJ-WS       TO VLR-JUROS-DEVOL-WS
              ELSE
                 IF VLR-JUROS-DEVOL-PJ-PP-WS > ZEROS
                    MOVE VLR-JUROS-DEVOL-PJ-PP-WS TO VLR-JUROS-DEVOL-WS
                 ELSE
                    IF VLR-JUROS-DEVOL-CE-WS > ZEROS
                       MOVE VLR-JUROS-DEVOL-CE-WS TO VLR-JUROS-DEVOL-WS
                    END-IF
                 END-IF
              END-IF
           END-IF.

           IF VLR-JUROS-DEVOL-WS > JUROS-DO-DIA-RED-WS
              MOVE JUROS-DO-DIA-RED-WS        TO VLR-JUROS-DEVOL-WS.

           IF INICIO-MES
              COMPUTE QTD-DIAS-ANT-WS = ULT-DIA-MES-ANT-WS -
                                        ULT-DIA-PROC-WS + 1
           ELSE
              COMPUTE QTD-DIAS-ANT-WS = DIA-PROC-WS - ULT-DIA-PROC-WS
           END-IF.

           IF SLD-DEV-ANT-DEVOL-WS > SLD-DEV-ANT-WS
              COMPUTE BASE-DEVOL-IOF-ADI-ANT-WS = SLD-DEV-ANT-DEVOL-WS -
                                                  SLD-DEV-ANT-WS
           ELSE
              MOVE ZEROS       TO BASE-DEVOL-IOF-ADI-ANT-WS
           END-IF.

           IF P-FISICAS
              COMPUTE IOF-DEVOL-NORMAL-WS ROUNDED =
                                            (((SLD-DEVOL-NUM-WS +
                                               VLR-JUROS-DEVOL-WS)  *
                                               QTD-DIAS-ANT-WS) *
                                               TX-IOF-FISICA-WS) / 100
           ELSE
              COMPUTE IOF-DEVOL-NORMAL-WS ROUNDED =
                                            (((SLD-DEVOL-NUM-WS +
                                               VLR-JUROS-DEVOL-WS)  *
                                               QTD-DIAS-ANT-WS) *
                                               TX-IOF-JURID-WS) / 100
           END-IF.

           IF SLD-DEVOL-NUM-WS GREATER BASE-DEVOL-IOF-ADI-ANT-WS
              COMPUTE IOF-DEVOL-ADICIONAL-WS ROUNDED =
                                (BASE-DEVOL-IOF-ADI-ANT-WS * 0,38) / 100
           ELSE
              COMPUTE IOF-DEVOL-ADICIONAL-WS ROUNDED =
                                         (SLD-DEVOL-NUM-WS * 0,38) / 100
           END-IF.

           COMPUTE IOF-DEVOL-TOTAL-WS = IOF-DEVOL-NORMAL-WS
                                      + IOF-DEVOL-ADICIONAL-WS.

           MOVE IOF-DEVOL-TOTAL-WS     TO IOF-DEVOL-1DIA-WS

099220     COMPUTE IOCS-DIARIOS-EXIGIVEIS-RED-WS =
099220             IOCS-DIARIOS-EXIGIVEIS-RED-WS +
099220             IOF-DEVOL-TOTAL-WS.

           IF IOCS-DIARIOS-EXIGIVEIS-RED-WS GREATER ZEROS
              MOVE ZEROS       TO IOCS-DIARIOS-EXIGIVEIS-RED-WS.

098650 243A-35-TESTA-SE-CALCULA-IOC.                                    00098650
098660                                                                  00098660
098670     IF  SLD-DEV-NUM-WS LESS ZEROS OR                             00098670
098680         SLD-DEV-NUM-ANT-WS LESS ZEROS                            00098680
               IF CTA-EMPRESARIAL OR CH-EMPRESA
                  MOVE CPF-CGC-RED-WS   TO CPF-CGC-AUX
                  MOVE SPACES           TO CH-ISENTO-IOF
                  PERFORM 99-VERIFICA-ISENCAO-IOF
                  IF ISENTO-IOF
                     NEXT SENTENCE
                  ELSE
098690               PERFORM 243B-35-CALCULA-IOC-DIARIO                 00098690
                  END-IF
               ELSE
098690            PERFORM 243B-35-CALCULA-IOC-DIARIO                    00098690
               END-IF
           END-IF.
098700                                                                  00098700
098710 243B-35-CALCULA-IOC-DIARIO.                                      00098710
098720                                                                  00098720
098740        IF SALDO-EMP-ANT-WS LESS THAN ZEROS                       00098740
098750           COMPUTE NUM-IOC-WS = (SALDO-EMP-ANT-WS +               00098750
098760                                 JUROS-DIARIOS-WS) * QDE-DIAS-WS  00098760
098770           IF P-FISICAS OR FACTORING                              00098770
098780              COMPUTE ACUM-IOC-FERIADO-WS ROUNDED =               00098780
098790                   (NUM-IOC-WS * TX-IOC-FISICA-WS) / 100          00098790
098800           ELSE                                                   00098800
098810             MOVE NUM-IOC-WS TO NUM-SIMPLES-WS                    00098810
098820             IF P-JURIDICAS AND SIMPLES AND FAIXA-NUM-SIMPLES     00098820
098830                COMPUTE ACUM-IOC-FERIADO-WS ROUNDED =             00098830
098840                   (NUM-IOC-WS * TX-IOC-SIMPLES-WS)  / 100        00098840
098850             ELSE                                                 00098850
098860                COMPUTE ACUM-IOC-FERIADO-WS ROUNDED =             00098860
098870                   (NUM-IOC-WS * TX-IOC-JURID-WS)  / 100.         00098870
098880                                                                  00098880
098890        IF SLD-EMP-RED-WS LESS THAN ZEROS                         00098890
098900           COMPUTE NUM-IOC-WS = SLD-EMP-RED-WS + JUROS-DIARIOS-WS 00098900
098910           IF P-FISICAS OR FACTORING                              00098910
098920              COMPUTE ACUM-IOC-DIARIO-WS ROUNDED =                00098920
098930                   (NUM-IOC-WS * TX-IOC-FISICA-WS) / 100          00098930
098940           ELSE                                                   00098940
098950             MOVE NUM-IOC-WS TO NUM-SIMPLES-WS                    00098950
098960             IF P-JURIDICAS AND SIMPLES AND FAIXA-NUM-SIMPLES     00098960
098970                COMPUTE ACUM-IOC-DIARIO-WS ROUNDED =              00098970
098980                   (NUM-IOC-WS * TX-IOC-SIMPLES-WS)  / 100        00098980
098990             ELSE                                                 00098990
099000                COMPUTE ACUM-IOC-DIARIO-WS ROUNDED =              00099000
099010                   (NUM-IOC-WS * TX-IOC-JURID-WS)  / 100.         00099010
099020                                                                  00099020
           IF  OPER-ISENTA-IOF
               MOVE ZEROS  TO  ACUM-IOC-DIARIO-WS
           END-IF
099030*..........................................................       00099030
099040*... COMANDOS PARA CALCULO DO IOF ADICIONAL DE 0,38  ......       00099040
099050*..........................................................       00099050
099060                                                                  00099060
099070      MOVE ZEROS TO BASE-IOF-ADICIONAL-WS IOF-ADICIONAL-WS.       00099070
099080                                                                  00099080
099110        IF SLD-EMP-RED-WS NOT LESS THAN ZEROS                     00099110
099120           MOVE ZEROS TO BASE-IOF-ADICIONAL-WS.                   00099120

099040*... COMANDOS PARA CALCULO DO IOF ADICIONAL DE 0,38               00099040
099040*... COM AJUSTE NO SALDO ANTERIOR DEVIDO A DEVOLUCAO.             00099040
            IF SLD-DEVOL-WS GREATER ZEROS
               COMPUTE SLD-EMP-ANT-AJUS-IOF-AD-DEV-WS =
                                      (SALDO-EMP-ANT-WS + SLD-DEVOL-WS)
               IF SLD-EMP-ANT-AJUS-IOF-AD-DEV-WS GREATER ZEROS
                  MOVE ZEROS TO SLD-EMP-ANT-AJUS-IOF-AD-DEV-WS
               END-IF
               IF SLD-EMP-RED-WS LESS
                  SLD-EMP-ANT-AJUS-IOF-AD-DEV-WS
      *           Caso o saldo de emprestimo atual seja menor que o saldo
      *           devedor do dia anterior (ja contando com as devolucoes)
      *           a base para calculo do IOF adicional deve ser o incremento
      *           de saldo devedor.
099150            COMPUTE  BASE-IOF-ADICIONAL-WS =                      00099150
099150                     SLD-EMP-RED-WS -                             00099150
099160                     SLD-EMP-ANT-AJUS-IOF-AD-DEV-WS               00099160
099130         ELSE                                                     00099130
                  MOVE ZEROS             TO IOF-ADICIONAL-WS
               END-IF
            ELSE
099140         IF SLD-EMP-RED-WS LESS SALDO-EMP-ANT-WS                  00099140
099150            COMPUTE BASE-IOF-ADICIONAL-WS = SLD-EMP-RED-WS -      00099150
099160                                            SALDO-EMP-ANT-WS      00099160
               END-IF
            END-IF.

           IF  OPER-ISENTA-IOF
               MOVE ZEROS  TO  BASE-IOF-ADICIONAL-WS
           END-IF

099180      IF BASE-IOF-ADICIONAL-WS NOT EQUAL ZEROS                    00099180
099190         COMPUTE IOF-ADICIONAL-WS = (BASE-IOF-ADICIONAL-WS *      00099190
099200                                    0,38) / 100.                  00099200
099210                                                                  00099210
            IF EMP-VENC-RED-WS > ZEROS
               MOVE DATA-MOV-WS           TO DATA-MOV-6-WS
               MOVE DIA-MOV-6-WS          TO DIA-MOV-INV-WS
               MOVE MES-MOV-6-WS          TO MES-MOV-INV-WS
               CALL 'M0952000' USING ANO-MOV-6-WS ANO-MOV-INV-WS
               MOVE EMP-VENC-RED-WS       TO EMP-VENC-RED-6-WS
               MOVE DIA-EMP-VENC-RED-6-WS TO DIA-EMP-VENC-RED-INV-WS
               MOVE MES-EMP-VENC-RED-6-WS TO MES-EMP-VENC-RED-INV-WS
               CALL 'M0952000' USING ANO-EMP-VENC-RED-6-WS
                                     ANO-EMP-VENC-RED-INV-WS
               IF ANOMES-EMP-VENC-RED-INV-WS LESS ANOMES-MOV-INV-WS
                  MOVE DIA-EMP-VENC-RED-INV-WS TO W091CL-DD-INFOR-1
                  MOVE MES-EMP-VENC-RED-INV-WS TO W091CL-MM-INFOR-1
                  MOVE ANO-EMP-VENC-RED-INV-WS TO W091CL-AA-INFOR-1
                  PERFORM 99-CALCULA-DATA-MOD-11
                  MOVE W091CL-DD-RES-2-3 TO DIA-EMP-VENC-RED-INV-WS
                  MOVE W091CL-MM-RES-2-3 TO MES-EMP-VENC-RED-INV-WS
                  MOVE W091CL-AA-RES-2-3 TO ANO-EMP-VENC-RED-INV-WS
                  IF DATA-MOV-INV-WS GREATER EMP-VENC-RED-INV-WS
                     MOVE ZEROS TO ACUM-IOC-DIARIO-WS.

099220     COMPUTE IOCS-DIARIOS-EXIGIVEIS-RED-WS =                      00099220
099230             IOCS-DIARIOS-EXIGIVEIS-RED-WS +                      00099230
099240             IOF-ADICIONAL-WS +                                   00099240
099250             ACUM-IOC-DIARIO-WS + ACUM-IOC-FERIADO-WS.            00099250
099260                                                                  00099260
099270     COMPUTE IOCS-DIARIOS-DISPENS-RED-WS =                        00099270
099280             ACUM-IOC-DIARIO-WS + ACUM-IOC-FERIADO-WS.            00099280
099290                                                                  00099290
099300     MOVE ZEROS TO ACUM-IOC-DIARIO-WS                             00099300
099310                   ACUM-IOC-FERIADO-WS                            00099310
099320                   NUM-IOC-WS.                                    00099320
099330                                                                  00099330
099340*.................................................................00099340
099350* NOTA- COMISSAO PERMANENCIA SOBRE CONTA VENCIDA                  00099350
099360*       (DEPAF-DIAFI-91/061, DE 12.03.91).                        00099360
099370*.................................................................00099370
099380                                                                  00099380
099390 244-35-TESTA-TALON-AUTOMATICO.                                   00099390
099400                                                                  00099400
099410************ IPMF *********************                           00099410
099420     MOVE INDICACOES-WS TO INDICA-WS.                             00099420
099430     IF DATA-IMPLANTA-RED-WS = DATA-RODADA-WS                     00099430
099440        IF NOT FORMULARIO-CONTINUO                                00099440
099450           IF TPCONTAB-RED-WS = 49                                00099450
099460              MOVE ZEROS         TO ACUM-CH-PROCESSADOS-WS        00099460
099470           ELSE                                                   00099470
099480              IF FORNECER-TALAO-WS = 0                            00099480
099490                 PERFORM 244-35-TALAO-CONTA-NOVA                  00099490
099500              ELSE                                                00099500
099510                 IF TP-PESSOA-RED-WS EQUAL 'G' OR '>'             00099510
099510*----------- ESTE TESTE FAZ COM QUE NAO GRAVA NA OCORRENCIA       00099510
099510*                QUANDO FOR CADASTRAMENTO                         00099510
099510*                IF TP-PESSOA-RED-WS EQUAL 'G'                    00099510
      *----------------------------------------------------
099520                    MOVE ZEROS   TO ACUM-CH-PROCESSADOS-WS        00099520
099530                 ELSE                                             00099530
099540                    MOVE 1       TO PER-ORIGEM-COMANDO-D10        00099540
099550                    MOVE 0       TO PER-NATUREZA-COMANDO-D10      00099550
099560                    MOVE 2       TO PER-QTDE-D10                  00099560
099570                    MOVE ZEROS   TO ACUM-CH-PROCESSADOS-WS        00099570
099580                    MOVE 66      TO PER-COD-MENS-D10              00099580
099590                    PERFORM 548-35-OCR-CH-PERSON                  00099590
099600        ELSE                                                      00099600
099610           MOVE ZEROS            TO ACUM-CH-PROCESSADOS-WS.       00099610
099620                                                                  00099620
099630     IF CHEQUE-NORMAL                                             00099630
099640        PERFORM 244-35-CHEQUE-PERSON-AUTOMATIC                    00099640
099650        MOVE ZEROS TO SW-CHEQUE-NORMAL.                           00099650

099660     IF CHEQUE-TRANSF-BANCARIA                                    00099660
099670        PERFORM 244-35-CHEQUE-TB-AUTOMATICO                       00099670
099680        MOVE ZEROS TO SW-CHEQUE-TB.                               00099680
099690                                                                  00099690
099700 244-35-TALAO-CONTA-NOVA.                                         00099700
099710***************************************                           00099710
099720*                                                                 00099720
099730     MOVE 1 TO SW-CHEQUE-NORMAL.                                  00099730
099740*    IF ID-CPF-CGC-RED-WS = 2                                     00099740
099750*       IF TP-TALAO-RED-WS = 2                                    00099750
099760*          ADD 80 TO ACUM-CH-PROCESSADOS-WS                       00099760
099770*       ELSE                                                      00099770
099780*          ADD 36 TO ACUM-CH-PROCESSADOS-WS                       00099780
099790*    ELSE                                                         00099790
099800*      IF EMP-LIM-RED-WS = 0                                      00099800
099810*         ADD 16 TO ACUM-CH-PROCESSADOS-WS                        00099810
099820*      ELSE                                                       00099820
099830*         ADD 36 TO ACUM-CH-PROCESSADOS-WS.                       00099830
161115     MOVE 0 TO ACUM-CH-PROCESSADOS-WS.
099840                                                                  00099840
099850 244-35-CHEQUE-PERSON-AUTOMATIC.                                  00099850
099860***************************************                           00099860
099870*                                                                 00099870
099880     IF ACUM-CH-PROCESSADOS-WS NOT EQUAL ZEROS                    00099880
099890        IF FORMULARIO-CONTINUO                                    00099890
099900           MOVE ZEROS TO ACUM-CH-PROCESSADOS-WS.                  00099900

099910     IF ACUM-CH-PROCESSADOS-WS NOT EQUAL ZEROS                    00099910
099920*    IF (TPCONTAB-RED-WS = 84 OR 44 OR 21 OR 23 OR 24 OR 43 OR 71 00099920
100112*           OR 72 OR 73 OR 74 OR 75 OR 77 OR 30 OR 31 OR 33) OR   00099930
099940*       (TP-PESSOA-RED-WS = 'V' OR 'G' OR '<') OR                 00099940
099950*       (CPF-CGC-RED-WS = ZEROS) OR                               00099950
099960*       (ATL-DIAS-PARAL-RED-WS GREATER 180) OR                    00099960
099970*       (FORMULARIO-CONTINUO) OR                                  00099970
099980*       (CALC-SMED-RED-WS EQUAL ZEROS) OR                         00099980
099990*       (FORNECER-TALAO-WS = 1) OR CTA-EMPRESARIAL                00099990
099920     IF (TPCONTAB-RED-WS = 84 OR 44 OR 21 OR 23 OR 24 OR 43 OR 71 00099920
100112            OR 72 OR 73 OR 74 OR 75 OR 77 OR 30 OR 31 OR 33)      00099930
099940     OR (TP-PESSOA-RED-WS = 'V' OR 'G' OR '<' OR '>' OR '#')      00099940
099950     OR (CPF-CGC-RED-WS = ZEROS)                                  00099950
099970     OR (FORMULARIO-CONTINUO)                                     00099970
099980     OR (CALC-SMED-RED-WS EQUAL ZEROS)                            00099980
099990     OR (FORNECER-TALAO-WS = 1)                                   00099990
099990     OR (CTA-EMPRESARIAL AND NOT PESSOA-MPE)                      00099990
100000         MOVE 1                  TO PER-ORIGEM-COMANDO-D10        00100000
100010         MOVE 0                  TO PER-NATUREZA-COMANDO-D10      00100010
100020         MOVE 2                  TO PER-QTDE-D10                  00100020
100030         MOVE ZEROS              TO ACUM-CH-PROCESSADOS-WS        00100030
100040         MOVE 66                 TO PER-COD-MENS-D10              00100040
100050         PERFORM 548-35-OCR-CH-PERSON.                            00100050
100060                                                                  00100060
100070     IF ACUM-CH-PROCESSADOS-WS NOT EQUAL ZEROS                    00100070
100080        MOVE ZEROS TO SW-SICAD                                    00100080
100090        PERFORM 999-96-ACESSA-SICAD                               00100090
100100        IF SICAD-NOK                                              00100100
100180           MOVE 1 TO PER-ORIGEM-COMANDO-D10                       00100180
100190           MOVE 0 TO PER-NATUREZA-COMANDO-D10                     00100190
100200           MOVE ACUM-CH-PROCESSADOS-WS TO PER-QTDE-D10            00100200
100210           MOVE ZEROS TO ACUM-CH-PROCESSADOS-WS                   00100210
100220           MOVE 64 TO PER-COD-MENS-D10                            00100220
100230           PERFORM 548-35-OCR-CH-PERSON.                          00100230
100240                                                                  00100240
100250     IF ACUM-CH-PROCESSADOS-WS NOT EQUAL ZEROS                    00100250
100260        IF DATA-IMPLANTA-RED-WS = ZEROS                           00100260
100270           MOVE 1 TO PER-ORIGEM-COMANDO-D10                       00100270
100280           MOVE 0 TO PER-NATUREZA-COMANDO-D10                     00100280
100290           MOVE ACUM-CH-PROCESSADOS-WS TO PER-QTDE-D10            00100290
100300           MOVE ZEROS TO ACUM-CH-PROCESSADOS-WS                   00100300
100310           MOVE 65 TO PER-COD-MENS-D10                            00100310
100320           PERFORM 548-35-OCR-CH-PERSON.                          00100320
100330                                                                  00100330
100340     MOVE TALON-FORNECIDOS-RED-WS   TO TALON-FORNECIDOS-ANT-WS.   00100340
100350     MOVE TALON-RESIDUO-RED-WS      TO TALON-RESIDUO-ANT-WS.      00100350
100360     MOVE TALON-PEDIDOS-ACUM-RED-WS TO TALON-PEDIDOS-ACUM-ANT-WS. 00100360
100370     IF ACUM-PEDIDOS-TALON-CORR-WS GREATER ZEROS                  00100370
100380        ADD ACUM-PEDIDOS-TALON-CORR-WS TO TALON-FORNECIDOS-RED-WS.00100380
100390     COMPUTE CONSUMO-PERSON-WS = ACUM-CH-PROCESSADOS-WS +         00100390
100400                                 TALON-RESIDUO-RED-WS.            00100400
100410                                                                  00100410
100420     IF TP-TALAO-RED-WS EQUAL 2                                   00100420
100430        DIVIDE CONSUMO-PERSON-WS BY PADRAO-JURIDICA-WS            00100430
100440                                    GIVING QUOCIENTE-PERSON-WS    00100440
100450                                    REMAINDER RESTO-PERSON-WS     00100450
100460     ELSE                                                         00100460
100470       IF EMP-LIM-RED-WS EQUAL ZEROS                              00100470
100480        IF ID-CPF-CGC-RED-WS = 2                                  00100480
100490          DIVIDE CONSUMO-PERSON-WS BY PADRAO-PERSON-WS            00100490
100500                                      GIVING QUOCIENTE-PERSON-WS  00100500
100510                                      REMAINDER RESTO-PERSON-WS   00100510
100520        ELSE                                                      00100520
100530          DIVIDE CONSUMO-PERSON-WS BY PADRAO-PERSON-COMUN-WS      00100530
100540                                      GIVING QUOCIENTE-PERSON-WS  00100540
100550                                      REMAINDER RESTO-PERSON-WS   00100550
100560       ELSE                                                       00100560
100570        IF ID-CPF-CGC-RED-WS = 2                                  00100570
100580          DIVIDE CONSUMO-PERSON-WS BY PADRAO-PERSON-WS            00100580
100590                                      GIVING QUOCIENTE-PERSON-WS  00100590
100600                                      REMAINDER RESTO-PERSON-WS   00100600
100610        ELSE                                                      00100610
100620          DIVIDE CONSUMO-PERSON-WS BY PADRAO-PERSON-COMUN-WS      00100620
100630                                      GIVING QUOCIENTE-PERSON-WS  00100630
100640                                      REMAINDER RESTO-PERSON-WS.  00100640
100650                                                                  00100650
100660     MOVE RESTO-PERSON-WS TO TALON-RESIDUO-RED-WS.                00100660
100670                                                                  00100670
100680     COMPUTE TALON-PEDIDOS-ACUM-RED-WS =                          00100680
100690             TALON-PEDIDOS-ACUM-RED-WS +                          00100690
100700             QUOCIENTE-PERSON-WS +                                00100700
100710             ACUM-PEDIDOS-TALON-CORR-WS.                          00100710

100720     IF TALON-PEDIDOS-ACUM-RED-WS GREATER TALON-FORNECIDOS-RED-WS 00100720
100730        MOVE TALON-PEDIDOS-ACUM-RED-WS TO TALON-FORNECIDOS-RED-WS.00100730
100740     COMPUTE TALON-SOLICIT-PARA-S131-WS =                         00100740
100750             TALON-FORNECIDOS-RED-WS - TALON-FORNECIDOS-ANT-WS.   00100750
100760                                                                  00100760
100770     IF  ACUM-PEDIDOS-TALON-CORR-WS GREATER ZEROS                 00100770
100780         COMPUTE TALON-AUTOM-WS = TALON-SOLICIT-PARA-S131-WS -    00100780
100790                                  ACUM-PEDIDOS-TALON-CORR-WS      00100790
100800         COMPUTE TALON-AUTOM-REJ-WS = QUOCIENTE-PERSON-WS -       00100800
100810                                      TALON-AUTOM-WS              00100810
100820     ELSE                                                         00100820
100830         MOVE TALON-SOLICIT-PARA-S131-WS TO TALON-AUTOM-WS        00100830
100840         COMPUTE TALON-AUTOM-REJ-WS = QUOCIENTE-PERSON-WS -       00100840
100850                                      TALON-AUTOM-WS.             00100850
100860                                                                  00100860
100870     IF  QUOCIENTE-PERSON-WS GREATER ZEROS                        00100870
100880         PERFORM 244A-35-TESTA-SITUACAO-CADASTR                   00100880
100890         IF  QUOCIENTE-PERSON-WS EQUAL ZEROS                      00100890
100900             MOVE TALON-FORNECIDOS-ANT-WS TO                      00100900
100910                  TALON-FORNECIDOS-RED-WS                         00100910
100920             MOVE TALON-RESIDUO-ANT-WS TO                         00100920
100930                  TALON-RESIDUO-RED-WS                            00100930
100940             MOVE TALON-PEDIDOS-ACUM-ANT-WS TO                    00100940
100950                  TALON-PEDIDOS-ACUM-RED-WS                       00100950
100960         ELSE                                                     00100960
100970           IF NOT FORMULARIO-CONTINUO                             00100970
100980              PERFORM 244B-35-TALON-AUTOM-OK-E-REJ.               00100980
100990                                                                  00100990
101000     IF  HOUVE-OCORR-14                                           00101000
101010         MOVE 9 TO PER-ORIGEM-COMANDO-D10                         00101010
101020         MOVE 1 TO PER-NATUREZA-COMANDO-D10                       00101020
101030         MOVE TALON-SOLICIT-PARA-S131-WS TO PER-QTDE-D10          00101030
101040         MOVE COD-MSG-OCORR-TALON-WS TO PER-COD-MENS-D10          00101040
101050         PERFORM 548-35-OCR-CH-PERSON.                            00101050

101060     MOVE ZEROS TO SW-HOUVE-OCORR-14                              00101060
101070                   COD-MSG-OCORR-TALON-WS                         00101070
101080                   TALON-SOLICIT-PARA-S131-WS.                    00101080
101090*                                                                 00101090
101100************ IPMF *********************                           00101100
101110 244-35-CHEQUE-TB-AUTOMATICO.                                     00101110
101120*     IF (TPCONTAB-RED-WS = 84 OR 44 OR 21 OR 23 OR 24 OR 43 OR 7100101120
100112*                        OR 72 OR 77 OR 30 OR 31 OR 33) OR        00101130
101140*        (TP-PESSOA-RED-WS = 'V' OR 'G' OR '<') OR                00101140
101150*        (CPF-CGC-RED-WS = ZEROS) OR                              00101150
101160*        (ATL-DIAS-PARAL-RED-WS GREATER 180) OR                   00101160
101170*        (CALC-SMED-RED-WS EQUAL ZEROS) OR                        00101170
101180*        (FORNECER-TALAO-WS = 1) OR CTA-EMPRESARIAL               00101180
           IF (TPCONTAB-RED-WS = 84 OR 44 OR 21 OR 23 OR 24 OR 43 OR 71
                              OR 72 OR 77 OR 30 OR 31 OR 33)
           OR (TP-PESSOA-RED-WS = 'V' OR 'G' OR '<' OR '>' OR '#')
           OR (CPF-CGC-RED-WS = ZEROS)
           OR (CALC-SMED-RED-WS EQUAL ZEROS)
           OR (FORNECER-TALAO-WS = 1)
           OR (CTA-EMPRESARIAL AND NOT PESSOA-MPE)
101190         MOVE ZEROS TO ACUM-CH-TB-PROCESSADOS-WS.                 00101190

101200     IF ACUM-CH-TB-PROCESSADOS-WS NOT EQUAL ZEROS                 00101200
101210        MOVE ZEROS TO SW-SICAD                                    00101210
101220        PERFORM 999-96-ACESSA-SICAD                               00101220
101230        IF SICAD-NOK                                              00101230
101310           MOVE 1 TO PER-ORIGEM-COMANDO-D10                       00101310
101320           MOVE 0 TO PER-NATUREZA-COMANDO-D10                     00101320
101330           MOVE ACUM-CH-TB-PROCESSADOS-WS TO PER-QTDE-D10         00101330
101340           MOVE 64 TO PER-COD-MENS-D10                            00101340
101350           MOVE ZEROS TO ACUM-CH-TB-PROCESSADOS-WS                00101350
101360           PERFORM 548-35-OCR-CH-PERSON.                          00101360

101370     IF ACUM-CH-TB-PROCESSADOS-WS NOT EQUAL ZEROS                 00101370
101380        IF DATA-IMPLANTA-RED-WS = ZEROS                           00101380
101390           MOVE 1 TO PER-ORIGEM-COMANDO-D10                       00101390
101400           MOVE 0 TO PER-NATUREZA-COMANDO-D10                     00101400
101410           MOVE ACUM-CH-TB-PROCESSADOS-WS TO PER-QTDE-D10         00101410
101420           MOVE ZEROS TO ACUM-CH-TB-PROCESSADOS-WS                00101420
101430           MOVE 65 TO PER-COD-MENS-D10                            00101430
101440           PERFORM 548-35-OCR-CH-PERSON.                          00101440
101450                                                                  00101450
101460     MOVE CHEQUE-TB-FORNECI-RED-WS  TO TALON-FORNECIDOS-ANT-TB-WS.00101460
101470     MOVE CHEQUE-TB-RESIDUO-RED-WS   TO TALON-RESIDUO-ANT-TB-WS.  00101470
101480     MOVE CHEQUE-TB-PEDIDOS-RED-WS TO TALON-PEDIDOS-ACUM-ANT-TB-WS00101480

101490     IF ACUM-PEDIDOS-CHEQUE-TB-WS  GREATER ZEROS                  00101490
101500        ADD ACUM-PEDIDOS-CHEQUE-TB-WS TO CHEQUE-TB-FORNECI-RED-WS.00101500
101510     COMPUTE CONSUMO-PERSON-TB-WS = ACUM-CH-TB-PROCESSADOS-WS +   00101510
101520                                 CHEQUE-TB-RESIDUO-RED-WS.        00101520

101530     IF P-JURIDICAS                                               00101530
101540        DIVIDE CONSUMO-PERSON-TB-WS BY PADRAO-TB-WS               00101540
101550                              GIVING QUOCIENTE-PERSON-TB-WS       00101550
101560                              REMAINDER RESTO-PERSON-TB-WS        00101560
101570     ELSE                                                         00101570
101580     IF P-FISICAS                                                 00101580
101590        DIVIDE CONSUMO-PERSON-WS BY TB-FISICAS-WS                 00101590
101600                              GIVING QUOCIENTE-PERSON-TB-WS       00101600
101610                              REMAINDER RESTO-PERSON-TB-WS        00101610
101620     ELSE                                                         00101620
101630        DIVIDE CONSUMO-PERSON-WS BY PADRAO-TB-WS                  00101630
101640                              GIVING QUOCIENTE-PERSON-TB-WS       00101640
101650                              REMAINDER RESTO-PERSON-TB-WS.       00101650

101740     MOVE RESTO-PERSON-TB-WS TO CHEQUE-TB-RESIDUO-RED-WS.         00101740
101750     COMPUTE CHEQUE-TB-PEDIDOS-RED-WS =                           00101750
101760             CHEQUE-TB-PEDIDOS-RED-WS +                           00101760
101770             QUOCIENTE-PERSON-TB-WS +                             00101770
101780             ACUM-PEDIDOS-CHEQUE-TB-WS.                           00101780

101790     IF CHEQUE-TB-PEDIDOS-RED-WS GREATER CHEQUE-TB-FORNECI-RED-WS 00101790
101800        MOVE CHEQUE-TB-PEDIDOS-RED-WS TO CHEQUE-TB-FORNECI-RED-WS.00101800

101810     COMPUTE TALON-SOLICIT-PARA-S131-TB-WS =                      00101810
101820            CHEQUE-TB-FORNECI-RED-WS - TALON-FORNECIDOS-ANT-TB-WS.00101820

101830     IF ACUM-PEDIDOS-CHEQUE-TB-WS GREATER ZEROS                   00101830
101840       COMPUTE TALON-AUTOM-TB-WS = TALON-SOLICIT-PARA-S131-TB-WS -00101840
101850                                  ACUM-PEDIDOS-CHEQUE-TB-WS       00101850
101860         COMPUTE TALON-AUTOM-REJ-TB-WS = QUOCIENTE-PERSON-TB-WS - 00101860
101870                                         TALON-AUTOM-TB-WS        00101870
101880     ELSE                                                         00101880
101890         MOVE TALON-SOLICIT-PARA-S131-TB-WS TO TALON-AUTOM-TB-WS  00101890
101900         COMPUTE TALON-AUTOM-REJ-TB-WS = QUOCIENTE-PERSON-TB-WS - 00101900
101910                                         TALON-AUTOM-TB-WS.       00101910

101920     IF  QUOCIENTE-PERSON-TB-WS GREATER ZEROS                     00101920
101930         PERFORM 244AA-35-TESTA-SITUACAO-CADAST                   00101930
101940         IF  QUOCIENTE-PERSON-TB-WS EQUAL ZEROS                   00101940
101950             MOVE TALON-FORNECIDOS-ANT-TB-WS   TO                 00101950
101960                  CHEQUE-TB-FORNECI-RED-WS                        00101960
101970             MOVE TALON-RESIDUO-ANT-TB-WS      TO                 00101970
101980                  CHEQUE-TB-RESIDUO-RED-WS                        00101980
101990             MOVE TALON-PEDIDOS-ACUM-ANT-TB-WS TO                 00101990
102000                  CHEQUE-TB-PEDIDOS-RED-WS                        00102000
102010         ELSE                                                     00102010
102020             PERFORM 244BB-35-TALON-AUTOM-OK-E-REJ.               00102020

102030     IF  HOUVE-OCORR-14                                           00102030
102040         MOVE 9                  TO PER-ORIGEM-COMANDO-D10        00102040
102050         MOVE 1                  TO PER-NATUREZA-COMANDO-D10      00102050
102060         MOVE TALON-SOLICIT-PARA-S131-TB-WS TO PER-QTDE-D10       00102060
102070         MOVE COD-MSG-OCORR-TALON-WS        TO PER-COD-MENS-D10   00102070
102080         PERFORM 548-35-OCR-CH-PERSON.                            00102080

102090     MOVE ZEROS TO SW-HOUVE-OCORR-14                              00102090
102100                   COD-MSG-OCORR-TALON-WS                         00102100
102110                   TALON-SOLICIT-PARA-S131-TB-WS.                 00102110
102130*                                                                 00102130
102140 244A-35-TESTA-SITUACAO-CADASTR.                                  00102140
102150     IF  TPCONTAB-RED-WS = 84 OR 44 OR 21 OR 23 OR 24 OR 43 OR 71 00102150
102160                        OR 72 OR 77                               00102160
102170         MOVE 1 TO PER-ORIGEM-COMANDO-D10                         00102170
102180         MOVE 0 TO PER-NATUREZA-COMANDO-D10                       00102180
102190         MOVE QUOCIENTE-PERSON-WS TO PER-QTDE-D10                 00102190
102200         MOVE ZEROS TO QUOCIENTE-PERSON-WS                        00102200
102210         MOVE 52 TO PER-COD-MENS-D10                              00102210
102220         PERFORM 548-35-OCR-CH-PERSON                             00102220
102230     ELSE                                                         00102230
102240         IF  CPF-CGC-RED-WS = ZEROS                               00102240
102250             MOVE 1 TO PER-ORIGEM-COMANDO-D10                     00102250
102260             MOVE 0 TO PER-NATUREZA-COMANDO-D10                   00102260
102270             MOVE QUOCIENTE-PERSON-WS TO PER-QTDE-D10             00102270
102280             MOVE ZEROS TO QUOCIENTE-PERSON-WS                    00102280
102290             MOVE 15 TO PER-COD-MENS-D10                          00102290
102300             PERFORM 548-35-OCR-CH-PERSON                         00102300
102310         ELSE                                                     00102310
102400               IF CALC-SMED-RED-WS = ZEROS                        00102400
102410                 MOVE 1 TO PER-ORIGEM-COMANDO-D10                 00102410
102420                 MOVE 0 TO PER-NATUREZA-COMANDO-D10               00102420
102430                 MOVE QUOCIENTE-PERSON-WS TO PER-QTDE-D10         00102430
102440                 MOVE ZEROS TO QUOCIENTE-PERSON-WS                00102440
102450                 MOVE 58 TO PER-COD-MENS-D10                      00102450
102460                 PERFORM 548-35-OCR-CH-PERSON                     00102460
102470               ELSE                                               00102470
102480               IF DATA-IMPLANTA-RED-WS = ZEROS                    00102480
102490                  MOVE 1 TO PER-ORIGEM-COMANDO-D10                00102490
102500                  MOVE 0 TO PER-NATUREZA-COMANDO-D10              00102500
102510                  MOVE QUOCIENTE-PERSON-WS TO PER-QTDE-D10        00102510
102520                  MOVE ZEROS TO QUOCIENTE-PERSON-WS               00102520
102530                  MOVE 65 TO PER-COD-MENS-D10                     00102530
102540                  PERFORM 548-35-OCR-CH-PERSON                    00102540
102550               ELSE                                               00102550
102560               IF SICAD-NOK                                       00102560
102570                  MOVE 1 TO PER-ORIGEM-COMANDO-D10                00102570
102580                  MOVE 0 TO PER-NATUREZA-COMANDO-D10              00102580
102590                  MOVE QUOCIENTE-PERSON-WS TO PER-QTDE-D10        00102590
102600                  MOVE ZEROS TO QUOCIENTE-PERSON-WS               00102600
102610                  MOVE 64 TO PER-COD-MENS-D10                     00102610
102620                  PERFORM 548-35-OCR-CH-PERSON                    00102620
102630               ELSE                                               00102630
102640                 IF (FORNECER-TALAO-WS = 1) OR                    00102640
100112                    (TPCONTAB-RED-WS = 30 OR 31 OR 33)
102650                    MOVE 1 TO PER-ORIGEM-COMANDO-D10              00102650
102660                    MOVE 0 TO PER-NATUREZA-COMANDO-D10            00102660
102670                    MOVE QUOCIENTE-PERSON-WS TO PER-QTDE-D10      00102670
102680                    MOVE ZEROS TO QUOCIENTE-PERSON-WS             00102680
102690                    MOVE 66 TO PER-COD-MENS-D10                   00102690
102700                    PERFORM 548-35-OCR-CH-PERSON.                 00102700
102710*                                                                 00102710
102720 244AA-35-TESTA-SITUACAO-CADAST.                                  00102720
102730     IF  TPCONTAB-RED-WS = 84 OR 44 OR 21 OR 23 OR 24 OR 43 OR 71 00102730
102740                        OR 72 OR 77                               00102740
102750         MOVE 1 TO PER-ORIGEM-COMANDO-D10                         00102750
102760         MOVE 0 TO PER-NATUREZA-COMANDO-D10                       00102760
102770         MOVE QUOCIENTE-PERSON-TB-WS TO PER-QTDE-D10              00102770
102780         MOVE ZEROS TO QUOCIENTE-PERSON-TB-WS                     00102780
102790         MOVE 52 TO PER-COD-MENS-D10                              00102790
102800         PERFORM 548-35-OCR-CH-PERSON                             00102800
102810     ELSE                                                         00102810
102820         IF  CPF-CGC-RED-WS = ZEROS                               00102820
102830             MOVE 1 TO PER-ORIGEM-COMANDO-D10                     00102830
102840             MOVE 0 TO PER-NATUREZA-COMANDO-D10                   00102840
102850             MOVE QUOCIENTE-PERSON-TB-WS TO PER-QTDE-D10          00102850
102860             MOVE ZEROS TO QUOCIENTE-PERSON-TB-WS                 00102860
102870             MOVE 15 TO PER-COD-MENS-D10                          00102870
102880             PERFORM 548-35-OCR-CH-PERSON                         00102880
102890         ELSE                                                     00102890
102980               IF CALC-SMED-RED-WS EQUAL ZEROS                    00102980
102990                 MOVE 1 TO PER-ORIGEM-COMANDO-D10                 00102990
103000                 MOVE 0 TO PER-NATUREZA-COMANDO-D10               00103000
103010                 MOVE QUOCIENTE-PERSON-TB-WS TO PER-QTDE-D10      00103010
103020                 MOVE ZEROS TO QUOCIENTE-PERSON-TB-WS             00103020
103030                 MOVE 58 TO PER-COD-MENS-D10                      00103030
103040                 PERFORM 548-35-OCR-CH-PERSON                     00103040
103050               ELSE                                               00103050
103060               IF DATA-IMPLANTA-RED-WS EQUAL ZEROS                00103060
103070                  MOVE 1 TO PER-ORIGEM-COMANDO-D10                00103070
103080                  MOVE 0 TO PER-NATUREZA-COMANDO-D10              00103080
103090                  MOVE QUOCIENTE-PERSON-TB-WS TO PER-QTDE-D10     00103090
103100                  MOVE ZEROS TO QUOCIENTE-PERSON-TB-WS            00103100
103110                  MOVE 65 TO PER-COD-MENS-D10                     00103110
103120                  PERFORM 548-35-OCR-CH-PERSON                    00103120
103130               ELSE                                               00103130
103140               IF SICAD-NOK                                       00103140
103150                  MOVE 1 TO PER-ORIGEM-COMANDO-D10                00103150
103160                  MOVE 0 TO PER-NATUREZA-COMANDO-D10              00103160
103170                  MOVE QUOCIENTE-PERSON-TB-WS TO PER-QTDE-D10     00103170
103180                  MOVE ZEROS TO QUOCIENTE-PERSON-TB-WS            00103180
103190                  MOVE 64 TO PER-COD-MENS-D10                     00103190
103200                  PERFORM 548-35-OCR-CH-PERSON                    00103200
103210               ELSE                                               00103210
103220                 IF (FORNECER-TALAO-WS = 1) OR                    00103220
100112                    (TPCONTAB-RED-WS = 30 OR 31 OR 33)
103230                    MOVE 1 TO PER-ORIGEM-COMANDO-D10              00103230
103240                    MOVE 0 TO PER-NATUREZA-COMANDO-D10            00103240
103250                    MOVE QUOCIENTE-PERSON-WS TO PER-QTDE-D10      00103250
103260                    MOVE ZEROS TO QUOCIENTE-PERSON-WS             00103260
103270                    MOVE 66 TO PER-COD-MENS-D10                   00103270
103280                    PERFORM 548-35-OCR-CH-PERSON.                 00103280
103300*                                                                 00103300
103310 244B-35-TALON-AUTOM-OK-E-REJ.                                    00103310
103340     IF  TALON-AUTOM-WS GREATER ZEROS                             00103340
103350         IF CALC-SMED-RED-WS EQUAL 1                              00103350
103360            MOVE 1 TO PER-ORIGEM-COMANDO-D10                      00103360
103370            MOVE 1 TO PER-NATUREZA-COMANDO-D10                    00103370
103380            MOVE TALON-AUTOM-WS TO PER-QTDE-D10                   00103380
103390            MOVE 16 TO PER-COD-MENS-D10                           00103390
103400            PERFORM 548-35-OCR-CH-PERSON                          00103400
103410         ELSE                                                     00103410
103420            MOVE 1 TO PER-ORIGEM-COMANDO-D10                      00103420
103430            MOVE 0 TO PER-NATUREZA-COMANDO-D10                    00103430
103440            MOVE TALON-AUTOM-WS TO PER-QTDE-D10                   00103440
103450            MOVE 58 TO PER-COD-MENS-D10                           00103450
103460            PERFORM 548-35-OCR-CH-PERSON.                         00103460
103470                                                                  00103470
103480     IF  TALON-AUTOM-REJ-WS GREATER ZEROS                         00103480
103490         MOVE 1 TO PER-ORIGEM-COMANDO-D10                         00103490
103500         MOVE 0 TO PER-NATUREZA-COMANDO-D10                       00103500
103510         MOVE TALON-AUTOM-REJ-WS TO PER-QTDE-D10                  00103510
103520         MOVE 16 TO PER-COD-MENS-D10                              00103520
103530         PERFORM 548-35-OCR-CH-PERSON.                            00103530
103540*                                                                 00103540
103550 244BB-35-TALON-AUTOM-OK-E-REJ.                                   00103550
103560*                                                                 00103560
103580     IF  TALON-AUTOM-TB-WS GREATER ZEROS                          00103580
103590         IF CALC-SMED-RED-WS EQUAL 1                              00103590
103600            MOVE 1 TO PER-ORIGEM-COMANDO-D10                      00103600
103610            MOVE 1 TO PER-NATUREZA-COMANDO-D10                    00103610
103620            MOVE TALON-AUTOM-TB-WS TO PER-QTDE-D10                00103620
103630            MOVE 16 TO PER-COD-MENS-D10                           00103630
103640            PERFORM 548-35-OCR-CH-PERSON                          00103640
103650         ELSE                                                     00103650
103660            MOVE 1 TO PER-ORIGEM-COMANDO-D10                      00103660
103670            MOVE 0 TO PER-NATUREZA-COMANDO-D10                    00103670
103680            MOVE TALON-AUTOM-TB-WS TO PER-QTDE-D10                00103680
103690            MOVE 58 TO PER-COD-MENS-D10                           00103690
103700            PERFORM 548-35-OCR-CH-PERSON.                         00103700
103710                                                                  00103710
103720     IF  TALON-AUTOM-REJ-TB-WS GREATER ZEROS                      00103720
103730         MOVE 1 TO PER-ORIGEM-COMANDO-D10                         00103730
103740         MOVE 0 TO PER-NATUREZA-COMANDO-D10                       00103740
103750         MOVE TALON-AUTOM-REJ-TB-WS TO PER-QTDE-D10               00103750
103760         MOVE 16 TO PER-COD-MENS-D10                              00103760
103770         PERFORM 548-35-OCR-CH-PERSON.                            00103770
103780*                                                                 00103780
103790 245-35-ATL-TRAILLER-AGENCIA.                                     00103790
103800*                                                                 00103800
103810     ADD 1 TO IND-ATL-TRAILLER.                                   00103810
103820     ADD 1 TO IND-ACUM-TRAILLER.                                  00103820
103830                                                                  00103830
103840     MOVE TOT-ATL-SALDOS-RED-WS (IND-ATL-TRAILLER) TO             00103840
103850         TOT-ANT-SALDOS-RED-WS (IND-ATL-TRAILLER)                 00103850
103860          ACUM-SLD-ANT-TAB (IND-ACUM-TRAILLER).                   00103860
103870     MOVE TOT-ATL-CONTAS-RED-WS (IND-ATL-TRAILLER) TO             00103870
103880         TOT-ANT-CONTAS-RED-WS (IND-ATL-TRAILLER)                 00103880
103890          ACUM-QDE-ANT-TAB (IND-ACUM-TRAILLER).                   00103890
103900     MOVE ACUM-SLD-ATL-TAB (IND-ACUM-TRAILLER) TO                 00103900
103910          TOT-ATL-SALDOS-RED-WS  (IND-ATL-TRAILLER).              00103910
103920     MOVE ACUM-QDE-ATL-TAB (IND-ACUM-TRAILLER) TO                 00103920
103930          TOT-ATL-CONTAS-RED-WS (IND-ATL-TRAILLER).               00103930
103970*                                                                 00103970
103980 260-35-TRANSFERENCIA.                                            00103980
103990*                                                                 00103990
104000     IF REGULARIZA-INSUF                                          00104000
104010         IF EMP-DATA-RED-WS NOT = ATL-ULT-MOV-RED-WS              00104010
104020             MOVE SLD-DEP-RED-WS TO SLD-EMP-RED-WS                00104020
104030             MOVE ZERO TO SLD-DEP-RED-WS.                         00104030
104040                                                                  00104040
104050     IF EMP-LIM-RED-WS GREATER ZERO  OR CANCELOU-EMPRESTIMO       00104050
104060         IF SLD-EMP-ANT-WS LESS ZERO                              00104060
104070             IF SLD-EMP-RED-WS = ZERO                             00104070
104080                 MOVE SLD-EMP-ANT-WS TO DI-MOV-VR-WS              00104080
104090                 MOVE 50 TO DI-MOV-LOTE-WS                        00104090
104100                 PERFORM 265-35-TRANSF-ACUMULA                    00104100
104110                 IF TPCONTAB-RED-WS = 01                          00104110
104120                    PERFORM 585-35-OCR-TRANSF-PARA-EMPREST        00104120
104130                 ELSE                                             00104130
104140                   IF TPCONTAB-RED-WS = 02                        00104140
104150                      PERFORM 263-35-TRANSF-PARA-PJ               00104150
104160                   ELSE                                           00104160
104170                      NEXT SENTENCE                               00104170
104180             ELSE                                                 00104180
104190                COMPUTE DI-MOV-VR-WS = SLD-EMP-ANT-WS -           00104190
104200                                       SLD-EMP-RED-WS             00104200
104210                IF DI-MOV-VR-WS LESS ZERO                         00104210
104220                   MOVE 50 TO DI-MOV-LOTE-WS                      00104220
104230                   PERFORM 265-35-TRANSF-ACUMULA                  00104230
104240                   IF TPCONTAB-RED-WS = 01                        00104240
104250                      PERFORM 585-35-OCR-TRANSF-PARA-EMPREST      00104250
104260                   ELSE                                           00104260
104270                    IF TPCONTAB-RED-WS = 02                       00104270
104280                       PERFORM 263-35-TRANSF-PARA-PJ              00104280
104290                    ELSE                                          00104290
104300                       NEXT SENTENCE                              00104300
104310                ELSE                                              00104310
104320                   IF DI-MOV-VR-WS GREATER ZERO                   00104320
104330                      MOVE 90 TO DI-MOV-LOTE-WS                   00104330
104340                      PERFORM 265-35-TRANSF-ACUMULA               00104340
104350                   ELSE                                           00104350
104360                      NEXT SENTENCE                               00104360
104370         ELSE                                                     00104370
104380            IF SLD-EMP-RED-WS LESS ZERO                           00104380
104390               MOVE SLD-EMP-RED-WS TO DI-MOV-VR-WS                00104390
104400               MOVE 90 TO DI-MOV-LOTE-WS                          00104400
104410               PERFORM 265-35-TRANSF-ACUMULA.                     00104410
104420                                                                  00104420
104430     IF SLD-EMP-RED-WS LESS ZERO                                  00104430
104440        IF TPCONTAB-RED-WS = 01                                   00104440
104450           PERFORM 590-35-OCR-TRANSF-DE-EMPREST                   00104450
104460        ELSE                                                      00104460
104470           IF TPCONTAB-RED-WS = 02                                00104470
104480              PERFORM 264-35-TRANSF-DE-PJ.                        00104480
104490                                                                  00104490
104500     IF MOV-NUM-RED-WS GREATER ZERO                               00104500
104510         IF ATL-ULT-MOV-RED-WS = DATA-D07-RED-WS                  00104510
104520             PERFORM 318-35-TESTA-DIF-SALDOS.                     00104520
104530                                                                  00104530
104540     IF SLD-EMP-RED-WS GREATER ZEROS                              00104540
104550        MOVE SLD-EMP-RED-WS TO SLD-DEP-RED-WS                     00104550
104560        MOVE ZEROS TO SLD-EMP-RED-WS.                             00104560
104570                                                                  00104570
104580     COMPUTE NAO-UTILIZACAO-WS = EMP-LIM-RED-WS + SLD-EMP-RED-WS. 00104580
104590                                                                  00104590
           MOVE EMP-VENC-RED-WS          TO DTU-VEN-LIM-WS
           MOVE DIAU-VEN-LIM-WS          TO DIAU-IVEN-LIM-WS
           MOVE MESU-VEN-LIM-WS          TO MESU-IVEN-LIM-WS
           MOVE ANOU-VEN-LIM-WS          TO ANOU-IVEN-LIM-WS

           IF  DATA-REC-WS GREATER DTU-IVEN-CTR-WS
               MOVE ZEROS              TO NAO-UTILIZACAO-WS.

104600     IF NAO-UTILIZACAO-WS GREATER THAN ZEROS                      00104600
104610        IF TPCONTAB-RED-WS = 01                                   00104610
104620           PERFORM 261-35-OCR-NAO-UTILIZACAO-PF                   00104620
104630        ELSE                                                      00104630
104640           IF TPCONTAB-RED-WS = 02                                00104640
104650              PERFORM 262-35-OCR-NAO-UTILIZACAO-PJ.               00104650
104660*                                                                 00104660
104670 261-35-OCR-NAO-UTILIZACAO-PF.                                    00104670
104680*                                                                 00104680
104690     MOVE 33 TO CH-TPREG-D10.                                     00104690
104700     MOVE CH-AG-WS TO CH-CODAG-D10.                               00104700
104710     MOVE CH-CONTA-WS    TO CONTA-D10.                            00104710
104720     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00104720
104730     MOVE NOME-RED-WS TO NUF-NOME-D10.                            00104730
104740     MOVE NAO-UTILIZACAO-WS TO NUF-VALOR-D10.                     00104740
104750     MOVE COD-POSTO-RED-WS TO NUF-COD-POSTO-D10.                  00104750
104760     MOVE CLIENTE-PREFEREN-RED-WS TO NUF-CLI-ESPECIAL-D10.        00104760
104770                                                                  00104770
104780     PERFORM 999-15-ACUMULA-D10.                                  00104780
104790                                                                  00104790
104800     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00104800
104810                                                                  00104810
104820     WRITE NUF-NAO-UTILIZACAO-PF-D10                              00104820
104830      INVALID KEY                                                 00104830
104840         PERFORM 999-20-ESTOUROU-AREA-D10.                        00104840
104850*                                                                 00104850
104860 262-35-OCR-NAO-UTILIZACAO-PJ.                                    00104860
104870*                                                                 00104870
104880     MOVE 35 TO CH-TPREG-D10.                                     00104880
104890     MOVE CH-AG-WS TO CH-CODAG-D10.                               00104890
104900     MOVE CH-CONTA-WS    TO CONTA-D10.                            00104900
104910     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00104910
104920     MOVE NOME-RED-WS TO NUJ-NOME-D10.                            00104920
104930     MOVE NAO-UTILIZACAO-WS TO NUJ-VALOR-D10.                     00104930
104940     MOVE COD-POSTO-RED-WS TO NUJ-COD-POSTO-D10.                  00104940
104950     MOVE CLIENTE-PREFEREN-RED-WS TO NUJ-CLI-ESPECIAL-D10.        00104950
104960                                                                  00104960
104970     PERFORM 999-15-ACUMULA-D10.                                  00104970
104980                                                                  00104980
104990     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00104990
105000                                                                  00105000
105010     WRITE NUJ-NAO-UTILIZACAO-PJ-D10                              00105010
105020      INVALID KEY                                                 00105020
105030         PERFORM 999-20-ESTOUROU-AREA-D10.                        00105030
105040*                                                                 00105040
105050 263-35-TRANSF-PARA-PJ.                                           00105050
105060*                                                                 00105060
105070      IF CH-EMPRESA                                               00105070
105080         IF CHE-INDUST                                            00105080
105090            PERFORM 595-35-TRANSF-PARA-CHE-IND                    00105090
105100         ELSE                                                     00105100
105110           IF CHE-COMERC                                          00105110
105120              PERFORM 595A-35-TRANSF-PARA-CHE-COM                 00105120
105130           ELSE                                                   00105130
105140             IF CHE-OUTROS                                        00105140
105150                PERFORM 595B-35-TRANSF-PARA-CHE-OUT.              00105150
105160                                                                  00105160
105170      IF CH-EMPRESA-PP                                            00105170
105180         IF CHE-INDUST-PP                                         00105180
105190            PERFORM 595-35-TRANSF-PARA-CHE-IND                    00105190
105200         ELSE                                                     00105200
105210           IF CHE-COMERC-PP                                       00105210
105220              PERFORM 595A-35-TRANSF-PARA-CHE-COM                 00105220
105230           ELSE                                                   00105230
105240             IF CHE-OUTROS-PP                                     00105240
105250                PERFORM 595B-35-TRANSF-PARA-CHE-OUT.              00105250
105260                                                                  00105260
105270      IF CTA-EMPRESARIAL                                          00105270
105280         IF INDUSTRIA                                             00105280
105290            PERFORM 597-35-TRANSF-PARA-CTA-EMP-IND                00105290
105300         ELSE                                                     00105300
105310           IF COMERCIO                                            00105310
105320              PERFORM 591-35-TRANSF-PARA-CTA-EMP-COM              00105320
105330           ELSE                                                   00105330
105340             IF OUTROS                                            00105340
105350                PERFORM 593-35-TRANSF-PARA-CTA-EMP-OUT.           00105350
105360*                                                                 00105360
105370 264-35-TRANSF-DE-PJ.                                             00105370
105380*                                                                 00105380
105390      IF CH-EMPRESA                                               00105390
105400         IF CHE-INDUST                                            00105400
105410            PERFORM 596-35-TRANSF-DE-CHE-IND                      00105410
105420         ELSE                                                     00105420
105430           IF CHE-COMERC                                          00105430
105440              PERFORM 596A-35-TRANSF-DE-CHE-COM                   00105440
105450           ELSE                                                   00105450
105460             IF CHE-OUTROS                                        00105460
105470                PERFORM 596B-35-TRANSF-DE-CHE-OUT.                00105470
105480                                                                  00105480
105490      IF CH-EMPRESA-PP                                            00105490
105500         IF CHE-INDUST-PP                                         00105500
105510            PERFORM 596-35-TRANSF-DE-CHE-IND                      00105510
105520         ELSE                                                     00105520
105530           IF CHE-COMERC-PP                                       00105530
105540              PERFORM 596A-35-TRANSF-DE-CHE-COM                   00105540
105550           ELSE                                                   00105550
105560             IF CHE-OUTROS-PP                                     00105560
105570                PERFORM 596B-35-TRANSF-DE-CHE-OUT.                00105570
105580                                                                  00105580
105590      IF CTA-EMPRESARIAL                                          00105590
105600         IF INDUSTRIA                                             00105600
105610            PERFORM 598-35-TRANSF-DE-CTA-EMP-IND                  00105610
105620         ELSE                                                     00105620
105630           IF COMERCIO                                            00105630
105640              PERFORM 592-35-TRANSF-DE-CTA-EMP-COM                00105640
105650           ELSE                                                   00105650
105660             IF OUTROS                                            00105660
105670                PERFORM 594-35-TRANSF-DE-CTA-EMP-OUT.             00105670
105700*                                                                 00105700
105710 265-35-TRANSF-ACUMULA.                                           00105710
105720*                                                                 00105720
105730     MOVE 1 TO SW-GERA-FICHA.                                     00105730
105740     ADD 1 TO ACUM-TRANSF-EMP.                                    00105740
105750                                                                  00105750
105760     IF DI-MOV-LOTE-WS = 50                                       00105760
105770         ADD 1 TO ACUM-QDE-DEB-TAB (TPCONTAB-RED-WS)              00105770
105780         COMPUTE ACUM-VR-DEB-TAB (TPCONTAB-RED-WS) =              00105780
105790         (DI-MOV-VR-WS * -1) + ACUM-VR-DEB-TAB (TPCONTAB-RED-WS)  00105790
105800         PERFORM 267-35-ACUMULA-CRE-FISICA-JUR                    00105800
105810     ELSE                                                         00105810
105820         ADD 1 TO ACUM-QDE-CRED-TAB (TPCONTAB-RED-WS)             00105820
105830         IF DI-MOV-VR-WS LESS ZERO                                00105830
105840             COMPUTE ACUM-VR-CRED-TAB (TPCONTAB-RED-WS) =         00105840
105850               (DI-MOV-VR-WS * -1) + ACUM-VR-CRED-TAB             00105850
105860                (TPCONTAB-RED-WS)                                 00105860
105870             PERFORM 268-35-ACUMULA-DEB-FISICA-JUR                00105870
105880         ELSE                                                     00105880
105890             PERFORM 269-35-SOMA-DEB-FISICA-JUR                   00105890
105900             ADD DI-MOV-VR-WS TO ACUM-VR-CRED-TAB                 00105900
105910                 (TPCONTAB-RED-WS).                               00105910
105920                                                                  00105920
105930 267-35-ACUMULA-CRE-FISICA-JUR.                                   00105930

105940     IF TPCONTAB-RED-WS = 01                                      00105940
105950        COMPUTE ACUM-VR-CRED-TAB (92) = (DI-MOV-VR-WS * -1) +     00105950
105960                ACUM-VR-CRED-TAB (92)                             00105960
105970        ADD 1 TO ACUM-QDE-CRED-TAB (92)                           00105970
105980     ELSE                                                         00105980
105990        IF TPCONTAB-RED-WS = 02                                   00105990
106000         IF CH-EMPRESA OR CH-EMPRESA-PP                           00106000
106010            IF CHE-INDUST OR CHE-INDUST-PP                        00106010
106020              COMPUTE ACUM-VR-CRED-TAB (89) =                     00106020
106030                      (DI-MOV-VR-WS * -1) + ACUM-VR-CRED-TAB (89) 00106030
106040              ADD 1 TO ACUM-QDE-CRED-TAB (89)                     00106040
106050            ELSE                                                  00106050
106060            IF CHE-COMERC OR CHE-COMERC-PP                        00106060
106070              COMPUTE ACUM-VR-CRED-TAB (90) =                     00106070
106080                      (DI-MOV-VR-WS * -1) + ACUM-VR-CRED-TAB (90) 00106080
106090              ADD 1 TO ACUM-QDE-CRED-TAB (90)                     00106090
106100            ELSE                                                  00106100
106110            IF CHE-OUTROS OR CHE-OUTROS-PP                        00106110
106120              COMPUTE ACUM-VR-CRED-TAB (91) =                     00106120
106130                      (DI-MOV-VR-WS * -1) + ACUM-VR-CRED-TAB (91) 00106130
106140              ADD 1 TO ACUM-QDE-CRED-TAB (91)                     00106140
106150            ELSE                                                  00106150
106160              NEXT SENTENCE                                       00106160
106170           ELSE                                                   00106170
106180            IF CTA-EMPRESARIAL                                    00106180
106190               IF INDUSTRIA                                       00106190
106200                  COMPUTE ACUM-VR-CRED-TAB (86) =                 00106200
106210                      (DI-MOV-VR-WS * -1) + ACUM-VR-CRED-TAB (86) 00106210
106220                  ADD 1 TO ACUM-QDE-CRED-TAB (86)                 00106220
106230               ELSE                                               00106230
106240               IF COMERCIO                                        00106240
106250                  COMPUTE ACUM-VR-CRED-TAB (87) =                 00106250
106260                      (DI-MOV-VR-WS * -1) + ACUM-VR-CRED-TAB (87) 00106260
106270                  ADD 1 TO ACUM-QDE-CRED-TAB (87)                 00106270
106280               ELSE                                               00106280
106290               IF OUTROS                                          00106290
106300                  COMPUTE ACUM-VR-CRED-TAB (88) =                 00106300
106310                      (DI-MOV-VR-WS * -1) + ACUM-VR-CRED-TAB (88) 00106310
106320                  ADD 1 TO ACUM-QDE-CRED-TAB (88).                00106320
106330                                                                  00106330
106340 268-35-ACUMULA-DEB-FISICA-JUR.                                   00106340

106350     IF TPCONTAB-RED-WS = 01                                      00106350
106360        COMPUTE ACUM-VR-DEB-TAB (92) = (DI-MOV-VR-WS * -1) +      00106360
106370                ACUM-VR-DEB-TAB (92)                              00106370
106380        ADD 1 TO ACUM-QDE-DEB-TAB (92)                            00106380
106390     ELSE                                                         00106390
106400        IF TPCONTAB-RED-WS = 02                                   00106400
106410           IF CH-EMPRESA OR CH-EMPRESA-PP                         00106410
106420              IF CHE-INDUST OR CHE-INDUST-PP                      00106420
106430                 COMPUTE ACUM-VR-DEB-TAB (89) =                   00106430
106440                    (DI-MOV-VR-WS * -1) + ACUM-VR-DEB-TAB (89)    00106440
106450                 ADD 1 TO ACUM-QDE-DEB-TAB (89)                   00106450
106460              ELSE                                                00106460
106470              IF CHE-COMERC OR CHE-COMERC-PP                      00106470
106480                 COMPUTE ACUM-VR-DEB-TAB (90) =                   00106480
106490                    (DI-MOV-VR-WS * -1) + ACUM-VR-DEB-TAB (90)    00106490
106500                 ADD 1 TO ACUM-QDE-DEB-TAB (90)                   00106500
106510              ELSE                                                00106510
106520              IF CHE-OUTROS OR CHE-OUTROS-PP                      00106520
106530                 COMPUTE ACUM-VR-DEB-TAB (91) =                   00106530
106540                    (DI-MOV-VR-WS * -1) + ACUM-VR-DEB-TAB (91)    00106540
106550                 ADD 1 TO ACUM-QDE-DEB-TAB (91)                   00106550
106560              ELSE                                                00106560
106570                 NEXT SENTENCE                                    00106570
106580           ELSE                                                   00106580
106590              IF CTA-EMPRESARIAL                                  00106590
106600                 IF INDUSTRIA                                     00106600
106610                    COMPUTE ACUM-VR-DEB-TAB (86) =                00106610
106620                       (DI-MOV-VR-WS * -1) + ACUM-VR-DEB-TAB (86) 00106620
106630                    ADD 1 TO ACUM-QDE-DEB-TAB (86)                00106630
106640                 ELSE                                             00106640
106650                 IF COMERCIO                                      00106650
106660                    COMPUTE ACUM-VR-DEB-TAB (87) =                00106660
106670                       (DI-MOV-VR-WS * -1) + ACUM-VR-DEB-TAB (87) 00106670
106680                    ADD 1 TO ACUM-QDE-DEB-TAB (87)                00106680
106690                 ELSE                                             00106690
106700                 IF OUTROS                                        00106700
106710                    COMPUTE ACUM-VR-DEB-TAB (88) =                00106710
106720                       (DI-MOV-VR-WS * -1) + ACUM-VR-DEB-TAB (88) 00106720
106730                    ADD 1 TO ACUM-QDE-DEB-TAB (88).               00106730
106750*                                                                 00106750
106760 269-35-SOMA-DEB-FISICA-JUR.                                      00106760

106770     IF TPCONTAB-RED-WS = 01                                      00106770
106780        ADD DI-MOV-VR-WS TO ACUM-VR-DEB-TAB (92)                  00106780
106790        ADD 1 TO ACUM-QDE-DEB-TAB (92)                            00106790
106800     ELSE                                                         00106800
106810        IF TPCONTAB-RED-WS = 02                                   00106810
106820           IF CH-EMPRESA OR CH-EMPRESA-PP                         00106820
106830              IF CHE-INDUST                                       00106830
106840                 ADD DI-MOV-VR-WS TO ACUM-VR-DEB-TAB (89)         00106840
106850                 ADD 1 TO ACUM-QDE-DEB-TAB (89)                   00106850
106860              ELSE                                                00106860
106870              IF CHE-COMERC OR CHE-COMERC-PP                      00106870
106880                 ADD DI-MOV-VR-WS TO ACUM-VR-DEB-TAB (90)         00106880
106890                 ADD 1 TO ACUM-QDE-DEB-TAB (90)                   00106890
106900              ELSE                                                00106900
106910              IF CHE-OUTROS OR CHE-OUTROS-PP                      00106910
106920                 ADD DI-MOV-VR-WS TO ACUM-VR-DEB-TAB (91)         00106920
106930                 ADD 1 TO ACUM-QDE-DEB-TAB (91)                   00106930
106940              ELSE                                                00106940
106950                 NEXT SENTENCE                                    00106950
106960           ELSE                                                   00106960
106970              IF CTA-EMPRESARIAL                                  00106970
106980                 IF INDUSTRIA                                     00106980
106990                    ADD DI-MOV-VR-WS TO ACUM-VR-DEB-TAB (86)      00106990
107000                    ADD 1 TO ACUM-QDE-DEB-TAB (86)                00107000
107010                 ELSE                                             00107010
107020                 IF COMERCIO                                      00107020
107030                    ADD DI-MOV-VR-WS TO ACUM-VR-DEB-TAB (87)      00107030
107040                    ADD 1 TO ACUM-QDE-DEB-TAB (87)                00107040
107050                 ELSE                                             00107050
107060                 IF OUTROS                                        00107060
107070                    ADD DI-MOV-VR-WS TO ACUM-VR-DEB-TAB (88)      00107070
107080                    ADD 1 TO ACUM-QDE-DEB-TAB (88).               00107080
107090                                                                  00107090
107100*                                                                 00107100
************************************************************************
DOCINI****F* P04808/270-35-INSUF-EXCESSO-VENCIM
DOCTXT* OBJETIVO
DOCTXT*   Esta rotina eh chamada exatamente antes do salvamento. Isso
DOCTXT*   e necessario para realizar a regularizacao de um adiantamento,
DOCTXT*   ou para atualizar as variaveis usadas para calculo dos
DOCTXT*   encargos equivalentes.
DOCEND******
107110 270-35-INSUF-EXCESSO-VENCIM.                                     00107110
107120*                                                                 00107120
107130     IF REGULARIZA-INSUF                                          00107130
107140         PERFORM 295-35-REGULARIZA-INSUF.                         00107140
107150                                                                  00107150
107160     COMPUTE WVALOR-EXCESSO-ATU = SLD-EMP-RED-WS * (-1).          00107160
107170     COMPUTE WVALOR-EXCESSO-ANT = SLD-EMP-ANT-WS * (-1).          00107170
107180     IF WVALOR-EXCESSO-ATU > EMP-LIM-RED-WS                       00107180
107190        IF SLD-EMP-ANT-WS LESS THAN ZEROS AND                     00107190
107200           SLD-EMP-RED-WS LESS THAN ZEROS                         00107200
107210           COMPUTE WSALDO-EXCESSO-ATU =                           00107210
107220               (WVALOR-EXCESSO-ANT - WVALOR-EXCESSO-ATU)          00107220
107230           IF WSALDO-EXCESSO-ATU LESS ZEROS                       00107230
107240              COMPUTE WSALDO-EXCESSO-ATU = WSALDO-EXCESSO-ATU -   00107240
107250                                           CPMF-WS                00107250
107260              IF WSALDO-EXCESSO-ATU LESS ZEROS                    00107260
107270                 ADD 1 TO QDE-INS-EXC-MES-RED-WS.                 00107270
107280                                                                  00107280
107290     IF WVALOR-EXCESSO-ATU > EMP-LIM-RED-WS                       00107290
107300        IF SLD-EMP-ANT-WS NOT LESS THAN ZEROS AND                 00107300
107310           SLD-EMP-RED-WS LESS THAN ZEROS                         00107310
107320           MOVE SLD-EMP-RED-WS TO WSALDO-EXCESSO-ATU              00107320
107330           IF WSALDO-EXCESSO-ATU LESS THAN ZEROS                  00107330
107340              COMPUTE WSALDO-EXCESSO-ATU = WSALDO-EXCESSO-ATU -   00107340
107350                                           CPMF-WS                00107350
107360              IF WSALDO-EXCESSO-ATU LESS ZEROS                    00107360
107370                 ADD 1 TO QDE-INS-EXC-MES-RED-WS.                 00107370
107380                                                                  00107380
107390     IF EMP-LIM-RED-WS = ZERO                                     00107390
107400         COMPUTE SLD-DISPONIVEL = SLD-DISP-S159-WS +              00107400
107410                                  SLD-DEP-RED-WS -                00107410
107420                 (SLD-BLO-RED-WS (1) + SLD-BLO-RED-WS (2) +       00107420
107430                  SLD-BLO-RED-WS (3) + SLD-BLO-RED-WS (4) +       00107430
107440                  SLD-BLO-RED-WS (5) + SLD-BLO-RED-WS (6) +       00107440
107450                  SLD-BLO-RED-WS (7) + SLD-BLO-RED-WS (8) +       00107450
107460                  SLD-BLO-RED-WS (9) + SLD-BLO-RED-WS (10) +      00107460
107470                  SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +     00107470
107480                  SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +     00107480
107490                  SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +     00107490
107500                  SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +     00107500
107510                  SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +     00107510
107520                  SLD-BLO-RED-WS (21))                            00107520
107530         IF SLD-DEP-RED-WS LESS ZERO                              00107530
      *            Saldo devedor real, ja contados os bloqueios
107540             MOVE 2 TO IND-MENS-FICHA SW-INSUF-EXCESSO-REAL       00107540
107550             PERFORM 290-35-ATL-INSUF-F10                         00107550
107560         ELSE                                                     00107560
107570             IF SLD-DISPONIVEL LESS ZERO                          00107570
      *            Saldo devedor, porem saldo bloqueado suficiente para
      *            cobrir saldo devedor
107580                 MOVE 1 TO IND-MENS-FICHA                         00107580
107590                 PERFORM 290-35-ATL-INSUF-F10                     00107590
107600             ELSE                                                 00107600
107610                 IF INSUF-EXCESSO-RED-WS GREATER ZERO             00107610
107620                     PERFORM 295-35-REGULARIZA-INSUF              00107620
107630                 ELSE                                             00107630
107640                      NEXT SENTENCE                               00107640
107650     ELSE                                                         00107650
107660         MOVE EMP-VENC-RED-WS TO DATA-AUX-RED                     00107660
107670         PERFORM 275-35-INVERTE-DATAS                             00107670
107680         COMPUTE EXCESSO-F10-WS = (EMP-LIM-RED-WS +               00107680
107690                          SLD-DEP-RED-WS + SLD-EMP-RED-WS) -      00107690
107700                 (SLD-BLO-RED-WS (1) + SLD-BLO-RED-WS (2) +       00107700
107710                  SLD-BLO-RED-WS (3) + SLD-BLO-RED-WS (4) +       00107710
107720                  SLD-BLO-RED-WS (5) + SLD-BLO-RED-WS (6) +       00107720
107730                  SLD-BLO-RED-WS (7) + SLD-BLO-RED-WS (8) +       00107730
107740                  SLD-BLO-RED-WS (9) + SLD-BLO-RED-WS (10) +      00107740
107750                  SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +     00107750
107760                  SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +     00107760
107770                  SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +     00107770
107780                  SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +     00107780
107790                  SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +     00107790
107800                  SLD-BLO-RED-WS (21))                            00107800
107810         IF EXCESSO-F10-WS LESS ZERO                              00107810
107820            COMPUTE INS-VR-RELATIVO = EXCESSO-F10-WS +            00107820
107830                 (SLD-BLO-RED-WS (1) + SLD-BLO-RED-WS (2) +       00107830
107840                  SLD-BLO-RED-WS (3) + SLD-BLO-RED-WS (4) +       00107840
107850                  SLD-BLO-RED-WS (5) + SLD-BLO-RED-WS (6) +       00107850
107860                  SLD-BLO-RED-WS (7) + SLD-BLO-RED-WS (8) +       00107860
107870                  SLD-BLO-RED-WS (9) + SLD-BLO-RED-WS (10) +      00107870
107880                  SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +     00107880
107890                  SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +     00107890
107900                  SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +     00107900
107910                  SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +     00107910
107920                  SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +     00107920
107930                  SLD-BLO-RED-WS (21))                            00107930
107940             PERFORM 273-35-GUARDA-EXCESSO-REAL                   00107940
107950             MOVE ZEROS TO INS-VR-RELATIVO                        00107950
107960             IF DATA-AUX-Y2-INV-RED LESS DATA-INVERTIDA-RED       00107960
107970                 MOVE 5 TO IND-MENS-FICHA                         00107970
107980                 PERFORM 570-35-OCR-CONTA-VENCIDA                 00107980
107990                 PERFORM 550-35-OCR-INS-CTA-VENCIDA               00107990
108000                 PERFORM 280-35-ATL-EXCESSO-F10                   00108000
108010             ELSE                                                 00108010
108020                 MOVE 3 TO IND-MENS-FICHA                         00108020
108030                 PERFORM 280-35-ATL-EXCESSO-F10                   00108030
108040         ELSE                                                     00108040
108050             IF DATA-AUX-Y2-INV-RED LESS DATA-INVERTIDA-RED       00108050
108060                PERFORM 271-35-EXCLUI-PF-SEM-EXCESSO              00108060
108070                IF INSUF-EXCESSO-RED-WS GREATER ZERO              00108070
108080                   PERFORM 285-35-REGULARIZA-EXCESSO              00108080
108090                ELSE                                              00108090
108100                   NEXT SENTENCE                                  00108100
108110             ELSE                                                 00108110
108120                 IF INSUF-EXCESSO-RED-WS GREATER ZERO             00108120
108130                     PERFORM 285-35-REGULARIZA-EXCESSO.           00108130
108140                                                                  00108140
108150***** NO REL. DE CONTAS VENCIDAS NAO CONSTAM PESSOAS FISICAS, EXCE00108150
108160***** TO, AS Q ESTAO COM EXCESSO.(OCORRENCIA DESATIVADA, MOMENTANE00108160
108170***** AMENTE, ATEH QUE SEJA REATIVADA A ROTINA DE RENOVACAO AUTOMA00108170
108180***** TICA, PARA PESSOAS FISICAS, OCASIAO EM QUE DEVERAH SER EXCLU00108180
108190***** IDO O COMENTARIO (*) ABAIXO, DO COMANDO 'IF NOT P-FISICAS' )00108190
108200                                                                  00108200
108210 271-35-EXCLUI-PF-SEM-EXCESSO.                                    00108210
108220                                                                  00108220
108230*    IF  NOT P-FISICAS                                            00108230
108240         MOVE 4 TO IND-MENS-FICHA                                 00108240
108250         PERFORM 570-35-OCR-CONTA-VENCIDA                         00108250
108260         PERFORM 550-35-OCR-INS-CTA-VENCIDA.                      00108260
108270                                                                  00108270
108300 273-35-GUARDA-EXCESSO-REAL.                                      00108300
108310                                                                  00108310
108320     IF INS-VR-RELATIVO LESS ZEROS                                00108320
108330        COMPUTE INS-VR-ABSOLUTO = INS-VR-RELATIVO * (-1)          00108330
108340        IF INS-VR-ABSOLUTO GREATER NUM-INSUF-EXCESSO-RED-WS       00108340
108350           MOVE INS-VR-RELATIVO TO NUM-INSUF-EXCES-RED-WS.        00108350
108360                                                                  00108360
108380 275-35-INVERTE-DATAS.                                            00108380
108400                                                                  00108400
108410     MOVE DIA-AUX TO DIA-INV.                                     00108410
108420     MOVE MES-AUX TO MES-INV.                                     00108420
108430     CALL 'M0952000' USING ANO-AUX ANO-INV.                       00108430
108440                                                                  00108440
108450     MOVE DATA-INVERTIDA-RED TO DATA-AUX-Y2-INV-RED.              00108450
108460                                                                  00108460
108470     MOVE DIA-D07-WS TO DIA-INV.                                  00108470
108480     MOVE MES-D07-WS TO MES-INV.                                  00108480
108490     CALL 'M0952000' USING ANO-D07-WS ANO-INV.                    00108490
108500*                                                                 00108500
108510 280-35-ATL-EXCESSO-F10.                                          00108510
108520*                                                                 00108520
108530     ADD 1 TO EXC-VEZ-CONTRATO-RED-WS.                            00108530
108540     MOVE EXCESSO-F10-WS TO INS-VR-ABSOLUTO.                      00108540
108550     COMPUTE INS-VR-RELATIVO = EXCESSO-F10-WS +                   00108550
108560                          (SLD-BLO-RED-WS (1) + SLD-BLO-RED-WS (2)00108560
108570                         + SLD-BLO-RED-WS (3) + SLD-BLO-RED-WS (4)00108570
108580                         + SLD-BLO-RED-WS (5) + SLD-BLO-RED-WS (6)00108580
108590                         + SLD-BLO-RED-WS (7) + SLD-BLO-RED-WS (8)00108590
108600                        + SLD-BLO-RED-WS (9) + SLD-BLO-RED-WS (10)00108600
108610                       + SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12)00108610
108620                       + SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14)00108620
108630                       + SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16)00108630
108640                       + SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18)00108640
108650                       + SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20)00108650
108660                       + SLD-BLO-RED-WS (21)) + CRED-ANTECIP-WS.  00108660
108670                                                                  00108670
108680     IF INSUF-EXCESSO-RED-WS GREATER ZERO                         00108680
108690         MOVE 2 TO INSUF-EXCESSO-RED-WS                           00108690
108700     ELSE                                                         00108700
108710         MOVE DATA-D07-RED-WS TO EXC-NOVO-RED-WS                  00108710
108720         MOVE 1 TO INSUF-EXCESSO-RED-WS                           00108720
108730         IF INS-VR-RELATIVO LESS ZEROS                            00108730
108740            COMPUTE INS-VR-ABSOLUTO-WS = INS-VR-RELATIVO * (-1)   00108740
108750            IF INS-VR-ABSOLUTO-WS GREATER EXC-MOR-RED-R-WS        00108750
108760               MOVE INS-VR-RELATIVO TO EXC-MOR-RED-WS             00108760
108770               MOVE EXC-NOVO-RED-WS TO EXC-DATA-MOR-RED-WS.       00108770
108780                                                                  00108780
108790     MOVE 0 TO SW-EXCESSO-EXTINTO.                                00108790
108800     PERFORM 575-35-OCR-EXCESSO.                                  00108800
108900*                                                                 00108900
108910 285-35-REGULARIZA-EXCESSO.                                       00108910
108920*                                                                 00108920
108930     ADD 1 TO EXC-VEZ-RED-WS.                                     00108930
108940     MOVE EXC-NOVO-RED-WS TO EXC-ULT-RED-WS.                      00108940
108950     MOVE ZEROS TO EXC-NOVO-RED-WS INSUF-EXCESSO-RED-WS           00108950
108960                                         EXCESSO-F10-WS.          00108960
108970     MOVE 7 TO IND-MENS-FICHA.                                    00108970
108980     IF IMPESSOAL                                                 00108980
108990        NEXT SENTENCE                                             00108990
109000     ELSE                                                         00109000
109010        MOVE 1 TO SW-EXCESSO-EXTINTO                              00109010
109020        PERFORM 575-35-OCR-EXCESSO.                               00109020
109030     MOVE ZEROS TO INSUF-EXCESSO-RED-WS.                          00109030
109050*                                                                 00109050
************************************************************************
DOCINI****F* P04808/290-35-ATL-INSUF-F10
DOCTXT* OBJETIVO
DOCTXT*   Deve ser chamado apenas apos alterar/validar dados referentes
DOCTXT*   a insuficiencia de fundos (antes do salvamento da conta).
DOCTXT*   Verifica se a conta se encontra em estado de insuficiencia a
DOCTXT*   fim de ou garantir que os juros sejam calculados corretamente.
DOCTXT*   Os dois casos sao: a conta nao estava com insuficiencia e
DOCTXT*   passou a ficar com saldo devedor (insuficiencia); A conta ja
DOCTXT*   se encontrava com insuficiencia de fundos e permaneceu com
DOCTXT*   saldo insuficiente.
DOCTXT*   Apos calcular insuficiencia relativa (saldo devedor - saldo
DOCTXT*   bloqueado) verifica se eh o maior patamar de saldo devedor
DOCTXT*   (INS-MOR-RED) para armazenar novo patamar se for o caso.
DOCEND******
109060 290-35-ATL-INSUF-F10.                                            00109060
109070*                                                                 00109070
109080     IF INSUF-EXCESSO-RED-WS = ZERO                               00109080
109090         MOVE 1 TO INSUF-EXCESSO-RED-WS                           00109090
109100         MOVE DATA-D07-RED-WS TO INS-NOVA-RED-WS                  00109100
109110         PERFORM 300-35-INSUF-JUROS-IOF                           00109110
109120         IF INS-VR-RELATIVO LESS ZEROS                            00109120
109130            COMPUTE INS-VR-ABSOLUTO-WS =  INS-VR-RELATIVO * (-1)  00109130
109140            IF INS-VR-ABSOLUTO-WS GREATER INS-MOR-RED-R-WS        00109140
109150               MOVE INS-VR-RELATIVO TO INS-MOR-RED-WS             00109150
109160               MOVE INS-NOVA-RED-WS TO INS-DATA-MOR-RED-WS        00109160
109170            ELSE                                                  00109170
109180               NEXT SENTENCE                                      00109180
109190         ELSE                                                     00109190
109200            NEXT SENTENCE                                         00109200
109210     ELSE                                                         00109210
109220         PERFORM 300-35-INSUF-JUROS-IOF                           00109220
109230         MOVE 2 TO INSUF-EXCESSO-RED-WS.                          00109230
109240                                                                  00109240
109480     PERFORM 550-35-OCR-INSUFICIENCIA.                            00109480
109500                                                                  00109500
109510 292-235E-COMPOSICAO-INS.                                         00109510
109520                                                                  00109520
109530     MOVE W-RAP-WS TO VALOR-D83.                                  00109530
109540                                                                  00109540
109550     PERFORM 999-110-CALCULA-DIAS-VENCIDO.                        00109550
109560                                                                  00109560
109570     IF QDE-DIAS-VENC-WS GREATER THAN 59                          00109570
109580        MOVE 05105    TO EVENTO-D83                               00109580
109590        MOVE 5        TO DIG-EVENTO-D83                           00109590
109600     ELSE                                                         00109600
109610        MOVE 00843    TO EVENTO-D83                               00109610
109620        MOVE 5        TO DIG-EVENTO-D83.                          00109620
109630*E                                                                00109630
109640     MOVE 2           TO LANCTO-D83.                              00109640
109650     PERFORM 999-35-GRAVA-D04883.                                 00109650
109660                                                                  00109660
109670     COMPUTE VALOR-D83 = HIST-392-WS + W-RAP-WS.                  00109670
109680     MOVE 05111       TO EVENTO-D83.                              00109680
109690     MOVE 0           TO DIG-EVENTO-D83.                          00109690
109700     MOVE 1           TO LANCTO-D83.                              00109700
109710     IF VALOR-D83 NOT EQUAL ZEROS                                 00109710
109720        PERFORM 999-35-GRAVA-D04883.                              00109720
109730     MOVE ZEROS TO RAP-RED-WS.                                    00109730
109740                                                                  00109740
109770 292-235E-COMPOSICAO-INS2.                                        00109770
109780*                                                                 00109780
109790     MOVE HIST-392-WS TO VALOR-D83.                               00109790
109800                                                                  00109800
109810     PERFORM 999-110-CALCULA-DIAS-VENCIDO.                        00109810
109820                                                                  00109820
109830     IF QDE-DIAS-VENC-WS GREATER THAN 59                          00109830
109840        MOVE 05105    TO EVENTO-D83                               00109840
109850        MOVE 5        TO DIG-EVENTO-D83                           00109850
109860     ELSE                                                         00109860
109870        MOVE 00843    TO EVENTO-D83                               00109870
109880        MOVE 5        TO DIG-EVENTO-D83.                          00109880
109890*E                                                                00109890
109900     MOVE 2           TO LANCTO-D83.                              00109900
109910     PERFORM 999-35-GRAVA-D04883.                                 00109910
109920     COMPUTE RAP-RED-WS = RAP-RED-WS - HIST-392-WS.               00109920
109930                                                                  00109930
************************************************************************
DOCINI****F* P04808/295-35-REGULARIZA-INSUF
DOCTXT* OBJETIVO
DOCTXT*   Gerar ocorrencia de regularizacao de insuficiencia de fundos
DOCTXT*   e contabilizacao dos eventos relacionados a adiantamento de
DOCTXT*   depositantes.
DOCEND******
109940 295-35-REGULARIZA-INSUF.                                         00109940
109950*                                                                 00109950
109960     ADD 1                TO INS-VEZ-RED-WS.                      00109960
109970     MOVE INS-NOVA-RED-WS TO INS-ULT-RED-WS.                      00109970
109980     MOVE ZERO            TO INS-NOVA-RED-WS INSUF-EXCESSO-RED-WS.00109980
109990                                                                  00109990
110220     PERFORM 550-35-OCR-INSUFICIENCIA.                            00110220
110230                                                                  00110230
110240     MOVE 2 TO SW-REGULARIZA-INSUF.                               00110240
110250     MOVE 8 TO IND-MENS-FICHA.                                    00110250
110260                                                                  00110260
************************************************************************
DOCINI****F* P04808/300-35-INSUF-JUROS-IOF
DOCTXT* OBJETIVO
DOCTXT*   Calcula valor relativo de insuficiencia, que eh a soma do
DOCTXT*   saldo disponivel e dos valores bloqueados.
DOCEND******
110280 300-35-INSUF-JUROS-IOF.                                          00110280
110290*                                                                 00110290
110300     COMPUTE MVR-CALC-WS = MVR-WS * 0.                            00110300
110310     MOVE SLD-DISPONIVEL TO INS-VR-ABSOLUTO.                      00110310
110320     IF INSUF-EXCESSO-REAL                                        00110320
110330        COMPUTE INS-VR-RELATIVO = SLD-DISPONIVEL +                00110330
110340                          (SLD-BLO-RED-WS (1) + SLD-BLO-RED-WS (2)00110340
110350                         + SLD-BLO-RED-WS (3) + SLD-BLO-RED-WS (4)00110350
110360                         + SLD-BLO-RED-WS (5) + SLD-BLO-RED-WS (6)00110360
110370                         + SLD-BLO-RED-WS (7) + SLD-BLO-RED-WS (8)00110370
110380                        + SLD-BLO-RED-WS (9) + SLD-BLO-RED-WS (10)00110380
110390                       + SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12)00110390
110400                       + SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14)00110400
110410                       + SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16)00110410
110420                       + SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18)00110420
110430                       + SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20)00110430
110440                       + SLD-BLO-RED-WS (21)) + CRED-ANTECIP-WS   00110440
110450     ELSE                                                         00110450
110460        MOVE ZEROS TO INS-VR-RELATIVO.                            00110460
110480*                                                                 00110480
110490 305-35-CALCULA-JUROS-IOF.                                        00110490
110500*                                                                 00110500
110510     IF P-JURIDICAS AND NOT FACTORING                             00110510
110520        IF DIA-D07-WS GREATER 1                                   00110520
110530           IF CH-HIST-D07 = 37 OR 39                              00110530
110540*             COMPUTE JUR-DEV-D10 ROUNDED = (EMP-NUM-IOF-RED-WS * 00110540
110550*                  TX-IOF-JURID-WS) / DIVISOR-IOF                 00110550
                    MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO JUR-DEV-D10
110560              PERFORM 580-35-OCR-JUROS-IOF                        00110560
110570           ELSE                                                   00110570
110580              MOVE JUROS-DIARIOS-WS TO JUR-DEV-D10                00110580
110590              PERFORM 580-35-OCR-JUROS-IOF                        00110590
110600     ELSE                                                         00110600
110610*       MOVE ZEROS TO JUR-IOF-MEDIA-D10 JUR-DEV-D10               00110610
              MOVE ZEROS TO JUR-IOF-MEDIA-D10
110620*       PERFORM 580-35-OCR-JUROS-IOF.                             00110620
              IF CH-HIST-D07 = 37 OR 39
                 MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO JUR-DEV-D10
                 PERFORM 580-35-OCR-JUROS-IOF
              ELSE
                 MOVE JUROS-DIARIOS-WS TO JUR-DEV-D10
                 PERFORM 580-35-OCR-JUROS-IOF.
110630                                                                  00110630
110640     IF P-FISICAS                                                 00110640
110650        IF DIA-D07-WS GREATER 1                                   00110650
110660           IF CH-HIST-D07 = 37 OR 39                              00110660
110670*             COMPUTE JUR-DEV-D10 ROUNDED = (EMP-NUM-IOF-RED-WS * 00110670
110680*                     TX-IOF-FISICA-WS) / DIVISOR-IOF             00110680
                    MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO JUR-DEV-D10
110690              PERFORM 580-35-OCR-JUROS-IOF                        00110690
110700           ELSE                                                   00110700
110710              MOVE JUROS-DIARIOS-WS TO JUR-DEV-D10                00110710
110720              PERFORM 580-35-OCR-JUROS-IOF                        00110720
110730        ELSE                                                      00110730
110740*          MOVE ZEROS TO JUR-IOF-MEDIA-D10 JUR-DEV-D10            00110740
                 MOVE ZEROS TO JUR-IOF-MEDIA-D10
110750*          PERFORM 580-35-OCR-JUROS-IOF.                          00110750
                 IF CH-HIST-D07 = 37 OR 39
                    MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO JUR-DEV-D10
                    PERFORM 580-35-OCR-JUROS-IOF
                 ELSE
                    MOVE JUROS-DIARIOS-WS TO JUR-DEV-D10
                    PERFORM 580-35-OCR-JUROS-IOF.
110760*                                                                 00110760
110800 306-35-EVENTO-JUROS.                                             00110800
110810                                                                  00110810
110820     MOVE TR-VALOR-D07 TO VALOR-D83                               00110820
110830     PERFORM 999-110-CALCULA-DIAS-VENCIDO                         00110830
110840     IF QDE-DIAS-VENC-WS GREATER THAN 59                          00110840
110850        MOVE 04989        TO EVENTO-D83                           00110850
110860        MOVE 1            TO DIG-EVENTO-D83                       00110860
110870        MOVE 1            TO LANCTO-D83                           00110870
110880        COMPUTE RAP-RED-WS = RAP-RED-WS - TR-VALOR-D07            00110880
110890        PERFORM 999-35-GRAVA-D04883                               00110890
110900     ELSE                                                         00110900
110910        MOVE 962          TO EVENTO-D83                           00110910
110920        MOVE 8            TO DIG-EVENTO-D83                       00110920
110930        MOVE 1            TO LANCTO-D83                           00110930
110940        PERFORM 999-35-GRAVA-D04883.                              00110940
110950                                                                  00110950
110960 307-35-EVENTO-IOF.                                               00110960
110970                                                                  00110970
110980     MOVE TR-VALOR-D07 TO VALOR-D83                               00110980
110990     MOVE 1            TO LANCTO-D83                              00110990
111000     IF ID-CPF-CGC-RED-WS = 1                                     00111000
111010        MOVE 04631        TO EVENTO-D83                           00111010
111020        MOVE 0            TO DIG-EVENTO-D83                       00111020
111030        PERFORM 999-35-GRAVA-D04883                               00111030
111040     ELSE                                                         00111040
111050        MOVE 00054        TO EVENTO-D83                           00111050
111060        MOVE 0            TO DIG-EVENTO-D83                       00111060
111070        PERFORM 999-35-GRAVA-D04883.                              00111070
111080                                                                  00111080
111090 308-35-EVENTO-ESTORNO-IOF.                                       00111090
111100                                                                  00111100
111110     MOVE TR-VALOR-D07 TO VALOR-D83                               00111110
111120     MOVE 2            TO LANCTO-D83                              00111120
111130     IF ID-CPF-CGC-RED-WS = 1                                     00111130
111140        MOVE 04631        TO EVENTO-D83                           00111140
111150        MOVE 0            TO DIG-EVENTO-D83                       00111150
111160        PERFORM 999-35-GRAVA-D04883                               00111160
111170     ELSE                                                         00111170
111180        MOVE 00054        TO EVENTO-D83                           00111180
111190        MOVE 0            TO DIG-EVENTO-D83                       00111190
111200        PERFORM 999-35-GRAVA-D04883.                              00111200
111210                                                                  00111210
111220 309-35-EVENTO-INS-JUROS.                                         00111220
111230                                                                  00111230
111240     IF TR-VALOR-D07 < INS-NJUR-REAL-RED-WS                       00111240
111250        COMPUTE INS-NJUR-REAL-RED-WS =                            00111250
111260                INS-NJUR-REAL-RED-WS - TR-VALOR-D07               00111260
111270     ELSE                                                         00111270
111280        MOVE ZEROS TO INS-NJUR-REAL-RED-WS.                       00111280
111290                                                                  00111290
111300     MOVE TR-VALOR-D07 TO VALOR-D83                               00111300
111310     MOVE 1            TO LANCTO-D83                              00111310
111320                                                                  00111320
111330*    PERFORM 999-110-CALCULA-DIAS-VENCIDO.                        00111330
111350                                                                  00111350
111360*    IF QDE-DIAS-VENC-WS GREATER 59                               00111360
      *       MOVE 1            TO SW-TEM-HIST-515
111370*       COMPUTE RAP-RED-WS = RAP-RED-WS + TR-VALOR-D07            00111370
111380*       MOVE 05105        TO EVENTO-D83                           00111380
111390*       MOVE 5            TO DIG-EVENTO-D83                       00111390
111400*       PERFORM 999-35-GRAVA-D04883                               00111400
111410*    END-IF                                                       00111410
111420        MOVE 00843        TO EVENTO-D83                           00111420
111430        MOVE 5            TO DIG-EVENTO-D83                       00111430
111440        PERFORM 999-35-GRAVA-D04883.                              00111440
111450                                                                  00111450
DOCINI****F* P04808/310-35-EVENTO-INS-IOF
DOCTXT* OBJETIVO
DOCTXT*   Recalcular variaveis referentes aos encargos de insuficiencia.
DOCTXT*   Chamada a partir do historico 516 de debito IOF COMPOS.INSUF.FUNDOS.
DOCTXT*
DOCEND******
111470 310-35-EVENTO-INS-IOF.                                           00111470
111480                                                                  00111480
111490     IF P-FISICAS OR FACTORING                                    00111490
111500        COMPUTE VALOR-IOF-WS ROUNDED =                            00111500
111510                ((INS-NIOF-REAL-RED-WS * TX-IOF-FISICA-WS) / 100) 00111510
111520        COMPUTE VALOR-D07-WS ROUNDED =                            00111520
111530                ((TR-VALOR-D07 / TX-IOF-FISICA-WS) * 100)         00111530
111540     ELSE                                                         00111540
111550        COMPUTE VALOR-IOF-WS ROUNDED =                            00111550
111560                ((INS-NIOF-REAL-RED-WS * TX-IOF-JURID-WS) / 100)  00111560
111570        COMPUTE VALOR-D07-WS ROUNDED =                            00111570
111580                ((TR-VALOR-D07 / TX-IOF-JURID-WS) * 100).         00111580
111590                                                                  00111590
111600*.................................................................00111600
111610*    CALCULO IOF ADICIONAL 0,38%                                  00111610
111620*.................................................................00111620
111630                                                                  00111630
111640     MOVE ZEROS TO IOF-ADICIONAL-WS                               00111640
111660     IF ACUM-BASE-IOF-ADIC-RED-WS NOT EQUAL ZEROS                 00111660
111670        COMPUTE IOF-ADICIONAL-WS =                                00111670
111690               ((ACUM-BASE-IOF-ADIC-RED-WS * 0,38) / 100) * -1    00111690
111700        IF IOF-ADICIONAL-WS NOT EQUAL ZEROS                       00111700
111710           COMPUTE VALOR-IOF-WS = VALOR-IOF-WS + IOF-ADICIONAL-WS.00111710
111720*.................................................................00111720
111730                                                                  00111730
111740     IF TR-VALOR-D07 < VALOR-IOF-WS                               00111740
111750        IF INS-NIOF-REAL-RED-WS > 0                               00111750
111760           COMPUTE INS-NIOF-REAL-RED-WS =                         00111760
111770                   INS-NIOF-REAL-RED-WS - VALOR-D07-WS            00111770
111780        END-IF                                                    00111780
111820        IF ACUM-BASE-IOF-ADIC-RED-WS > 0                          00111820
111830           COMPUTE ACUM-BASE-IOF-ADIC-RED-WS =                    00111830
111840                   ACUM-BASE-IOF-ADIC-RED-WS - VALOR-D07-WS       00111840
111850        END-IF                                                    00111850
111860     ELSE                                                         00111860
111870        MOVE ZEROS TO INS-NIOF-REAL-RED-WS                        00111870
111890                      ACUM-BASE-IOF-ADIC-RED-WS.                  00111890
111900                                                                  00111900
111910     MOVE TR-VALOR-D07 TO VALOR-D83                               00111910
111920     MOVE 1            TO LANCTO-D83                              00111920
111930                                                                  00111930
111940     IF ID-CPF-CGC-RED-WS = 1                                     00111940
111950        MOVE 04998        TO EVENTO-D83                           00111950
111960        MOVE 0            TO DIG-EVENTO-D83                       00111960
111970        PERFORM 999-35-GRAVA-D04883                               00111970
111980     ELSE                                                         00111980
111990        MOVE 04992        TO EVENTO-D83                           00111990
112000        MOVE 1            TO DIG-EVENTO-D83                       00112000
112010        PERFORM 999-35-GRAVA-D04883.                              00112010
112020                                                                  00112020
112040 315-35-ACUMULA-SALDOS.                                           00112040
112060                                                                  00112060
112070     IF EXCLUI-CONTA AND                                          00112070
112080        SLD-DEP-RED-WS EQUAL ZEROS AND                            00112080
112090        SLD-EMP-RED-WS EQUAL ZEROS                                00112090
112100        NEXT SENTENCE                                             00112100
112110     ELSE                                                         00112110
112120     IF EMP-LIM-RED-WS GREATER ZEROS                              00112120
112130         ADD 1 TO ACUM-QDE-ATL-TAB (TPCONTAB-RED-WS)              00112130
112140         ADD 1 TO ACUM-QDE-ATL-TAB (98)                           00112140
112150         ADD EMP-LIM-RED-WS TO ACUM-SLD-ATL-TAB (98)              00112150
112160         IF SLD-EMP-RED-WS LESS ZERO                              00112160
112170             PERFORM 316-35-ACUMULA-POR-TITCONTAB                 00112170
112180             IF EMP-NUM-RED-WS = ZERO                             00112180
112190                 NEXT SENTENCE                                    00112190
112200             ELSE                                                 00112200
112210                 ADD 1 TO ACUM-QDE-ATL-TAB (97)                   00112210
112220                 IF FUNC                                          00112220
112230                    COMPUTE NUM-TOTAL-FUNC-WS =                   00112230
112240                      EMP-NUM-RED-WS + EMP-NUM-EXCED-FUNC-RED-WS  00112240
112250                    ADD NUM-TOTAL-FUNC-WS TO ACUM-SLD-ATL-TAB (97)00112250
112260                 ELSE                                             00112260
112270                    ADD EMP-NUM-RED-WS TO ACUM-SLD-ATL-TAB (97)   00112270
112280         ELSE                                                     00112280
112290             ADD 1 TO ACUM-QDE-ATL-TAB (99)                       00112290
112300             ADD SLD-DEP-RED-WS TO ACUM-SLD-ATL-TAB (99)          00112300
112310             ADD SLD-DEP-RED-WS TO ACUM-SLD-ATL-TAB               00112310
112320                                            (TPCONTAB-RED-WS)     00112320
112330             IF EMP-NUM-RED-WS = ZERO                             00112330
112340                 NEXT SENTENCE                                    00112340
112350             ELSE                                                 00112350
112360                 ADD 1 TO ACUM-QDE-ATL-TAB (97)                   00112360
112370                 IF FUNC                                          00112370
112380                    COMPUTE NUM-TOTAL-FUNC-WS =                   00112380
112390                        EMP-NUM-RED-WS + EMP-NUM-EXCED-FUNC-RED-WS00112390
112400                    ADD NUM-TOTAL-FUNC-WS TO ACUM-SLD-ATL-TAB (97)00112400
112410                 ELSE                                             00112410
112420                    ADD EMP-NUM-RED-WS TO ACUM-SLD-ATL-TAB (97)   00112420
112430     ELSE                                                         00112430
112440         ADD 1 TO ACUM-QDE-ATL-TAB (TPCONTAB-RED-WS)              00112440
112450         ADD SLD-DEP-RED-WS TO ACUM-SLD-ATL-TAB (TPCONTAB-RED-WS).00112450
112460*                                                                 00112460
112470 316-35-ACUMULA-POR-TITCONTAB.                                    00112470
112480*                                                                 00112480
112490     IF TPCONTAB-RED-WS = 01                                      00112490
112500        ADD SLD-EMP-RED-WS TO ACUM-SLD-ATL-TAB (92)               00112500
112510        ADD 1 TO ACUM-QDE-ATL-TAB (92)                            00112510
112520     ELSE                                                         00112520
112530        IF TPCONTAB-RED-WS = 02                                   00112530
112540           IF CH-EMPRESA OR CH-EMPRESA-PP                         00112540
112550              IF CHE-INDUST OR CHE-INDUST-PP                      00112550
112560                 ADD SLD-EMP-RED-WS TO ACUM-SLD-ATL-TAB (89)      00112560
112570                 ADD 1 TO ACUM-QDE-ATL-TAB (89)                   00112570
112580              ELSE                                                00112580
112590              IF CHE-COMERC OR CHE-COMERC-PP                      00112590
112600                 ADD SLD-EMP-RED-WS TO ACUM-SLD-ATL-TAB (90)      00112600
112610                 ADD 1 TO ACUM-QDE-ATL-TAB (90)                   00112610
112620              ELSE                                                00112620
112630              IF CHE-OUTROS OR CHE-OUTROS-PP                      00112630
112640                 ADD SLD-EMP-RED-WS TO ACUM-SLD-ATL-TAB (91)      00112640
112650                 ADD 1 TO ACUM-QDE-ATL-TAB (91)                   00112650
112660              ELSE                                                00112660
112670                 NEXT SENTENCE                                    00112670
112680           ELSE                                                   00112680
112690             IF CTA-EMPRESARIAL                                   00112690
112700                IF INDUSTRIA                                      00112700
112710                   ADD SLD-EMP-RED-WS TO ACUM-SLD-ATL-TAB (86)    00112710
112720                   ADD 1 TO ACUM-QDE-ATL-TAB (86)                 00112720
112730                ELSE                                              00112730
112740                IF COMERCIO                                       00112740
112750                   ADD SLD-EMP-RED-WS TO ACUM-SLD-ATL-TAB (87)    00112750
112760                   ADD 1 TO ACUM-QDE-ATL-TAB (87)                 00112760
112770                ELSE                                              00112770
112780                IF OUTROS                                         00112780
112790                   ADD SLD-EMP-RED-WS TO ACUM-SLD-ATL-TAB (88)    00112790
112800                   ADD 1 TO ACUM-QDE-ATL-TAB (88).                00112800
112810*                                                                 00112810
112820 318-35-TESTA-DIF-SALDOS.                                         00112820
112830*                                                                 00112830
112840     MOVE SPACES TO ESP-AC-CAD-WS.                                00112840
112850                                                                  00112850
112860     IF GR-DIFERENCA NOT = VR-MOV-RED-WS (MOV-NUM-RED-WS)         00112860
112870       OR QDE-GR-DIFERENCA GREATER 1                              00112870
112880         MOVE GR-DIFERENCA TO GR-DIF-VR-ABSOLUTO                  00112880
112890         IF JURIDICA OR PESSOA-K                                  00112890
112900             IF GR-DIF-VR-ABSOLUTO LESS GR-DIF-SLD-PJUR-WS OR     00112900
112910                NOT HA-GR-CRE-DEB                                 00112910
112920                NEXT SENTENCE                                     00112920
112930             ELSE                                                 00112930
112940                 MOVE 1 TO SW-OCR-GR-DIFERENCA                    00112940
112950                 PERFORM 530-35-OCR-ESPECIAIS                     00112950
112960         ELSE                                                     00112960
112970             IF GR-DIF-VR-ABSOLUTO NOT LESS GR-DIF-SLD-PFIS-WS OR 00112970
112980                HA-GR-CRE-DEB                                     00112980
112990                MOVE 1 TO SW-OCR-GR-DIFERENCA                     00112990
113000                PERFORM 530-35-OCR-ESPECIAIS.                     00113000
113010     MOVE 0 TO SW-INDICA-GR-CRE-DEB.                              00113010
113040*                                                                 00113040
113050 330-35-ATUALIZA-FIM-MES.                                         00113050
113060*                                                                 00113060
113070     MOVE DATA-ANT-MST-WS TO EXT-DATA-RED-WS.                     00113070
113080     MOVE ZEROS TO SOMA-BLOQ-WS.                                  00113080
113090     ADD SLD-BLO-RED-WS (1)                                       00113090
113100         SLD-BLO-RED-WS (2)                                       00113100
113110         SLD-BLO-RED-WS (3)                                       00113110
113120         SLD-BLO-RED-WS (4)                                       00113120
113130         SLD-BLO-RED-WS (5)                                       00113130
113140         SLD-BLO-RED-WS (6)                                       00113140
113150         SLD-BLO-RED-WS (7)                                       00113150
113160         SLD-BLO-RED-WS (8)                                       00113160
113170         SLD-BLO-RED-WS (9)                                       00113170
113180         SLD-BLO-RED-WS (10)                                      00113180
113190         SLD-BLO-RED-WS (11)                                      00113190
113200         SLD-BLO-RED-WS (12)                                      00113200
113210         SLD-BLO-RED-WS (13)                                      00113210
113220         SLD-BLO-RED-WS (14)                                      00113220
113230         SLD-BLO-RED-WS (15)                                      00113230
113240         SLD-BLO-RED-WS (16)                                      00113240
113250         SLD-BLO-RED-WS (17)                                      00113250
113260         SLD-BLO-RED-WS (18)                                      00113260
113270         SLD-BLO-RED-WS (19)                                      00113270
113280         SLD-BLO-RED-WS (20)                                      00113280
113290         SLD-BLO-RED-WS (21) TO SOMA-BLOQ-WS.                     00113290
113300     MOVE SOMA-BLOQ-WS TO EXT-VR-BLOQ-WS.                         00113300
113310     MOVE ZEROS TO SOMA-BLOQ-WS.                                  00113310
113320                                                                  00113320
113330     IF SLD-EMP-RED-WS LESS ZERO                                  00113330
113340         MOVE SLD-EMP-RED-WS TO EXT-SLD-RED-WS                    00113340
113350         MOVE 'E' TO EXT-TPSLD-RED-WS                             00113350
113360     ELSE                                                         00113360
113370         MOVE SLD-DEP-RED-WS TO EXT-SLD-RED-WS                    00113370
113380         MOVE 'D' TO EXT-TPSLD-RED-WS.                            00113380
113390                                                                  00113390
113400     MOVE ZERO TO IND1.                                           00113400
113420     PERFORM 999-30-ZERA-MOV-F10 17 TIMES.                        00113420
113430                                                                  00113430
113440     MOVE ZEROS TO MOV-NUM-RED-WS.                                00113440
113450*                                                                 00113450
113460 335-35-REMANEJA-SMEDIO.                                          00113460
113470*                                                                 00113470
113480     MOVE SMED-ATL5-RED-WS TO SMED-ATL6-RED-WS.                   00113480
113490     MOVE SMED-ATL4-RED-WS TO SMED-ATL5-RED-WS.                   00113490
113500     MOVE SMED-ATL3-RED-WS TO SMED-ATL4-RED-WS.                   00113500
113510     MOVE SMED-ATL2-RED-WS TO SMED-ATL3-RED-WS.                   00113510
113520     MOVE SMED-DEV-UTI2-RED-WS TO SMED-DEV-UTI3-RED-WS.           00113520
113530     MOVE SMED-ATL1-RED-WS TO SMED-ATL2-RED-WS.                   00113530
113540     MOVE SMED-DEV-UTI1-RED-WS TO SMED-DEV-UTI2-RED-WS.           00113540
113550     PERFORM 340-35-CALCULA-SMED-MES.                             00113550
113570                                                                  00113570
113580     MOVE ZEROS TO NUM-SMED-ESTE-RED-WS                           00113580
113590                EMP-NUM-RED-WS   EMP-NUM-EXCED-FUNC-RED-WS        00113590
113600                NUM-SEM-BLOQ-RED-WS                               00113600
113610                SLD-DEV-NUM-WS JUROS-DIARIOS-WS                   00113610
113620                SMED-DEV-ESTE-RED-WS FATOR-ACUMULADO-RED-WS       00113620
113630                DIAS-UTEIS-UTIL-RED-WS.                           00113630
113640                                                                  00113640
113650     IF INICIO-ANO                                                00113650
113660         MOVE ZEROS TO INS-ULT-RED-WS  INS-VEZ-RED-WS             00113660
113670                       INS-MOR-RED-WS  INS-DATA-MOR-RED-WS        00113670
113680                       EXC-VEZ-RED-WS  EXC-MOR-RED-WS             00113680
113690                       EXC-ULT-RED-WS  EXC-DATA-MOR-RED-WS        00113690
113700                       ACT-ULT-RED-WS  ACT-VEZ-RED-WS             00113700
113710                       ACT-MOR-RED-WS  ACT-DATA-MOR-RED-WS        00113710
113720                       NUM-ULT-RED-WS  NUM-VEZ-RED-WS             00113720
113730                       NUM-MOR-RED-WS  NUM-DATA-MOR-RED-WS        00113730
113740                       EMP-JCOB-RED-WS                            00113740
113750                       EXTRATO-EXTRA-RED-WS                       00113750
113760                       PERFORM 335A-35-ZERA-PERSON                00113760
113770                       IF EMP-LIM-RED-WS NOT EQUAL ZEROS          00113770
113780                          MOVE ZEROS TO NUM-INSUF-EXCESSO-RED-WS. 00113780
113810                                                                  00113810
113820 335A-35-ZERA-PERSON.                                             00113820
113830                                                                  00113830
113840     IF  CH-CONTA-WS EQUAL 88887                                  00113840
113850         MOVE ZEROS TO CH-PERSON-WS CH-COMUM-WS CH-ESPECIAL-WS    00113850
113860     ELSE                                                         00113860
113870         COMPUTE TALON-PEDIDOS-ACUM-RED-WS =                      00113870
113880                 (TALON-FORNECIDOS-RED-WS * -1) +                 00113880
113890                  TALON-PEDIDOS-ACUM-RED-WS                       00113890
113900         MOVE ZEROS TO TALON-FORNECIDOS-RED-WS.                   00113900
113910                                                                  00113910
113950 340-35-CALCULA-SMED-MES.                                         00113950
113960*                                                                 00113960
113970     IF MES-D07-WS = 1                                            00113970
113980         MOVE 12 TO MES-WS                                        00113980
113990         CALL 'M0952000' USING ANO-D07-WS ANO-WS1                 00113990
114000         COMPUTE ANO-WS1 = ANO-WS1 - 1                            00114000
114010         MOVE AA-WS1 TO ANO-WS                                    00114010
114020     ELSE                                                         00114020
114030         MOVE ANO-D07-WS TO ANO-WS                                00114030
114040         COMPUTE MES-WS = MES-D07-WS - 1.                         00114040
114050                                                                  00114050
114080                                                                  00114080
114190         COMPUTE SMED-ATL1-RED-WS = NUM-SMED-ESTE-RED-WS /        00114190
114200                           DIAS-UTEIS-WS.                         00114200
114220         COMPUTE SMED-DEV-UTI1-RED-WS = SMED-DEV-ESTE-RED-WS /    00114220
114230                           DIAS-UTEIS-WS.                         00114230
114240*                                                                 00114240
114610 500-35-OCR-HEAD-AGENCIA.                                         00114610
114620*                                                                 00114620
114630     MOVE 01 TO CH-TPREG-D10.                                     00114630
114640     MOVE CH-AG-WS TO CH-CODAG-D10.                               00114640
114650     MOVE ZEROS TO CONTA-D10 DV-CONTA-D10.                        00114650
114660     MOVE HF-SEQUENC-ATL-WS TO CH-SEQUENC-D10.                    00114660
114670     MOVE HAG-TELEPROCES-RED-WS TO HAG-TELEPROC-D10.              00114670
114680******************      SPREAD       *******************          00114680
114690*    MOVE HAG-VRMIN-RED-WS TO HAG-VRMIN-D10.                      00114690
114700     MOVE ZEROS            TO HAG-VRMIN-D10.                      00114700
114710********************************************************          00114710
114720                                                                  00114720
114730     MOVE HAG-PARAMETROS-RED-WS TO HAG-PARAMETRO-D10.             00114730
114740     MOVE HAG-VALOR-TAXAS-RED-WS TO HAG-VR-TAXAS-D10.             00114740
114750                                                                  00114750
114760     MOVE HAG-AG-NOME-RED-WS TO HAG-NOMEAG-D10.                   00114760
114770     MOVE DATA-D07-RED-WS TO HAG-DATA-D10.                        00114770
114780     MOVE CLASSE-GEROF-WS TO HAG-CLASSE-GEROF-D10.                00114780
114790                                                                  00114790
114800     PERFORM 999-15-ACUMULA-D10.                                  00114800
114810                                                                  00114810
114820     WRITE REG-HEADER-AGENCIA-D10                                 00114820
114830      INVALID KEY                                                 00114830
114840         PERFORM 999-20-ESTOUROU-AREA-D10.                        00114840
114850                                                                  00114850
114900 505-35-OCR-FICHA-CC.                                             00114900
114910*                                                                 00114910
114920     MOVE 08 TO CH-TPREG-D10.                                     00114920
114930     MOVE CH-AG-WS TO CH-CODAG-D10.                               00114930
114940     MOVE CH-CONTA-WS TO CONTA-D10.                               00114940
114950     MOVE CH-DIGITO-WS TO DV-CONTA-D10.                           00114950
114960     MOVE TPCONTAB-RED-WS TO FH-TPCONTAB-D10.                     00114960
114970     MOVE NOME-RED-WS TO FH-NOME-D10.                             00114970
114980     MOVE COD-POSTO-RED-WS TO FH-COD-POSTO-D10.                   00114980
114990     MOVE CLIENTE-PREFEREN-RED-WS TO FH-CLI-ESPECIAL-D10.         00114990
115000     MOVE TP-PESSOA-RED-WS TO FH-TP-PESSOA-D10.                   00115000

250412     MOVE  ZEROS           TO VAR-ORTN-D10

115010     IF TPCONTAB-RED-WS EQUAL 49                                  00115010
115020        MOVE CM-REINV-WS TO CRED-ANTECIP-D10                      00115020
115030     ELSE                                                         00115030
115040        MOVE CRED-ANTECIP-WS TO CRED-ANTECIP-D10.                 00115040
115050                                                                  00115050
115060     MOVE SLD-DEP-RED-WS TO FH-SLD-DEP-D10.                       00115060
115070     MOVE SLD-EMP-RED-WS TO FH-SLD-EMP-D10.                       00115070
115080     MOVE SLD-BLO-RED-WS (1) TO FH-SLD-BLO-1DIA-D10.              00115080
115090     MOVE SLD-BLO-RED-WS (2) TO FH-SLD-BLO-2DIA-D10.              00115090
115100     MOVE ZEROS TO FH-SLD-BLO-3DIA-D10.                           00115100
115110     ADD SLD-BLO-RED-WS (3)                                       00115110
115120         SLD-BLO-RED-WS (4)                                       00115120
115130         SLD-BLO-RED-WS (5)                                       00115130
115140         SLD-BLO-RED-WS (6)                                       00115140
115150         SLD-BLO-RED-WS (7)                                       00115150
115160         SLD-BLO-RED-WS (8)                                       00115160
115170         SLD-BLO-RED-WS (9)                                       00115170
115180         SLD-BLO-RED-WS (10)                                      00115180
115190         SLD-BLO-RED-WS (11)                                      00115190
115200         SLD-BLO-RED-WS (12)                                      00115200
115210         SLD-BLO-RED-WS (13)                                      00115210
115220         SLD-BLO-RED-WS (14)                                      00115220
115230         SLD-BLO-RED-WS (15)                                      00115230
115240         SLD-BLO-RED-WS (16)                                      00115240
115250         SLD-BLO-RED-WS (17)                                      00115250
115260         SLD-BLO-RED-WS (18)                                      00115260
115270         SLD-BLO-RED-WS (19)                                      00115270
115280         SLD-BLO-RED-WS (20)                                      00115280
115290         SLD-BLO-RED-WS (21) TO FH-SLD-BLO-3DIA-D10.              00115290

115300     IF DIA-D07-WS GREATER 1                                      00115300
115310        COMPUTE FH-SMED-D10 = (NUM-SMED-ESTE-RED-WS /             00115310
115320                              (DIA-D07-WS - 1))                   00115320
115330     ELSE                                                         00115330
115340        MOVE NUM-SMED-ESTE-RED-WS TO FH-SMED-D10.                 00115340
115350                                                                  00115350
115360     PERFORM 505A-35-TESTA-CONTRATO-VENCIDO.                      00115360
115370                                                                  00115370
115380     MOVE EMP-LIM-RED-WS  TO FH-EMP-LIM-D10.                      00115380
115390     IF FUNC                                                      00115390
115400        COMPUTE NUM-TOTAL-FUNC-WS =                               00115400
115410                EMP-NUM-RED-WS + EMP-NUM-EXCED-FUNC-RED-WS        00115410
115420        MOVE NUM-TOTAL-FUNC-WS TO FH-EMP-NUM-D10                  00115420
115430     ELSE                                                         00115430
115440        MOVE EMP-NUM-RED-WS  TO FH-EMP-NUM-D10.                   00115440
115450                                                                  00115450
115460     MOVE DATA-D07-RED-WS TO FH-DATA-D10 FICHA-DATA-RED-WS.       00115460
115470                                                                  00115470
115480     ADD 1 TO FICHA-NUM-RED-WS.                                   00115480
115490     MOVE FICHA-NUM-RED-WS TO FH-NUM-D10.                         00115490
115500                                                                  00115500
115510     MOVE ATL-ULT-MOV-RED-WS TO FH-ATL-ULT-MOV-D10.               00115510

250412     MOVE ZEROS             TO FH-MOVIMENTOS-D10.

115520     MOVE MOVIMENTOS-RED-WS TO FH-MOVIMENTOS-D10.                 00115520
115530                                                                  00115530
115540     IF IND-MENS-FICHA = ZERO                                     00115540
115550        MOVE SPACES TO FH-SITUACAO-CONTA-D10                      00115550
115560     ELSE                                                         00115560
115570        MOVE MENS-FICHA-TAB (IND-MENS-FICHA) TO                   00115570
115580                             FH-SITUACAO-CONTA-D10.               00115580
115590                                                                  00115590
115600        IF EMP-LIM-RED-WS GREATER ZERO                            00115600
115610           COMPUTE FH-JUR-DIA-D10 ROUNDED =                       00115610
115620                (TX-ENCARGOS-CONTERRANEO-WS                       00115620
115630                * SLD-EMP-RED-WS) / 3000                          00115630
115640                                                                  00115640
115650           MOVE ZEROS            TO FH-IOF-DIA-D10                00115650
115660           IF ATL-ULT-MOV-RED-WS = DATA-D07-RED-WS                00115660
115670              COMPUTE FH-JUR-ATE-EMIS-D10 =                       00115670
115680                   (EMP-NUM-RED-WS * (TX-ENCARGOS-CONTERRANEO-WS +00115680
115690                   VARIACAO-OTNF-WS + (VARIACAO-OTNF-WS *         00115690
115700                   TX-ENCARGOS-CONTERRANEO-WS) / 100)) / 3000     00115700
115710              MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO               00115710
115720                                FH-IOF-ATE-EMIS-D10               00115720
115730              IF FUNC                                             00115730
115740                 COMPUTE FH-JUR-ATE-EMIS-D10 =                    00115740
115750                         FH-JUR-ATE-EMIS-D10 / 2                  00115750
115760                 COMPUTE JUROS-EXCED-FUNC-WS =                    00115760
115770                         (EMP-NUM-EXCED-FUNC-RED-WS *             00115770
115780                         (TX-ENCARGOS-CONTERRANEO-WS +            00115780
115790                         VARIACAO-OTNF-WS + (VARIACAO-OTNF-WS *   00115790
115800                        TX-ENCARGOS-CONTERRANEO-WS) / 100)) / 300000115800
115810                 COMPUTE FH-JUR-ATE-EMIS-D10 =                    00115810
115820                         FH-JUR-ATE-EMIS-D10 + JUROS-EXCED-FUNC-WS00115820
115830              ELSE                                                00115830
115840                 NEXT SENTENCE                                    00115840
115850        ELSE                                                      00115850
115860              MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO               00115860
115870                                FH-IOF-ATE-EMIS-D10               00115870
115880              COMPUTE NUMEROS-WS = (SLD-EMP-RED-WS *              00115880
115890                      ATL-DIAS-PARAL-RED-WS) + EMP-NUM-RED-WS     00115890
115900              COMPUTE FH-JUR-ATE-EMIS-D10 =                       00115900
115910                     (NUMEROS-WS * (TX-ENCARGOS-CONTERRANEO-WS +  00115910
115920                     VARIACAO-OTNF-WS + (VARIACAO-OTNF-WS *       00115920
115930                     TX-ENCARGOS-CONTERRANEO-WS) / 100)) / 3000   00115930
115940              IF FUNC                                             00115940
115950                 IF SLD-EMP-RED-WS LESS -1000,00                  00115950
115960                    COMPUTE NUM-TOTAL-FUNC-WS =                   00115960
115970                            ((SLD-EMP-RED-WS + 1000,00) *         00115970
115980                ATL-DIAS-PARAL-RED-WS) + EMP-NUM-EXCED-FUNC-RED-WS00115980
115990                    COMPUTE NUMEROS-WS = (-1000 *                 00115990
116000                           ATL-DIAS-PARAL-RED-WS) + EMP-NUM-RED-WS00116000
116010                    COMPUTE FH-JUR-ATE-EMIS-D10 =                 00116010
116020                      ((NUMEROS-WS *                              00116020
116030                      (TX-ENCARGOS-CONTERRANEO-WS +               00116030
116040                      VARIACAO-OTNF-WS + (VARIACAO-OTNF-WS *      00116040
116050                      TX-ENCARGOS-CONTERRANEO-WS) / 100)) / 3000) 00116050
116060                                                          / 2     00116060
116070                    COMPUTE JUROS-EXCED-FUNC-WS =                 00116070
116080                           (NUM-TOTAL-FUNC-WS *                   00116080
116090                         (TX-ENCARGOS-CONTERRANEO-WS +            00116090
116100                         VARIACAO-OTNF-WS + (VARIACAO-OTNF-WS *   00116100
116110                       TX-ENCARGOS-CONTERRANEO-WS) / 100)) / 3000 00116110
116120                    COMPUTE FH-JUR-ATE-EMIS-D10 =                 00116120
116130                         FH-JUR-ATE-EMIS-D10 + JUROS-EXCED-FUNC-WS00116130
116140                 ELSE                                             00116140
116150                    COMPUTE FH-JUR-ATE-EMIS-D10 =                 00116150
116160                            FH-JUR-ATE-EMIS-D10 / 2               00116160
116170              ELSE                                                00116170
116180                 NEXT SENTENCE                                    00116180
116190     ELSE                                                         00116190
116200         MOVE ZEROS TO FH-JUR-ATE-EMIS-D10 FH-IOF-ATE-EMIS-D10    00116200
116210                      FH-JUR-DIA-D10       FH-IOF-DIA-D10         00116210
116220         COMPUTE SLD-REAL-WS = SLD-DEP-RED-WS -                   00116220
116230                 (SLD-BLO-RED-WS (1) + SLD-BLO-RED-WS (2) +       00116230
116240                  SLD-BLO-RED-WS (3) + SLD-BLO-RED-WS (4) +       00116240
116250                  SLD-BLO-RED-WS (5) + SLD-BLO-RED-WS (6) +       00116250
116260                  SLD-BLO-RED-WS (7) + SLD-BLO-RED-WS (8) +       00116260
116270                  SLD-BLO-RED-WS (9) + SLD-BLO-RED-WS (10) +      00116270
116280                  SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +     00116280
116290                  SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +     00116290
116300                  SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +     00116300
116310                  SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +     00116310
116320                  SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +     00116320
116330                  SLD-BLO-RED-WS (21))                            00116330
116340         IF SLD-REAL-WS LESS ZERO                                 00116340
116350           COMPUTE FH-JUR-DIA-D10 ROUNDED = (SLD-REAL-WS *        00116350
116360             TX-JUROS-WS) / 3000.                                 00116360
116370                                                                  00116370
116380     IF EMP-LIM-RED-WS NOT GREATER ZEROS                          00116380
116390        IF SLD-REAL-WS LESS THAN MVR-CALC-WS                      00116390
116400           MOVE ZEROS TO FH-IOF-DIA-D10                           00116400
116410           IF ATL-ULT-MOV-RED-WS EQUAL DATA-D07-RED-WS            00116410
116420              MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO               00116420
116430                                FH-IOF-ATE-EMIS-D10               00116430
116440           ELSE                                                   00116440
116450              MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO               00116450
116460                                FH-IOF-ATE-EMIS-D10               00116460
116470        ELSE                                                      00116470
116480           NEXT SENTENCE                                          00116480
116490     ELSE                                                         00116490
116500        IF INSUF-ANT GREATER ZEROS                                00116500
116510           MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO                  00116510
116520                             FH-IOF-ATE-EMIS-D10                  00116520
116530           MOVE ZEROS TO FH-IOF-DIA-D10.                          00116530
116540                                                                  00116540
116550     IF P-FISICAS                                                 00116550
116560        IF EMP-LIM-RED-WS GREATER ZERO                            00116560
116570           COMPUTE FH-JUR-DIA-D10 ROUNDED =                       00116570
116580                (TX-ENCARGOS-CONTERRANEO-WS                       00116580
116590                * SLD-EMP-RED-WS) / 3000                          00116590
116600           MOVE ZEROS TO FH-IOF-DIA-D10                           00116600
116610           IF ATL-ULT-MOV-RED-WS = DATA-D07-RED-WS                00116610
116620              COMPUTE FH-JUR-ATE-EMIS-D10 =                       00116620
116630                   (EMP-NUM-RED-WS * (TX-ENCARGOS-CONTERRANEO-WS +00116630
116640                   VARIACAO-OTNF-WS + (VARIACAO-OTNF-WS *         00116640
116650                   TX-ENCARGOS-CONTERRANEO-WS) / 100)) / 3000     00116650
116660              MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO               00116660
116670                        FH-IOF-ATE-EMIS-D10                       00116670
116680              IF FUNC                                             00116680
116690                 COMPUTE FH-JUR-ATE-EMIS-D10 =                    00116690
116700                         FH-JUR-ATE-EMIS-D10 / 2                  00116700
116710                 COMPUTE JUROS-EXCED-FUNC-WS =                    00116710
116720                         (EMP-NUM-EXCED-FUNC-RED-WS *             00116720
116730                         (TX-ENCARGOS-CONTERRANEO-WS +            00116730
116740                         VARIACAO-OTNF-WS + (VARIACAO-OTNF-WS *   00116740
116750                        TX-ENCARGOS-CONTERRANEO-WS) / 100)) / 300000116750
116760                 COMPUTE FH-JUR-ATE-EMIS-D10 =                    00116760
116770                         FH-JUR-ATE-EMIS-D10 + JUROS-EXCED-FUNC-WS00116770
116780              ELSE                                                00116780
116790                 NEXT SENTENCE                                    00116790
116800           ELSE                                                   00116800
                    IF  OPER-ISENTA-IOF
116810                  COMPUTE FH-IOF-ATE-EMIS-D10 ROUNDED =           00116810
116830                      EMP-NUM-IOF-RED-WS * TX-IOF-FISICA-WS /     00116830
116840                                           DIVISOR-IOF            00116840
                    ELSE
116810                  COMPUTE FH-IOF-ATE-EMIS-D10 ROUNDED =
116820                      ((SLD-EMP-RED-WS * ATL-DIAS-PARAL-RED-WS) + 00116820
116830                      EMP-NUM-IOF-RED-WS) * TX-IOF-FISICA-WS /    00116830
116840                                            DIVISOR-IOF           00116840
                    END-IF
116850              COMPUTE NUMEROS-WS = (SLD-EMP-RED-WS *              00116850
116860                      ATL-DIAS-PARAL-RED-WS) + EMP-NUM-RED-WS     00116860
116870              COMPUTE FH-JUR-ATE-EMIS-D10 =                       00116870
116880                     (NUMEROS-WS * (TX-ENCARGOS-CONTERRANEO-WS +  00116880
116890                     VARIACAO-OTNF-WS + (VARIACAO-OTNF-WS *       00116890
116900                     TX-ENCARGOS-CONTERRANEO-WS) / 100)) / 3000   00116900
116910              IF FUNC                                             00116910
116920                 IF SLD-EMP-RED-WS LESS -1000,00                  00116920
116930                    COMPUTE NUM-TOTAL-FUNC-WS =                   00116930
116940                            ((SLD-EMP-RED-WS + 1000,00) *         00116940
116950                ATL-DIAS-PARAL-RED-WS) + EMP-NUM-EXCED-FUNC-RED-WS00116950
116960                    COMPUTE NUMEROS-WS = (-1000 *                 00116960
116970                           ATL-DIAS-PARAL-RED-WS) + EMP-NUM-RED-WS00116970
116980                    COMPUTE FH-JUR-ATE-EMIS-D10 =                 00116980
116990                      ((NUMEROS-WS *                              00116990
117000                      (TX-ENCARGOS-CONTERRANEO-WS +               00117000
117010                      VARIACAO-OTNF-WS + (VARIACAO-OTNF-WS *      00117010
117020                      TX-ENCARGOS-CONTERRANEO-WS) / 100)) / 3000) 00117020
117030                                                          / 2     00117030
117040                    COMPUTE JUROS-EXCED-FUNC-WS =                 00117040
117050                           (NUM-TOTAL-FUNC-WS *                   00117050
117060                         (TX-ENCARGOS-CONTERRANEO-WS +            00117060
117070                         VARIACAO-OTNF-WS + (VARIACAO-OTNF-WS *   00117070
117080                       TX-ENCARGOS-CONTERRANEO-WS) / 100)) / 3000 00117080
117090                    COMPUTE FH-JUR-ATE-EMIS-D10 =                 00117090
117100                         FH-JUR-ATE-EMIS-D10 + JUROS-EXCED-FUNC-WS00117100
117110                 ELSE                                             00117110
117120                    COMPUTE FH-JUR-ATE-EMIS-D10 =                 00117120
117130                            FH-JUR-ATE-EMIS-D10 / 2               00117130
117140              ELSE                                                00117140
117150                 NEXT SENTENCE                                    00117150
117160     ELSE                                                         00117160
117170         MOVE ZEROS TO FH-JUR-ATE-EMIS-D10 FH-IOF-ATE-EMIS-D10    00117170
117180                      FH-JUR-DIA-D10       FH-IOF-DIA-D10         00117180
117190         COMPUTE SLD-REAL-WS = SLD-DEP-RED-WS -                   00117190
117200                 (SLD-BLO-RED-WS (1) + SLD-BLO-RED-WS (2) +       00117200
117210                  SLD-BLO-RED-WS (3) + SLD-BLO-RED-WS (4) +       00117210
117220                  SLD-BLO-RED-WS (5) + SLD-BLO-RED-WS (6) +       00117220
117230                  SLD-BLO-RED-WS (7) + SLD-BLO-RED-WS (8) +       00117230
117240                  SLD-BLO-RED-WS (9) + SLD-BLO-RED-WS (10) +      00117240
117250                  SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +     00117250
117260                  SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +     00117260
117270                  SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +     00117270
117280                  SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +     00117280
117290                  SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +     00117290
117300                  SLD-BLO-RED-WS (21))                            00117300
117310         IF SLD-REAL-WS LESS ZERO                                 00117310
117320           COMPUTE FH-JUR-DIA-D10 ROUNDED = (SLD-REAL-WS *        00117320
117330             TX-JUROS-WS) / 3000.                                 00117330

117340     IF P-FISICAS                                                 00117340
117350     IF EMP-LIM-RED-WS NOT GREATER ZEROS                          00117350
117360        IF SLD-REAL-WS LESS THAN MVR-CALC-WS                      00117360
117370           MOVE ZEROS TO FH-IOF-DIA-D10                           00117370
117380           IF ATL-ULT-MOV-RED-WS EQUAL DATA-D07-RED-WS            00117380
117390              MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO               00117390
117400                        FH-IOF-ATE-EMIS-D10                       00117400
117410           ELSE                                                   00117410
117420              MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO               00117420
117430                        FH-IOF-ATE-EMIS-D10                       00117430
117440        ELSE                                                      00117440
117450           NEXT SENTENCE                                          00117450
117460     ELSE                                                         00117460
117470        IF INSUF-ANT GREATER ZEROS                                00117470
117480           MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO                  00117480
117490                     FH-IOF-ATE-EMIS-D10                          00117490
117500           MOVE ZEROS TO FH-IOF-DIA-D10.                          00117500
117510                                                                  00117510
117520     PERFORM 999-15-ACUMULA-D10.                                  00117520
117530                                                                  00117530
117540     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00117540
117550                                                                  00117550
117560     WRITE REG-FICHA-D10                                          00117560
117570        INVALID KEY                                               00117570
117580         PERFORM 999-20-ESTOUROU-AREA-D10.                        00117580
117590                                                                  00117590
117600     IF IMPLANTACAO                                               00117600
117610         MOVE ZEROS TO SW-IMPLANTACAO                             00117610
117620     ELSE                                                         00117620
117630         PERFORM 610-35-OCR-FICHA-RECOLHER.                       00117630

117640     MOVE ZERO TO SW-GERA-FICHA.                                  00117640
117650                                                                  00117650
117660  505A-35-TESTA-CONTRATO-VENCIDO.                                 00117660
117670                                                                  00117670
117680     IF  EMP-LIM-RED-WS GREATER ZEROS                             00117680
117690         COMPUTE EXCESSO-AUX-WS = (EMP-LIM-RED-WS +               00117690
117700                                   SLD-DEP-RED-WS +               00117700
117710                                   SLD-EMP-RED-WS) -              00117710
117720                 (SLD-BLO-RED-WS (1)  + SLD-BLO-RED-WS (2)  +     00117720
117730                  SLD-BLO-RED-WS (3)  + SLD-BLO-RED-WS (4)  +     00117730
117740                  SLD-BLO-RED-WS (5)  + SLD-BLO-RED-WS (6)  +     00117740
117750                  SLD-BLO-RED-WS (7)  + SLD-BLO-RED-WS (8)  +     00117750
117760                  SLD-BLO-RED-WS (9)  + SLD-BLO-RED-WS (10) +     00117760
117770                  SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +     00117770
117780                  SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +     00117780
117790                  SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +     00117790
117800                  SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +     00117800
117810                  SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +     00117810
117820                  SLD-BLO-RED-WS (21))                            00117820
117830     ELSE                                                         00117830
117840         MOVE ZEROS TO EXCESSO-AUX-WS.                            00117840
117850                                                                  00117850
117860     IF  CONTRATO-VENCIDO                                         00117860
117870         IF  TPCONTAB-RED-WS = 01                                 00117870
117880             IF  EMP-LIM-RED-WS GREATER ZEROS                     00117880
117890                 IF  EXCESSO-AUX-WS NOT LESS ZEROS                00117890
117900                     MOVE DIA-PROX-VENC-WS TO DIA-AUX-Y2          00117900
117910                     MOVE MES-PROX-VENC-WS TO MES-AUX-Y2          00117910
117920                     MOVE AA-PROX-VENC-WS  TO ANO-AUX-Y2          00117920
117930                     MOVE DATA-AUX-Y2-RED  TO FH-EMP-VENC-D10     00117930
117940                 ELSE                                             00117940
117950                     MOVE EMP-VENC-RED-WS TO FH-EMP-VENC-D10      00117950
117960              ELSE                                                00117960
117970                  MOVE EMP-VENC-RED-WS TO FH-EMP-VENC-D10         00117970
117980         ELSE                                                     00117980
117990             MOVE EMP-VENC-RED-WS TO FH-EMP-VENC-D10              00117990
118000     ELSE                                                         00118000
118010         MOVE EMP-VENC-RED-WS TO FH-EMP-VENC-D10.                 00118010
118020                                                                  00118020
118060 510-35-OCR-EXTRATO.                                              00118060
118070*                                                                 00118070
118080     MOVE ZEROS TO SOMA-BLOQ-WS.                                  00118080
118090     ADD SLD-BLO-RED-WS (1)                                       00118090
118100         SLD-BLO-RED-WS (2)                                       00118100
118110         SLD-BLO-RED-WS (3)                                       00118110
118120         SLD-BLO-RED-WS (4)                                       00118120
118130         SLD-BLO-RED-WS (5)                                       00118130
118140         SLD-BLO-RED-WS (6)                                       00118140
118150         SLD-BLO-RED-WS (7)                                       00118150
118160         SLD-BLO-RED-WS (8)                                       00118160
118170         SLD-BLO-RED-WS (9)                                       00118170
118180         SLD-BLO-RED-WS (10)                                      00118180
118190         SLD-BLO-RED-WS (11)                                      00118190
118200         SLD-BLO-RED-WS (12)                                      00118200
118210         SLD-BLO-RED-WS (13)                                      00118210
118220         SLD-BLO-RED-WS (14)                                      00118220
118230         SLD-BLO-RED-WS (15)                                      00118230
118240         SLD-BLO-RED-WS (16)                                      00118240
118250         SLD-BLO-RED-WS (17)                                      00118250
118260         SLD-BLO-RED-WS (18)                                      00118260
118270         SLD-BLO-RED-WS (19)                                      00118270
118280         SLD-BLO-RED-WS (20)                                      00118280
118290         SLD-BLO-RED-WS (21) TO SOMA-BLOQ-WS.                     00118290
118300     MOVE SOMA-BLOQ-WS TO EXT-VR-BLOQ-D10.                        00118300
118310     MOVE ZEROS TO SOMA-BLOQ-WS.                                  00118310
118320     MOVE 10 TO CH-TPREG-D10.                                     00118320
118330     MOVE CH-AG-WS TO CH-CODAG-D10.                               00118330
118340     MOVE CH-CONTA-WS TO CONTA-D10.                               00118340
118350     MOVE CH-DIGITO-WS TO DV-CONTA-D10.                           00118350
118360     MOVE TPCONTAB-RED-WS TO EXT-COD-TPCONTAB-D10.                00118360
118370     MOVE TP-PESSOA-RED-WS TO EXT-TPPESSOA-D10.                   00118370
118380     MOVE NOME-CLIENTE-RED-WS TO EXT-NOME-CLIENTE-D10.            00118380
118400     MOVE ENDERECO-WS TO EXT-ENDERECO-D10.                        00118400
118410     MOVE CPF-CGC-RED-WS TO EXT-CPF-CGC-D10.                      00118410
118420     MOVE COD-POSTO-RED-WS TO EXT-COD-POSTO-D10                   00118420
118430     MOVE CLIENTE-PREFEREN-RED-WS TO EXT-CLI-ESPECIAL-D10         00118430
118440     MOVE EMP-VENC-RED-WS TO EXT-EMP-VENC-D10.                    00118440
118450     MOVE EMP-LIM-RED-WS TO EXT-LIM-D10.                          00118450
118460     MOVE EXTRATO-RED-WS TO EXT-EXTRATO-D10.                      00118460

250412     MOVE SPACES            TO EXT-NOME-TPCONTAB-D10.
250412     MOVE SPACES            TO EXT-NOME-MENS-D10.
250412     MOVE ZEROS             TO ESPECIAIS-D10.
250412     MOVE ZEROS             TO EXT-MOVIMENTOS-D10.

           MOVE    ZEROS  TO  IND-EXT-MOV
           PERFORM 99-ZERA-EXT-MOVIMENTOS-D10 17 TIMES

118470     MOVE MOVIMENTOS-RED-WS TO EXT-MOVIMENTOS-D10.                00118470
118480                                                                  00118480
118490     IF EXTRATO-ESPECIAL-RED-WS NOT EQUAL 2                       00118490
118500        PERFORM 999-15-ACUMULA-D10                                00118500
118510        MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10                      00118510
118520        WRITE REG-EXTRATO-D10 INVALID KEY                         00118520
118540                              PERFORM 999-20-ESTOUROU-AREA-D10.   00118540
118550                                                                  00118550
118560 512-35-OCR-EXTRA-EXTRA.                                          00118560
118570                                                                  00118570
118580     MOVE EXTRA-VR-BLOQ-WS TO EXT-VR-BLOQ-D10.                    00118580
118590     MOVE 10 TO CH-TPREG-D10.                                     00118590
118600     MOVE EXTRA-AG-WS TO CH-CODAG-D10.                            00118600
118610     MOVE EXTRA-CONTA-WS TO CONTA-D10.                            00118610
118620     MOVE EXTRA-DIGITO-WS TO DV-CONTA-D10.                        00118620
118630     MOVE EXTRA-TPCONTAB-WS TO EXT-COD-TPCONTAB-D10.              00118630
118640     MOVE TP-PESSOA-RED-WS TO EXT-TPPESSOA-D10.                   00118640
118650     MOVE NOME-CLIENTE-RED-WS TO EXT-NOME-CLIENTE-D10.            00118650
118670     MOVE ENDERECO-WS TO EXT-ENDERECO-D10.                        00118670
118680     MOVE CPF-CGC-RED-WS TO EXT-CPF-CGC-D10.                      00118680
118690     MOVE COD-POSTO-RED-WS TO EXT-COD-POSTO-D10                   00118690
118700     MOVE CLIENTE-PREFEREN-RED-WS TO EXT-CLI-ESPECIAL-D10         00118700
118710     MOVE EXTRA-EMP-VENC-WS TO EXT-EMP-VENC-D10.                  00118710
118720     MOVE EXTRA-EMP-LIM-WS  TO EXT-LIM-D10.                       00118720
118730     MOVE EXTRA-EXTRATO-WS  TO EXT-EXTRATO-D10.                   00118730

250412     MOVE SPACES              TO EXT-NOME-TPCONTAB-D10.
250412     MOVE SPACES              TO EXT-NOME-MENS-D10.
250412     MOVE ZEROS               TO ESPECIAIS-D10.
250412     MOVE ZEROS               TO EXT-MOVIMENTOS-D10.

           MOVE    ZEROS  TO  IND-EXT-MOV
           PERFORM 99-ZERA-EXT-MOVIMENTOS-D10 17 TIMES

118740     MOVE EXTRA-MOVIMENTOS-WS TO EXT-MOVIMENTOS-D10.              00118740
118750     IF EXTRATO-ESPECIAL-RED-WS NOT EQUAL 2                       00118750
118760        MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10                      00118760
118770        WRITE REG-EXTRATO-D10 INVALID KEY                         00118770
118790                              PERFORM 999-20-ESTOUROU-AREA-D10.   00118790
118800*                                                                 00118800
118810 515-35-INICIA-OCR-DIARIO.                                        00118810
118820*                                                                 00118820
118830     IF SLD-DEP-RED-WS GREATER ZERO OR EMP-LIM-RED-WS = ZERO      00118830
118840         MOVE SLD-DEP-RED-WS TO DI-SLD-ANT-D10                    00118840
118850         MOVE 'D' TO DI-TPSLD-ANT-D10                             00118850
118860     ELSE                                                         00118860
118870         MOVE SLD-EMP-RED-WS TO DI-SLD-ANT-D10                    00118870
118880         MOVE 'E' TO DI-TPSLD-ANT-D10.                            00118880
118890                                                                  00118890
118900     MOVE CH-N-LOTE-D07 TO DI-MOV-LOTE-WS.                        00118900
118910     MOVE CH-HIST-D07 TO DI-MOV-HIST-WS.                          00118910
118920                                                                  00118920
118960 520-35-OCR-DIARIO-CC.                                            00118960
118970*                                                                 00118970
118980     MOVE ZEROS TO DI-DATA-REMUN-D10 DI-INTERFACE-D10.            00118980
118990     IF  TRANS-D07                                                00118990
119000         IF  DI-MOV-HIST-WS EQUAL 32 OR 80 OR 95 OR 87            00119000
119010             MOVE DATA-REMUN-D07 TO DI-DATA-REMUN-D10.            00119010
119020     MOVE 12 TO CH-TPREG-D10.                                     00119020
119030     MOVE CH-AG-WS TO CH-CODAG-D10.                               00119030
119040     MOVE CH-CONTA-WS TO CONTA-D10.                               00119040
119050     MOVE CH-DIGITO-WS TO DV-CONTA-D10.                           00119050
119060     MOVE TPCONTAB-RED-WS TO DI-TPCONTAB-D10.                     00119060
119070     MOVE NOME-RED-WS TO DI-NOME-D10.                             00119070
119080     MOVE DI-AC-CAD-WS TO DI-AC-CAD-D10.                          00119080
119090     MOVE DI-MOV-REF-WS TO DI-MOV-REF-D10.                        00119090
119100     MOVE DI-MOV-LOTE-WS TO DI-MOV-LOTE-D10.                      00119100
119110     MOVE DI-MOV-HIST-WS TO DI-MOV-HIST-D10.                      00119110
119120     MOVE COD-POSTO-RED-WS TO DI-COD-POSTO-D10.                   00119120
119130     MOVE CLIENTE-PREFEREN-RED-WS TO DI-CLI-ESPECIAL-D10.         00119130
119140     MOVE CALC-SMED-RED-WS        TO DI-CALC-SMED-D10.            00119140
119150     MOVE INDICACOES-WS           TO INDICA-WS.                   00119150
119160     MOVE SPACES                  TO DI-CONTRA-ORD-D10.           00119160
119170                                                                  00119170
119180     IF DI-AC-CAD-D10 = 'C'                                       00119180
119190         IF CH-SEQUENC-D10 = 1                                    00119190
119200             MOVE SLD-DEP-RED-WS TO DI-SLD-ANT-D10 DI-MOV-VR-WS   00119200
119210             MOVE 'D' TO DI-TPSLD-ANT-D10                         00119210
119220             MOVE ZEROS TO DI-SLD-ATL-D10                         00119220
119230             MOVE SPACES TO DI-TPSLD-ATL-D10                      00119230
119240         ELSE                                                     00119240
119250             MOVE SLD-DEP-RED-WS TO DI-SLD-ATL-D10 DI-MOV-VR-WS   00119250
119260             MOVE 'D' TO DI-TPSLD-ATL-D10                         00119260
119270             MOVE ZEROS TO DI-SLD-ANT-D10                         00119270
119280             MOVE SPACES TO DI-TPSLD-ANT-D10                      00119280
119290     ELSE                                                         00119290
119300         MOVE DI-SLD-ANT-WS TO DI-SLD-ANT-D10                     00119300
119310         MOVE DI-TPSLD-ANT-WS TO DI-TPSLD-ANT-D10                 00119310
119320         MOVE SLD-DEP-RED-WS TO DI-SLD-ATL-D10                    00119320
119330         MOVE 'D' TO DI-TPSLD-ATL-D10                             00119330
119340         IF SLD-EMP-RED-WS LESS ZERO                              00119340
119350             IF SLD-DEP-RED-WS = ZERO                             00119350
119360                 MOVE SLD-EMP-RED-WS TO DI-SLD-ATL-D10            00119360
119370                 MOVE 'E' TO DI-TPSLD-ATL-D10.                    00119370
119380                                                                  00119380
119390     IF TRANS-D07                                                 00119390
119400        IF DI-MOV-HIST-WS EQUAL 33 OR 85 OR 05 OR 70              00119400
119410           MOVE 02 TO DI-INTERFACE-D10                            00119410
119420        ELSE                                                      00119420
119430           IF DI-MOV-HIST-WS EQUAL 30 OR 97                       00119430
119440              MOVE 04 TO DI-INTERFACE-D10                         00119440
119450           ELSE                                                   00119450
119460              IF DI-MOV-HIST-WS EQUAL 12 OR 19 OR 23 OR 73 OR 86  00119460
119470                                      OR 91                       00119470
119480                 MOVE 06 TO DI-INTERFACE-D10                      00119480
119490              ELSE                                                00119490
119500                 IF DI-MOV-HIST-WS EQUAL 15 OR 16 OR 82 OR 83 OR  00119500
119510                                         88                       00119510
119520                    MOVE 08 TO DI-INTERFACE-D10                   00119520
119530                 ELSE                                             00119530
119540                    IF DI-MOV-HIST-WS EQUAL 79                    00119540
119550                       MOVE 10 TO DI-INTERFACE-D10                00119550
119560                    ELSE                                          00119560
119570                       IF DI-MOV-HIST-WS EQUAL 95                 00119570
119580                          MOVE 12 TO DI-INTERFACE-D10             00119580
119590                       ELSE                                       00119590
119600                          IF DI-MOV-HIST-WS EQUAL 32 OR 80        00119600
119610                             MOVE 14 TO DI-INTERFACE-D10.         00119610
119620                                                                  00119620
119630     PERFORM 999-15-ACUMULA-D10.                                  00119630
119640     IF DI-MOV-LOTE-WS = ZERO AND DI-MOV-HIST-WS = 14             00119640
119650         COMPUTE DI-MOV-VR-WS = DI-MOV-VR-WS * -1.                00119650
119660                                                                  00119660
119680     MOVE DI-MOV-VR-WS TO DI-MOV-VR-D10.                          00119680
119690     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00119690
119700                                                                  00119700
119710     WRITE REG-DIARIO-D10                                         00119710
119720      INVALID KEY                                                 00119720
119730         PERFORM 999-20-ESTOUROU-AREA-D10.                        00119730
119770*                                                                 00119770
119780 525-35-OCR-PROTOCOLO.                                            00119780
119790*                                                                 00119790
119800     ADD 1 TO IND-PROTOCOLO.                                      00119800
119810                                                                  00119810
119820     IF IND-PROTOCOLO = 1                                         00119820
               MOVE SPACES   TO REG-PROTOC-D10
               INITIALIZE REG-PROTOC-D10
119830         MOVE 16 TO CH-TPREG-D10                                  00119830
119840         MOVE CH-AG-WS TO CH-CODAG-D10                            00119840
119850         PERFORM 999-15-ACUMULA-D10                               00119850
119860         MOVE 0          TO CH-SEQUENC-D10                        00119860
119870         MOVE ACUM-REG-AG-ANT TO PR-TOT-REG-ANT-D10               00119870
119880         MOVE ACUM-REG-AG-ATL TO PR-TOT-REG-ATL-D10               00119880
119890         MOVE ACUM-CAD-CC TO PR-CAD-CC-D10                        00119890
119900         MOVE ACUM-TRANSF-EMP TO PR-TRANSF-EMP-D10                00119900
119910         MOVE ACUM-OUTROS TO PR-OUTROS-D10                        00119910
119920         MOVE ACUM-CAD-CARTAO TO PR-CAD-CARTAO-D10                00119920
119930         MOVE ZERO TO CONTA-D10 DV-CONTA-D10                      00119930
119940         IF INICIO-ANO                                            00119940
119950             MOVE SW-INICIO-ANO TO PR-MUD-MES-D10                 00119950
119960         ELSE                                                     00119960
119970             MOVE SW-INICIO-MES TO PR-MUD-MES-D10.                00119970
119990                                                                  00119990
120000     MOVE COD-OCR-REAL-TAB (IND-PROTOCOLO) TO                     00120000
120010                      PR-COD-OCR-D10 (IND-PROTOCOLO).             00120010
120020     MOVE ACUM-TPOCR-TAB (IND-PROTOCOLO) TO                       00120020
120030                      PR-QDE-OCR-D10 (IND-PROTOCOLO).             00120030

230412     MOVE  SPACES  TO PR-NOME-OCR-D10 (IND-PROTOCOLO).

120050 530-35-OCR-ESPECIAIS.                                            00120050
120060*                                                                 00120060
120070     MOVE 18 TO CH-TPREG-D10.                                     00120070
120080     MOVE CH-AG-WS TO CH-CODAG-D10.                               00120080
120090     MOVE CH-CONTA-WS TO CONTA-D10.                               00120090
120100     MOVE CH-DIGITO-WS TO DV-CONTA-D10.                           00120100
120110     MOVE ESP-AC-CAD-WS TO ESP-AC-CAD-D10.                        00120110
120120     MOVE TPCONTAB-RED-WS TO ESP-TPCONTAB-D10.                    00120120
120130     MOVE NOME-RED-WS TO ESP-NOME-D10.                            00120130
120140     MOVE COD-POSTO-RED-WS TO ESP-COD-POSTO-D10.                  00120140
120150     MOVE CLIENTE-PREFEREN-RED-WS TO ESP-CLI-ESPECIAL-D10.        00120150
120160     MOVE TP-PESSOA-RED-WS        TO ESP-TP-PESSOA-D10.           00120160
120170     MOVE SLD-ANT TO ESP-SLD-ANT-D10.                             00120170
120180     MOVE TPSLD-ANT TO ESP-TPSLD-ANT-D10.                         00120180
120190     MOVE NUM-SMED-ESTE-RED-WS TO ESP-NUM-SMED-MES-D10.           00120190
120200     MOVE DIA-D07-WS TO ESP-MOV-DIA-D10.                          00120200
120210                                                                  00120210
120220     IF QUEBROU-CONTA-ESP                                         00120220
120230        MOVE ZEROS TO ESP-MOV-REF-D10 ESP-MOV-HIST-D10            00120230
120240                      ESP-VR-D10                                  00120240
120250     ELSE                                                         00120250
120260     IF OCR-GR-DIFERENCA                                          00120260
120270         MOVE ZEROS TO ESP-MOV-HIST-D10 ESP-MOV-REF-D10           00120270
120280                       SW-OCR-GR-DIFERENCA                        00120280
120290         MOVE GR-DIFERENCA TO ESP-VR-D10                          00120290
120300     ELSE                                                         00120300
120310         MOVE TR-REF-D07 TO ESP-MOV-REF-D10                       00120310
120320         MOVE CH-HIST-D07 TO ESP-MOV-HIST-D10                     00120320
120330         MOVE VR-MOV-RED-WS (MOV-NUM-RED-WS) TO ESP-VR-D10.       00120330
120340     IF SLD-EMP-RED-WS LESS ZEROS                                 00120340
120350         MOVE SLD-EMP-RED-WS TO ESP-SLD-ATL-D10                   00120350
120360         MOVE 'E' TO ESP-TPSLD-ATL-D10                            00120360
120370     ELSE                                                         00120370
120380         MOVE SLD-DEP-RED-WS TO ESP-SLD-ATL-D10                   00120380
120390         MOVE 'D' TO ESP-TPSLD-ATL-D10.                           00120390
120400                                                                  00120400
120410     PERFORM 999-15-ACUMULA-D10.                                  00120410
120420                                                                  00120420
120430     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00120430
120440                                                                  00120440
120450     WRITE REG-ESPEC-D10                                          00120450
120460      INVALID KEY                                                 00120460
120470         PERFORM 999-20-ESTOUROU-AREA-D10.                        00120470
120480     MOVE 1 TO SW-CRED-DEB-ESP.                                   00120480
120520*                                                                 00120520
120530 535-35-OCR-DEPOSITO-BLOQUEADO.                                   00120530
120540                                                                  00120540
120550     MOVE 19 TO CH-TPREG-D10.                                     00120550
120560     MOVE CH-AG-WS TO CH-CODAG-D10.                               00120560
120570     MOVE CH-CONTA-WS    TO CONTA-D10.                            00120570
120580     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00120580
120590     MOVE TPCONTAB-RED-WS TO DBLO-TPCONTAB-D10.                   00120590
120600     MOVE NOME-RED-WS TO DBLO-NOME-D10.                           00120600
120610     MOVE COD-POSTO-RED-WS TO DBLO-COD-POSTO-D10                  00120610
120620     MOVE CLIENTE-PREFEREN-RED-WS TO DBLO-CLI-ESPECIAL-D10        00120620

250412     MOVE  SPACES          TO DBLO-NOME-MENS-D10
           MOVE  ZEROS           TO DBLO-QDE-D10

040420     MOVE  ZEROS           TO IND-DBLO                            00040420
040400     PERFORM 540-35-LIMPA-DBLO 12 TIMES.                          00040400

120630     IF  HOUVE-DESBLOQUEIO OR HOUVE-ESTORNO                       00120630
120640         MOVE DESBLOQ-WS TO DESBLOQ-D10                           00120640
120650         MOVE HIST-DESBLOQ-WS TO HIST-DESBLOQ-D10                 00120650
120660         MOVE PRAZO-DESBLOQ-WS TO PRAZO-DESBLOQ-D10               00120660
120670         MOVE DBLO-COD-MENS-WS TO DBLO-COD-MENS-D10               00120670
120680     ELSE                                                         00120680
250412         MOVE  ZEROS           TO DESBLOQ-D10

120690         MOVE ZEROS TO HIST-DESBLOQ-D10                           00120690
120700                       PRAZO-DESBLOQ-D10                          00120700
120710         MOVE ZEROS       TO DBLO-HIST-D10                        00120710
120720         MOVE DBLO-QDE-WS TO DBLO-QDE-D10                         00120720
120730         MOVE 35 TO DBLO-COD-MENS-D10                             00120730
120740         MOVE SLD-BLO-RED-WS (1) TO DBLO-D10 (1)                  00120740
120750         MOVE SLD-BLO-RED-WS (2) TO DBLO-D10 (2)                  00120750
120760         MOVE SLD-BLO-RED-WS (3) TO DBLO-D10 (3)                  00120760
120770         COMPUTE DBLO-D10 (4)  = SLD-BLO-RED-WS (4)  +            00120770
120780                                 SLD-BLO-RED-WS (5)               00120780
120790         COMPUTE DBLO-D10 (5)  = SLD-BLO-RED-WS (6)  +            00120790
120800                                 SLD-BLO-RED-WS (7)               00120800
120810         COMPUTE DBLO-D10 (6)  = SLD-BLO-RED-WS (8)  +            00120810
120820                                 SLD-BLO-RED-WS (9)               00120820
120830         COMPUTE DBLO-D10 (7)  = SLD-BLO-RED-WS (10) +            00120830
120840                                 SLD-BLO-RED-WS (11)              00120840
120850         COMPUTE DBLO-D10 (8)  = SLD-BLO-RED-WS (12) +            00120850
120860                                 SLD-BLO-RED-WS (13)              00120860
120870         COMPUTE DBLO-D10 (9)  = SLD-BLO-RED-WS (14) +            00120870
120880                                 SLD-BLO-RED-WS (15)              00120880
120890         COMPUTE DBLO-D10 (10) = SLD-BLO-RED-WS (16) +            00120890
120900                                 SLD-BLO-RED-WS (17)              00120900
120910         COMPUTE DBLO-D10 (11) = SLD-BLO-RED-WS (18) +            00120910
120920                                 SLD-BLO-RED-WS (19)              00120920
120930         COMPUTE DBLO-D10 (12) = SLD-BLO-RED-WS (20) +            00120930
120940                                 SLD-BLO-RED-WS (21).             00120940
120950                                                                  00120950
120960     PERFORM 999-15-ACUMULA-D10.                                  00120960
120970                                                                  00120970
120980     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00120980
120990     WRITE REG-DEP-BLO-D10                                        00120990
121000        INVALID KEY                                               00121000
121010         PERFORM 999-20-ESTOUROU-AREA-D10.                        00121010

250412     MOVE  ZEROS        TO  REG-DEP-BLO-D10
250412     MOVE  SPACES       TO  REG-DEP-BLO-D10
           INITIALIZE REG-DEP-BLO-D10

121020     IF  HOUVE-DESBLOQUEIO OR HOUVE-ESTORNO                       00121020
121030         MOVE ZEROS TO SW-DESBLOQUEIO                             00121030
121040     ELSE                                                         00121040
121050         MOVE ZERO TO SW-GERA-BLOQUEADO DBLO-QDE-WS.              00121050
121060*                                                                 00121060
040400 540-35-LIMPA-DBLO.                                               00040400
040410                                                                  00040410
040420     ADD 1 TO IND-DBLO                                            00040420
040430     MOVE ZEROS TO DBLO-D10(IND-DBLO).                            00040430

121070 540-35-OCR-ACERTO-EXT-CONTABIL.                                  00121070
121080*                                                                 00121080
121090     MOVE 20 TO CH-TPREG-D10.                                     00121090
121100     MOVE CH-AG-WS TO CH-CODAG-D10.                               00121100
121110     MOVE CH-CONTA-WS TO CONTA-D10.                               00121110
121120     MOVE CH-DIGITO-WS TO DV-CONTA-D10.                           00121120
121130     MOVE TPCONTAB-RED-WS TO AC-EC-TPCONTAB-D10                   00121130
121140     MOVE NOME-RED-WS TO AC-EC-NOME-D10.                          00121140
121150     MOVE COD-POSTO-RED-WS TO AC-EC-COD-POSTO-D10                 00121150
121160     MOVE CLIENTE-PREFEREN-RED-WS TO AC-EC-CLI-ESPECIAL-D10       00121160
121170     MOVE AC-EC-CAD-WS TO AC-EC-CAD-D10.                          00121170
121180                                                                  00121180
121190     IF AC-EC-CAD-D10 = 'C'                                       00121190
121200         MOVE ZEROS TO AC-EC-MOV-NLOTE-D10 AC-EC-REF-D10          00121200
121210         MOVE SLD-DEP-RED-WS TO AC-EC-VR-D10                      00121210
121220     ELSE                                                         00121220
121230         MOVE CH-N-LOTE-D07 TO AC-EC-MOV-NLOTE-D10                00121230
121240         MOVE CH-HIST-D07 TO AC-EC-MOV-HIST-D10                   00121240
121250         MOVE AC-EC-REF-D07 TO AC-EC-REF-D10                      00121250
121260         MOVE AC-EC-VALOR-D07 TO AC-EC-VR-D10.                    00121260
121270                                                                  00121270
121280     PERFORM 999-15-ACUMULA-D10.                                  00121280
121290                                                                  00121290
121300     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00121300
121310                                                                  00121310
121320     WRITE REG-AC-EXT-CONTAB-D10                                  00121320
121330      INVALID KEY                                                 00121330
121340         PERFORM 999-20-ESTOUROU-AREA-D10.                        00121340
121350                                                                  00121350
121390 545-35-OCR-CAD-CC.                                               00121390
121400*                                                                 00121400
121410     MOVE 22                       TO CH-TPREG-D10.               00121410
121420     MOVE CH-AG-WS                 TO CH-CODAG-D10.               00121420
121430     MOVE CH-CONTA-WS              TO CONTA-D10.                  00121430
121440     MOVE CH-DIGITO-WS             TO DV-CONTA-D10.               00121440
121450     MOVE TPCONTAB-RED-WS          TO C-CC-TPCONTAB-D10.          00121450
121460     MOVE DATA-IMPLANTA-RED-WS     TO C-CC-DATA-IMP-D10.          00121460
121470     MOVE IDENTIFICACAO-RED-WS     TO C-CC-IDENTIFICACAO-D10.     00121470
121480     MOVE NOME-CLIENTE-RED-WS      TO C-CC-NOME-CLIENTE-D10.      00121480
121490*    MOVE ENDERECO-RED-WS          TO C-CC-ENDERECO-D10.          00121490
121500     MOVE ENDERECO-WS              TO C-CC-ENDERECO-D10.          00121500
121510     MOVE COD-POSTO-RED-WS         TO C-CC-COD-POSTO-D10.         00121510
121520     MOVE CLIENTE-PREFEREN-RED-WS  TO C-CC-CLI-ESPECIAL-D10.      00121520
121530     MOVE TP-TALAO-RED-WS          TO C-CC-TP-TALAO-D10.          00121530
121540     MOVE COD-TJUR-WS              TO C-CC-COD-TJUR-D10.          00121540
121550     MOVE INDICA-CTAREMUN-WS       TO C-CC-INDICA-CTAREMUN-D10.   00121550
121560     MOVE INDICA-TRIB-WS           TO C-CC-INDICA-TRIB-D10.       00121560
121570     MOVE ALIQ-IRESTL-WS           TO C-CC-ALIQ-IRESTL-D10.       00121570
121580     MOVE ISENCAO-IPMF-RED-WS      TO C-CC-ISENCAO-IPMF-D10.      00121580
121590     MOVE AVISO-LANC-RED-WS        TO C-CC-AVISO-LANC-D10.        00121590
121600     MOVE OPCAO-PC-RED-WS          TO C-CC-OPCAO-PC-D10.          00121600
121610     MOVE MANIFESTACAO-RED-WS      TO C-CC-MANIFESTACAO-IN89-D10. 00121610
121620*                                                                 00121620
121670     MOVE CD-CLI-COTIT-RED-WS      TO C-CC-CD-CLI-COTIT-D10.      00121670
121680     MOVE IND-ALT-COTIT-RED-WS     TO C-CC-IND-ALT-COTIT-D10.     00121680
121710     MOVE INI-LIMINAR-RED-WS       TO C-CC-INI-ISEN-D10.          00121710
121720     MOVE FIM-LIMINAR-RED-WS       TO C-CC-FIM-ISEN-D10.          00121720
121730     MOVE GRUPO-TARIFA-RED-WS      TO C-CC-GRUPO-TARIFA-D10.      00121730
121740     MOVE ZEROS     TO ALIQ-IRESTL-WS                             00121740
121750                       COD-TJUR-WS.                               00121750
121760     MOVE SPACES TO INDICA-CTAREMUN-WS                            00121760
121770                    INDICA-TRIB-WS                                00121770
                          C-CC-NOME-MENS-D10.
121780                                                                  00121780
121790     IF SLD-EMP-RED-WS LESS ZERO                                  00121790
121800         MOVE SLD-EMP-RED-WS TO C-CC-SLD-ANT-D10                  00121800
121810         MOVE 'E' TO C-CC-TPSLD-ANT-D10                           00121810
121820     ELSE                                                         00121820
121830         MOVE SLD-DEP-RED-WS TO C-CC-SLD-ANT-D10                  00121830
121840         MOVE 'D' TO C-CC-TPSLD-ANT-D10.                          00121840

121850     MOVE CD-CLI-RED-WS TO C-CC-CD-CLI-D10.                       00121850
121860     PERFORM 999-15-ACUMULA-D10.                                  00121860
121870     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00121870
121880     MOVE C-CC-COD-MENS-D10 TO MENS-AUX.                          00121880
121890     WRITE REG-CAD-CC-D10                                         00121890
121900       INVALID KEY                                                00121900
121910         PERFORM 999-20-ESTOUROU-AREA-D10.                        00121910
122150*                                                                 00122150
122160 548-35-OCR-CH-PERSON.                                            00122160
122170     MOVE 14                     TO CH-TPREG-D10.                 00122170
122180     MOVE CH-AG-WS               TO CH-CODAG-D10.                 00122180
122190     MOVE CH-CONTA-WS            TO CONTA-D10.                    00122190
122200     MOVE CH-DIGITO-WS           TO DV-CONTA-D10.                 00122200
122210     MOVE DATA-D07-RED-WS        TO PER-DATA-D10.                 00122210
122220     MOVE NOME-RED-WS            TO PER-NOME-D10.                 00122220
122230     MOVE COD-POSTO-RED-WS       TO PER-COD-POSTO-D10.            00122230
122240     MOVE CLIENTE-PREFEREN-RED-WS TO PER-CLI-ESPECIAL-D10.        00122240
122250     MOVE TP-TALAO-RED-WS        TO PER-TP-TALAO-D10.             00122250
122260*********** IPMF  *****************                               00122260
122270     IF  CHEQUE-TRANSF-BANCARIA                                   00122270
122280         MOVE 'TB'               TO PER-CHEQUE-TB-D10             00122280
122290     ELSE                                                         00122290
122300         MOVE SPACES             TO PER-CHEQUE-TB-D10.            00122300
122310***********************************                               00122310
122320     IF  NAO-HA-CONTA                                             00122320
122330         MOVE ZEROS              TO SW-CH-PERSONAL                00122330
122340         MOVE CH-CONTA-D07       TO CH-CONTA-D10                  00122340
122350         MOVE SPACES             TO PER-NOME-D10.                 00122350

122360     MOVE 1                      TO SW-HOUVE-OCORR-14.            00122360
122370     MOVE PER-COD-MENS-D10       TO COD-MSG-OCORR-TALON-WS.       00122370
122380     PERFORM 999-15-ACUMULA-D10.                                  00122380
122390     MOVE CH-SEQUENC-WS          TO CH-SEQUENC-D10.               00122390

250412     MOVE  SPACES                TO PER-NOME-MENS-D10

122400     WRITE REG-PERSONAL-D10                                       00122400
122410       INVALID KEY                                                00122410
122420         PERFORM 999-20-ESTOUROU-AREA-D10.                        00122420
122450                                                                  00122450
************************************************************************
DOCINI****F* P04808/550-35-OCR-INSUFICIENCIA
DOCTXT* OBJETIVO
DOCTXT*   Gerar ocorrencia de adiantamento a depositantes e atualizar
DOCTXT*   variaveis para calculo de juros e IOF.
DOCTXT*   Esta rotina e chamada ao salvar a conta corrente, apos
DOCTXT*   atualizacao de saldos.
DOCTXT*
DOCEND******
122490 550-35-OCR-INSUFICIENCIA.                                        00122490
122500                                                                  00122500
/CVBR/* Ler Tabela de Fundos para agecia 016 e pessoa juridica
/CVBR/     MOVE 0               TO SW-FUNDOS-FND.
/CVBR/     IF (CH-AG-WS = 016 AND JURIDICA)
/CVBR/         PERFORM 99-LE-TABFND-POR-CONTA.
123100*.................................................................00123100
      * ATUALIZACAO DE SALDO PARA CALCULAR JUROS E IOF DE INSUFICIENCIA.
           IF REG-COR-WS
             MOVE ZEROS TO SALDO-ATUAL-WS
             IF SLD-EMP-RED-WS LESS ZEROS
                MOVE SLD-EMP-RED-WS TO SALDO-ATUAL-WS
             ELSE
                MOVE SLD-DEP-RED-WS TO SALDO-ATUAL-WS.

           MOVE SPACES TO REG-INSUF-D10.
           INITIALIZE REG-INSUF-D10.
123110     MOVE 24           TO CH-TPREG-D10.                           00123110
123120     MOVE CH-AG-WS     TO CH-CODAG-D10.                           00123120
123130     MOVE CH-CONTA-WS  TO CONTA-D10.                              00123130
123140     MOVE CH-DIGITO-WS TO DV-CONTA-D10.                           00123140
123150     MOVE 1            TO INS-TPREG-D10.                          00123150
123160     MOVE TPCONTAB-RED-WS TO INS-TPCONTAB-D10.                    00123160
123170     MOVE NOME-CLIENTE-RED-WS TO INS-NOME-CLIENTE-D10.            00123170

           MOVE TP-PESSOA-RED-WS    TO INS-TPPES-D10
           MOVE GRUPO-TARIFA-RED-WS TO INS-GRTAR-D10

123180     IF ID-CPF-CGC-RED-WS EQUAL 1 OR 2                            00123180
123190        MOVE ID-CPF-CGC-RED-WS TO INS-ID-CPF-CGC-D10              00123190
123200        MOVE CPF-CGC-RED-WS    TO INS-CPF-CGC-D10                 00123200
123210     ELSE                                                         00123210
123220        MOVE ZEROS             TO INS-ID-CPF-CGC-D10              00123220
123230        MOVE ZEROS             TO INS-CPF-CGC-D10.                00123230

123240     MOVE COD-POSTO-RED-WS TO INS-COD-POSTO-D10.                  00123240
123250     MOVE CLIENTE-PREFEREN-RED-WS TO INS-CLI-ESPECIAL-D10.        00123250
123260     MOVE CALC-SMED-RED-WS         TO INS-CALC-SMED-D10.          00123260
123280     MOVE ENDERECO-WS TO INS-ENDERECO-D10.                        00123280
123290                                                                  00123290
123300     MOVE INS-ULT-RED-WS TO INS-DATA-ULT-D10.                     00123300
123310     MOVE INS-VEZ-RED-WS TO INS-NUM-VEZES-D10.                    00123310
      *    Necessario para saber se houve regularizacao em cujo caso
      *    a variavel INS-NOVA-RED-WS estara zerada.
123320     IF INS-NOVA-RED-WS GREATER ZERO                              00123320
      *    Calcula a quantidade de dias com insuficiencia de fundos.
123330         MOVE INS-NOVA-RED-WS TO INS-DATA-INIC-D10                00123330
123340                             DATA-MENOR-RED                       00123340
123350         MOVE DATA-D07-RED-WS TO DATA-MAIOR-RED                   00123350
123360         PERFORM 800-05-CALCULA-NUM-DIAS                          00123360
123370         MOVE DIAS-TRANSF-WS TO INS-NUM-DIAS-D10                  00123370
123400     ELSE                                                         00123400
123410         MOVE ZERO TO INS-DATA-INIC-D10 INS-NUM-DIAS-D10.         00123410
123420     MOVE SLD-DEP-ANT-WS TO INS-SLD-ANT-D10.                      00123420
      *    Faz o move para o relatorio e guarda o valor absoluto da variavel
123430     MOVE SLD-DEP-RED-WS                                          00123430
123440                 TO INS-SLD-DEP-D10 INS-VR-ABSOLUTO.              00123440

123450*................................................................ 00123450
123460*..COMANDOS PARA CALCULO DA BASE DE CALCULO IOF ADICIONAL DE 0,38 00123460
123470*................................................................ 00123470
123480                                                                  00123480
123490      MOVE ZEROS TO BASE-IOF-ADICIONAL-WS IOF-ADICIONAL-WS.       00123490
123500                                                                  00123500
123510      IF SLD-DEVOL-WS NOT = ZEROS                                 00123510
123540         IF (SLD-DEVOL-WS NOT < ACUM-BASE-IOF-ADIC-RED-WS)        00123540
      *            Se o saldo de devolucao eh maior que o saldo devedor
      *            mais os incrementos de saldo que ocorreram durante a
      *            insuficiencia, nao ha o que se fazer, o valor acumulado
      *            de insuficiencia deve ser zerado.
123550             MOVE ZEROS TO ACUM-BASE-IOF-ADIC-RED-WS              00123550
123560         ELSE                                                     00123560
      *            Se o saldo de devolucao eh menor que o valor acumulado,
      *            precisamos entao atualizar o valor acumulado da operacao
      *            aqui.
123590             COMPUTE ACUM-BASE-IOF-ADIC-RED-WS ROUNDED =          00123590
123600                     ACUM-BASE-IOF-ADIC-RED-WS - SLD-DEVOL-WS.    00123600
123601                                                                  00123601
      *     Faz-se um move dos campos de saldo de deposito anterior e atual
      *     para variaveis sem sinal, ou seja, eh tratado o valor absoluto.
123642      MOVE SLD-DEP-RED-WS TO SLD-DEP-RED-POS-WS                   00123642
123643      MOVE SLD-DEP-ANT-WS TO SLD-DEP-ANT-POS-WS                   00123643
123644                                                                  00123644
123645      IF SLD-DEP-RED-WS NOT LESS THAN ZEROS                       00123645
      *        Se o saldo deposito for zero ou positivo, o evento eh de
      *        regularizacao.
123646         MOVE ZEROS TO BASE-IOF-ADICIONAL-WS                      00123646
            ELSE
123645        IF SLD-DEP-ANT-WS NOT LESS THAN ZEROS                     00123645
      *          Trata-se de primeiro adiantamento
123646           MOVE SLD-DEP-RED-POS-WS TO BASE-IOF-ADICIONAL-WS       00123646
123648        ELSE                                                      00123648
123652          IF SLD-DEP-RED-POS-WS = SLD-DEP-ANT-POS-WS              00123652
      *            Nao houve alteracao no estado de insuficiencia da conta.
123653             MOVE ZEROS        TO BASE-IOF-ADICIONAL-WS           00123653
123655          ELSE                                                    00123655
123656            IF SLD-DEP-RED-POS-WS > SLD-DEP-ANT-POS-WS            00123656
      *              Houve um incremento no saldo devedor da conta, ELA
      *              ficou mais negativa. Entao, a base do IOF adicional
      *              esta diferenca de saldo devedor.
123657               COMPUTE BASE-IOF-ADICIONAL-WS =                    00123657
123658                                SLD-DEP-RED-POS-WS -              00123658
123659                                SLD-DEP-ANT-POS-WS.               00123659
123664                                                                  00123664
           IF  OPER-ISENTA-IOF
               MOVE ZEROS TO BASE-IOF-ADICIONAL-WS IOF-ADICIONAL-WS
           ELSE
      *         Representa o saldo devedor inicial da operacao, incrementado
      *         a cada diferenca de saldo devedor entre o saldo do dia anterior
      *         e o saldo do dia atual.
123680          COMPUTE ACUM-BASE-IOF-ADIC-RED-WS =                     00123680
123690                  ACUM-BASE-IOF-ADIC-RED-WS +                     00123690
123700                  BASE-IOF-ADICIONAL-WS                           00123700
123730          COMPUTE IOF-ADICIONAL-WS = ((ACUM-BASE-IOF-ADIC-RED-WS *00123730
123740                                      0,38) / 100) * -1           00123740
           END-IF.
123765*................................................................ 00123765
123770     COMPUTE INS-SLD-BLO-D10 =                                    00123770
123780                 (SLD-BLO-RED-WS (1) + SLD-BLO-RED-WS (2) +       00123780
123790                  SLD-BLO-RED-WS (3) + SLD-BLO-RED-WS (4) +       00123790
123800                  SLD-BLO-RED-WS (5) + SLD-BLO-RED-WS (6) +       00123800
123810                  SLD-BLO-RED-WS (7) + SLD-BLO-RED-WS (8) +       00123810
123820                  SLD-BLO-RED-WS (9) + SLD-BLO-RED-WS (10) +      00123820
123830                  SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +     00123830
123840                  SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +     00123840
123850                  SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +     00123850
123860                  SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +     00123860
123870                  SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +     00123870
123880                  SLD-BLO-RED-WS (21)).                           00123880
123890                                                                  00123890
123900     MOVE INS-SLD-BLO-D10 TO SLD-BLO-WS.                          00123900
123910                                                                  00123910
      *    Move o valor sendo adiantado (atualizado) para o SLD-DEP-RED
123920     MOVE VALOR-ACUM-ADIANT-RED-WS TO SLD-DEP-RED.                00123920
      *    Neste momento, SLD-DEP-ANT contem o valor de adiantamento do dia
      *    anterior, enquanto SLD-DEP-RED contem o valor adiantado nesta rodada,
      *    ou seja, o que foi adiantado nesta execucao.
123930     MOVE ZEROS TO  WINSUFICIENCIA-ATU.                           00123930
123940                                                                  00123940
123950     IF VALOR-ACUM-ADIANT-RED-WS NOT = ZEROS                      00123950
      *    Nao se trata de uma regularizacao. Um valor de adiantamento foi
      *    recebido.
      *        Verifica se o valor de adiantamento recebido no dia anterior
      *        eh diferente de zero.
123990         IF SLD-DEP-ANT NOT = ZEROS                               00123990
124000          IF SLD-DEP-RED GREATER THAN SLD-DEP-ANT                 00124000
      *           Se houve diminuicao do saldo devedor.
124010            COMPUTE WINSUFICIENCIA-ATU = SLD-DEP-RED - SLD-DEP-ANT00124010
124020                                       + CPMF-WS                  00124020
124030            IF WINSUFICIENCIA-ATU GREATER THAN ZEROS              00124030
124040               ADD 1 TO QDE-INS-EXC-MES-RED-WS.                   00124040
124050                                                                  00124050
124060     IF VALOR-ACUM-ADIANT-RED-WS = ZEROS                          00124060
      *    Evento de regularizacao de insuficiencia.
124070        IF IMPESSOAL OR                                           00124070
                 ((CH-AG-WS = 016) AND FUNDOS-FND) OR
124090           ((CH-AG-WS = 152) AND (CH-CONTA-WS = 23096)) OR        00124090
124100           (CONTA-NAO-CADASTRADA)                                 00124100
124110           NEXT SENTENCE                                          00124110
124120        ELSE                                                      00124120
124130        COMPUTE SALDO-ATUAL-INS = SLD-DEP-RED-WS - SLD-BLO-WS     00124130
124140        IF SALDO-ATUAL-INS < ZEROS                                00124140
124150           IF SLD-BLO-WS = ZEROS                                  00124150
124160              IF SALDO-ATUAL-INS < SALDO-ANTERIOR-INS             00124160
124170                 ADD 1 TO QDE-INS-EXC-MES-RED-WS                  00124170
124180              ELSE                                                00124180
124190                 NEXT SENTENCE                                    00124190
124200           ELSE                                                   00124200
124210              COMPUTE SALDO-BLOQ-INS = SLD-BLO-WS * (-1)          00124210
124220              IF SALDO-ATUAL-INS < SALDO-BLOQ-INS                 00124220
124230                 COMPUTE WINSUFICIENCIA-ATU =                     00124230
124240                        SALDO-BLOQ-INS - SALDO-ATUAL-INS          00124240
124250                 IF WINSUFICIENCIA-ATU GREATER THAN ZEROS         00124250
124260                    ADD 1 TO QDE-INS-EXC-MES-RED-WS.              00124260
124270                                                                  00124270
124540     IF SLD-DEVOL-WS NOT = ZEROS                                  00124540
124550        COMPUTE SLD-DEVOL-WS ROUNDED = SLD-DEVOL-WS +             00124550
124570                            (SLD-DEVOL-WS * 0,0000)               00124570
      *       Calculo dos juros de insuficiencia para devolucao.
124580        IF  P-FISICAS                                             00124580
      *           Juros de devolucao computados como o saldo de devolucao
      *           vezes um fator que eh dado pelo quociente entre o indice
      *           121 do dia corrente e do proximo dia util - 1.
124590            COMPUTE INS-JUR-REAL-DEVOL-WS ROUNDED =               00124590
124600                           SLD-DEVOL-WS * FATOR-INSUF-PF-WS       00124600
124610        ELSE                                                      00124610
124620            COMPUTE INS-JUR-REAL-DEVOL-WS ROUNDED =               00124620
124630                           SLD-DEVOL-WS * FATOR-INSUF-PJ-WS.      00124630
124640                                                                  00124640
124650     IF SLD-DEVOL-WS NOT = ZEROS                                  00124650
      *    Se os juros reais de devolucao superarem o que estah acumulado
      *    apenas zeramos os juros acumulados.
124660        IF INS-JUR-REAL-DEVOL-WS NOT < INS-NJUR-REAL-RED-WS       00124660
124670           MOVE ZEROS TO INS-NJUR-REAL-RED-WS                     00124670
124680        ELSE                                                      00124680
124690           COMPUTE INS-NJUR-REAL-RED-WS ROUNDED =                 00124690
124700                   INS-NJUR-REAL-RED-WS - INS-JUR-REAL-DEVOL-WS.  00124700
124710                                                                  00124710
124720     IF SLD-DEVOL-WS NOT = ZEROS                                  00124720
      *    Se os juros atualizados da operacao sao nulos, entao a insuficiencia
      *    nao foi real...
124730        IF INS-NJUR-REAL-RED-WS = ZEROS                           00124730
124740           IF QDE-INS-EXC-MES-RED-WS NOT = ZEROS                  00124740
124750              COMPUTE QDE-INS-EXC-MES-RED-WS =                    00124750
124760                                   QDE-INS-EXC-MES-RED-WS - 1     00124760
124770           ELSE                                                   00124770
124780              NEXT SENTENCE                                       00124780
124790        ELSE                                                      00124790
124800           IF QDE-INS-EXC-MES-RED-WS > 1                          00124800
124810              COMPUTE QDE-INS-EXC-MES-RED-WS =                    00124810
124820                                   QDE-INS-EXC-MES-RED-WS - 1.    00124820

124840     IF SLD-DEVOL-WS NOT = ZEROS                                  00124840
      *       Saldo do dia anterior (absoluto)
              MOVE SALDO-ANTERIOR-RED-WS TO SALDO-ANTERIOR-RED-AUX
              IF SLD-DEVOL-WS < SALDO-ANTERIOR-RED-AUX
      *          Se o saldo de devolucao for menor que o saldo anterior
124880           COMPUTE INS-NIOF-REAL-RED-WS ROUNDED =                 00124880
124890                  (INS-NIOF-REAL-RED-WS -                         00124890
124890                  ((SLD-DEVOL-WS + INS-JUR-REAL-DEVOL-WS)
124890                                 * DIAS-PARAL-WS))
              ELSE
124880           COMPUTE INS-NIOF-REAL-RED-WS ROUNDED =                 00124880
124890                  (INS-NIOF-REAL-RED-WS -                         00124890
124890                ((SALDO-ANTERIOR-RED-AUX + INS-JUR-REAL-DEVOL-WS)
124890                                          * DIAS-PARAL-WS))
              END-IF
              IF INS-NIOF-REAL-RED-WS < ZEROS
                 MOVE ZEROS              TO INS-NIOF-REAL-RED-WS
              END-IF
            END-IF.
124910                                                                  00124910
124920     MOVE SLD-BLO-RED-WS (1)  TO INS-SLD-BLO-24HS-D10.            00124920
124930     MOVE ZEROS TO NUM-JUR-REAL-WS                                00124930
124940                   NUM-JUR-DECOR-WS                               00124940
124950                   NUM-IOC-REAL-WS                                00124950
124960                   NUM-IOC-DECOR-WS.                              00124960
124970                                                                  00124970
124980     MOVE ZEROS TO VR-ADIANT-REAL-WS.                             00124980

124990     IF VALOR-ACUM-ADIANT-RED-WS NOT EQUAL ZEROS                  00124990
125030        PERFORM 550-35A-ACESSA-ADIANTAMENTO                       00125030
125040     ELSE                                                         00125040
125050     IF IMPESSOAL OR                                              00125050
/CVBR/*       ((CH-AG-WS = 016) AND FUNDOS) OR                          00125060
/CVBR/        ((CH-AG-WS = 016) AND FUNDOS-FND) OR
125070        ((CH-AG-WS = 152) AND (CH-CONTA-WS = 23096)) OR           00125070
125080        (CONTA-NAO-CADASTRADA)                                    00125080
125090        NEXT SENTENCE                                             00125090
125100     ELSE                                                         00125100
125110        IF SLD-BLO-WS NOT < SLD-DEP-RED-WS                        00125110
125120           IF SLD-DEP-RED-WS NOT < ZEROS                          00125120
125130              MOVE ZEROS TO VR-ADIANT-REAL-WS                     00125130
125140           ELSE                                                   00125140
125150              MOVE SLD-DEP-RED-WS TO VR-ADIANT-REAL-WS            00125150
125160        ELSE                                                      00125160
125170        IF SLD-DEP-RED-WS NOT < 0                                 00125170
125180           MOVE ZEROS TO VR-ADIANT-REAL-WS                        00125180
125190        ELSE                                                      00125190
125200           MOVE SLD-DEP-RED-WS TO VR-ADIANT-REAL-WS.              00125200
125210                                                                  00125210
125220     IF VR-ADIANT-REAL-WS < ZEROS                                 00125220
125230        COMPUTE VR-ADIANT-REAL-WS = VR-ADIANT-REAL-WS * (-1).     00125230
125240                                                                  00125240
125250     IF VR-ADIANT-REAL-WS NOT EQUAL ZEROS                         00125250
125260        COMPUTE NUM-JUR-REAL-WS ROUNDED =                         00125260
125270                INS-NJUR-REAL-RED-WS + VR-ADIANT-REAL-WS          00125270
              IF  OPER-ISENTA-IOF
                  MOVE INS-NIOF-REAL-RED-WS TO NUM-IOC-REAL-WS
              ELSE
125280            COMPUTE NUM-IOC-REAL-WS ROUNDED =
125290                INS-NIOF-REAL-RED-WS +
125290               (VR-ADIANT-REAL-WS * QTDE-DIAS-CORRIDOS-WS)
              END-IF
125300     ELSE                                                         00125300
125310        MOVE INS-NJUR-REAL-RED-WS TO NUM-JUR-REAL-WS              00125310
125320        MOVE INS-NIOF-REAL-RED-WS TO NUM-IOC-REAL-WS.             00125320
125330                                                                  00125330
      *GSOL00293313
           IF (SALDO-ANTERIOR-RED-WS LESS THAN ZEROS AND
               SALDO-ATUAL-WS NOT LESS ZEROS)
               MOVE INS-NIOF-REAL-RED-WS TO NUM-IOC-REAL-WS
           END-IF

125350*----   CALCULO JUROS INSUFICIENCIA DECORRENTE    ----------------00125350
125360*    IF NOT CLIENTE-PREFEREN                                      00125360
125370      COMPUTE SLD-TOT-WS = SLD-DEP-RED-WS + SLD-DISP-S159-WS      00125370
125380      IF  SLD-BLO-WS GREATER SLD-TOT-WS                           00125380
125390         IF  SLD-BLO-WS EQUAL ZEROS                               00125390
125400              MOVE INS-NJUR-DECOR-RED-WS TO NUM-JUR-DECOR-WS      00125400
125410         ELSE                                                     00125410
125420              IF  SLD-DEP-RED-WS NOT LESS ZEROS                   00125420
125430                  COMPUTE NUM-JUR-DECOR-WS ROUNDED =              00125430
125440                          INS-NJUR-DECOR-RED-WS + SLD-DEP-RED-WS -00125440
125450                          SLD-BLO-WS                              00125450
125460              ELSE                                                00125460
125470                  COMPUTE NUM-JUR-DECOR-WS ROUNDED =              00125470
125480                         INS-NJUR-DECOR-RED-WS -                  00125480
125490                         SLD-BLO-WS                               00125490
125500      ELSE                                                        00125500
125510          MOVE INS-NJUR-DECOR-RED-WS TO NUM-JUR-DECOR-WS.         00125510
125740                                                                  00125740
           IF (SALDO-ANTERIOR-RED-WS LESS THAN ZEROS AND
               SALDO-ATUAL-WS NOT LESS ZEROS)
               NEXT SENTENCE
           ELSE
125750     IF  P-FISICAS                                                00125750
125760         COMPUTE INS-NJUR-REAL-RED-WS ROUNDED = NUM-JUR-REAL-WS * 00125760
125770                 FATOR-INSUF-PF-WS + INS-NJUR-REAL-RED-WS         00125770
125780     ELSE                                                         00125780
125790         COMPUTE INS-NJUR-REAL-RED-WS ROUNDED = NUM-JUR-REAL-WS * 00125790
125800                 FATOR-INSUF-PJ-WS + INS-NJUR-REAL-RED-WS.        00125800
125810                                                                  00125810
125820     MOVE INS-NJUR-REAL-RED-WS TO INS-JUR-ATL-R-D10.              00125820
125830                                                                  00125830
125840     IF IMPESSOAL OR                                              00125840
/CVBR/*       ((CH-AG-WS = 016) AND FUNDOS) OR                          00125850
/CVBR/        ((CH-AG-WS = 016) AND FUNDOS-FND) OR
125860        ((CH-AG-WS = 152) AND (CH-CONTA-WS = 23096)) OR           00125860
125870        (CONTA-NAO-CADASTRADA)                                    00125870
125880        MOVE ZEROS TO INS-NJUR-DECOR-RED-WS                       00125880
125890     ELSE                                                         00125890
125900      IF  P-FISICAS                                               00125900
125910          COMPUTE INS-NJUR-DECOR-RED-WS ROUNDED = NUM-JUR-DECOR-WS00125910
125920                  * FATOR-INSUF-PF-WS + INS-NJUR-DECOR-RED-WS     00125920
125930      ELSE                                                        00125930
125940          COMPUTE INS-NJUR-DECOR-RED-WS ROUNDED = NUM-JUR-DECOR-WS00125940
125950                  * FATOR-INSUF-PJ-WS + INS-NJUR-DECOR-RED-WS.    00125950
125960                                                                  00125960
125970     MOVE INS-NJUR-DECOR-RED-WS TO INS-JUR-ATL-D-D10.             00125970
125980                                                                  00125980
125990     COMPUTE INS-JUR-REAL-WS = INS-JUR-ATL-R-D10 * (-1).          00125990
126000     COMPUTE INS-JUR-DECOR-WS = INS-JUR-ATL-D-D10 * (-1).         00126000
126010                                                                  00126010
126048     IF P-FISICAS OR FACTORING                                    00126048
              MOVE TX-IOF-FISICA-WS TO ALIQUOTA-WS                      00126049
           ELSE                                                         00126050
             MOVE NUM-IOC-REAL-WS TO NUM-SIMPLES-WS                     00126051
           IF P-JURIDICAS AND SIMPLES AND FAIXA-NUM-SIMPLES             00126052
                MOVE TX-IOC-SIMPLES-WS TO ALIQUOTA-WS                   00126053
              ELSE                                                      00126054
                MOVE TX-IOF-JURID-WS   TO ALIQUOTA-WS.                  00126055
                                                                        00126056
           IF  OPER-ISENTA-IOF
               NEXT SENTENCE
           ELSE
               COMPUTE INS-NIOF-REAL-RED-WS = NUM-IOC-REAL-WS -
                                              INS-JUR-REAL-WS
           END-IF.

126048     IF P-FISICAS OR FACTORING                                    00126094
126049        COMPUTE INS-IOF-ATL-R-D10 ROUNDED = IOF-ADICIONAL-WS -    00126095
126051                  (INS-NIOF-REAL-RED-WS * TX-IOF-FISICA-WS / 100) 00126097
126060     ELSE                                                         00126098
126070       MOVE NUM-IOC-REAL-WS TO NUM-SIMPLES-WS                     00126099
126080       IF P-JURIDICAS AND SIMPLES AND FAIXA-NUM-SIMPLES           00126100
126090           COMPUTE INS-IOF-ATL-R-D10 ROUNDED = IOF-ADICIONAL-WS - 00126101
126110                 (INS-NIOF-REAL-RED-WS * TX-IOC-SIMPLES-WS / 100) 00126110
126120       ELSE                                                       00126120
126130           COMPUTE INS-IOF-ATL-R-D10 ROUNDED = IOF-ADICIONAL-WS - 00126130
126150                 (INS-NIOF-REAL-RED-WS * TX-IOF-JURID-WS / 100).  00126150
126160                                                                  00126160
126220     IF ((CH-AG-WS = 016) AND FUNDOS-FND)
126230          MOVE ZEROS TO INS-NIOF-REAL-RED-WS.                     00126230
126260                                                                  00126260
126270     MOVE ZEROS TO INS-IOF-ATL-D-D10.                             00126270
126280                                                                  00126280
126290     MOVE ZEROS TO INS-JUR-REAL-WS                                00126290
126300                   INS-JUR-DECOR-WS.                              00126300
126310                                                                  00126310
126320     COMPUTE INS-NUM-SMEDIO-MES-D10 = (SMED-ATL1-RED-WS +         00126320
126330             SMED-ATL2-RED-WS + SMED-ATL3-RED-WS) / 3.            00126330
126340                                                                  00126340
126350     MOVE CRED-ANTECIP-WS TO INS-CRED-ANTECIP-D10.                00126350
126360                                                                  00126360
126370     COMPUTE INSUF-AUX-WS = SLD-DISP-S159-WS + INS-SLD-DEP-D10 -  00126370
126380                            INS-SLD-BLO-D10.                      00126380

126390     IF  INS-NUM-DIAS-D10 EQUAL ZEROS                             00126390
126400         IF  INSUF-AUX-WS NOT NEGATIVE                            00126400
/GCVN/             IF  SALDO-ANTERIOR-INS < 0
126410                 MOVE 1 TO SW-INSUF-EXTINTA.                      00126410

126430     IF IMPESSOAL OR                                              00126430
              ((CH-AG-WS = 016) AND FUNDOS-FND) OR
126450        ((CH-AG-WS = 152) AND (CH-CONTA-WS = 23096)) OR           00126450
126460        (CONTA-NAO-CADASTRADA)                                    00126460
126470        MOVE ZEROS TO QDE-INS-EXC-MES-RED-WS                      00126470
126480                      INS-QDE-OCORR-D10                           00126480
126490                      INS-CTRL-FIM-D10                            00126490
126500     ELSE                                                         00126500
126510        MOVE QDE-INS-EXC-MES-RED-WS TO INS-QDE-OCORR-D10          00126510
126520        IF INSUFICIENCIA-EXTINTA                                  00126520
126530           MOVE 1 TO INS-CTRL-FIM-D10                             00126530
126540           MOVE ZEROS TO QDE-INS-EXC-MES-RED-WS                   00126540
126550        ELSE                                                      00126550
126560           MOVE 0 TO INS-CTRL-FIM-D10.                            00126560
126570                                                                  00126570
126590     MOVE RAP-RED-WS TO INS-RAP-D10.                              00126590
126600                                                                  00126600
126610     PERFORM 999-15-ACUMULA-D10.                                  00126610
126620                                                                  00126620
126630     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00126630
126640                                                                  00126640
/GCVN/      WRITE REG-INSUF-D10                                         00126650
/GCVN/       INVALID KEY                                                00126660
/GCVN/         PERFORM 999-20-ESTOUROU-AREA-D10.                        00126670
126680                                                                  00126680
126690     IF  NOT INSUFICIENCIA-EXTINTA                                00126690
126700         MOVE SPACES TO REG-INSUF-MOVTOS-D10                      00126700
126710         IF  IND-MOVTOS NOT EQUAL ZEROS                           00126710
126720             MOVE ZEROS TO IND-AUX                                00126720
/GCVN/             PERFORM 550A-35-GRAVA-MOVTOS-INSUF IND-MOVTOS TIMES. 00126730
126740                                                                  00126740
126750     IF INSUF-EXCESSO-RED-WS = 1                                  00126750
126760         MOVE 6 TO EXT-COD-MENS-D10                               00126760
126770     ELSE                                                         00126770
126780       IF INSUF-EXCESSO-RED-WS = 2                                00126780
126790         MOVE 1  TO INSUF-EXCESSO-RED-WS                          00126790
126800         MOVE 7 TO EXT-COD-MENS-D10.                              00126800
126810                                                                  00126810
126820     IF IND-MENS-FICHA = 1                                        00126820
126830         MOVE 10 TO EXT-COD-MENS-D10.                             00126830
126860                                                                  00126860
126870 550-35-OCR-INS-CTA-VENCIDA.                                      00126870
126880                                                                  00126880
           MOVE SPACES TO REG-INSUF-D10.
           INITIALIZE REG-INSUF-D10.
           MOVE ZEROS        TO INS-IOF-1DIA-D-D10
                                INS-IOF-1DIA-R-D10
                                INS-JUR-1DIA-D-D10
                                INS-JUR-1DIA-R-D10.
126890     MOVE 24           TO CH-TPREG-D10.                           00126890
126900     MOVE CH-AG-WS     TO CH-CODAG-D10.                           00126900
126910     MOVE CH-CONTA-WS  TO CONTA-D10.                              00126910
126920     MOVE CH-DIGITO-WS TO DV-CONTA-D10.                           00126920
126930     MOVE 1            TO INS-TPREG-D10.                          00126930
126940     MOVE TPCONTAB-RED-WS TO INS-TPCONTAB-D10.                    00126940
126950     MOVE NOME-CLIENTE-RED-WS TO INS-NOME-CLIENTE-D10.            00126950

           MOVE TP-PESSOA-RED-WS    TO INS-TPPES-D10
           MOVE GRUPO-TARIFA-RED-WS TO INS-GRTAR-D10

126960     MOVE 'VEN'        TO INS-CV-D10.                             00126960
126970     IF ID-CPF-CGC-RED-WS EQUAL 1 OR 2                            00126970
126980        MOVE ID-CPF-CGC-RED-WS TO INS-ID-CPF-CGC-D10              00126980
126990        MOVE CPF-CGC-RED-WS    TO INS-CPF-CGC-D10                 00126990
127000     ELSE                                                         00127000
127010        MOVE ZEROS             TO INS-ID-CPF-CGC-D10              00127010
127020        MOVE ZEROS             TO INS-CPF-CGC-D10.                00127020
127030     MOVE COD-POSTO-RED-WS TO INS-COD-POSTO-D10.                  00127030
127040     MOVE CLIENTE-PREFEREN-RED-WS TO INS-CLI-ESPECIAL-D10.        00127040
127050     MOVE CALC-SMED-RED-WS         TO INS-CALC-SMED-D10.          00127050
127060*    MOVE ENDERECO-RED-WS TO INS-ENDERECO-D10.                    00127060
127070     MOVE ENDERECO-WS TO INS-ENDERECO-D10.                        00127070
127080                                                                  00127080
127090     MOVE INS-ULT-RED-WS TO INS-DATA-ULT-D10.                     00127090
127100     MOVE INS-VEZ-RED-WS TO INS-NUM-VEZES-D10.                    00127100
127110     MOVE ZERO TO INS-DATA-INIC-D10 INS-NUM-DIAS-D10.             00127110
127120     MOVE SLD-EMP-ANT-WS TO INS-SLD-ANT-D10.                      00127120
127130     MOVE SLD-EMP-RED-WS TO INS-SLD-DEP-D10.                      00127130
127140                                                                  00127140
127150     COMPUTE INS-SLD-BLO-D10 =                                    00127150
127160                 (SLD-BLO-RED-WS (1) + SLD-BLO-RED-WS (2) +       00127160
127170                  SLD-BLO-RED-WS (3) + SLD-BLO-RED-WS (4) +       00127170
127180                  SLD-BLO-RED-WS (5) + SLD-BLO-RED-WS (6) +       00127180
127190                  SLD-BLO-RED-WS (7) + SLD-BLO-RED-WS (8) +       00127190
127200                  SLD-BLO-RED-WS (9) + SLD-BLO-RED-WS (10) +      00127200
127210                  SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +     00127210
127220                  SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +     00127220
127230                  SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +     00127230
127240                  SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +     00127240
127250                  SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +     00127250
127260                  SLD-BLO-RED-WS (21)).                           00127260
127270                                                                  00127270
127280     MOVE INS-SLD-BLO-D10 TO SLD-BLO-WS.                          00127280
127290                                                                  00127290
127300     MOVE SLD-BLO-RED-WS (1)  TO INS-SLD-BLO-24HS-D10.            00127300
127310                                                                  00127310
127320     MOVE ZEROS TO INS-JUR-ATL-R-D10.                             00127320
127330                                                                  00127330
127340     MOVE ZEROS TO INS-JUR-ATL-D-D10.                             00127340
127350                                                                  00127350
127360     MOVE ZEROS TO INS-IOF-ATL-R-D10.                             00127360
127370                                                                  00127370
127380     MOVE ZEROS TO INS-IOF-ATL-D-D10.                             00127380
127400                                                                  00127400
127410     COMPUTE INS-NUM-SMEDIO-MES-D10 = (SMED-ATL1-RED-WS +         00127410
127420             SMED-ATL2-RED-WS + SMED-ATL3-RED-WS) / 3.            00127420
127430                                                                  00127430
127440     MOVE CRED-ANTECIP-WS TO INS-CRED-ANTECIP-D10.                00127440
127450                                                                  00127450
127460     MOVE ZEROS TO INS-QDE-OCORR-D10                              00127460
127470                      INS-CTRL-FIM-D10.                           00127470
127480                                                                  00127480
127490     MOVE RAP-RED-WS TO INS-RAP-D10.                              00127490
127500                                                                  00127500
127510     IF  IND-MOVTOS NOT EQUAL ZEROS AND                           00127510
127520         SLD-EMP-RED-WS < ZEROS                                   00127520
127530         PERFORM 999-15-ACUMULA-D10.                              00127530
127540                                                                  00127540
/GCVN/     IF  IND-MOVTOS NOT EQUAL ZEROS AND                           00127560
/GCVN/         SLD-EMP-RED-WS < ZEROS                                   00127570
/GCVN/         MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10                     00127580
/GCVN/         WRITE REG-INSUF-D10                                      00127590
/GCVN/               INVALID KEY                                        00127600
/GCVN/               PERFORM 999-20-ESTOUROU-AREA-D10.                  00127610
127620                                                                  00127620
127630     IF  IND-MOVTOS NOT EQUAL ZEROS AND                           00127630
127640         SLD-EMP-RED-WS < ZEROS                                   00127640
127650         MOVE SPACES TO REG-INSUF-MOVTOS-D10                      00127650
127660         MOVE ZEROS TO IND-AUX                                    00127660
127670         PERFORM 550A-35-GRAVA-MOVTOS-INSUF IND-MOVTOS TIMES.     00127670
127700                                                                  00127700
127710 550-35A-ACESSA-ADIANTAMENTO.                                     00127710
127720                                                                  00127720
127730      CALL 'M0952000' USING ANO-MOV-WS ANO-MOV-D15.               00127730
127740      MOVE MES-MOV-WS   TO MES-MOV-D15.                           00127740
127750      MOVE DIA-MOV-WS   TO DIA-MOV-D15.                           00127750
127760      MOVE CH-AG-WS     TO AGENCIA-D15.                           00127760
127770      MOVE CH-CONTA-WS  TO CONTA-D15.                             00127770
127780      MOVE CH-DIGITO-WS TO DV-CONTA-D15.                          00127780
127790      READ D04815.                                                00127790
127800      IF STATUS-D04815-WS EQUAL '23'                              00127800
127810         MOVE VALOR-ACUM-ADIANT-RED-WS TO VR-ADIANT-REAL-WS       00127810
127820      ELSE                                                        00127820
127830        IF STATUS-D04815-WS EQUAL '00'                            00127830
127840           MOVE VLR-REAL-D15 TO VR-ADIANT-REAL-WS                 00127840
127850        ELSE                                                      00127850
127860          DISPLAY '**P04808-CANCELADO ERRO LEITURA D04815**'      00127860
127870          MOVE COD-RETORNO-WS (3) TO RETURN-CODE                  00127870
127880          DISPLAY 'RETURN CODE EH .. ' STATUS-D04815-WS           00127880
127890          GOBACK.                                                 00127890
127900                                                                  00127900
127910 550A-35-GRAVA-MOVTOS-INSUF.                                      00127910
127920                                                                  00127920
            MOVE SPACES TO REG-INSUF-MOVTOS-D10.
            INITIALIZE REG-INSUF-MOVTOS-D10.
127930      ADD 1 TO IND-AUX.                                           00127930
127940      MOVE 24           TO CH-TPREG-D10.                          00127940
127950      MOVE CH-AG-WS     TO CH-CODAG-D10.                          00127950
127960      MOVE CH-CONTA-WS  TO CONTA-D10                              00127960
127970      MOVE CH-DIGITO-WS TO DV-CONTA-D10.                          00127970
127980      MOVE 2            TO INS-TPREG-D10.                         00127980
127990      MOVE MOV-LOTE-TAB (IND-AUX) TO INS-MOV-LOTE-D10.            00127990
128000      MOVE MOV-HIST-TAB (IND-AUX) TO INS-MOV-HIST-D10.            00128000
128010      MOVE MOV-REF-TAB  (IND-AUX) TO INS-MOV-REF-D10.             00128010
128020      MOVE MOV-VR-TAB   (IND-AUX) TO INS-MOV-VR-D10.              00128020
128030      PERFORM 999-15-ACUMULA-D10.                                 00128030
128040      MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                       00128040

            WRITE REG-INSUF-MOVTOS-D10                                  00128050
            INVALID KEY                                                 00128060
               PERFORM 999-20-ESTOUROU-AREA-D10.                        00128070
128090*                                                                 00128090
128110 555-35-OCR-CAD-EMP.                                              00128110
128120                                                                  00128120
128130     MOVE 26                      TO CH-TPREG-D10.                00128130
128140     MOVE CH-AG-WS                TO CH-CODAG-D10.                00128140
128150     MOVE CH-CONTA-WS             TO CONTA-D10.                   00128150
128160     MOVE CH-DIGITO-WS            TO DV-CONTA-D10.                00128160
128170     MOVE TPCONTAB-RED-WS         TO C-EMP-TPCONTAB-D10.          00128170
128180     MOVE NOME-CLIENTE-RED-WS     TO C-EMP-NOME-CLIENTE-D10.      00128180
128190     MOVE TP-PESSOA-RED-WS        TO C-EMP-TPPES-D10.             00128190

250412     MOVE SPACES                  TO C-EMP-NOME-MENS-D10

           MOVE ID-CPF-CGC-RED-WS       TO C-EMP-IDPES-D10
           MOVE GRUPO-TARIFA-RED-WS     TO C-EMP-GRTAR-D10

128200*    MOVE ENDERECO-RED-WS         TO C-EMP-ENDERECO-D10.          00128200
128210     MOVE ENDERECO-WS             TO C-EMP-ENDERECO-D10.          00128210
128220     MOVE COD-POSTO-RED-WS        TO C-EMP-COD-POSTO-D10          00128220
128230     MOVE CLIENTE-PREFEREN-RED-WS TO C-EMP-CLI-ESPECIAL-D10       00128230
128240     COMPUTE C-EMP-SLD-CONTA-D10 = (SLD-DEP-RED-WS +              00128240
128250                  EMP-LIM-RED-WS + SLD-EMP-RED-WS) -              00128250
128260                 (SLD-BLO-RED-WS (1)  + SLD-BLO-RED-WS (2)  +     00128260
128270                  SLD-BLO-RED-WS (3)  + SLD-BLO-RED-WS (4)  +     00128270
128280                  SLD-BLO-RED-WS (5)  + SLD-BLO-RED-WS (6)  +     00128280
128290                  SLD-BLO-RED-WS (7)  + SLD-BLO-RED-WS (8)  +     00128290
128300                  SLD-BLO-RED-WS (9)  + SLD-BLO-RED-WS (10) +     00128300
128310                  SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +     00128310
128320                  SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +     00128320
128330                  SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +     00128330
128340                  SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +     00128340
128350                  SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +     00128350
128360                  SLD-BLO-RED-WS (21)).                           00128360
128370                                                                  00128370
128380     IF C-EMP-SLD-CONTA-D10 LESS ZERO                             00128380
128390         MOVE 'E' TO C-EMP-TPSLD-D10                              00128390
128400     ELSE                                                         00128400
128410         MOVE 'D' TO C-EMP-TPSLD-D10.                             00128410
128420                                                                  00128420
128430     COMPUTE C-EMP-SMED-TRIM-D10 = ((NUM-SMED-ESTE-RED-WS /       00128430
128440         DIA-D07-WS) + SMED-ATL1-RED-WS + SMED-ATL2-RED-WS) / 3.  00128440
128450     MOVE EMP-VENC-RED-WS        TO C-EMP-VENC-D10.               00128450
128460     MOVE EMP-LIM-RED-WS         TO C-EMP-LIM-D10.                00128460
128470     MOVE EMP-TAXA-JUR-RED-WS    TO CAD-EMP-TAXA-D10.             00128470
128480     MOVE EMP-SEGURO-RED-WS      TO C-EMP-SEG-D10.                00128480
128490     MOVE EMP-PROPOSTA-RED-WS    TO C-EMP-PROPOSTA-D10.           00128490
128500     MOVE RAP-RED-WS             TO C-EMP-RAP-D10.                00128500
128510     MOVE DIA-DEBITO-JUROS-RED-WS TO C-EMP-DIA-DEBITO-D10.        00128510
128520     MOVE IOCS-DIARIOS-EXIGIVEIS-RED-WS TO C-EMP-IOF-D10.         00128520
128530                                                                  00128530
128540     PERFORM 999-39-VERIFICA-SLD-DECORR.                          00128540
128550                                                                  00128550
128560     IF NOT CLIENTE-PREFEREN                                      00128560
128570     IF C-EMP-COD-MENS-D10 NOT EQUAL 24                           00128570
128580        COMPUTE EXCESSO-WS = EMP-LIM-RED-WS + SLD-DEV-NUM-WS      00128580
128590        IF EXCESSO-WS GREATER ZEROS                               00128590
128600           MOVE ZEROS TO EXCESSO-WS.                              00128600
128610                                                                  00128610
128620     IF NOT CLIENTE-PREFEREN                                      00128620
128630     IF EMP-LIM-RED-WS GREATER ZEROS AND                          00128630
128640        SLD-DEV-NUM-WS LESS ZEROS                                 00128640
128650        IF  P-FISICAS                                             00128650
128660               COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =                00128660
128670                    ((SLD-DEV-NUM-WS +                            00128670
128680                    JUROS-DIARIOS-WS) * FATOR-JUROS-PFISICA-WS) + 00128680
128690                    (EXCESSO-WS * FATOR-EXCESSO-PFISICA-WS)       00128690
128700        ELSE                                                      00128700
128710           IF P-JURIDICAS                                         00128710
128720              IF CH-EMPRESA                                       00128720
128730                 COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =              00128730
128740                         ((SLD-DEV-NUM-WS +                       00128740
128750                         JUROS-DIARIOS-WS) *                      00128750
128760                         FATOR-JUROS-PJURIDICA-WS) +              00128760
128770                         (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)00128770
128780              ELSE                                                00128780
128790              IF CH-EMPRESA-PP                                    00128790
128800                 COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =              00128800
128810                         ((SLD-DEV-NUM-WS +                       00128810
128820                         JUROS-DIARIOS-WS) *                      00128820
128830                         FATOR-JUROS-PJ-PP-WS) +                  00128830
128840                         (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)00128840
128850              ELSE                                                00128850
128860                 IF CTA-EMPRESARIAL                               00128860
128870                    COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =           00128870
128880                            ((SLD-DEV-NUM-WS +                    00128880
128890                            JUROS-DIARIOS-WS) *                   00128890
128900                            (FATOR-JUROS-CTA-EMPRES-WS  +         00128900
128910                            (EMP-TAXA-JUR-RED-WS / 100))) +       00128910
128920                         (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)00128920
128930                 ELSE                                             00128930
128940                    NEXT SENTENCE                                 00128940
128950           ELSE                                                   00128950
128960              NEXT SENTENCE                                       00128960
128970     ELSE                                                         00128970
128980        IF SLD-DEV-NUM-WS NOT LESS ZEROS AND                      00128980
128990           JUROS-DIARIOS-WS NOT EQUAL ZEROS                       00128990
129000           IF P-FISICAS                                           00129000
129010              COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =                 00129010
129020                         JUROS-DIARIOS-WS *                       00129020
129030                         FATOR-JUROS-PFISICA-WS                   00129030
129040           ELSE                                                   00129040
129050              IF P-JURIDICAS                                      00129050
129060                 IF CH-EMPRESA                                    00129060
129070                    COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =           00129070
129080                            JUROS-DIARIOS-WS *                    00129080
129090                            FATOR-JUROS-PJURIDICA-WS              00129090
129100                 ELSE                                             00129100
129110                 IF CH-EMPRESA-PP                                 00129110
129120                    COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =           00129120
129130                            JUROS-DIARIOS-WS *                    00129130
129140                            FATOR-JUROS-PJ-PP-WS                  00129140
129150                 ELSE                                             00129150
129160                    IF CTA-EMPRESARIAL                            00129160
129170                       COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =        00129170
129180                            JUROS-DIARIOS-WS *                    00129180
129190                            (FATOR-JUROS-CTA-EMPRES-WS  +         00129190
129200                            (EMP-TAXA-JUR-RED-WS / 100))          00129200
129210                    ELSE                                          00129210
129220                       NEXT SENTENCE                              00129220
129230              ELSE                                                00129230
129240                 NEXT SENTENCE                                    00129240
129250        ELSE                                                      00129250
129260           MOVE ZEROS TO C-EMP-JUR-DEV-D10.                       00129260
129270                                                                  00129270
129280     IF NOT CLIENTE-PREFEREN                                      00129280
129290        COMPUTE C-EMP-JUR-DEV-D10 = C-EMP-JUR-DEV-D10 +           00129290
129300                                    JUROS-DIARIOS-WS.             00129300
129310*-----------------------------------------------------------------00129310
129320*      CALCULO JUROS DE CLIENTE ESPECIAL                          00129320
129330*-----------------------------------------------------------------00129330
129340     IF CLIENTE-PREFEREN                                          00129340
129350        IF C-EMP-COD-MENS-D10 NOT EQUAL 24                        00129350
129360           COMPUTE EXCESSO-WS = EMP-LIM-RED-WS + SLD-EMP-RED-WS   00129360
129370           IF EXCESSO-WS GREATER ZEROS                            00129370
129380              MOVE ZEROS TO EXCESSO-WS.                           00129380
129390     IF CLIENTE-PREFEREN                                          00129390
129400        IF EMP-LIM-RED-WS GREATER ZEROS AND                       00129400
129410           SLD-EMP-RED-WS LESS ZEROS                              00129410
129420           IF  P-FISICAS                                          00129420
129430               COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =                00129430
129440                    ((SLD-EMP-RED-WS +                            00129440
129450                    JUROS-DIARIOS-WS) * FATOR-JUROS-PFISICA-WS) + 00129450
129460                    (EXCESSO-WS * FATOR-EXCESSO-PFISICA-WS)       00129460
129470           ELSE                                                   00129470
129480              IF P-JURIDICAS                                      00129480
129490                 IF CH-EMPRESA                                    00129490
129500                     COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =          00129500
129510                         ((SLD-EMP-RED-WS +                       00129510
129520                         JUROS-DIARIOS-WS) *                      00129520
129530                         FATOR-JUROS-PJURIDICA-WS) +              00129530
129540                         (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)00129540
129550                 ELSE                                             00129550
129560                 IF CH-EMPRESA-PP                                 00129560
129570                     COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =          00129570
129580                         ((SLD-EMP-RED-WS +                       00129580
129590                         JUROS-DIARIOS-WS) *                      00129590
129600                         FATOR-JUROS-PJ-PP-WS) +                  00129600
129610                         (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)00129610
129620                 ELSE                                             00129620
129630                    IF CTA-EMPRESARIAL                            00129630
129640                       COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =        00129640
129650                            ((SLD-EMP-RED-WS +                    00129650
129660                            JUROS-DIARIOS-WS) *                   00129660
129670                            (FATOR-JUROS-CTA-EMPRES-WS  +         00129670
129680                            (EMP-TAXA-JUR-RED-WS / 100))) +       00129680
129690                         (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)00129690
129700                    ELSE                                          00129700
129710                       NEXT SENTENCE                              00129710
129720              ELSE                                                00129720
129730                 NEXT SENTENCE                                    00129730
129740        ELSE                                                      00129740
129750           IF SLD-EMP-RED-WS NOT LESS ZEROS AND                   00129750
129760              JUROS-DIARIOS-WS NOT EQUAL ZEROS                    00129760
129770              IF P-FISICAS                                        00129770
129780                 COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =              00129780
129790                         JUROS-DIARIOS-WS *                       00129790
129800                         FATOR-JUROS-PFISICA-WS                   00129800
129810           ELSE                                                   00129810
129820              IF P-JURIDICAS                                      00129820
129830                 IF CH-EMPRESA                                    00129830
129840                    COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =           00129840
129850                            JUROS-DIARIOS-WS *                    00129850
129860                            FATOR-JUROS-PJURIDICA-WS              00129860
129870                 ELSE                                             00129870
129880                 IF CH-EMPRESA-PP                                 00129880
129890                    COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =           00129890
129900                            JUROS-DIARIOS-WS *                    00129900
129910                            FATOR-JUROS-PJ-PP-WS                  00129910
129920                 ELSE                                             00129920
129930                    IF CTA-EMPRESARIAL                            00129930
129940                       COMPUTE C-EMP-JUR-DEV-D10 ROUNDED =        00129940
129950                            JUROS-DIARIOS-WS *                    00129950
129960                            (FATOR-JUROS-CTA-EMPRES-WS  +         00129960
129970                            (EMP-TAXA-JUR-RED-WS / 100))          00129970
129980                    ELSE                                          00129980
129990                       NEXT SENTENCE                              00129990
130000              ELSE                                                00130000
130010                 NEXT SENTENCE                                    00130010
130020        ELSE                                                      00130020
130030           MOVE ZEROS TO C-EMP-JUR-DEV-D10.                       00130030
130040                                                                  00130040
130050     IF CLIENTE-PREFEREN                                          00130050
130060        COMPUTE C-EMP-JUR-DEV-D10 = C-EMP-JUR-DEV-D10 +           00130060
130070                                    JUROS-DIARIOS-WS.             00130070
130080     MOVE ZEROS TO SLD-DEV-NUM-WS.                                00130080
130090     PERFORM 999-15-ACUMULA-D10.                                  00130090
130100                                                                  00130100
130110     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00130110
130120     MOVE C-EMP-COD-MENS-D10 TO MENS-AUX.                         00130120
130130     WRITE REG-CAD-EMP-D10                                        00130130
130140       INVALID KEY                                                00130140
130150         PERFORM 999-20-ESTOUROU-AREA-D10.                        00130150
130160*                                                                 00130160
130170 560-35-INICIA-OCR-AC-NUMEROS.                                    00130170
130180*                                                                 00130180
           MOVE CH-SEQUENC-D10 TO CH-SEQUENC-AUX.
           MOVE CH-SEQUENC-AUX TO CH-SEQUENC-D10.
130190     MOVE 28 TO CH-TPREG-D10.                                     00130190
130200     MOVE CH-AG-WS TO CH-CODAG-D10.                               00130200
130210     MOVE CH-CONTA-WS TO CONTA-D10.                               00130210
130220     MOVE CH-DIGITO-WS TO DV-CONTA-D10.                           00130220
130230     MOVE NOME-RED-WS TO AC-N-NOME-D10.                           00130230
130240     MOVE NUM-ULT-RED-WS TO AC-N-DTAULT-NANT-D10.                 00130240
130250     MOVE AC-N-REF-D07 TO AC-N-DOC-D10                            00130250
130260     MOVE COD-POSTO-RED-WS TO AC-N-COD-POSTO-D10                  00130260
130270     MOVE CLIENTE-PREFEREN-RED-WS TO AC-N-CLI-ESPECIAL-D10        00130270
130280     IF AC-N-ADD-SUBT-D07 = 'S' OR 'T'                            00130280
130290         COMPUTE AC-N-NUMEROS-D10 = AC-NUMEROS-D07 * -1           00130290
130300     ELSE                                                         00130300
130310         MOVE AC-NUMEROS-D07 TO AC-N-NUMEROS-D10.                 00130310
130320                                                                  00130320
130330     IF RECUSA-AC-NUMEROS                                         00130330
130340         MOVE ZEROS TO AC-N-NANT-D10 AC-N-NATL-D10                00130340
130350                       AC-N-NVEZES-D10 SW-RECUSA-AC-NUMEROS       00130350
130360         MOVE 1 TO CH-SEQUENC-D10                                 00130360
130370         PERFORM 999-15-ACUMULA-D10                               00130370
130380         PERFORM 620-35-GRAVA-OCR-AC-NUMEROS.                     00130380
130390                                                                  00130390
130400     IF FUNC                                                      00130400
130410        COMPUTE NUM-TOTAL-FUNC-WS =                               00130410
130420                EMP-NUM-RED-WS + EMP-NUM-EXCED-FUNC-RED-WS        00130420
130430        MOVE NUM-TOTAL-FUNC-WS TO AC-N-NANT-D10                   00130430
130440     ELSE                                                         00130440
130450        MOVE EMP-NUM-RED-WS TO AC-N-NANT-D10.                     00130450
130480*                                                                 00130480
130490 565-35-COMPLEM-OCR-AC-NUMEROS.                                   00130490
130500*                                                                 00130500
130510     MOVE AC-N-COD-MENS-WS TO AC-N-COD-MENS-D10.                  00130510
130520                                                                  00130520
130530     IF CH-SEQUENC-D10 = 1                                        00130530
130540        IF FUNC                                                   00130540
130550           COMPUTE NUM-TOTAL-FUNC-WS =                            00130550
130560                   EMP-NUM-RED-WS + EMP-NUM-EXCED-FUNC-RED-WS     00130560
130570           MOVE NUM-TOTAL-FUNC-WS TO AC-N-NATL-D10                00130570
130580        ELSE                                                      00130580
130590           MOVE EMP-NUM-RED-WS TO AC-N-NATL-D10                   00130590
130600     ELSE                                                         00130600
130610         MOVE EMP-NUM-IOF-RED-WS TO AC-N-NATL-D10.                00130610
130620     MOVE NUM-VEZ-RED-WS TO AC-N-NVEZES-D10.                      00130620
130630                                                                  00130630
130640     PERFORM 999-15-ACUMULA-D10.                                  00130640
130650                                                                  00130650
130660     PERFORM 620-35-GRAVA-OCR-AC-NUMEROS.                         00130660
130670                                                                  00130670
130690 570-35-OCR-CONTA-VENCIDA.                                        00130690
130710                                                                  00130710
130720     PERFORM 999-100-PERCENTUAL-UTILIZACAO.                       00130720
130730                                                                  00130730
130740*-------------------------------------------------------          00130740
130750*--- JUROS DE MORA DE 1% AO MES TRANSFORMADO AO DIA ----          00130750
130760*-------------------------------------------------------          00130760
130770                                                                  00130770
130780      COMPUTE HUM-PORCENTO-WS =(((1 / 100) + 1) ** (1 / 30)) - 1. 00130780
130790                                                                  00130790
130810     MOVE ZEROS TO FATOR-VENCIDO-WS.                              00130810
130820                                                                  00130820
130830     IF P-FISICAS                                                 00130830
130840        COMPUTE FATOR-VENCIDO-WS = (((FATOR-JUROS-PFISICA-WS      00130840
130850                      + 1) * (HUM-PORCENTO-WS + 1)) - 1)          00130850
130860     ELSE                                                         00130860
130870      IF P-JURIDICAS                                              00130870
130880       IF CH-EMPRESA                                              00130880
130890          COMPUTE FATOR-VENCIDO-WS = (((FATOR-JUROS-PJURIDICA-WS  00130890
130900                      + 1) * (HUM-PORCENTO-WS + 1)) - 1)          00130900
130910       ELSE                                                       00130910
130920       IF CH-EMPRESA-PP                                           00130920
130930          COMPUTE FATOR-VENCIDO-WS = (((FATOR-JUROS-PJ-PP-WS      00130930
130940                      + 1) * (HUM-PORCENTO-WS + 1)) - 1)          00130940
130950       ELSE                                                       00130950
130960        IF CTA-EMPRESARIAL                                        00130960
130970           COMPUTE FATOR-VENCIDO-WS = (((FATOR-JUROS-CTA-EMPRES-WS00130970
130980                      + 1) * (HUM-PORCENTO-WS + 1)) - 1).         00130980
130990*---------------------------------------------------------        00130990
131000                                                                  00131000
           MOVE SPACES TO REG-CTA-VENC-D10.
           INITIALIZE REG-CTA-VENC-D10.
131010     MOVE 30 TO CH-TPREG-D10.                                     00131010
131020     MOVE CH-AG-WS TO CH-CODAG-D10.                               00131020
131030     MOVE CH-CONTA-WS TO CONTA-D10.                               00131030
131040     MOVE CH-DIGITO-WS TO DV-CONTA-D10.                           00131040
131050     MOVE NOME-CLIENTE-RED-WS TO CV-NOME-CLIENTE-D10.             00131050
131060     MOVE COD-POSTO-RED-WS TO CV-COD-POSTO-D10.                   00131060
131070     MOVE CLIENTE-PREFEREN-RED-WS TO CV-CLI-ESPECIAL-D10.         00131070
131080     MOVE EMP-SEGURO-RED-WS TO CV-EMP-SEG-D10.                    00131080
131090     MOVE ENDERECO-WS TO CV-ENDERECO-D10.                         00131090
131100     MOVE SLD-DEP-RED-WS  TO CV-SLD-DEP-D10.                      00131100
131110     MOVE SLD-EMP-RED-WS  TO CV-SLD-EMP-D10                       00131110
131120                                                                  00131120
131130     COMPUTE CV-SMED-D10 = (SMED-ATL1-RED-WS + SMED-ATL2-RED-WS + 00131130
131140                           SMED-ATL3-RED-WS) / 3.                 00131140
131150                                                                  00131150
131160     MOVE EMP-VENC-RED-WS TO CV-EMP-VENC-D10 DATA-MENOR-RED.      00131160
131170     MOVE DATA-D07-RED-WS TO DATA-MAIOR-RED.                      00131170
131180     MOVE EMP-LIM-RED-WS  TO CV-EMP-LIM-D10.                      00131180
131190     MOVE EMP-TAXA-JUR-RED-WS TO CV-EMP-TAXA-D10.                 00131190
131200     IF FUNC                                                      00131200
131210        COMPUTE NUM-TOTAL-FUNC-WS =                               00131210
131220                EMP-NUM-RED-WS + EMP-NUM-EXCED-FUNC-RED-WS        00131220
131230        MOVE NUM-TOTAL-FUNC-WS TO CV-EMP-NUM-D10                  00131230
131240     ELSE                                                         00131240
131250        MOVE EMP-NUM-RED-WS  TO CV-EMP-NUM-D10.                   00131250
131260                                                                  00131260
131270     MOVE ZEROS TO CV-JUR-1DIA-D10.                               00131270
131280                                                                  00131280
131290     PERFORM 800-05-CALCULA-NUM-DIAS.                             00131290
131300                                                                  00131300
131310     MOVE DIAS-TRANSF-WS TO CV-QDE-DIA-D10.                       00131310
131320                                                                  00131320
131330***************************************************************** 00131330
131340*      APURACAO DO IOC PARA CLIENTE ESPECIAL                    * 00131340
131350***************************************************************** 00131350
131360                                                                  00131360
              IF CH-EMPRESA OR CTA-EMPRESARIAL
ACMF             MOVE SPACES           TO CH-ISENTO-IOF
                 MOVE CPF-CGC-RED-WS   TO CPF-CGC-AUX
                 PERFORM 99-VERIFICA-ISENCAO-IOF
              END-IF.

131380        IF SALDO-EMP-ANT-WS LESS THAN ZEROS                       00131380
                 IF ISENTO-IOF
                    NEXT SENTENCE
                 ELSE
131390              COMPUTE NUM-IOC-WS = (SALDO-EMP-ANT-WS +            00131390
131400                             JUROS-DIARIOS-WS) * QDE-DIAS-WS      00131400
131410              IF P-FISICAS OR FACTORING                           00131410
131420                 COMPUTE ACUM-IOC-FERIADO-WS ROUNDED =            00131420
131430                         ((NUM-IOC-WS * TX-IOC-FISICA-WS) / 100)  00131430
131440              ELSE                                                00131440
131450                 MOVE NUM-IOC-WS TO NUM-SIMPLES-WS                00131450
131460                 IF P-JURIDICAS AND SIMPLES AND                   00131460
131460                    FAIXA-NUM-SIMPLES                             00131460
131470                    COMPUTE ACUM-IOC-FERIADO-WS ROUNDED =         00131470
131480                         ((NUM-IOC-WS * TX-IOC-SIMPLES-WS)  / 100)00131480
131490                 ELSE                                             00131490
131500                    COMPUTE ACUM-IOC-FERIADO-WS ROUNDED =         00131500
131510                         ((NUM-IOC-WS * TX-IOC-JURID-WS)  / 100)  00131510
                       END-IF
                    END-IF
                 END-IF
              END-IF.
131520                                                                  00131520
131530        IF SLD-EMP-RED-WS LESS THAN ZEROS                         00131530
                 IF ISENTO-IOF
                    NEXT SENTENCE
                 ELSE
131540              COMPUTE NUM-IOC-WS = SLD-EMP-RED-WS +               00131540
131540                                            JUROS-DIARIOS-WS      00131540
131550              IF P-FISICAS OR FACTORING                           00131550
131560                 COMPUTE ACUM-IOC-DIARIO-WS ROUNDED =             00131560
131570                      ((NUM-IOC-WS * TX-IOC-FISICA-WS) / 100)     00131570
131580              ELSE                                                00131580
131590                 MOVE NUM-IOC-WS TO NUM-SIMPLES-WS                00131590
131600                 IF P-JURIDICAS AND SIMPLES AND FAIXA-NUM-SIMPLES 00131600
131610                    COMPUTE ACUM-IOC-DIARIO-WS ROUNDED =          00131610
131620                        ((NUM-IOC-WS * TX-IOC-SIMPLES-WS)  / 100) 00131620
131630                 ELSE                                             00131630
131640                    COMPUTE ACUM-IOC-DIARIO-WS ROUNDED =          00131640
131650                        ((NUM-IOC-WS * TX-IOC-JURID-WS)  / 100)   00131650
                       END-IF
                    END-IF
                 END-IF
              END-IF.
131660                                                                  00131660
           IF  OPER-ISENTA-IOF
               MOVE ZEROS  TO  ACUM-IOC-DIARIO-WS
           END-IF

131670*..........................................................       00131670
131680*... COMANDOS PARA CALCULO DO IOF ADICIONAL DE 0,38  ......       00131680
131690*..........................................................       00131690
131700                                                                  00131700
131710      MOVE ZEROS TO BASE-IOF-ADICIONAL-WS IOF-ADICIONAL-WS.       00131710
131720                                                                  00131720
131750      IF SLD-EMP-RED-WS NOT LESS THAN ZEROS                       00131750
131760         MOVE ZEROS TO BASE-IOF-ADICIONAL-WS                      00131760
131770      ELSE                                                        00131770
               IF ISENTO-IOF
                  NEXT SENTENCE
               ELSE
131780            IF SLD-EMP-RED-WS LESS SLD-EMP-ANT-WS                 00131780
131790               COMPUTE BASE-IOF-ADICIONAL-WS = SLD-EMP-RED-WS -   00131790
131800                                               SLD-EMP-ANT-WS     00131800
                  END-IF
               END-IF
            END-IF.
131810                                                                  00131810
           IF  OPER-ISENTA-IOF
               MOVE ZEROS  TO  BASE-IOF-ADICIONAL-WS
           END-IF

131820      IF BASE-IOF-ADICIONAL-WS NOT EQUAL ZEROS                    00131820
               IF ISENTO-IOF
                  NEXT SENTENCE
               ELSE
131830            COMPUTE IOF-ADICIONAL-WS = (BASE-IOF-ADICIONAL-WS *   00131830
131840                                    0,38) / 100                   00131840
               END-IF
            END-IF.
131850*.............................................................    00131850
            IF ISENTO-IOF
               NEXT SENTENCE
            ELSE
131870         COMPUTE CV-IOF-EMIS-D10 =                                00131870
131880                 IOCS-DIARIOS-EXIGIVEIS-RED-WS +                  00131880
131890                 IOF-ADICIONAL-WS +                               00131890
131900                 ACUM-IOC-DIARIO-WS + ACUM-IOC-FERIADO-WS         00131900
            END-IF.
131910                                                                  00131910
131920      MOVE ZEROS TO ACUM-IOC-DIARIO-WS                            00131920
131930                    ACUM-IOC-FERIADO-WS                           00131930
131940                    NUM-IOC-WS.                                   00131940
131950                                                                  00131950
            IF ISENTO-IOF
               NEXT SENTENCE
            ELSE
131960         MOVE EMP-NUM-IOF-RED-WS TO CV-EMP-NUM-IOF-D10            00131960
            END-IF.
131970                                                                  00131970
131980     PERFORM 999-39-VERIFICA-SLD-DECORR.                          00131980
131990                                                                  00131990
132000     IF NOT CLIENTE-PREFEREN                                      00132000
132010        COMPUTE EXCESSO-WS = EMP-LIM-RED-WS + SLD-DEV-NUM-WS      00132010
132020        IF EXCESSO-WS GREATER ZEROS                               00132020
132030           MOVE ZEROS TO EXCESSO-WS.                              00132030
132040                                                                  00132040
132050     MOVE ZEROS            TO CV-JUR-EMIS-D10.                    00132050
132060                                                                  00132060
132070     IF NOT CLIENTE-PREFEREN                                      00132070
132080     IF EMP-LIM-RED-WS GREATER ZEROS AND                          00132080
132090        SLD-DEV-NUM-WS LESS ZEROS                                 00132090
132100        IF P-FISICAS                                              00132100
132110         IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PF-WS         00132110
132120             COMPUTE CV-JUR-EMIS-D10 ROUNDED = ((SLD-DEV-NUM-WS + 00132120
132130                   JUROS-DIARIOS-WS) * FATOR-VENCIDO-WS) +        00132130
132140                   (EXCESSO-WS * FATOR-EXCESSO-PFISICA-WS)        00132140
132150         ELSE                                                     00132150
132160             COMPUTE CV-JUR-EMIS-D10 ROUNDED = ((SLD-DEV-NUM-WS + 00132160
132170                   JUROS-DIARIOS-WS) * FATOR-IAC-PF-WS) +         00132170
132180                   (EXCESSO-WS * FATOR-EXCESSO-PFISICA-WS)        00132180
132190        ELSE                                                      00132190
132200         IF P-JURIDICAS                                           00132200
132210          IF CH-EMPRESA OR CH-EMPRESA-PP                          00132210
132220           IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PJ-WS       00132220
132230              COMPUTE CV-JUR-EMIS-D10 ROUNDED =                   00132230
132240                      ((SLD-DEV-NUM-WS +                          00132240
132250                      JUROS-DIARIOS-WS) *                         00132250
132260                      FATOR-VENCIDO-WS) +                         00132260
132270                      (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)   00132270
132280           ELSE                                                   00132280
132290              COMPUTE CV-JUR-EMIS-D10 ROUNDED =                   00132290
132300                      ((SLD-DEV-NUM-WS +                          00132300
132310                      JUROS-DIARIOS-WS) *                         00132310
132320                      FATOR-IAC-PJ-WS) +                          00132320
132330                      (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)   00132330
132340          ELSE                                                    00132340
132350           IF CTA-EMPRESARIAL                                     00132350
132360            IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PJ-WS      00132360
132370               COMPUTE CV-JUR-EMIS-D10 ROUNDED =                  00132370
132380                         ((SLD-DEV-NUM-WS +                       00132380
132390                         JUROS-DIARIOS-WS) * FATOR-VENCIDO-WS) +  00132390
132400                      (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)   00132400
132410            ELSE                                                  00132410
132420               COMPUTE CV-JUR-EMIS-D10 ROUNDED =                  00132420
132430                         ((SLD-DEV-NUM-WS +                       00132430
132440                         JUROS-DIARIOS-WS) * FATOR-IAC-PJ-WS) +   00132440
132450                      (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)   00132450
132460           ELSE                                                   00132460
132470              MOVE ZEROS TO CV-JUR-EMIS-D10                       00132470
132480          ELSE                                                    00132480
132490             MOVE ZEROS TO CV-JUR-EMIS-D10                        00132490
132500     ELSE                                                         00132500
132510        IF SLD-DEV-NUM-WS NOT LESS ZEROS AND                      00132510
132520           JUROS-DIARIOS-WS NOT EQUAL ZEROS                       00132520
132530         IF P-FISICAS                                             00132530
132540          IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PF-WS        00132540
132550             COMPUTE CV-JUR-EMIS-D10 ROUNDED =                    00132550
132560                     JUROS-DIARIOS-WS * FATOR-VENCIDO-WS          00132560
132570          ELSE                                                    00132570
132580             COMPUTE CV-JUR-EMIS-D10 ROUNDED =                    00132580
132590                     JUROS-DIARIOS-WS * FATOR-JUROS-PFISICA-WS    00132590
132600         ELSE                                                     00132600
132610          IF P-JURIDICAS                                          00132610
132620           IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PJ-WS       00132620
132630              COMPUTE CV-JUR-EMIS-D10 ROUNDED =                   00132630
132640                      JUROS-DIARIOS-WS * FATOR-VENCIDO-WS         00132640
132650           ELSE                                                   00132650
132660            IF CH-EMPRESA                                         00132660
132670               COMPUTE CV-JUR-EMIS-D10 ROUNDED =                  00132670
132680                      JUROS-DIARIOS-WS * FATOR-IAC-PJ-WS
132690            ELSE                                                  00132690
132700             IF CH-EMPRESA-PP                                     00132700
132710                COMPUTE CV-JUR-EMIS-D10 ROUNDED =                 00132710
132720                      JUROS-DIARIOS-WS * FATOR-IAC-PJ-WS
132730             ELSE                                                 00132730
132740              IF CTA-EMPRESARIAL                                  00132740
132750                COMPUTE CV-JUR-EMIS-D10 ROUNDED =                 00132750
132760                      JUROS-DIARIOS-WS * FATOR-IAC-PJ-WS
132770              ELSE                                                00132770
132780                MOVE ZEROS TO CV-JUR-EMIS-D10.                    00132780
132790                                                                  00132790
132800     IF NOT CLIENTE-PREFEREN                                      00132800
132810        COMPUTE CV-JUR-EMIS-D10 = CV-JUR-EMIS-D10 +               00132810
132820                                  JUROS-DIARIOS-WS.               00132820
132830*-----------------------------------------------------------------00132830
132840*        CALCULO DOS JUROS DE CLIENTE ESPECIAL                    00132840
132850*-----------------------------------------------------------------00132850
132860     IF CLIENTE-PREFEREN                                          00132860
132870        COMPUTE EXCESSO-WS = EMP-LIM-RED-WS + SLD-EMP-RED-WS      00132870
132880        IF EXCESSO-WS GREATER ZEROS                               00132880
132890           MOVE ZEROS TO EXCESSO-WS.                              00132890
132900     IF CLIENTE-PREFEREN                                          00132900
132910     IF EMP-LIM-RED-WS GREATER ZEROS AND                          00132910
132920        SLD-EMP-RED-WS LESS ZEROS                                 00132920
132930        IF P-FISICAS                                              00132930
132940         IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PF-WS         00132940
132950            COMPUTE CV-JUR-EMIS-D10 ROUNDED = ((SLD-EMP-RED-WS +  00132950
132960                   JUROS-DIARIOS-WS) * FATOR-VENCIDO-WS) +        00132960
132970                   (EXCESSO-WS * FATOR-EXCESSO-PFISICA-WS)        00132970
132980         ELSE                                                     00132980
132990            COMPUTE CV-JUR-EMIS-D10 ROUNDED = ((SLD-EMP-RED-WS +  00132990
133000                   JUROS-DIARIOS-WS) * FATOR-IAC-PF-WS) +         00133000
133010                   (EXCESSO-WS * FATOR-EXCESSO-PFISICA-WS)        00133010
133020        ELSE                                                      00133020
133030          IF P-JURIDICAS                                          00133030
133040             IF CH-EMPRESA OR CH-EMPRESA-PP                       00133040
133050              IF FATOR-VENCIDO-WS GREATER THAN FATOR-INSUF-PJ-WS  00133050
133060                 COMPUTE CV-JUR-EMIS-D10 ROUNDED =                00133060
133070                      ((SLD-EMP-RED-WS +                          00133070
133080                      JUROS-DIARIOS-WS) *                         00133080
133090                      FATOR-VENCIDO-WS) +                         00133090
133100                      (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)   00133100
133110              ELSE                                                00133110
133120                 COMPUTE CV-JUR-EMIS-D10 ROUNDED =                00133120
133130                      ((SLD-EMP-RED-WS +                          00133130
133140                      JUROS-DIARIOS-WS) *                         00133140
133150                      FATOR-IAC-PJ-WS) +                          00133150
133160                      (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)   00133160
133170             ELSE                                                 00133170
133180               IF CTA-EMPRESARIAL                                 00133180
133190                IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PJ-WS  00133190
133200                   COMPUTE CV-JUR-EMIS-D10 ROUNDED =              00133200
133210                         ((SLD-EMP-RED-WS +                       00133210
133220                         JUROS-DIARIOS-WS) * FATOR-VENCIDO-WS) +  00133220
133230                      (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)   00133230
133240                ELSE                                              00133240
133250                   COMPUTE CV-JUR-EMIS-D10 ROUNDED =              00133250
133260                         ((SLD-EMP-RED-WS +                       00133260
133270                         JUROS-DIARIOS-WS) * FATOR-IAC-PJ-WS) +   00133270
133280                      (EXCESSO-WS * FATOR-EXCESSO-PJURIDICA-WS)   00133280
133290               ELSE                                               00133290
133300                  MOVE ZEROS TO CV-JUR-EMIS-D10                   00133300
133310           ELSE                                                   00133310
133320              MOVE ZEROS TO CV-JUR-EMIS-D10                       00133320
133330      ELSE                                                        00133330
133340         IF SLD-EMP-RED-WS NOT LESS ZEROS AND                     00133340
133350           JUROS-DIARIOS-WS NOT EQUAL ZEROS                       00133350
133360         IF P-FISICAS                                             00133360
133370          IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PF-WS        00133370
133380             COMPUTE CV-JUR-EMIS-D10 ROUNDED =                    00133380
133390                     JUROS-DIARIOS-WS * FATOR-VENCIDO-WS          00133390
133400          ELSE                                                    00133400
133410             COMPUTE CV-JUR-EMIS-D10 ROUNDED =                    00133410
133420                     JUROS-DIARIOS-WS * FATOR-JUROS-PFISICA-WS    00133420
133430         ELSE                                                     00133430
133440          IF P-JURIDICAS                                          00133440
133450           IF FATOR-VENCIDO-WS GREATER THAN FATOR-IAC-PJ-WS       00133450
133460              COMPUTE CV-JUR-EMIS-D10 ROUNDED =                   00133460
133470                      JUROS-DIARIOS-WS * FATOR-VENCIDO-WS         00133470
133480           ELSE                                                   00133480
133490            IF CH-EMPRESA                                         00133490
133500               COMPUTE CV-JUR-EMIS-D10 ROUNDED =                  00133500
133510                       JUROS-DIARIOS-WS * FATOR-IAC-PJ-WS         00133510
133520            ELSE                                                  00133520
133530              IF CH-EMPRESA-PP                                    00133530
133540               COMPUTE CV-JUR-EMIS-D10 ROUNDED =                  00133540
133550                       JUROS-DIARIOS-WS * FATOR-IAC-PJ-WS
133560              ELSE                                                00133560
133570               IF CTA-EMPRESARIAL                                 00133570
133580                COMPUTE CV-JUR-EMIS-D10 ROUNDED =                 00133580
133590                      JUROS-DIARIOS-WS * FATOR-IAC-PJ-WS
133600               ELSE                                               00133600
133610                MOVE ZEROS            TO CV-JUR-EMIS-D10.         00133610
133620                                                                  00133620
133630     MOVE ZEROS TO NUMEROS-WS NUM-TOTAL-FUNC-WS.                  00133630
133640     IF CLIENTE-PREFEREN                                          00133640
133650        COMPUTE CV-JUR-EMIS-D10 = CV-JUR-EMIS-D10 +               00133650
133660                                  JUROS-DIARIOS-WS.               00133660
133670     IF P-FISICAS OR FACTORING                                    00133670
133680        IF SLD-DEV-NUM-WS LESS ZERO                               00133680
133690           MOVE ZEROS TO CV-IOF-1DIA-D10                          00133690
133700        ELSE                                                      00133700
133710           MOVE ZEROS TO CV-IOF-1DIA-D10 SLD-DEV-NUM-WS           00133710
133720     ELSE                                                         00133720
133730           IF SLD-DEV-NUM-WS LESS ZERO                            00133730
133740              MOVE ZEROS TO CV-IOF-1DIA-D10                       00133740
133750           ELSE                                                   00133750
133760              MOVE ZEROS TO CV-IOF-1DIA-D10 SLD-DEV-NUM-WS.       00133760
133790                                                                  00133790
133800     MOVE ATL-ULT-MOV-RED-WS TO CV-ULT-MOV-D10.                   00133800
133810                                                                  00133810
133820     IF CV-QDE-DIA-D10 GREATER 15                                 00133820
133830         MOVE 1 TO CV-TR-CL-D10                                   00133830
133840     ELSE                                                         00133840
133850         MOVE ZERO TO CV-TR-CL-D10.                               00133850
133870                                                                  00133870
133880     PERFORM 999-15-ACUMULA-D10.                                  00133880
133890                                                                  00133890
133900     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00133900
133910                                                                  00133910
133920     WRITE REG-CTA-VENC-D10                                       00133920
133930       INVALID KEY                                                00133930
133940         PERFORM 999-20-ESTOUROU-AREA-D10.                        00133940
133950                                                                  00133950
133960*    *** N O T A ****                                             00133960
133970*    -O PROCEDIMENTO ABAIXO OBJETIVA EVITAR QUE SE EMITA          00133970
133980*    FICHA DE CAIXA PARA UMA CONTA QUE PERMANECA VENCIDA E        00133980
133990*    SEM MOVIMENTACAO POR MAIS DE UMA RODADA.                     00133990
134000*                                                                 00134000
134010     MOVE FICHA-DATA-RED-WS TO DATA-RED-WS.                       00134010
134020     MOVE DIA-WS TO DIA-INV.                                      00134020
134030     MOVE MES-WS TO MES-INV.                                      00134030
134040     CALL 'M0952000' USING ANO-WS ANO-INV.                        00134040
134050*                                                                 00134050
134060     MOVE EMP-VENC-RED-WS TO DATA-RED-WS.                         00134060
134070     MOVE DIA-WS TO DIA-AUX-Y2-INV.                               00134070
134080     MOVE MES-WS TO MES-AUX-Y2-INV.                               00134080
134090     CALL 'M0952000' USING ANO-WS ANO-AUX-Y2-INV.                 00134090
134100                                                                  00134100
134110     IF DATA-AUX-Y2-INV-RED  GREATER DATA-INVERTIDA-RED           00134110
134120         MOVE 1 TO SW-GERA-FICHA.                                 00134120
134160*                                                                 00134160
************************************************************************
DOCINI****F* P04808/575-35-OCR-EXCESSO
DOCTXT* OBJETIVO
DOCTXT*   Cria os registros de tipo EXCESSO-D10 (32) no arquivo de
DOCTXT*   ocorrencias.
DOCTXT*   Guarda as seguintes variaveis para posterior processamento:
DOCTXT*   EXC-ULT-RED-WS
DOCTXT*   EXC-VEZ-RED-WS
DOCTXT*   Calcula a quantidade de dias em excesso para gerar o registro
DOCTXT*   de ocorrencia.
DOCEND******
134170 575-35-OCR-EXCESSO.                                              00134170
134180*                                                                 00134180
134190     MOVE 32           TO CH-TPREG-D10.                           00134190
134200     MOVE CH-AG-WS     TO CH-CODAG-D10.                           00134200
134210     MOVE CH-CONTA-WS  TO    CONTA-D10.                           00134210
134220     MOVE CH-DIGITO-WS TO DV-CONTA-D10.                           00134220
134230     MOVE 1            TO EXC-TPREG-D10.                          00134230
134240     MOVE NOME-CLIENTE-RED-WS TO EXC-NOME-CLIENTE-D10.            00134240

           MOVE GRUPO-TARIFA-RED-WS TO EXC-GRTAR-D10

134250     IF ID-CPF-CGC-RED-WS EQUAL 1 OR 2                            00134250
134260        MOVE ID-CPF-CGC-RED-WS TO EXC-ID-CPF-CGC-D10              00134260
134270        MOVE CPF-CGC-RED-WS    TO EXC-CPF-CGC-D10                 00134270
134280     ELSE                                                         00134280
134290        MOVE ZEROS             TO EXC-ID-CPF-CGC-D10              00134290
134300        MOVE ZEROS             TO EXC-CPF-CGC-D10.                00134300
134310     MOVE COD-POSTO-RED-WS TO EXC-COD-POSTO-D10.                  00134310
134320     MOVE CLIENTE-PREFEREN-RED-WS TO EXC-CLI-ESPECIAL-D10.        00134320
134330     MOVE CALC-SMED-RED-WS        TO EXC-CALC-SMED-D10.           00134330
134340     MOVE EMP-SEGURO-RED-WS       TO EXC-EMP-SEG-D10.             00134340
134360     MOVE ENDERECO-WS TO EXC-ENDERECO-D10.                        00134360
134370     MOVE EXC-ULT-RED-WS TO EXC-DATA-ANT-D10.                     00134370
134380     MOVE EXC-VEZ-RED-WS TO EXC-NVEZES-D10.                       00134380
134390     MOVE TP-PESSOA-RED-WS TO EXC-TPES-D10.                       00134390
134400     MOVE EXC-NOVO-RED-WS TO EXC-DATA-INIC-D10 DATA-MENOR-RED.    00134400
134410     MOVE DATA-D07-RED-WS TO DATA-MAIOR-RED.                      00134410
134420                                                                  00134420
134430     IF  COD-GARANTIA-RED-WS = 'GA' OR 'GB' OR 'GC' OR 'GD' OR    00134430
134440                               'GE' OR 'GF'                       00134440
134450         MOVE COD-GARANTIA-RED-WS TO EXC-GARANTIA-D10             00134450
134460     ELSE                                                         00134460
134470         MOVE SPACES              TO EXC-GARANTIA-D10.            00134470
134480                                                                  00134480
134490     PERFORM 800-05-CALCULA-NUM-DIAS.                             00134490
134500                                                                  00134500
134510     MOVE DIAS-TRANSF-WS TO EXC-NDIA-D10.                         00134510
134530                                                                  00134530
134540     COMPUTE EXC-SLD-ANT-D10 = SLD-DEP-ANT-WS +                   00134540
134550                               SLD-EMP-ANT-WS.                    00134550
134560     IF SLD-EMP-RED-WS LESS ZERO                                  00134560
134570         MOVE SLD-EMP-RED-WS TO EXC-SLD-EMP-D10                   00134570
134580     ELSE                                                         00134580
134590         MOVE SLD-DEP-RED-WS TO EXC-SLD-EMP-D10.                  00134590
134600                                                                  00134600
134610     COMPUTE EXC-SLD-BLO-D10 =                                    00134610
134620                 (SLD-BLO-RED-WS (1) + SLD-BLO-RED-WS (2) +       00134620
134630                  SLD-BLO-RED-WS (3) + SLD-BLO-RED-WS (4) +       00134630
134640                  SLD-BLO-RED-WS (5) + SLD-BLO-RED-WS (6) +       00134640
134650                  SLD-BLO-RED-WS (7) + SLD-BLO-RED-WS (8) +       00134650
134660                  SLD-BLO-RED-WS (9) + SLD-BLO-RED-WS (10) +      00134660
134670                  SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +     00134670
134680                  SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +     00134680
134690                  SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +     00134690
134700                  SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +     00134700
134710                  SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +     00134710
134720                  SLD-BLO-RED-WS (21)).                           00134720
134730     MOVE EXC-SLD-BLO-D10 TO SLD-BLO-WS.                          00134730
134740     MOVE SLD-BLO-RED-WS (1) TO EXC-SLD-BLO-24HS-D10.             00134740
134750                                                                  00134750
134760     MOVE EMP-LIM-RED-WS TO EXC-EMP-LIM-D10.                      00134760
134770     MOVE EMP-VENC-RED-WS TO EXC-VENCTO-EMP-D10.                  00134770
134780     MOVE EMP-TAXA-JUR-RED-WS TO EXC-TAXA-D10.                    00134780
134790     MOVE EXCESSO-F10-WS TO EXC-VALOR-D10                         00134790
134800                                                                  00134800
134810     IF INS-VR-ABSOLUTO GREATER SLD-BLO-WS                        00134810
134820         MOVE 2 TO SW-INSUF-EXCESSO-REAL                          00134820
134830     ELSE                                                         00134830
134840         MOVE ZERO TO SW-INSUF-EXCESSO-REAL.                      00134840
134850                                                                  00134850
134860     COMPUTE EXC-NUM-SMEDIO-MES-D10 = (SMED-ATL1-RED-WS +         00134860
134870             SMED-ATL2-RED-WS + SMED-ATL3-RED-WS) / 3.            00134870
134880                                                                  00134880
134890     MOVE CRED-ANTECIP-WS      TO EXC-CRED-ANTECIP-D10.           00134890
134900     PERFORM 999-15-ACUMULA-D10.                                  00134900
134910                                                                  00134910
134920     IF TEM-HIST-71-373                                           00134920
134930        IF QDE-INS-EXC-MES-RED-WS NOT = ZEROS                     00134930
134940           COMPUTE QDE-INS-EXC-MES-RED-WS =                       00134940
134950                            QDE-INS-EXC-MES-RED-WS - 1.           00134950
134960     IF IMPESSOAL                                                 00134960
134970        MOVE ZEROS TO QDE-INS-EXC-MES-RED-WS                      00134970
134980                      EXC-QDE-OCORR-D10                           00134980
134990                      EXC-CTRL-FIM-D10                            00134990
135000     ELSE                                                         00135000
135010        MOVE QDE-INS-EXC-MES-RED-WS TO EXC-QDE-OCORR-D10          00135010
135020        IF EXCESSO-EXTINTO                                        00135020
135030           MOVE 1 TO EXC-CTRL-FIM-D10                             00135030
135040           MOVE ZEROS TO QDE-INS-EXC-MES-RED-WS                   00135040
135050        ELSE                                                      00135050
135060           MOVE 0 TO EXC-CTRL-FIM-D10.                            00135060

135070     MOVE EXC-VEZ-CONTRATO-RED-WS TO EXC-VEZ-CONTRATO-D10.        00135070
135080     MOVE EMP-DATA-RED-WS TO EXC-EMP-DATA-D10.                    00135080
135090     MOVE SPACES        TO EXC-RESTO-D10.                         00135090
135100     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00135100
135110                                                                  00135110
135120     WRITE REG-EXCESSO-D10                                        00135120
135130       INVALID KEY                                                00135130
135140         PERFORM 999-20-ESTOUROU-AREA-D10.                        00135140
135150                                                                  00135150
135160     MOVE 0 TO SW-EXCESSO-EXTINTO.                                00135160
135170     MOVE SPACES TO REG-EXCESSO-MOVTOS-D10.                       00135170
           INITIALIZE REG-EXCESSO-MOVTOS-D10
135180     IF  IND-MOVTOS NOT EQUAL ZEROS                               00135180
135190         MOVE ZEROS TO IND-AUX                                    00135190
135200         PERFORM 575A-35-GRAVA-MOVTOS-EXCESSO IND-MOVTOS TIMES.   00135200
135210                                                                  00135210
135220     IF INSUF-EXCESSO-REAL                                        00135220
135230         IF INSUF-EXCESSO-RED-WS = 1                              00135230
135240             MOVE 8 TO EXT-COD-MENS-D10                           00135240
135250         ELSE                                                     00135250
135260             MOVE 1 TO INSUF-EXCESSO-RED-WS                       00135260
135270             MOVE 9 TO EXT-COD-MENS-D10                           00135270
135280     ELSE                                                         00135280
135290         MOVE 1  TO INSUF-EXCESSO-RED-WS                          00135290
135300         MOVE 10 TO EXT-COD-MENS-D10.                             00135300
135330                                                                  00135330
135340 575A-35-GRAVA-MOVTOS-EXCESSO.                                    00135340
135350                                                                  00135350
135170      MOVE SPACES TO REG-EXCESSO-MOVTOS-D10.                      00135170
            INITIALIZE REG-EXCESSO-MOVTOS-D10
135360      ADD 1 TO IND-AUX.                                           00135360
135370      MOVE 32           TO CH-TPREG-D10.                          00135370
135380      MOVE CH-AG-WS     TO CH-CODAG-D10.                          00135380
135390      MOVE CH-CONTA-WS  TO CONTA-D10                              00135390
135400      MOVE CH-DIGITO-WS TO DV-CONTA-D10.                          00135400
135410      MOVE 2            TO EXC-TPREG-D10.                         00135410
135420      MOVE MOV-LOTE-TAB (IND-AUX) TO EXC-MOV-LOTE-D10.            00135420
135430      MOVE MOV-HIST-TAB (IND-AUX) TO EXC-MOV-HIST-D10.            00135430
135440      MOVE MOV-REF-TAB  (IND-AUX) TO EXC-MOV-REF-D10.             00135440
135450      MOVE MOV-VR-TAB   (IND-AUX) TO EXC-MOV-VR-D10.              00135450
135460      PERFORM 999-15-ACUMULA-D10.                                 00135460
135470      MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                       00135470
135480      WRITE REG-EXCESSO-MOVTOS-D10                                00135480
135490      INVALID KEY                                                 00135490
135500        PERFORM 999-20-ESTOUROU-AREA-D10.                         00135500
135520*                                                                 00135520
135530 580-35-OCR-JUROS-IOF.                                            00135530
135540*                                                                 00135540
135550     IF FUNC                                                      00135550
135560        COMPUTE NUM-TOTAL-FUNC-WS =                               00135560
135570                EMP-NUM-RED-WS + EMP-NUM-EXCED-FUNC-RED-WS        00135570
135580        MOVE NUM-TOTAL-FUNC-WS   TO JUR-NUM-D10                   00135580
135590     ELSE                                                         00135590
135600        MOVE EMP-NUM-RED-WS      TO JUR-NUM-D10.                  00135600

135610     MOVE EMP-TAXA-JUR-RED-WS    TO JUR-TAXA-D10                  00135610
135620     MOVE SPACES                 TO JUR-CANC-D10                  00135620
135650     MOVE TR-VALOR-D07           TO JUR-COB-D10                   00135650
135660                                                                  00135660
135670*    IF CH-HIST-D07 = 37 OR 38                                    00135670
135680*        MOVE ZEROS TO JUR-DEV-D10 JUR-DIF-D10                    00135680
135690*    ELSE                                                         00135690
135700*        COMPUTE JUR-DIF-D10 = (JUR-DEV-D10 + JUR-COB-D10).       00135700

           COMPUTE JUR-DIF-D10 = (JUR-DEV-D10 + JUR-COB-D10)

135720     MOVE 34                      TO CH-TPREG-D10                 00135720
135730     MOVE CH-AG-WS                TO CH-CODAG-D10                 00135730
135740     MOVE CH-CONTA-WS             TO CONTA-D10                    00135740
135750     MOVE CH-DIGITO-WS            TO DV-CONTA-D10                 00135750
135760     MOVE NOME-RED-WS             TO JUR-NOME-D10                 00135760
135770     MOVE COD-POSTO-RED-WS        TO JUR-COD-POSTO-D10            00135770
135780     MOVE CLIENTE-PREFEREN-RED-WS TO JUR-CLI-ESPECIAL-D10         00135780
135790     MOVE EMP-SEGURO-RED-WS       TO JUR-SEG-D10                  00135790
135800                                                                  00135800
135810     IF SLD-EMP-RED-WS LESS ZERO                                  00135810
135820         MOVE SLD-EMP-RED-WS TO JUR-SLD-ATL-D10                   00135820
135830         MOVE 'E' TO JUR-TPSLD-D10                                00135830
135840     ELSE                                                         00135840
135850         MOVE SLD-DEP-RED-WS TO JUR-SLD-ATL-D10                   00135850
135860         MOVE 'D' TO JUR-TPSLD-D10.                               00135860
135870                                                                  00135870
135880     PERFORM 999-15-ACUMULA-D10.                                  00135880
135890                                                                  00135890
135900     IF CH-HIST-D07 = 40                                          00135900
135910         MOVE 1 TO CH-SEQUENC-WS                                  00135910
135920     ELSE                                                         00135920
135930         IF CH-HIST-D07 = 39                                      00135930
135940             MOVE 2 TO CH-SEQUENC-WS                              00135940
135950         ELSE                                                     00135950
135960             IF CH-HIST-D07 = 38                                  00135960
135970                 MOVE 3 TO CH-SEQUENC-WS                          00135970
135980             ELSE                                                 00135980
135990                 IF CH-HIST-D07 = 37                              00135990
136000                     MOVE 4 TO CH-SEQUENC-WS.                     00136000
136010                                                                  00136010
136020     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00136020
136030                                                                  00136030
136040     WRITE REG-JUROS-IOF-D10                                      00136040
136050      INVALID KEY                                                 00136050
136060         PERFORM 999-20-ESTOUROU-AREA-D10.                        00136060
136070*                                                                 00136070
136080 585-35-OCR-TRANSF-PARA-EMPREST.                                  00136080
136090*                                                                 00136090
136100     MOVE 36 TO CH-TPREG-D10.                                     00136100
136110     MOVE CH-AG-WS TO CH-CODAG-D10.                               00136110
136120     MOVE CH-CONTA-WS    TO CONTA-D10.                            00136120
136130     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00136130
136140     MOVE NOME-RED-WS TO TPE-NOME-D10.                            00136140
136150     MOVE DI-MOV-VR-WS TO TPE-VALOR-D10.                          00136150
136160     MOVE COD-POSTO-RED-WS TO TPE-COD-POSTO-D10.                  00136160
136170     MOVE CLIENTE-PREFEREN-RED-WS TO TPE-CLI-ESPECIAL-D10.        00136170
136180                                                                  00136180
136190     PERFORM 999-15-ACUMULA-D10.                                  00136190
136200                                                                  00136200
136210     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00136210
136220                                                                  00136220
136230     WRITE REG-TR-P-EMP-D10                                       00136230
136240      INVALID KEY                                                 00136240
136250         PERFORM 999-20-ESTOUROU-AREA-D10.                        00136250
136260                                                                  00136260
136280 590-35-OCR-TRANSF-DE-EMPREST.                                    00136280
136290*                                                                 00136290
136300     MOVE 38 TO CH-TPREG-D10.                                     00136300
136310     MOVE CH-AG-WS TO CH-CODAG-D10.                               00136310
136320     MOVE CH-CONTA-WS    TO CONTA-D10.                            00136320
136330     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00136330
136340     MOVE NOME-RED-WS TO TDE-NOME-D10.                            00136340
136350     MOVE SLD-EMP-RED-WS TO TDE-VALOR-D10.                        00136350
136360     MOVE COD-POSTO-RED-WS TO TDE-COD-POSTO-D10.                  00136360
136370     MOVE CLIENTE-PREFEREN-RED-WS TO TDE-CLI-ESPECIAL-D10.        00136370
136380                                                                  00136380
136390     PERFORM 999-15-ACUMULA-D10.                                  00136390
136400                                                                  00136400
136410     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00136410
136420                                                                  00136420
136430     WRITE REG-TR-DE-EMP-D10                                      00136430
136440      INVALID KEY                                                 00136440
136450         PERFORM 999-20-ESTOUROU-AREA-D10.                        00136450
136460                                                                  00136460
136480 595-35-TRANSF-PARA-CHE-IND.                                      00136480
136490*                                                                 00136490
136500     MOVE 37 TO CH-TPREG-D10.                                     00136500
136510     MOVE CH-AG-WS TO CH-CODAG-D10.                               00136510
136520     MOVE CH-CONTA-WS    TO CONTA-D10.                            00136520
136530     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00136530
136540     MOVE NOME-RED-WS TO CPI-NOME-D10.                            00136540
136550     MOVE DI-MOV-VR-WS TO CPI-VALOR-D10.                          00136550
136560     MOVE COD-POSTO-RED-WS TO CPI-COD-POSTO-D10.                  00136560
136570     MOVE CLIENTE-PREFEREN-RED-WS TO CPI-CLI-ESPECIAL-D10.        00136570
136580                                                                  00136580
136590     PERFORM 999-15-ACUMULA-D10.                                  00136590
136600                                                                  00136600
136610     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00136610
136620                                                                  00136620
136630     WRITE TR-P-CHE-IND-D10                                       00136630
136640      INVALID KEY                                                 00136640
136650         PERFORM 999-20-ESTOUROU-AREA-D10.                        00136650
136660*                                                                 00136660
136670 595A-35-TRANSF-PARA-CHE-COM.                                     00136670
136680*                                                                 00136680
136690     MOVE 40 TO CH-TPREG-D10.                                     00136690
136700     MOVE CH-AG-WS TO CH-CODAG-D10.                               00136700
136710     MOVE CH-CONTA-WS    TO CONTA-D10.                            00136710
136720     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00136720
136730     MOVE NOME-RED-WS TO CPC-NOME-D10.                            00136730
136740     MOVE DI-MOV-VR-WS TO CPC-VALOR-D10.                          00136740
136750     MOVE COD-POSTO-RED-WS TO CPC-COD-POSTO-D10.                  00136750
136760     MOVE CLIENTE-PREFEREN-RED-WS TO CPC-CLI-ESPECIAL-D10.        00136760
136770                                                                  00136770
136780     PERFORM 999-15-ACUMULA-D10.                                  00136780
136790                                                                  00136790
136800     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00136800
136810                                                                  00136810
136820     WRITE TR-P-CHE-COM-D10                                       00136820
136830      INVALID KEY                                                 00136830
136840         PERFORM 999-20-ESTOUROU-AREA-D10.                        00136840
136850*                                                                 00136850
136860 595B-35-TRANSF-PARA-CHE-OUT.                                     00136860
136870*                                                                 00136870
136880     MOVE 42 TO CH-TPREG-D10.                                     00136880
136890     MOVE CH-AG-WS TO CH-CODAG-D10.                               00136890
136900     MOVE CH-CONTA-WS    TO CONTA-D10.                            00136900
136910     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00136910
136920     MOVE NOME-RED-WS TO CPO-NOME-D10.                            00136920
136930     MOVE DI-MOV-VR-WS TO CPO-VALOR-D10.                          00136930
136940     MOVE COD-POSTO-RED-WS TO CPO-COD-POSTO-D10.                  00136940
136950     MOVE CLIENTE-PREFEREN-RED-WS TO CPO-CLI-ESPECIAL-D10.        00136950
136960                                                                  00136960
136970     PERFORM 999-15-ACUMULA-D10.                                  00136970
136980                                                                  00136980
136990     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00136990
137000                                                                  00137000
137010     WRITE TR-P-CHE-OUT-D10                                       00137010
137020      INVALID KEY                                                 00137020
137030         PERFORM 999-20-ESTOUROU-AREA-D10.                        00137030
137040*                                                                 00137040
137050 596-35-TRANSF-DE-CHE-IND.                                        00137050
137060*                                                                 00137060
137070     MOVE 39 TO CH-TPREG-D10.                                     00137070
137080     MOVE CH-AG-WS TO CH-CODAG-D10.                               00137080
137090     MOVE CH-CONTA-WS    TO CONTA-D10.                            00137090
137100     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00137100
137110     MOVE NOME-RED-WS TO CDI-NOME-D10.                            00137110
137120     MOVE COD-POSTO-RED-WS TO CDI-COD-POSTO-D10.                  00137120
137130     MOVE CLIENTE-PREFEREN-RED-WS TO CDI-CLI-ESPECIAL-D10.        00137130
137140     MOVE SLD-EMP-RED-WS TO CDI-VALOR-D10.                        00137140
137150                                                                  00137150
137160     PERFORM 999-15-ACUMULA-D10.                                  00137160
137170                                                                  00137170
137180     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00137180
137190                                                                  00137190
137200     WRITE TR-D-CHE-IND-D10                                       00137200
137210        INVALID KEY                                               00137210
137220         PERFORM 999-20-ESTOUROU-AREA-D10.                        00137220
137230*                                                                 00137230
137240 596A-35-TRANSF-DE-CHE-COM.                                       00137240
137250*                                                                 00137250
137260     MOVE 41 TO CH-TPREG-D10.                                     00137260
137270     MOVE CH-AG-WS TO CH-CODAG-D10.                               00137270
137280     MOVE CH-CONTA-WS    TO CONTA-D10.                            00137280
137290     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00137290
137300     MOVE NOME-RED-WS TO CDC-NOME-D10.                            00137300
137310     MOVE COD-POSTO-RED-WS TO CDC-COD-POSTO-D10.                  00137310
137320     MOVE CLIENTE-PREFEREN-RED-WS TO CDC-CLI-ESPECIAL-D10.        00137320
137330     MOVE SLD-EMP-RED-WS TO CDC-VALOR-D10.                        00137330
137340                                                                  00137340
137350     PERFORM 999-15-ACUMULA-D10.                                  00137350
137360                                                                  00137360
137370     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00137370
137380                                                                  00137380
137390     WRITE TR-D-CHE-COM-D10                                       00137390
137400        INVALID KEY                                               00137400
137410         PERFORM 999-20-ESTOUROU-AREA-D10.                        00137410
137420*                                                                 00137420
137430 596B-35-TRANSF-DE-CHE-OUT.                                       00137430
137440*                                                                 00137440
137450     MOVE 43 TO CH-TPREG-D10.                                     00137450
137460     MOVE CH-AG-WS TO CH-CODAG-D10.                               00137460
137470     MOVE CH-CONTA-WS    TO CONTA-D10.                            00137470
137480     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00137480
137490     MOVE NOME-RED-WS TO CDO-NOME-D10.                            00137490
137500     MOVE COD-POSTO-RED-WS TO CDO-COD-POSTO-D10.                  00137500
137510     MOVE CLIENTE-PREFEREN-RED-WS TO CDO-CLI-ESPECIAL-D10.        00137510
137520     MOVE SLD-EMP-RED-WS TO CDO-VALOR-D10.                        00137520
137530                                                                  00137530
137540     PERFORM 999-15-ACUMULA-D10.                                  00137540
137550                                                                  00137550
137560     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00137560
137570                                                                  00137570
137580     WRITE TR-D-CHE-OUT-D10                                       00137580
137590        INVALID KEY                                               00137590
137600         PERFORM 999-20-ESTOUROU-AREA-D10.                        00137600
137610*                                                                 00137610
137620 597-35-TRANSF-PARA-CTA-EMP-IND.                                  00137620
137630*                                                                 00137630
137640     MOVE 44 TO CH-TPREG-D10.                                     00137640
137650     MOVE CH-AG-WS TO CH-CODAG-D10.                               00137650
137660     MOVE CH-CONTA-WS    TO CONTA-D10.                            00137660
137670     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00137670
137680     MOVE NOME-RED-WS TO TPI-NOME-D10.                            00137680
137690     MOVE DI-MOV-VR-WS TO TPI-VALOR-D10.                          00137690
137700     MOVE COD-POSTO-RED-WS TO TPI-COD-POSTO-D10.                  00137700
137710     MOVE CLIENTE-PREFEREN-RED-WS TO TPI-CLI-ESPECIAL-D10.        00137710
137720                                                                  00137720
137730     PERFORM 999-15-ACUMULA-D10.                                  00137730
137740                                                                  00137740
137750     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00137750
137760                                                                  00137760
137770     WRITE TR-P-CTA-E-IND-D10                                     00137770
137780       INVALID KEY                                                00137780
137790         PERFORM 999-20-ESTOUROU-AREA-D10.                        00137790
137800*                                                                 00137800
137810 591-35-TRANSF-PARA-CTA-EMP-COM.                                  00137810
137820*                                                                 00137820
137830     MOVE 46 TO CH-TPREG-D10.                                     00137830
137840     MOVE CH-AG-WS TO CH-CODAG-D10.                               00137840
137850     MOVE CH-CONTA-WS    TO CONTA-D10.                            00137850
137860     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00137860
137870     MOVE NOME-RED-WS TO TPC-NOME-D10.                            00137870
137880     MOVE DI-MOV-VR-WS TO TPC-VALOR-D10.                          00137880
137890     MOVE COD-POSTO-RED-WS TO TPC-COD-POSTO-D10.                  00137890
137900     MOVE CLIENTE-PREFEREN-RED-WS TO TPC-CLI-ESPECIAL-D10.        00137900
137910                                                                  00137910
137920     PERFORM 999-15-ACUMULA-D10.                                  00137920
137930                                                                  00137930
137940     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00137940
137950                                                                  00137950
137960     WRITE TR-P-CTA-E-COM-D10                                     00137960
137970       INVALID KEY                                                00137970
137980         PERFORM 999-20-ESTOUROU-AREA-D10.                        00137980
137990*                                                                 00137990
138000 593-35-TRANSF-PARA-CTA-EMP-OUT.                                  00138000
138010*                                                                 00138010
138020     MOVE 48 TO CH-TPREG-D10.                                     00138020
138030     MOVE CH-AG-WS TO CH-CODAG-D10.                               00138030
138040     MOVE CH-CONTA-WS    TO CONTA-D10.                            00138040
138050     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00138050
138060     MOVE NOME-RED-WS TO TPO-NOME-D10.                            00138060
138070     MOVE DI-MOV-VR-WS TO TPO-VALOR-D10.                          00138070
138080     MOVE COD-POSTO-RED-WS TO TPO-COD-POSTO-D10.                  00138080
138090     MOVE CLIENTE-PREFEREN-RED-WS TO TPO-CLI-ESPECIAL-D10.        00138090
138100                                                                  00138100
138110     PERFORM 999-15-ACUMULA-D10.                                  00138110
138120                                                                  00138120
138130     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00138130
138140                                                                  00138140
138150     WRITE TR-P-CTA-E-OUT-D10                                     00138150
138160       INVALID KEY                                                00138160
138170         PERFORM 999-20-ESTOUROU-AREA-D10.                        00138170
138180*                                                                 00138180
138190 598-35-TRANSF-DE-CTA-EMP-IND.                                    00138190
138200*                                                                 00138200
138210     MOVE 45 TO CH-TPREG-D10.                                     00138210
138220     MOVE CH-AG-WS TO CH-CODAG-D10.                               00138220
138230     MOVE CH-CONTA-WS    TO CONTA-D10.                            00138230
138240     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00138240
138250     MOVE NOME-RED-WS TO TDI-NOME-D10.                            00138250
138260     MOVE SLD-EMP-RED-WS TO TDI-VALOR-D10.                        00138260
138270     MOVE COD-POSTO-RED-WS TO TDI-COD-POSTO-D10.                  00138270
138280     MOVE CLIENTE-PREFEREN-RED-WS TO TDI-CLI-ESPECIAL-D10.        00138280
138290                                                                  00138290
138300     PERFORM 999-15-ACUMULA-D10.                                  00138300
138310                                                                  00138310
138320     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00138320
138330                                                                  00138330
138340     WRITE TR-D-CTA-E-IND-D10                                     00138340
138350      INVALID KEY                                                 00138350
138360         PERFORM 999-20-ESTOUROU-AREA-D10.                        00138360
138370*                                                                 00138370
138380 592-35-TRANSF-DE-CTA-EMP-COM.                                    00138380
138390*                                                                 00138390
138400     MOVE 47 TO CH-TPREG-D10.                                     00138400
138410     MOVE CH-AG-WS TO CH-CODAG-D10.                               00138410
138420     MOVE CH-CONTA-WS    TO CONTA-D10.                            00138420
138430     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00138430
138440     MOVE NOME-RED-WS TO TDC-NOME-D10.                            00138440
138450     MOVE SLD-EMP-RED-WS TO TDC-VALOR-D10.                        00138450
138460     MOVE COD-POSTO-RED-WS TO TDC-COD-POSTO-D10.                  00138460
138470     MOVE CLIENTE-PREFEREN-RED-WS TO TDC-CLI-ESPECIAL-D10.        00138470
138480                                                                  00138480
138490     PERFORM 999-15-ACUMULA-D10.                                  00138490
138500                                                                  00138500
138510     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00138510
138520                                                                  00138520
138530     WRITE TR-D-CTA-E-COM-D10                                     00138530
138540      INVALID KEY                                                 00138540
138550         PERFORM 999-20-ESTOUROU-AREA-D10.                        00138550
138560*                                                                 00138560
138570 594-35-TRANSF-DE-CTA-EMP-OUT.                                    00138570
138580*                                                                 00138580
138590     MOVE 49 TO CH-TPREG-D10.                                     00138590
138600     MOVE CH-AG-WS TO CH-CODAG-D10.                               00138600
138610     MOVE CH-CONTA-WS    TO CONTA-D10.                            00138610
138620     MOVE CH-DIGITO-WS   TO DV-CONTA-D10.                         00138620
138630     MOVE NOME-RED-WS TO TDO-NOME-D10.                            00138630
138640     MOVE SLD-EMP-RED-WS TO TDO-VALOR-D10.                        00138640
138650     MOVE COD-POSTO-RED-WS TO TDO-COD-POSTO-D10.                  00138650
138660     MOVE CLIENTE-PREFEREN-RED-WS TO TDO-CLI-ESPECIAL-D10.        00138660
138670                                                                  00138670
138680     PERFORM 999-15-ACUMULA-D10.                                  00138680
138690                                                                  00138690
138700     MOVE CH-SEQUENC-WS TO CH-SEQUENC-D10.                        00138700
138710                                                                  00138710
138720     WRITE TR-D-CTA-E-OUT-D10                                     00138720
138730      INVALID KEY                                                 00138730
138740         PERFORM 999-20-ESTOUROU-AREA-D10.                        00138740
138770*                                                                 00138770
138980 605-35-OCR-RAZAO.                                                00138980
138990*                                                                 00138990
           MOVE SPACES TO REG-RAZAO-D10.

139000     ADD 1 TO IND-RAZAO.                                          00139000
139010                                                                  00139010
139020     MOVE 52 TO CH-TPREG-D10.                                     00139020
139030     MOVE CH-AG-WS TO CH-CODAG-D10.                               00139030
139040     MOVE COD-POSTO-RED-WS TO RZ-COD-POSTO-D10.                   00139040
139050     MOVE CLIENTE-PREFEREN-RED-WS TO RZ-CLI-ESPECIAL-D10.         00139050
139060     MOVE ZEROS TO CONTA-D10 DV-CONTA-D10.                        00139060
139070     MOVE IND-RAZAO TO RZ-TPCONTAB-D10 CH-SEQUENC-D10.            00139070
139080     IF ACUM-QDE-ANT-TAB (IND-RAZAO) GREATER ZERO OR              00139080
139090        ACUM-SLD-ANT-TAB (IND-RAZAO) GREATER ZERO OR              00139090
139100        ACUM-QDE-CRED-TAB (IND-RAZAO) GREATER ZERO OR             00139100
139110        ACUM-VR-CRED-TAB (IND-RAZAO) GREATER ZERO OR              00139110
139120        ACUM-QDE-DEB-TAB (IND-RAZAO) GREATER  ZERO OR             00139120
139130        ACUM-VR-DEB-TAB (IND-RAZAO) GREATER ZERO OR               00139130
139140        ACUM-QDE-ATL-TAB (IND-RAZAO) GREATER ZERO OR              00139140
139150        ACUM-SLD-ATL-TAB (IND-RAZAO) GREATER ZERO                 00139150
139160        PERFORM 602-35-GRAVA-OCR-RAZAO.                           00139160
139170*                                                                 00139170
139180 602-35-GRAVA-OCR-RAZAO.                                          00139180
139190*                                                                 00139190
           MOVE SPACES TO RZ-NOME-CONTAB-D10
139200                                                                  00139200
139210     MOVE ACUM-QDE-ANT-TAB (IND-RAZAO) TO RZ-TOTCTAS-ANT-D10.     00139210
139220     MOVE ACUM-SLD-ANT-TAB (IND-RAZAO) TO RZ-TOTSLDS-ANT-D10.     00139220
139230     MOVE ACUM-QDE-CRED-TAB (IND-RAZAO) TO RZ-C-QDE-D10.          00139230
139240     MOVE ACUM-VR-CRED-TAB (IND-RAZAO) TO RZ-C-VR-D10.            00139240
139250     MOVE ACUM-QDE-DEB-TAB (IND-RAZAO) TO RZ-D-QDE-D10.           00139250
139260     MOVE ACUM-VR-DEB-TAB (IND-RAZAO)  TO RZ-D-VR-D10.            00139260
139270     MOVE ACUM-QDE-ATL-TAB (IND-RAZAO) TO RZ-TOTCTAS-ATL-D10.     00139270
139280     MOVE ACUM-SLD-ATL-TAB (IND-RAZAO) TO RZ-TOTSLDS-ATL-D10.     00139280
139290                                                                  00139290
139300     COMPUTE RZ-DIF-CTAS-D10 = RZ-TOTCTAS-ATL-D10 -               00139300
139310                                       RZ-TOTCTAS-ANT-D10.        00139310
139320     COMPUTE RZ-DIF-SLDS-D10 = RZ-TOTSLDS-ATL-D10 -               00139320
139330                                       RZ-TOTSLDS-ANT-D10.        00139330
139340                                                                  00139340
139350     PERFORM 999-15-ACUMULA-D10.                                  00139350
139360                                                                  00139360
139370     WRITE REG-RAZAO-D10                                          00139370
139380           INVALID KEY                                            00139380
139390         PERFORM 999-20-ESTOUROU-AREA-D10.                        00139390
139430*                                                                 00139430
139440 610-35-OCR-FICHA-RECOLHER.                                       00139440
139450*                                                                 00139450
139460     IF IND-FICHA-RECOLHER = 10                                   00139460
               MOVE SPACES TO REG-FH-RECOL-D10
               INITIALIZE REG-FH-RECOL-D10
139470         MOVE 54 TO CH-TPREG-D10                                  00139470
139480         MOVE FH-RECOLHER-D10-WS TO ESSENCIA-FH-RECOL-D10         00139480
139490         ADD 1 TO SEQ-FH-RECOL-WS                                 00139490
139500         MOVE SEQ-FH-RECOL-WS TO CH-SEQUENC-D10                   00139500
139510         PERFORM 999-15-ACUMULA-D10                               00139510
139520         PERFORM 615-35-GRAVA-OCR-FICHA-RECOL                     00139520
139530         PERFORM 999-25-ZERA-FH-RECOLHER-WS 10 TIMES              00139530
139540         MOVE ZERO TO IND-FICHA-RECOLHER.                         00139540
139550                                                                  00139550
139560     IF CHAVE-MENOR NOT = HIGH-VALUE                              00139560
139570       IF NOT TRAIL-AG-WS                                         00139570
139580         ADD 1 TO IND-FICHA-RECOLHER                              00139580
139590         MOVE IND-FICHA-RECOLHER TO FR-QDE-FICHA-D10-WS           00139590
139600         MOVE CH-CONTA-WS TO FR-CONTA-D10-WS (FR-QDE-FICHA-D10-WS)00139600
139610         MOVE CH-DIGITO-WS TO FR-DV-CONTA-D10-WS                  00139610
139620                                             (FR-QDE-FICHA-D10-WS)00139620
139630         IF EXCLUI-CONTA                                          00139630
139640             MOVE 'E' TO FR-EXCL-D10-WS (FR-QDE-FICHA-D10-WS)     00139640
139650         ELSE                                                     00139650
139660             MOVE SPACE TO FR-EXCL-D10-WS (FR-QDE-FICHA-D10-WS).  00139660
139670*                                                                 00139670
139680 615-35-GRAVA-OCR-FICHA-RECOL.                                    00139680
139690*                                                                 00139690
139700     IF CHAVE-MENOR = HIGH-VALUE                                  00139700
139710         MOVE AGENCIA-F10-WS TO CH-CODAG-D10                      00139710
139720     ELSE                                                         00139720
139730         MOVE CH-AG-WS TO CH-CODAG-D10.                           00139730
139740                                                                  00139740
139750     MOVE ZEROS TO    CONTA-D10 FR-QDE-FICHA-D10-WS               00139750
139760                   DV-CONTA-D10 IND-FICHA-RECOLHER.               00139760
139770     WRITE REG-FH-RECOL-D10                                       00139770
139780        INVALID KEY                                               00139780
139790         PERFORM 999-20-ESTOUROU-AREA-D10.                        00139790
139800*                                                                 00139800
139810 620-35-GRAVA-OCR-AC-NUMEROS.                                     00139810
139820*                                                                 00139820
139830     WRITE REG-AC-NUM-D10 INVALID KEY                             00139830
139850                          PERFORM 999-20-ESTOUROU-AREA-D10.       00139850
139860*                                                                 00139860
139870 625-35-GRAVA-OCR-PROTOCOLO.                                      00139870
139880*                                                                 00139880
139890     WRITE REG-PROTOC-D10                                         00139890
139900        INVALID KEY                                               00139900
139910         PERFORM 999-20-ESTOUROU-AREA-D10.                        00139910
139920                                                                  00139920
139930     MOVE ZEROS TO ACUM-REG-AG-ANT ACUM-REG-AG-ATL ACUM-CAD-CC    00139930
139940                                   ACUM-TRANSF-EMP ACUM-OUTROS.   00139940
139950*    .......................................                      00139950

139970*    ************************************                         00139970
139980*    * AS DUAS ROTINAS ABAIXO TEM   POR *                         00139980
139990*    * OBJETIVO CALCULAR O NUMERO    DE *                         00139990
140000*    * DIAS ENTRE DUAS DATAS E FORAM CO-*                         00140000
140010*    * PIADAS DO ACDAYS.                *                         00140010
140020*    ************************************                         00140020
140030*                                                                 00140030
140050 800-05-CALCULA-NUM-DIAS.                                         00140050
140060*                                                                 00140060
140070     IF (DATA-MENOR-RED NOT EQUAL DATA-MAIOR-RED) AND             00140070
140080        (DATA-MENOR-RED NOT = ZEROS) AND                          00140080
140090        (DATA-MAIOR-RED NOT = ZEROS)                              00140090
      *       Calcula a quantidade de dias corridos entre as dadas datas.
140100        MOVE '09' TO W091CL-TP-OPER                               00140100
140110        MOVE 001  TO W091CL-CD-AG-REQ                             00140110
140120        MOVE DIA-MENOR TO W091CL-DD-INFOR-1                       00140120
140130        MOVE MES-MENOR TO W091CL-MM-INFOR-1                       00140130
140140        CALL 'M0952000' USING ANO-MENOR W091CL-AA-INFOR-1         00140140
140150        MOVE DIA-MAIOR TO W091CL-DD-INFOR-2                       00140150
140160        MOVE MES-MAIOR TO W091CL-MM-INFOR-2                       00140160
140170        CALL 'M0952000' USING ANO-MAIOR W091CL-AA-INFOR-2         00140170
140180        MOVE 1 TO W091CL-ST-ARQ-RES                               00140180
140190        CALL 'P09102' USING W091CL-REGISTRO                       00140190
140200        PERFORM 999-95-TESTE-VALIDADE-RETORNO                     00140200
140210        IF  RETORNO-SUBROT-OK                                     00140210
140220            MOVE W091CL-QT-DD-UTIL TO DIAS-TRANSF-WS              00140220
140230        ELSE                                                      00140230
140240            PERFORM 999-99-ROT-ERRO                               00140240
140250     ELSE                                                         00140250
140260        MOVE ZEROS TO DIAS-TRANSF-WS.                             00140260
140270                                                                  00140270
140300 850-GRAVA-D04.                                                   00140300
140310     ADD 1 TO IND-GRAVA-D04.                                      00140310
140320     MOVE COD-AG-TAB (IND-GRAVA-D04)    TO COD-AG-D04.            00140320
140330     MOVE DT-POS-MST-ANT-TAB (IND-GRAVA-D04) TO                   00140330
140340                                 DT-POS-MST-ANT-D04.              00140340
140350     MOVE DT-COR-MST-ATL-TAB (IND-GRAVA-D04) TO                   00140350
140360                                 DT-COR-MST-ATL-D04.              00140360
140370     MOVE HR-COR-MST-ANT-TAB (IND-GRAVA-D04) TO                   00140370
140380                                 HR-COR-MST-ANT-D04.              00140380
140390     MOVE HR-COR-MST-ATL-TAB (IND-GRAVA-D04) TO                   00140390
140400                                 HR-COR-MST-ATL-D04.              00140400
140410     MOVE DT-POS-MST-ATL-TAB (IND-GRAVA-D04) TO                   00140410
140420                                        DT-POS-MST-ATL-D04.       00140420
140430     MOVE DT-COR-MST-ANT-TAB (IND-GRAVA-D04) TO                   00140430
140440                                        DT-COR-MST-ANT-D04.       00140440
140450     MOVE SEQ-MST-ATL-TAB (IND-GRAVA-D04) TO SEQ-MST-ATL-D04.     00140450
140460     MOVE SEQ-MST-ANT-TAB (IND-GRAVA-D04) TO SEQ-MST-ANT-D04.     00140460
140470     MOVE SPACES                       TO ESP-D04 COD-ERRO-D04.   00140470
140480     MOVE SALDO-MST-ATL-TAB (IND-GRAVA-D04) TO SALDO-MST-ATL-D04. 00140480
140490     MOVE SALDO-MST-ANT-TAB (IND-GRAVA-D04) TO SALDO-MST-ANT-D04. 00140490
140500     MOVE QDE-AGENCIA-ANT-TAB (IND-GRAVA-D04) TO                  00140500
140510                               QDE-AGENCIA-ANT-D04.               00140510
140520     MOVE QDE-AGENCIA-ATL-TAB (IND-GRAVA-D04) TO                  00140520
140530                               QDE-AGENCIA-ATL-D04.               00140530
140540     MOVE REG-EXTRATO-ANT-TAB (IND-GRAVA-D04) TO                  00140540
140550                               REG-EXTRATO-ANT-D04.               00140550
140560     MOVE REG-EXTRATO-ATL-TAB (IND-GRAVA-D04) TO                  00140560
140570                               REG-EXTRATO-ATL-D04.               00140570
140580     MOVE REG-CORRENTISTA-ANT-TAB (IND-GRAVA-D04) TO              00140580
140590                               REG-CORRENTISTA-ANT-D04.           00140590
140600     MOVE REG-CORRENTISTA-ATL-TAB (IND-GRAVA-D04) TO              00140600
140610                               REG-CORRENTISTA-ATL-D04.           00140610
140620     REWRITE REG-D04.                                             00140620
140630     IF  STATUS-D04-WS NOT EQUAL '00'                             00140630
140640         MOVE STATUS-D04-WS TO FILE-STATUS-WS                     00140640
140650         MOVE '***P04808 ERRO NA GRAVACAO DO ArqAgencias'         00140650
140660                              TO MENSAGEM-ERRO-WS                 00140660
140670         PERFORM 999-99-ROT-ERRO.                                 00140670
140680                                                                  00140680
140700*    ***********************************                          00140700
140710*    * AS DESCRICOES ABAIXO REFEREM-SE *                          00140710
140720*    * A ROTINAS INDEPENDENTES         *                          00140720
140730*    ***********************************                          00140730
140750*                                                                 00140750
140760 999-05-FIM-ANORMAL.                                              00140760
140770*                                                                 00140770
140780      DISPLAY '**P04808-CANCELADO.MST OU MVTO SEM REGISTROS**'.   00140780
140790      MOVE COD-RETORNO-WS (3) TO RETURN-CODE.                     00140790
140800      DISPLAY 'RETURN CODE EH..' COD-RETORNO-WS (3).              00140800
140810      DISPLAY 'MENSAGEM RETORNO EH ..' MEN-RETORNO-WS (3).        00140810
140820      GOBACK.                                                     00140820
140840*                                                                 00140840
140850 999-10-GRAVA-F10.                                                00140850
140860*                                                                 00140860
140870     IF REG-EXT-WS OR REG-COR-WS                                  00140870
140880        ADD 1 TO ACUM-REG-AG-ATL.                                 00140880
140890                                                                  00140890
140900     IF  REG-COR-WS AND REGULARIZOU-INSUF                         00140900
140910         MOVE ZEROS TO INSUF-EXCESSO-RED-WS                       00140910
140930                       INS-NJUR-DECOR-RED-WS                      00140930
140950                       INS-NIOF-DECOR-RED-WS.                     00140950
140960                                                                  00140960
140970     IF  REG-COR-WS                                               00140970
140980         ADD 1 TO SEQ-POS-REL-WS                                  00140980
140990         COMPUTE POS-RELATIVA-WS =                                00140990
141000                    (CH-CONTA-WS - SEQ-POS-REL-WS) + 1            00141000
141010         COMPUTE SALDO-DEP-WS =                                   00141010
141020                 SLD-DEP-RED-WS * POS-RELATIVA2-WS                00141020
141030         ADD SALDO-DEP-WS TO ACUM-SALDO-DEP-WS.                   00141030

141040     MOVE SEQ-D04-WS  TO CH-SEQ-WS.

141050     IF  HEAD-AG-WS
141060         MOVE REG-HEADER-AG-RED-WS TO REG-HEADER-AG-ARQ-UPDT
141070                                      REG-HEADER-AG-D11
141090         MOVE HAG-TX-IOF-FISICA-RED-WS TO TX-IOC-FISICA-WS
141100         MOVE HAG-TX-IOF-JURID-RED-WS TO TX-IOC-JURID-WS
/GCVN/         WRITE REG-HEADER-AG-ARQ-UPDT
141120         WRITE REG-HEADER-AG-D11
141130         ADD 1 TO CONT-QDE-AGENCIA
141140         MOVE 0                 TO TIPO-HEAD-02DD
141150         MOVE CH-AG-ARQ-UPDT     TO CODAG-HEAD-02DD
141160         MOVE HF-DATA-ATL-WS    TO DATA-TELEX-WS
141170         MOVE ANO-TELEX-WS      TO ANO-TELEX-INV-WS
141180         MOVE MES-TELEX-WS      TO MES-TELEX-INV-WS
141190         MOVE DIA-TELEX-WS      TO DIA-TELEX-INV-WS
141200         MOVE DATA-TELEX-INV-WS TO DTREF-HEAD-02DD
141210         PERFORM 999-34-GRAVA-DISCO-TELEX
141220     ELSE
141230     IF  REG-COR-WS
141240         PERFORM 999-26-VALOR-MEDIO-CONTRATO
141250         PERFORM 999-32-TESTA-ADIANTAMENTOS
141260         PERFORM 999-33-CRED-ANTECIP-TELEX
141270         PERFORM 999-33A-ENCARGOS-DIARIOS-TELEX
141280         PERFORM 999-33B-TESTE-VENCIMENTO-CONTR
141320         MOVE ZEROS TO EMP-NUM-EXCED-FUNC-RED-WS
               INITIALIZE REG-CORRENT-D11
141330         MOVE REG-CORRENT-RED-WS TO REG-CORRENT-ARQ-UPDT
141340                                    REG-CORRENT-D11
               IF TPCONTAB-RED-WS = 49
141350            MOVE CM-REINV-WS  TO CM-REINV-D11
               END-IF
100112         IF TPCONTAB-RED-WS = 30
                  MOVE CM-JUDIC-WS  TO CM-REINV-D11
               END-IF

BOSSA***--------------------------------------------------------------***BOSSA
BOSSA***            AGUARDANDO REUNIAO PARA DEFINICOES                ***BOSSA
BOSSA***--------------------------------------------------------------***BOSSA
100112         IF TPCONTAB-RED-WS = 31 OR 33
                  MOVE CRED-ANTECIP-WS TO CM-REINV-D11
100112         END-IF
BOSSA***--------------------------------------------------------------***BOSSA

141360         MOVE ZEROS TO CM-REINV-WS CM-JUDIC-WS CRED-ANTECIP-WS

/GCVN/         WRITE REG-CORRENT-ARQ-UPDT
141380         WRITE REG-CORRENT-D11
141390         ADD 1 TO CONT-REG-CORRENTISTA
141400     ELSE
141410     IF  TRAIL-AG-WS
141420         MOVE REG-TRAILLER-AG-RED-WS TO REG-TRAILLER-AG-ARQ-UPDT
141430                                        REG-TRAILLER-AG-D11
/GCVN/         WRITE REG-TRAILLER-AG-ARQ-UPDT
141450         WRITE REG-TRAILLER-AG-D11
141460         MOVE ZEROS TO DIAS-UTEIS-WS
141470     ELSE
141480     IF  REG-EXT-WS
               INITIALIZE REG-EXTRATO-D11
141490         MOVE SEQ-D04-WS TO CH-EXT-SEQ-WS
141500         MOVE REG-EXTRATO-WS TO REG-EXTRATO-ARQ-UPDT
141510                                REG-EXTRATO-D11
/GCVN/         WRITE REG-EXTRATO-ARQ-UPDT
141530         WRITE REG-EXTRATO-D11
141540         ADD 1 TO CONT-REG-EXTRATO
141550     ELSE
141560         MOVE '00' TO FILE-STATUS-WS
141570         DISPLAY 'P04808 ERRO NO TIPO DE REGISTRO'
141600         DISPLAY 'TIPO DE REGISTRO EH ' CH-TIPOREG-WS
141610         PERFORM 999-99-ROT-ERRO.
141620
141630     IF  STATUS-ARQ-UPDT-WS NOT EQUAL '00'
141640         MOVE STATUS-ARQ-UPDT-WS TO FILE-STATUS-WS
141650         MOVE 'P04808 ERRO NA GRAVACAO DO ArqExtMensal **'
141660                   TO MENSAGEM-ERRO-WS                            00141660
141670         PERFORM 999-99-ROT-ERRO.                                 00141670
141680                                                                  00141680
141690     MOVE ZERO TO SW-F10 SW-OCR-ESP                               00141690
141700         SLD-EMP-ANT-WS CH-SEQUENC-WS SW-REGULARIZA-INSUF         00141700
141710         SW-CANCELOU-EMPRESTIMO GR-DIFERENCA QDE-GR-DIFERENCA     00141710
141720         DI-MOV-REF-WS SLD-ANT IND-MENS-FICHA SW-GERA-FICHA       00141720
141730         SW-MOVIMENTACAO INSUFICIENCIA-WS MVR-CALC-WS             00141730
141740         SLD-DEP-ANT-WS IND-AUX IND-MOVTOS INSUF-AUX-WS           00141740
141750         SW-INSUF-EXTINTA SW-CONTRATO-VENCIDO                     00141750
141760         DATA-VENCIM-RED-WS DATA-PROX-VENC-RED-WS                 00141760
141770         EXCESSO-AUX-WS ANO-AUX-WS MES-AUX-WS                     00141770
141780         TALON-FORNECIDOS-ANT-WS TALON-RESIDUO-ANT-WS             00141780
141790         TALON-PEDIDOS-ACUM-ANT-WS TALON-AUTOM-REJ-WS             00141790
141800         QUOCIENTE-PERSON-WS RESTO-PERSON-WS TALON-AUTOM-WS       00141800
141810         TALON-SOLICIT-PARA-S131-WS CONSUMO-PERSON-WS             00141810
141820         ACUM-PEDIDOS-TALON-CORR-WS ACUM-CH-PROCESSADOS-WS        00141820
141830         ACUM-TALON-CTA-88887-WS SW-HOUVE-OCORR-14                00141830
141840         ACUM-CH-TB-PROCESSADOS-WS ACUM-PEDIDOS-CHEQUE-TB-WS      00141840
141850         ACUM-IOC-DIARIO-WS                                       00141850
               DT-MOV-ATUAL-IOF DT-ULT-MOV-IOF QT-DIAS-IOF.
141860     PERFORM 999-31-LIMPA-TAB-MOVTOS.                             00141860
141870     MOVE ZEROS TO IND-MOVTOS.                                    00141870
141880*                                                                 00141880
141890 999-12-CALCULO-CM-REINV.                                         00141890
141900                                                                  00141900
141910     IF SLD-DEP-RED-WS GREATER ZEROS                              00141910
              COMPUTE CM-REINV-WS ROUNDED =
                      VR-SELIC-DIA-PREC-WS * SLD-DEP-RED-WS
141940        MOVE CM-REINV-WS TO CRED-ANTECIP-WS.                      00141940
141950                                                                  00141950
141960 999-15-ACUMULA-D10.                                              00141960
141970*                                                                 00141970
141980     SET IND-OCR TO 1.                                            00141980
141990*                                                                 00141990
142000     SEARCH COD-OCR-TAB AT END                                    00142000
142010         DISPLAY '**P04808-CANCELADO. TP-OCR INEXISTE NA TABELA T 00142010
142020-                'AB-OCOD-OCR***'                                 00142020
142030         MOVE COD-RETORNO-WS (4) TO RETURN-CODE                   00142030
142040         DISPLAY ' RETURN CODE EH ..' COD-RETORNO-WS (4)          00142040
142050         DISPLAY ' MENSAGEM DE RETORNO EH ..' MEN-RETORNO-WS (4)  00142050
142060         GOBACK                                                   00142060
142070*                                                                 00142070
142080     WHEN COD-OCR-REAL-TAB (IND-OCR) = CH-TPREG-D10               00142080
142090         MOVE COD-OCR-CONV-TAB (IND-OCR) TO IND-ACUM-OCR.         00142090
142100*                                                                 00142100
142110     IF FH-RECOLHER-D10                                           00142110
142120        ADD FR-QDE-FICHA-D10-WS TO                                00142120
142130           ACUM-TPOCR-TAB (IND-ACUM-OCR)                          00142130
142140     ELSE                                                         00142140
142150         IF  INSUF-D10                                            00142150
142160             IF  INS-TPREG-D10 EQUAL 2                            00142160
142170                 NEXT SENTENCE                                    00142170
142180             ELSE                                                 00142180
142190                 ADD 1 TO ACUM-TPOCR-TAB (IND-ACUM-OCR)           00142190
142200         ELSE                                                     00142200
142210             IF  EXCESSO-D10                                      00142210
142220                 IF  EXC-TPREG-D10 EQUAL 2                        00142220
142230                     NEXT SENTENCE                                00142230
142240                 ELSE                                             00142240
142250                     ADD 1 TO ACUM-TPOCR-TAB (IND-ACUM-OCR)       00142250
142260             ELSE                                                 00142260
142270                IF CH-PERSONAL                                    00142270
142280                   IF PER-ORIGEM-COMANDO-D10 EQUAL 9              00142280
142290                      NEXT SENTENCE                               00142290
142300                   ELSE                                           00142300
142310                      ADD 1 TO ACUM-TPOCR-TAB (IND-ACUM-OCR)      00142310
142320                ELSE                                              00142320
142330                   ADD 1 TO ACUM-TPOCR-TAB (IND-ACUM-OCR).        00142330
142340     ADD 1 TO CH-SEQUENC-WS.                                      00142340
142350                                                                  00142350
142390 999-20-ESTOUROU-AREA-D10.                                        00142390
142400*                                                                 00142400
142410     WRITE REG-FICHA-D10                                          00142410
142420          INVALID KEY                                             00142420
142430         DISPLAY '**P04808-CANCELADO. AREA INSUFICIENTE PARA O D0 00142430
142440-                '4810************'                               00142440
142450         MOVE COD-RETORNO-WS (3) TO RETURN-CODE                   00142450
142460         DISPLAY 'RETURN CODE EH .. ' COD-RETORNO-WS (3)          00142460
142470         DISPLAY 'MENSAGEM RETORNO EH ' MEN-RETORNO-WS (3)        00142470
142480         GOBACK.                                                  00142480
142490                                                                  00142490
142500 999-25-ZERA-FH-RECOLHER-WS.                                      00142500
142510                                                                  00142510
142520     ADD 1 TO IND-FICHA-RECOLHER.                                 00142520
142530                                                                  00142530
142540     MOVE SPACES TO FR-EXCL-D10-WS (IND-FICHA-RECOLHER)           00142540
142550                    FR-DV-CONTA-D10-WS (IND-FICHA-RECOLHER).      00142550
142560     MOVE ZEROS TO FR-CONTA-D10-WS (IND-FICHA-RECOLHER).          00142560
142570*                                                                 00142570
************************************************************************
DOCINI****F* P04808/999-26-VALOR-MEDIO-CONTRATO
DOCTXT* OBJETIVO
DOCTXT*   Calcula o valor medio de contrato de cheque especial.
DOCEND******
142580 999-26-VALOR-MEDIO-CONTRATO.                                     00142580
142590                                                                  00142590
142600     IF  NOT INICIO-MES                                           00142600
142610         IF  EMP-LIM-RED-WS NOT EQUAL LIMITE-ANTERIOR-WS          00142610
142620             PERFORM 999-26A-CALCULA-MEDIA-CONTRATO               00142620
142630         ELSE                                                     00142630
142640             NEXT SENTENCE                                        00142640
142650     ELSE                                                         00142650
142660         MOVE EMP-LIM-RED-WS TO VALOR-MEDIO-LIMITE-RED-WS.        00142660
142670*                                                                 00142670
142680 999-26A-CALCULA-MEDIA-CONTRATO.                                  00142680
142690                                                                  00142690
142700     CALL 'M0952000' USING ANO-RODADA-WS ANO-AUX-WS.              00142700
142710     PERFORM 999-33C-TESTA-ANO-BISSEXTO.                          00142710
142720     IF  ANO-BISSEXTO                                             00142720
142730         MOVE 29 TO NUM-DIAS-MES-WS                               00142730
142740     ELSE                                                         00142740
142750         MOVE NUM-DIAS-MES-TAB (MES-RODADA-WS) TO NUM-DIAS-MES-WS.00142750
142760     COMPUTE RESTO-DIAS-MES-WS = NUM-DIAS-MES-WS -                00142760
142770                                 DIA-RODADA-WS.                   00142770
142780     COMPUTE VALOR-MEDIO-LIMITE-RED-WS ROUNDED =                  00142780
142790             ((LIMITE-ANTERIOR-WS * DIA-RODADA-WS) +              00142790
142800             (EMP-LIM-RED-WS * RESTO-DIAS-MES-WS)) /              00142800
142810             NUM-DIAS-MES-WS.                                     00142810
142820     MOVE ZEROS TO SW-ANO-BISSEXTO                                00142820
142830                   LIMITE-ANTERIOR-WS.                            00142830
142840*                                                                 00142840
142850 999-30-ZERA-MOV-F10.                                             00142850
142860*                                                                 00142860
142870     ADD 1 TO IND1.                                               00142870
142880                                                                  00142880
142890     MOVE ZEROS TO DIA-MOV-RED-WS (IND1)                          00142890
142900                    HIST-MOV-RED-WS (IND1)                        00142900
142910                    REF-MOV-RED-WS (IND1)                         00142910
142920                    VR-MOV-RED-WS (IND1).                         00142920
142930                                                                  00142930
142940 999-31-LIMPA-TAB-MOVTOS.                                         00142940
142950                                                                  00142950
142960     MOVE ZEROS TO ZERA-MOV-LOTE-TAB                              00142960
142970                   ZERA-MOV-HIST-TAB                              00142970
142980                   ZERA-MOV-REF-TAB                               00142980
142990                   ZERA-MOV-VR-TAB.                               00142990
143000     MOVE ZERA-MOVIMENTOS TO ZERA-RESTO-MOVTOS.                   00143000
143010                                                                  00143010
DOCINI****F* P04808/999-32-TESTA-ADIANTAMENTOS
DOCTXT* OBJETIVO
DOCTXT*   Zera a data de adiantamento caso a conta nao tenha tido
DOCTXT*   adiantamento na data.
DOCEND******
143020 999-32-TESTA-ADIANTAMENTOS.                                      00143020
143030     IF  VALOR-ACUM-ADIANT-RED-WS EQUAL ZEROS                     00143030
143040         MOVE ZEROS TO DATA-ADIANT-RED-WS.                        00143040
143050                                                                  00143050
143060 999-33-CRED-ANTECIP-TELEX.                                       00143060
143070                                                                  00143070
143080     IF  CRED-ANTECIP-WS NOT EQUAL ZEROS                          00143080
143090         MOVE 9            TO TIPO-CAD-02DD                       00143090
143100         MOVE CH-CONTA-WS  TO CONTA-CAD-02DD                      00143100
143110         MOVE CH-DIGITO-WS TO DIGITO-CAD-02DD                     00143110
143120         MOVE 99           TO CODHIST-MOV-02DD                    00143120
143130         MOVE ZEROS        TO NUMDOC-MOV-02DD                     00143130
143140         MOVE CRED-ANTECIP-WS TO VALOR-MOV-02DD                   00143140
143150         PERFORM 999-34-GRAVA-DISCO-TELEX.                        00143150
143160                                                                  00143160
143170 999-33A-ENCARGOS-DIARIOS-TELEX.                                  00143170
143180                                                                  00143180
143230     COMPUTE ENCARGOS-DIARIOS-WS = JUROS-DIARIOS-WS +             00143230
143240                                   IOCS-DIARIOS-EXIGIVEIS-RED-WS. 00143240
143250     IF  ENCARGOS-DIARIOS-WS NOT EQUAL ZEROS                      00143250
143260         MOVE 9                   TO TIPO-CAD-02DD                00143260
143270         MOVE CH-CONTA-WS         TO CONTA-CAD-02DD               00143270
143280         MOVE CH-DIGITO-WS        TO DIGITO-CAD-02DD              00143280
143290         MOVE 99                  TO CODHIST-MOV-02DD             00143290
143300         MOVE 048048              TO NUMDOC-MOV-02DD              00143300
143310         MOVE ENCARGOS-DIARIOS-WS TO VALOR-MOV-02DD               00143310
143320         PERFORM 999-34-GRAVA-DISCO-TELEX.                        00143320
143330     MOVE ZEROS TO QTDE-DIAS-WS                                   00143330
143340                   NUM-DIAS-WS                                    00143340
143350                   NUMEROS-IOC-WS                                 00143350
143360                   IOC-DIARIOS-WS                                 00143360
143370                   SLD-DEV-CALCULO-WS                             00143370
143380                   ENCARGOS-DIARIOS-WS.                           00143380
143400***                                                               00143400
143410*** A ROTINA DE RENOVACAO AUTOMATICA DE CONTRATOS EH UM PERFORM   00143410
143420*** QUE FOGE AS ESPECIFICACOES DA PROGRAMACAO TOP-DOWN DEVIDO A   00143420
143430*** NECESSIDADE DA EXECUCAO DOS MODULOS DE OCORRENCIAS DE EXTRATO 00143430
143440*** E CADASTRAMENTO DE EMPRESTIMO                                 00143440
143450***                                                               00143450
143460 999-33B-TESTE-VENCIMENTO-CONTR.                                  00143460
143470                                                                  00143470
143480     IF  CONTRATO-VENCIDO                                         00143480
143490         IF  TPCONTAB-RED-WS = 01                                 00143490
143500             IF  EMP-LIM-RED-WS GREATER ZEROS                     00143500
143510                 COMPUTE EXCESSO-AUX-WS = (EMP-LIM-RED-WS +       00143510
143520                                           SLD-DEP-RED-WS +       00143520
143530                                           SLD-EMP-RED-WS) -      00143530
143540                    (SLD-BLO-RED-WS (1)  + SLD-BLO-RED-WS (2)  +  00143540
143550                     SLD-BLO-RED-WS (3)  + SLD-BLO-RED-WS (4)  +  00143550
143560                     SLD-BLO-RED-WS (5)  + SLD-BLO-RED-WS (6)  +  00143560
143570                     SLD-BLO-RED-WS (7)  + SLD-BLO-RED-WS (8)  +  00143570
143580                     SLD-BLO-RED-WS (9)  + SLD-BLO-RED-WS (10) +  00143580
143590                     SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +  00143590
143600                     SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +  00143600
143610                     SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +  00143610
143620                     SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +  00143620
143630                     SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +  00143630
143640                     SLD-BLO-RED-WS (21)).                        00143640
143680                                                                  00143680
143690 999-33C-TESTA-ANO-BISSEXTO.                                      00143690
143700                                                                  00143700
143710     DIVIDE ANO-AUX-WS BY 4 GIVING QUOCIENTE-AUX-WS               00143710
143720                            REMAINDER RESTO-AUX-WS.               00143720
143730     IF  RESTO-AUX-WS EQUAL ZEROS                                 00143730
143740         MOVE 1 TO SW-ANO-BISSEXTO                                00143740
143750     ELSE                                                         00143750
143760         MOVE ZEROS TO SW-ANO-BISSEXTO.                           00143760
143770                                                                  00143770
143780 999-34-GRAVA-DISCO-TELEX.                                        00143780
143790                                                                  00143790
143820     MOVE ZEROS TO SW-ERRO-GRAV-TELEX.                            00143820

143830     IF TIPO-HEAD-02DD EQUAL 0                                    00143830
143840        WRITE REG-HEAD-02DD                                       00143840
143850              INVALID KEY MOVE 1 TO SW-ERRO-GRAV-TELEX            00143850
143860     ELSE                                                         00143860
143870        IF TIPO-HEAD-02DD EQUAL 1 OR 2 OR 3                       00143870
143880           WRITE REG-CAD-02DD                                     00143880
143890                 INVALID KEY MOVE 1 TO SW-ERRO-GRAV-TELEX         00143890
143900        ELSE                                                      00143900
143910           IF TIPO-HEAD-02DD EQUAL 9                              00143910
143920              WRITE REG-MOV-02DD                                  00143920
143930                    INVALID KEY MOVE 1 TO SW-ERRO-GRAV-TELEX.     00143930

143940     IF  ERRO-GRAVACAO-TELEX                                      00143940
143950         DISPLAY '* P04808 CANCELADO - ERRO GRAVACAO D12802 *'    00143950
143960         MOVE COD-RETORNO-WS (3) TO RETURN-CODE                   00143960
143970         DISPLAY 'RETURN CODE EH .. ' COD-RETORNO-WS (3)          00143970
143980         DISPLAY 'MENSAGEM RETORNO EH ' MEN-RETORNO-WS (3)        00143980
143990         GOBACK.                                                  00143990
144000                                                                  00144000
144010     MOVE ZEROS TO TIPO-HEAD-02DD                                 00144010
144020                   CODAG-HEAD-02DD                                00144020
144030                   DTREF-HEAD-02DD                                00144030
144040                   TIPO-CAD-02DD                                  00144040
144050                   CONTA-CAD-02DD                                 00144050
144060                   DTVENC-CHBNB-02DD                              00144060
144070                   LIMITE-CHBNB-02DD                              00144070
144080                   DTCONTR-CHBNB-02DD                             00144080
144090                   TIPO-MOV-02DD                                  00144090
144100                   CONTA-MOV-02DD                                 00144100
144110                   DIGITO-MOV-02DD                                00144110
144120                   CODHIST-MOV-02DD                               00144120
144130                   NUMDOC-MOV-02DD                                00144130
144140                   VALOR-MOV-02DD.                                00144140

144150     MOVE SPACES TO DIGITO-CAD-02DD                               00144150
144160                    NOME-CLI-CAD-02DD                             00144160
144170                    NOME-CLI2-CAD-02DD.                           00144170
144180*                                                                 00144180
144190  999-35-GRAVA-D04883.                                            00144190
144200                                                                  00144200
144210     MOVE DIA-MOV-WS      TO DIA-D83.                             00144210
144220     MOVE MES-MOV-WS      TO MES-D83.                             00144220
144230     MOVE ANO-MOV-WS      TO ANO-D83.                             00144230
144240     MOVE CH-AG-WS        TO AGN-D83.                             00144240
144250     MOVE CH-CONTA-WS     TO TITULAR-D83.                         00144250
144260     MOVE CH-DIGITO-WS    TO DIG-TITULAR-D83.                     00144260
144270     MOVE TPCONTAB-RED-WS TO TIPO-CONTABIL-D83.                   00144270
144280                                                                  00144280
144290* NAO GRAVAR ENCARGOS CONTA DO TESOURO NACIONAL                   00144290
144300     IF (CH-AG-WS = 136 AND CH-CONTA-WS = 40095)                  00144300
144310        NEXT SENTENCE                                             00144310
144320     ELSE                                                         00144320
144330*...............................................                  00144330
144340     WRITE REG-D83                                                00144340
144350           INVALID KEY                                            00144350
144360           DISPLAY 'WRITE INVALIDO - D04883 ERRO DE GRAVACAO'     00144360
144370           MOVE COD-RETORNO-WS (3) TO RETURN-CODE                 00144370
144380           DISPLAY 'RETURN CODE EH .. ' COD-RETORNO-WS (3)        00144380
144390           DISPLAY 'MENSAGEM RETORNO EH ' MEN-RETORNO-WS (3)      00144390
144400           GOBACK.                                                00144400

       999-35A-GERA-ESTORNO-JRIOF-MES.

           MOVE ZEROS                  TO REG-D07B

      * CH-N-LOTE-D07
      * PRAZO-DESBLOQ-D07
      * DATA-REMUN-D07
      * TPMOV-D07

           IF JUR-MENSAL-1DIA-WS GREATER ZEROS
           AND JUR-DEVOL-1DIA-WS GREATER ZEROS
              MOVE ZEROS               TO REG-D07B
                                          CH-N-LOTE-D07B
                                          PRAZO-DESBLOQ-D07B
                                          DATA-REMUN-D07B
                                          TPMOV-D07B
                                          ZEROS-1
                                          ZEROS-2
              MOVE 7                   TO CH-TPREG-D07B
              MOVE CH-AG-WS            TO CH-CODAG-D07B

              MOVE DIA-PROX-PROC-WS    TO DIA-MOVIM-07B
              MOVE MES-PROX-PROC-WS    TO MES-MOVIM-07B
              MOVE AA-PROX-PROC-WS     TO ANO-MOVIM-07B

              MOVE DATA-MOVIM-07B      TO CH-DATA-D07B
              MOVE 90                  TO CH-N-LOTE-D07B
              MOVE 383                 TO CH-HIST-D07B
              MOVE CH-CONTA-WS         TO CONTA-D07B
              MOVE CH-DIGITO-WS        TO DV-CONTA-D07B
              MOVE 009628              TO TR-REF-D07B

              IF JUR-MENSAL-1DIA-WS LESS JUR-DEVOL-1DIA-WS
                 MOVE JUR-MENSAL-1DIA-WS TO TR-VALOR-D07B
              ELSE
                 MOVE JUR-DEVOL-1DIA-WS  TO TR-VALOR-D07B
              END-IF

              WRITE REG-D07B
              IF FS-D07B NOT EQUAL ZEROS
                 DISPLAY 'P04808 WRITE D04807B 1: ' FS-D07B
                 MOVE FS-D07B          TO RETURN-CODE
                 GOBACK
              END-IF
           END-IF

           IF IOF-MENSAL-1DIA-WS GREATER ZEROS
           AND IOF-DEVOL-1DIA-WS GREATER ZEROS
              MOVE ZEROS               TO REG-D07B
                                          CH-N-LOTE-D07B
                                          PRAZO-DESBLOQ-D07B
                                          DATA-REMUN-D07B
                                          TPMOV-D07B
                                          ZEROS-1
                                          ZEROS-2
              MOVE 7                   TO CH-TPREG-D07B
              MOVE CH-AG-WS            TO CH-CODAG-D07B

              MOVE DIA-PROX-PROC-WS    TO DIA-MOVIM-07B
              MOVE MES-PROX-PROC-WS    TO MES-MOVIM-07B
              MOVE AA-PROX-PROC-WS     TO ANO-MOVIM-07B

              MOVE DATA-MOVIM-07B      TO CH-DATA-D07B
              MOVE 90                  TO CH-N-LOTE-D07B
              MOVE 388                 TO CH-HIST-D07B
              MOVE CH-CONTA-WS         TO CONTA-D07B
              MOVE CH-DIGITO-WS        TO DV-CONTA-D07B

              IF P-FISICAS
                 MOVE 004631           TO TR-REF-D07B
              ELSE
                 MOVE 000054           TO TR-REF-D07B
              END-IF

              IF IOF-MENSAL-1DIA-WS LESS IOF-DEVOL-1DIA-WS
                 MOVE IOF-MENSAL-1DIA-WS TO TR-VALOR-D07B
              ELSE
                 MOVE IOF-DEVOL-1DIA-WS  TO TR-VALOR-D07B
              END-IF

              WRITE REG-D07B
              IF FS-D07B NOT EQUAL ZEROS
                 DISPLAY 'P04808 WRITE D04807B 2: ' FS-D07B
                 MOVE FS-D07B          TO RETURN-CODE
                 GOBACK
              END-IF
           END-IF.

144570 999-36-PROCESSA-ARQ-TAXA.                                        00144570
144580     MOVE ZEROS TO VR-ITAH-ANT-WS                                 00144580
144590                   VR-ITAH-ATL-WS                                 00144590
144600                   VR-ITAF-ANT-WS                                 00144600
144610                   VR-ITAF-ATL-WS                                 00144610
144620                   VR-IAC-ANT-WS                                  00144620
144630                   VR-IAC-ATL-WS                                  00144630
144640                   VR-BTNF-DIA-WS                                 00144640
144650                   VR-BTNF-NEXT-WS                                00144650
144660                   SW-ERRO-TBTX.                                  00144660
144670     PERFORM 999-38-ACESSA-TAB-SIEF.                              00144670
           MOVE DIA-SIEF-WS         TO DIA-INV-DEVOL.
           MOVE MES-SIEF-WS         TO MES-INV-DEVOL.
           MOVE ANO-SIEF-WS         TO ANO-INV-DEVOL.
      ******* PRECATORIOS
           PERFORM 999-36-CALCULA-DIAS-UTEIS-MES
126148     PERFORM 999-36-CALCULA-DIAS-UTEIS-ATL                        00126148
           IF QTD-DIAS-UTEIS-WS GREATER ZEROS
              PERFORM 999-36-PESQ-TR-DIA1-MES-ATL
           ELSE
              PERFORM 999-36-PESQ-MES-ANTERIOR
              PERFORM 999-36-PESQ-TR-DIA1-MES-ANT
126148        PERFORM 999-36-CALCULA-DIAS-UTEIS-ANT                     00126148
           END-IF
      ******* PRECATORIOS
144680     PERFORM 999-37A-TESTA-CONSISTENCIA-D01.                      00144680
144690     MOVE ZEROS TO SW-FIM-PROCESSAMENTO.                          00144690
144700     MOVE 'TBAG' TO TABE-TAXA-D01.                                00144700
144710     START TabUtils KEY = TABE-TAXA-D01.                          00144710
144720     IF STATUS-D01-WS NOT EQUAL '00'                              00144720
144730        MOVE STATUS-D01-WS TO FILE-STATUS-WS                      00144730
144740        MOVE '*** P04808 ERRO NO START-TBAG TabUtils ***'         00144740
144750                  TO MENSAGEM-ERRO-WS                             00144750
144760         PERFORM  999-99-ROT-ERRO.                                00144760
144770     READ TabUtils.                                               00144770
144780     IF STATUS-D01-WS EQUAL '10'                                  00144780
144790        MOVE 1 TO SW-FIM-PROCESSAMENTO                            00144790
144800     ELSE                                                         00144800
144810        IF STATUS-D01-WS NOT EQUAL '00' AND '04'                  00144810
144820           MOVE STATUS-D01-WS TO FILE-STATUS-WS                   00144820
144830           MOVE 'P04808 ERRO PRIMEIRA LEITURA-TBAG TabUtils **'   00144830
144840                     TO MENSAGEM-ERRO-WS                          00144840
144850           PERFORM  999-99-ROT-ERRO.                              00144850
144860     PERFORM 999-37-LEITURA-D04801 UNTIL FIM-PROCESSAMENTO.       00144860
144870                                                                  00144870
126240***************************************************************** 00126240
126241                                                                  00126241
126242 999-36-CALCULA-DIAS-UTEIS-ATL.                                   00126242

126244     MOVE '05'              TO W091CL-TP-OPER.                    00126244
126245     MOVE 001               TO W091CL-CD-AG-REQ.                  00126245
126243                                                                  00126243
126246     MOVE 01                TO W091CL-DD-INFOR-1.                 00126246
126247     MOVE MES-RODADA-WS     TO W091CL-MM-INFOR-1.                 00126247
140140     CALL 'M0952000' USING ANO-RODADA-WS W091CL-AA-INFOR-1.
126243                                                                  00126243
126246     MOVE DIA-RODADA-WS     TO W091CL-DD-INFOR-2.                 00126246
126247     MOVE MES-RODADA-WS     TO W091CL-MM-INFOR-2.                 00126247
140140     CALL 'M0952000' USING ANO-RODADA-WS W091CL-AA-INFOR-2.

           IF W091CL-DT-INFOR-1 NOT = W091CL-DT-INFOR-2
140180        MOVE 0                 TO W091CL-ST-ARQ-RES
140190        CALL 'P09102'   USING W091CL-REGISTRO
140200        PERFORM 999-95-TESTE-VALIDADE-RETORNO                     00140200
140210        IF  RETORNO-SUBROT-OK                                     00140210
140220            MOVE W091CL-QT-DD-UTIL TO QTD-DIAS-UTEIS-WS           00140220
I14023        ELSE                                                      00140230
140240            PERFORM 999-99-ROT-ERRO                               00140240
              END-IF
           ELSE
              MOVE ZEROS          TO QTD-DIAS-UTEIS-WS
           END-IF.

126257***************************************************************** 00126257
126243 999-36-PESQ-TR-DIA1-MES-ATL.                                     00126243
126243                                                                  00126243
149110     MOVE CH-DATA-D07     TO DATA-D07-RED-WS.                     00149110
149120     MOVE 01              TO DIA-TR-WS.                           00149120
149130     MOVE MES-D07-WS      TO MES-TR-WS.                           00149130
149140     CALL 'M0952000' USING ANO-D07-WS ANO-TR-WS.                  00149140

126196     MOVE 048             TO W09508-CD-SIS-SLT.                   00126196
126197     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00126197
126198     MOVE 49              TO W09508-CD-ID-ECF.                    00126198
126199     MOVE DATA-TR-WS      TO W09508-DT-REF-CNS.                   00126199
126200     CALL 'P09511' USING W09508-AREA-SIEF.                        00126200
126201     IF W09508-CD-RET-ROT = '**'                                  00126201
126202        IF W09508-CD-TP-ID EQUAL 2                                00126202
126203           MOVE W09508-NR-DIV-ATZ TO DIV-TR-WS                    00126203
126204           COMPUTE W09508-VR-ID-ECF = W09508-VR-ID-ECF /          00126204
126205                                      DIV-TR-WS                   00126205
126206           MOVE W09508-VR-ID-ECF TO VR-TR-DIA-PREC-WS             00126206
126208        ELSE                                                      00126208
126210           MOVE W09508-VR-ID-ECF TO VR-TR-DIA-PREC-WS             00126210
126211     ELSE                                                         00126211
126212        DISPLAY '** P04808 - ERRO ACESSO TABELA SIEF 1**'         00126212
126212        DISPLAY '**          ACESSO INDICE 49        **'          00126212
              DISPLAY 'DATA-TR-WS = ' DATA-TR-WS
126213        DISPLAY W09508-CD-RET-ROT                                 00126213
126214        DISPLAY W09508-DE-MSG-RET                                 00126214
126215        DISPLAY W09508-SQLCODE                                    00126215
126216        MOVE COD-RETORNO-WS (4) TO RETURN-CODE                    00126216
126217        DISPLAY 'RETURN CODE      = ' COD-RETORNO-WS (4)          00126217
126218        DISPLAY 'MENSAGEM RETORNO = ' MEN-RETORNO-WS (4)          00126218
126219        GOBACK.                                                   00126219
126220                                                                  00126220
126221     IF VR-TR-DIA-PREC-WS  EQUAL ZEROS                            00126221
126222        DISPLAY '*********************************************'   00126222
126212        DISPLAY '**       P04808 - ACESSO TABELA SIEF       **'   00126212
126212        DISPLAY '**            ACESSO INDICE 49             **'   00126212
126212        DISPLAY '**     VALOR DO INDICE 49 IGUAL A ZERO     **'   00126212
126226        DISPLAY '**    COMUNICAR JOAO FRANCISCO - F048771   **'   00126226
126222        DISPLAY '*********************************************'   00126222
126224        DISPLAY '** DATA-MOVIMENTO = '  DATA-TR-WS                00126224
126225        DISPLAY '** VR-TR-DIA      = '  VR-TR-DIA-PREC-WS         00126225
126227        DISPLAY '*********************************************'.  00126227
126220                                                                  00126220
126257***************************************************************** 00126257
       999-36-CALCULA-DIAS-UTEIS-MES.

140180     MOVE 1                 TO W091CL-ST-ARQ-RES.
126245     MOVE 001               TO W091CL-CD-AG-REQ.                  00126245
126243                                                                  00126243
126246     MOVE 01                TO W091CL-DD-INFOR-1.                 00126246
126247     MOVE MES-RODADA-WS     TO W091CL-MM-INFOR-1.                 00126247
140140     CALL 'M0952000' USING ANO-RODADA-WS W091CL-AA-INFOR-1.
126243                                                                  00126243
126246     MOVE NUM-DIAS-MES-TAB (MES-RODADA-WS) TO W091CL-DD-INFOR-2.  00126246
126247     MOVE MES-RODADA-WS     TO W091CL-MM-INFOR-2.                 00126247
046510     IF  MES-RODADA-WS EQUAL 2                                    00046510
046520         CALL 'M0952000' USING ANO-RODADA-WS ANO-AUX-WS           00046520
046520         MOVE ANO-AUX-WS TO ANO-TR-WS                             00046520
046530         PERFORM 999-33C-TESTA-ANO-BISSEXTO                       00046530
046540         IF  ANO-BISSEXTO                                         00046540
046550             MOVE 29        TO W091CL-DD-INFOR-2                  00046550
046560         ELSE                                                     00046560
046550             MOVE 28        TO W091CL-DD-INFOR-2                  00046550
               END-IF
           END-IF.

126246     MOVE 0                 TO W091CL-DD-INFOR-1.                 00126246
126244     MOVE '11'              TO W091CL-TP-OPER.                    00126244
           MOVE 1                 TO W091CL-QT-DIA-REQ.
           MOVE W091CL-DD-INFOR-2 TO W091CL-DD-INFOR-1.
           CALL 'P09102' USING W091CL-REGISTRO.
           MOVE W091CL-DD-RES-2-3 TO W091CL-DD-INFOR-2.
           MOVE W091CL-MM-RES-2-3 TO W091CL-MM-INFOR-2.
           MOVE W091CL-AA-RES-2-3 TO W091CL-AA-INFOR-2.

126246     MOVE 1                 TO W091CL-DD-INFOR-1.                 00126246

126244     MOVE '05'              TO W091CL-TP-OPER.                    00126244
140190     CALL 'P09102'   USING W091CL-REGISTRO.
140200     PERFORM 999-95-TESTE-VALIDADE-RETORNO                        00140200
140210     IF  RETORNO-SUBROT-OK                                        00140210
140220         MOVE W091CL-QT-DD-UTIL TO QTD-DIAS-UTEIS-MES-WS          00140220
140230     ELSE                                                         00140230
140240         PERFORM 999-99-ROT-ERRO.                                 00140240

126257***************************************************************** 00126257
       999-36-PESQ-MES-ANTERIOR.
126243
126185     MOVE DIA-RODADA-WS   TO W091CL-DD-INFOR-1.                   00126185
126186     MOVE MES-RODADA-WS   TO W091CL-MM-INFOR-1.                   00126186
140170     CALL 'M0952000' USING ANO-RODADA-WS W091CL-AA-INFOR-1.

140180     MOVE 1               TO W091CL-ST-ARQ-RES                    00140180
126188     MOVE '10'            TO W091CL-TP-OPER.                      00126188
126189     MOVE 001             TO W091CL-CD-AG-REQ.                    00126189
126190     MOVE 10              TO W091CL-QT-DIA-REQ.                   00126190
140190     CALL 'P09102'   USING W091CL-REGISTRO                        00140190
140200     PERFORM 999-95-TESTE-VALIDADE-RETORNO                        00140200
140210     IF  RETORNO-SUBROT-OK                                        00140210
140220         NEXT SENTENCE                                            00140220
140230     ELSE                                                         00140230
140240         PERFORM 999-99-ROT-ERRO.                                 00140240
126195                                                                  00126195
126257***************************************************************** 00126257
126243 999-36-PESQ-TR-DIA1-MES-ANT.                                     00126243
126243                                                                  00126243
126196     MOVE 048               TO W09508-CD-SIS-SLT.                 00126196
126197     MOVE 'P04808'          TO W09508-CD-PRG-SLT.                 00126197
126198     MOVE 49                TO W09508-CD-ID-ECF.                  00126198
126193     MOVE 01                TO DIA-TR-WS.                         00126193
126193     MOVE W091CL-MM-RES-2-3 TO MES-TR-WS.                         00126193
126193     MOVE W091CL-AA-RES-2-3 TO ANO-TR-WS.                         00126193
126199     MOVE DATA-TR-WS        TO W09508-DT-REF-CNS.                 00126199
126200     CALL 'P09511' USING W09508-AREA-SIEF.                        00126200
126201     IF W09508-CD-RET-ROT = '**'                                  00126201
126202        IF W09508-CD-TP-ID EQUAL 2                                00126202
126203           MOVE W09508-NR-DIV-ATZ TO DIV-TR-WS                    00126203
126204           COMPUTE W09508-VR-ID-ECF = W09508-VR-ID-ECF /          00126204
126205                                      DIV-TR-WS                   00126205
126206           MOVE W09508-VR-ID-ECF TO VR-TR-DIA-PREC-WS             00126206
126208        ELSE                                                      00126208
126210           MOVE W09508-VR-ID-ECF TO VR-TR-DIA-PREC-WS             00126210
126211     ELSE                                                         00126211
126212        DISPLAY '** P04808 -  ERRO ACESSO TABELA SIEF 2 **'       00126212
126212        DISPLAY '**          ACESSO INDICE 49          **'        00126212
126213        DISPLAY W09508-CD-RET-ROT                                 00126213
126214        DISPLAY W09508-DE-MSG-RET                                 00126214
126215        DISPLAY W09508-SQLCODE                                    00126215
126216        MOVE COD-RETORNO-WS (4) TO RETURN-CODE                    00126216
126217        DISPLAY 'RETURN CODE      = ' COD-RETORNO-WS (4)          00126217
126218        DISPLAY 'MENSAGEM RETORNO = ' MEN-RETORNO-WS (4)          00126218
126219        GOBACK.                                                   00126219
126220                                                                  00126220
126221     IF VR-TR-DIA-PREC-WS  EQUAL ZEROS                            00126221
126222        DISPLAY '*********************************************'   00126222
126212        DISPLAY '**       P04808 - ACESSO TABELA SIEF       **'   00126212
126212        DISPLAY '**            ACESSO INDICE 49             **'   00126212
126212        DISPLAY '**     VALOR DO INDICE 49 IGUAL A ZERO     **'   00126212
126226        DISPLAY '**    COMUNICAR JOAO FRANCISCO - F048771   **'   00126226
126222        DISPLAY '*********************************************'   00126222
126224        DISPLAY '** DATA-MOVIMENTO = '  DATA-TR-WS                00126224
126225        DISPLAY '** VR-TR-DIA      = '  VR-TR-DIA-PREC-WS         00126225
126227        DISPLAY '*********************************************'.  00126227
126220                                                                  00126220
126257***************************************************************** 00126257
126220 999-36-CALCULA-DIAS-UTEIS-ANT.                                   00126220
126258                                                                  00126258
126245     MOVE 001               TO W091CL-CD-AG-REQ.                  00126245
126243                                                                  00126243
126246     MOVE 01                TO W091CL-DD-INFOR-1.                 00126246
126247     MOVE W091CL-MM-RES-2-3 TO W091CL-MM-INFOR-1                  00126247
                                     W091CL-MM-INFOR-2.
126247     MOVE W091CL-AA-RES-2-3 TO W091CL-AA-INFOR-1                  00126247
                                     W091CL-AA-INFOR-2.

126243     IF W091CL-MM-RES-2-3 EQUAL 01 OR 03 OR 05 OR 07 OR 08 OR     00126243
                                      10 OR 12
126246        MOVE 31             TO W091CL-DD-INFOR-2                  00126246
           ELSE
126243        IF W091CL-MM-RES-2-3 EQUAL 04 OR 06 OR 09 OR 11           00126243
126246           MOVE 30          TO W091CL-DD-INFOR-2                  00126246
              ELSE
183600           DIVIDE 4 INTO W091CL-AA-RES-2-3 GIVING QUOCIENTE-WS    00183600
183600           REMAINDER BISSEXTO                                     00183600
183800           IF BISSEXTO EQUAL ZEROS
126243              MOVE 29       TO W091CL-DD-INFOR-2                  00126243
                 ELSE
126243              MOVE 28       TO W091CL-DD-INFOR-2                  00126243
                 END-IF
              END-IF
           END-IF.

140180     MOVE 0                 TO W091CL-ST-ARQ-RES.
126244     MOVE '11'              TO W091CL-TP-OPER.                    00126244
           MOVE 1                 TO W091CL-QT-DIA-REQ.
           CALL 'P09102' USING W091CL-REGISTRO.
           MOVE W091CL-MM-RES-2-3 TO W091CL-MM-INFOR-2.
           MOVE W091CL-AA-RES-2-3 TO W091CL-AA-INFOR-2.

140180     MOVE 1                 TO W091CL-ST-ARQ-RES.
126244     MOVE '05'              TO W091CL-TP-OPER.                    00126244
140190     CALL 'P09102'   USING W091CL-REGISTRO.
140200     PERFORM 999-95-TESTE-VALIDADE-RETORNO                        00140200
140210     IF  RETORNO-SUBROT-OK                                        00140210
140220         MOVE W091CL-QT-DD-UTIL TO QTD-DIAS-UTEIS-MES-WS          00140220
126243         DISPLAY '999-36-CALCULA-DIAS-UTEIS-ANT'                  00126243
126243         DISPLAY 'QTD-DIAS-UTEIS-MES-WS = ' QTD-DIAS-UTEIS-MES-WS 00126243
140230     ELSE                                                         00140230
140240         PERFORM 999-99-ROT-ERRO.                                 00140240

126257***************************************************************** 00126257

144880 999-37-LEITURA-D04801.                                           00144880
144890     READ TabUtils.
144900     IF STATUS-D01-WS EQUAL '10'                                  00144900
144910        MOVE 1 TO SW-FIM-PROCESSAMENTO                            00144910
144920     ELSE                                                         00144920
144930        IF STATUS-D01-WS NOT EQUAL '00' AND '04'                  00144930
144940           MOVE STATUS-D01-WS TO FILE-STATUS-WS                   00144940
144950           MOVE '*** P04808 ERRO NA LEITURA DO TabUtils-999-37***'
144960                     TO MENSAGEM-ERRO-WS                          00144960
144970           PERFORM  999-99-ROT-ERRO.                              00144970
144980                                                                  00144980
144990     IF TAB-AGENCIAS                                              00144990
145000        PERFORM 999-42-ACESSA-TAB-AGENCIAS                        00145000
145010     ELSE                                                         00145010
145020        MOVE 1 TO SW-FIM-PROCESSAMENTO.                           00145020
145030                                                                  00145030
145040 999-37A-TESTA-CONSISTENCIA-D01.                                  00145040
145050                                                                  00145050
145060     IF  VR-IAC-ANT-WS EQUAL ZEROS OR                             00145060
145070         VR-IAC-ATL-WS EQUAL ZEROS                                00145070
145080         MOVE 1 TO SW-ERRO-TBTX                                   00145080
145090         DISPLAY '*********************************************'  00145090
145100         DISPLAY '** P04808 - VALOR DO INDICE DE ATRASO DE   **'  00145100
145110         DISPLAY '**          CREDITO ESTAH ZERADO           **'  00145110
145120         DISPLAY '** DATA-MOVIMENTO - '  CH-DATA-D07              00145120
145130         DISPLAY '** IAC-DAY        - '  VR-IAC-ANT-WS            00145130
145140         DISPLAY '** IAC-DAY-NEXT   - '  VR-IAC-ATL-WS            00145140
145150         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00145150
145160         DISPLAY '**           GILSON 299.3629               **'  00145160
145170         DISPLAY '*********************************************'. 00145170
145180                                                                  00145180
145190     IF  VR-ITAH-ANT-WS EQUAL ZEROS OR                            00145190
145200         VR-ITAH-ATL-WS EQUAL ZEROS                               00145200
145210         MOVE 1 TO SW-ERRO-TBTX                                   00145210
145220         DISPLAY '*********************************************'  00145220
145230         DISPLAY '** P04808 - VALOR DO INDICE DE TITULOS EM  **'  00145230
145240         DISPLAY '**          ATRASO P.JURIDICA ESTAH ZERADO **'  00145240
145250         DISPLAY '** DATA-MOVIMENTO - '  CH-DATA-D07              00145250
145260         DISPLAY '** ITAH-DAY       - '  VR-ITAH-ANT-WS           00145260
145270         DISPLAY '** ITAH-DAY-NEXT  - '  VR-ITAH-ATL-WS           00145270
145280         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00145280
145290         DISPLAY '**           GILSON 299.3629               **'  00145290
145300         DISPLAY '*********************************************'. 00145300
145310                                                                  00145310
145320     IF  VR-ITAF-ANT-WS EQUAL ZEROS OR                            00145320
145330         VR-ITAF-ATL-WS EQUAL ZEROS                               00145330
145340         MOVE 1 TO SW-ERRO-TBTX                                   00145340
145350         DISPLAY '*********************************************'  00145350
145360         DISPLAY '** P04808 - VALOR DO INDICE DE TITULOS EM  **'  00145360
145370         DISPLAY '**          ATRASO P.FISICA   ESTAH ZERADO **'  00145370
145380         DISPLAY '** DATA-MOVIMENTO - '  CH-DATA-D07              00145380
145390         DISPLAY '** ITAH-DAY       - '  VR-ITAF-ANT-WS           00145390
145400         DISPLAY '** ITAH-DAY-NEXT  - '  VR-ITAF-ATL-WS           00145400
145410         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00145410
145420         DISPLAY '**           GILSON 299.3629               **'  00145420
145430         DISPLAY '*********************************************'. 00145430
145440                                                                  00145440
145450     IF  VR-BTNF-DIA-WS EQUAL ZEROS                               00145450
145460         MOVE 1 TO SW-ERRO-TBTX                                   00145460
145470         DISPLAY '*********************************************'  00145470
145480         DISPLAY '** P04808 - VALOR EXTRAMERCADO  ZERADO     **'  00145480
145490         DISPLAY '** DATA-MOVIMENTO - '  CH-DATA-D07              00145490
145500         DISPLAY '** IDER-DAY       - '  VR-BTNF-DIA-WS           00145500
145510         DISPLAY '** IDER-DAY-NEXT  - '  VR-BTNF-NEXT-WS          00145510
145520         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00145520
145530         DISPLAY '**           GILSON 299.3629               **'  00145530
145540         DISPLAY '*********************************************'. 00145540
145550                                                                  00145550
145570     IF  FATOR-JUR-PJ-F1 EQUAL ZEROS                              00145570
145580         MOVE 1 TO SW-ERRO-TBTX                                   00145580
145590         DISPLAY '**********************************************' 00145590
145600         DISPLAY '** P04808 - FATOR DO CHEQUE EMPRESA EH ZERO **' 00145600
145610         DISPLAY '** DATA-MOVIMENTO    '  CH-DATA-D07             00145610
145620         DISPLAY '** FATOR CH.EMPR.F1  '  FATOR-JUR-PJ-F1         00145620
145630         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00145630
145640         DISPLAY '**           GILSON 299.3629               **'  00145640
145650         DISPLAY '**********************************************'.00145650
145660                                                                  00145660
145670     IF  FATOR-JUR-PJ-F2 EQUAL ZEROS                              00145670
145680         MOVE 1 TO SW-ERRO-TBTX                                   00145680
145690         DISPLAY '**********************************************' 00145690
145700         DISPLAY '** P04808 - FATOR DO CHEQUE EMPRESA EH ZERO **' 00145700
145710         DISPLAY '** DATA-MOVIMENTO    '  CH-DATA-D07             00145710
145720         DISPLAY '** FATOR CH.EMPR.F2  '  FATOR-JUR-PJ-F2         00145720
145730         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00145730
145740         DISPLAY '**           GILSON 299.3629               **'  00145740
145750         DISPLAY '**********************************************'.00145750
145760                                                                  00145760
145770     IF  FATOR-JUR-PJ-F3 EQUAL ZEROS                              00145770
145780         MOVE 1 TO SW-ERRO-TBTX                                   00145780
145790         DISPLAY '**********************************************' 00145790
145800         DISPLAY '** P04808 - FATOR DO CHEQUE EMPRESA EH ZERO **' 00145800
145810         DISPLAY '** DATA-MOVIMENTO    '  CH-DATA-D07             00145810
145820         DISPLAY '** FATOR CH.EMPR.F3  '  FATOR-JUR-PJ-F3         00145820
145830         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00145830
145840         DISPLAY '**           GILSON 299.3629               **'  00145840
145850         DISPLAY '*********************************************'. 00145850
145860                                                                  00145860
145870     IF  FATOR-JUR-PJ-F4 EQUAL ZEROS                              00145870
145880         MOVE 1 TO SW-ERRO-TBTX                                   00145880
145890         DISPLAY '**********************************************' 00145890
145900         DISPLAY '** P04808 - FATOR DO CHEQUE EMPRESA EH ZERO **' 00145900
145910         DISPLAY '** DATA-MOVIMENTO    '  CH-DATA-D07             00145910
145920         DISPLAY '** FATOR CH.EMPR.F4  '  FATOR-JUR-PJ-F4         00145920
145930         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS    **' 00145930
145940         DISPLAY '**           GILSON 299.3629                **' 00145940
145950         DISPLAY '**********************************************'.00145950
145960                                                                  00145960
145980     IF  FATOR-JUR-PJ-PP-F1 EQUAL ZEROS                           00145980
145990         MOVE 1 TO SW-ERRO-TBTX                                   00145990
146000         DISPLAY '**********************************************' 00146000
146010         DISPLAY '** P04808 - FATOR DO CHEQUE EMPRESA EH ZERO **' 00146010
146020         DISPLAY '** DATA-MOVIMENTO       '  CH-DATA-D07          00146020
146030         DISPLAY '** FATOR CH.EMPR.PP F1  '  FATOR-JUR-PJ-PP-F1   00146030
146040         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00146040
146050         DISPLAY '**           GILSON 299.3629               **'  00146050
146060         DISPLAY '**********************************************'.00146060
146070                                                                  00146070
146080     IF  FATOR-JUR-PJ-PP-F2 EQUAL ZEROS                           00146080
146090         MOVE 1 TO SW-ERRO-TBTX                                   00146090
146100         DISPLAY '**********************************************' 00146100
146110         DISPLAY '** P04808 - FATOR DO CHEQUE EMPRESA EH ZERO **' 00146110
146120         DISPLAY '** DATA-MOVIMENTO       '  CH-DATA-D07          00146120
146130         DISPLAY '** FATOR CH.EMPR.PP F2  '  FATOR-JUR-PJ-PP-F2   00146130
146140         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00146140
146150         DISPLAY '**           GILSON 299.3629               **'  00146150
146160         DISPLAY '**********************************************'.00146160
146170                                                                  00146170
146180     IF  FATOR-JUR-PJ-PP-F3 EQUAL ZEROS                           00146180
146190         MOVE 1 TO SW-ERRO-TBTX                                   00146190
146200         DISPLAY '**********************************************' 00146200
146210         DISPLAY '** P04808 - FATOR DO CHEQUE EMPRESA EH ZERO **' 00146210
146220         DISPLAY '** DATA-MOVIMENTO       '  CH-DATA-D07          00146220
146230         DISPLAY '** FATOR CH.EMPR.PP F3  '  FATOR-JUR-PJ-PP-F3   00146230
146240         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00146240
146250         DISPLAY '**           GILSON 299.3629               **'  00146250
146260         DISPLAY '*********************************************'. 00146260
146270                                                                  00146270
146280     IF  FATOR-JUR-PJ-PP-F4 EQUAL ZEROS                           00146280
146290         MOVE 1 TO SW-ERRO-TBTX                                   00146290
146300         DISPLAY '**********************************************' 00146300
146310         DISPLAY '** P04808 - FATOR DO CHEQUE EMPRESA EH ZERO **' 00146310
146320         DISPLAY '** DATA-MOVIMENTO       '  CH-DATA-D07          00146320
146330         DISPLAY '** FATOR CH.EMPR.PP F4  '  FATOR-JUR-PJ-PP-F4   00146330
146340         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS    **' 00146340
146350         DISPLAY '**           GILSON 299.3629                **' 00146350
146360         DISPLAY '**********************************************'.00146360
146370                                                                  00146370
146380     IF  FATOR-JUR-PF-F1 EQUAL ZEROS                              00146380
146390         MOVE 1 TO SW-ERRO-TBTX                                   00146390
146400         DISPLAY '**********************************************' 00146400
146410         DISPLAY '** P04808 - FATOR DO CH.ESPECIAL ESTAH ZERADO*' 00146410
146420         DISPLAY '** DATA-MOVIMENTO    '  CH-DATA-D07             00146420
146430         DISPLAY '** FATOR CH.ESPECIAL '  FATOR-JUR-PF-F1         00146430
146440         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00146440
146450         DISPLAY '**           GILSON 299.3629               **'  00146450
146460         DISPLAY '*********************************************'. 00146460
146470                                                                  00146470
146480     IF  FATOR-JUR-PF-F2 EQUAL ZEROS                              00146480
146490         MOVE 1 TO SW-ERRO-TBTX                                   00146490
146500         DISPLAY '**********************************************' 00146500
146510         DISPLAY '** P04808 - FATOR DO CH.ESPECIAL ESTAH ZERADO*' 00146510
146520         DISPLAY '** DATA-MOVIMENTO    '  CH-DATA-D07             00146520
146530         DISPLAY '** FATOR CH.ESPECIAL '  FATOR-JUR-PF-F2         00146530
146540         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS    **' 00146540
146550         DISPLAY '**           GILSON 299.3629                **' 00146550
146560         DISPLAY '**********************************************'.00146560
146570                                                                  00146570
146580     IF  FATOR-JUR-PF-F3 EQUAL ZEROS                              00146580
146590         MOVE 1 TO SW-ERRO-TBTX                                   00146590
146600         DISPLAY '**********************************************' 00146600
146610         DISPLAY '** P04808 - FATOR DO CH.ESPECIAL ESTAH ZERADO*' 00146610
146620         DISPLAY '** DATA-MOVIMENTO    '  CH-DATA-D07             00146620
146630         DISPLAY '** FATOR CH.ESPECIAL '  FATOR-JUR-PF-F3-WS      00146630
146640         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00146640
146650         DISPLAY '**           GILSON 299.3629               **'  00146650
146660         DISPLAY '*********************************************'. 00146660
146670                                                                  00146670
146680     IF  FATOR-JUR-PF-F4 EQUAL ZEROS                              00146680
146690         MOVE 1 TO SW-ERRO-TBTX                                   00146690
146700         DISPLAY '**********************************************' 00146700
146710         DISPLAY '** P04808 - FATOR DO CH.ESPECIAL ESTAH ZERADO*' 00146710
146720         DISPLAY '** DATA-MOVIMENTO    '  CH-DATA-D07             00146720
146730         DISPLAY '** FATOR CH.ESPECIAL '  FATOR-JUR-PF-F4         00146730
146740         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS    **' 00146740
146750         DISPLAY '**           GILSON 299.3629                **' 00146750
146760         DISPLAY '**********************************************'.00146760
146770                                                                  00146770
146780     IF  FATOR-JUR-PF-F5 EQUAL ZEROS                              00146780
146790         MOVE 1 TO SW-ERRO-TBTX                                   00146790
146800         DISPLAY '**********************************************' 00146800
146810         DISPLAY '** P04808 - FATOR DO CH.ESPECIAL ESTAH ZERADO*' 00146810
146820         DISPLAY '** DATA-MOVIMENTO    '  CH-DATA-D07             00146820
146830         DISPLAY '** FATOR CH.ESPECIAL '  FATOR-JUR-PF-F5         00146830
146840         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00146840
146850         DISPLAY '**           GILSON 299.3629               **'  00146850
146860         DISPLAY '**********************************************'.00146860
146870                                                                  00146870
146880     IF  FATOR-JUR-CE-WS EQUAL ZEROS                              00146880
146890         MOVE 1 TO SW-ERRO-TBTX                                   00146890
146900         DISPLAY '**********************************************' 00146900
146910         DISPLAY '** P04808 - FATOR DA CTA EMPRESARIAL EH ZERO *' 00146910
146920         DISPLAY '** DATA-MOVIMENTO    '  CH-DATA-D07             00146920
146930         DISPLAY '** FATOR CTA-EMPRESA '  FATOR-JUR-CE-WS         00146930
146940         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS    **' 00146940
146950         DISPLAY '**           GILSON 299.3629                **' 00146950
146960         DISPLAY '**********************************************'.00146960
146970                                                                  00146970
146880     IF  VR-SELIC-ANO-WS EQUAL ZEROS                              00146880
146890         MOVE 1 TO SW-ERRO-TBTX                                   00146890
146900         DISPLAY '**********************************************' 00146900
146910         DISPLAY '** P04808 - FATOR DA SELIC EH ZERO           *' 00146910
146920         DISPLAY '** DATA-MOVIMENTO    '  CH-DATA-D07             00146920
146930         DISPLAY '** FATOR SELIC-ANO   '  VR-SELIC-ANO-WS         00146930
146940         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS    **' 00146940
146950         DISPLAY '**           GILSON 299.3629                **' 00146950
146960         DISPLAY '**********************************************' 00146960
           ELSE
              COMPUTE VR-SELIC-DIA-PREC-WS =
                      ((((VR-SELIC-ANO-WS / 100) + 1) ** (1 / 252)) - 1)

              COMPUTE VR-SELIC-DIA-WS =
                      ((((((VR-SELIC-ANO-WS / 100) + 1) ** (1 / 252))
                                                   - 1) * 98) / 100).

146980     IF  NOT  HOUVE-ERRO-TBTX                                     00146980
               MOVE ZEROS TO FATOR-IAC-PJ-WS
               IF PRM-CALC-TX-IAC1
                  COMPUTE FATOR-IAC-PJ-WS =                             00147140
                       (VR-IAC-ATL-WS / VR-IAC-ANT-WS) - 1              00147150
               END-IF

146990         COMPUTE FATOR-INSUF-PJ-WS =                              00146990
147000                 (VR-IAC-ATL-WS / VR-IAC-ANT-WS) - 1              00147000
147010       IF FATOR-INSUF-PJ-WS LESS ZEROS                            00147010
147020         MOVE 1 TO SW-ERRO-TBTX                                   00147020
147030         DISPLAY '*********************************************'  00147030
147040         DISPLAY '**P04808 - FATOR IAC ESTAH NEGATIVO        **'  00147040
147050         DISPLAY '**DATA-MOVIMENTO - '  CH-DATA-D07               00147050
147060         DISPLAY '**IAC-DAY        - '  VR-IAC-ANT-WS             00147060
147070         DISPLAY '**IAC-DAY-NEXT   - '  VR-IAC-ATL-WS             00147070
147080         DISPLAY '**FATOR-IAC      - '  FATOR-INSUF-PJ-WS         00147080
147090         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'  00147090
147100         DISPLAY '**           GILSON 299.3629               **'  00147100
147110         DISPLAY '*********************************************'. 00147110
147120                                                                  00147120
147130     IF  NOT  HOUVE-ERRO-TBTX                                     00147130
               MOVE ZEROS TO FATOR-IAC-PF-WS
               IF PRM-CALC-TX-IAC1
                  COMPUTE FATOR-IAC-PF-WS =                             00147140
                       (VR-IAC-ATL-WS / VR-IAC-ANT-WS) - 1              00147150
               END-IF

147140         COMPUTE FATOR-INSUF-PF-WS =                              00147140
147150                 (VR-IAC-ATL-WS / VR-IAC-ANT-WS) - 1              00147150
147160       IF FATOR-INSUF-PF-WS LESS ZEROS                            00147160
147170          MOVE 1 TO SW-ERRO-TBTX                                  00147170
147180          DISPLAY '*******************************************'   00147180
147190          DISPLAY '**P04808 - FATOR IAC ESTAH NEGATIVO      **'   00147190
147200          DISPLAY '**DATA-MOVIMENTO - '  CH-DATA-D07              00147200
147210          DISPLAY '**IAC-DAY        - '  VR-IAC-ANT-WS            00147210
147220          DISPLAY '**IAC-DAY-NEXT   - '  VR-IAC-ATL-WS            00147220
147230          DISPLAY '**FATOR-IAC      - '  FATOR-INSUF-PF-WS        00147230
147240          DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'   00147240
147250          DISPLAY '**           GILSON 299.3629             **'   00147250
147260          DISPLAY '*******************************************'.  00147260
147270                                                                  00147270
147280     IF  NOT  HOUVE-ERRO-TBTX                                     00147280
147290         IF FATOR-EXCESSO-CE-WS EQUAL ZEROS                       001472d9
                  IF PRM-CALC-EXCESSO
147310            DISPLAY '*******************************************' 00147310
147320            DISPLAY '**P04808 - FATOR EXCESSO CTA-EMPRESARIAL **' 00147320
147330            DISPLAY '**         ESTAH ZERADO                  **' 00147330
147340            DISPLAY '**DATA-MOVIMENTO - '  CH-DATA-D07            00147340
147350            DISPLAY '**FATOR-CTA-EMPR - '  FATOR-EXCESSO-CE-WS    00147350
147360            DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **' 00147360
147370            DISPLAY '**           GILSON 299.3629             **' 00147370
147380            DISPLAY '*******************************************' 00147380
147390            MOVE ZEROS TO FATOR-EXCESSO-CE-WS.                    00147390
147400                                                                  00147400
147410     IF  NOT  HOUVE-ERRO-TBTX                                     00147410
147420         IF FATOR-EXCESSO-PJ-WS EQUAL ZEROS                       00147420
                  IF PRM-CALC-EXCESSO
147430            DISPLAY '*******************************************' 00147430
147440            DISPLAY '** P04808 - FATOR EXCESSO P.JURIDICA     **' 00147440
147450            DISPLAY '**          ESTAH ZERADO                 **' 00147450
147460            DISPLAY '** DATA-MOVIMENTO    '  CH-DATA-D07          00147460
147470            DISPLAY '** FATOR EXCESSO P.J '  FATOR-EXCESSO-PJ-WS  00147470
147480            DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **' 00147480
147490            DISPLAY '**           GILSON 299.3629             **' 00147490
147500            DISPLAY '*******************************************' 00147500
147510            MOVE ZEROS TO FATOR-EXCESSO-PJ-WS.                    00147510
147520                                                                  00147520
147530     IF  NOT  HOUVE-ERRO-TBTX                                     00147530
147540         IF FATOR-EXCESSO-PF-WS EQUAL ZEROS                       00147540
                  IF PRM-CALC-EXCESSO
147550            DISPLAY '*******************************************' 00147550
147560            DISPLAY '** P04808 - FATOR EXCESSO P.FISICAS      **' 00147560
147570            DISPLAY '**          ESTAH ZERADO                 **' 00147570
147580            DISPLAY '** DATA-MOVIMENTO    '  CH-DATA-D07          00147580
147590            DISPLAY '** FATOR EXCESSO P.F '  FATOR-EXCESSO-PF-WS  00147590
147600            DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **' 00147600
147610            DISPLAY '**           GILSON 299.3629             **' 00147610
147620            DISPLAY '*******************************************' 00147620
147630            MOVE ZEROS TO FATOR-EXCESSO-PF-WS.                    00147630
147640                                                                  00147640
147650     IF  NOT  HOUVE-ERRO-TBTX                                     00147650
147660         COMPUTE FATOR-CM-WS =                                    00147660
147670                 (VR-BTNF-DIA-WS / 100)                           00147670
147680         IF FATOR-CM-WS LESS ZEROS                                00147680
147690            MOVE 1 TO SW-ERRO-TBTX                                00147690
147700            DISPLAY '*******************************************' 00147700
147710            DISPLAY '**P04808 - FATOR DE CORRECAO PARA REIN-  **' 00147710
147720            DISPLAY '**     VESTIMENTO ESTAH NEGATIVO         **' 00147720
147730            DISPLAY '**DATA-MOVIMENTO - '  CH-DATA-D07            00147730
147740            DISPLAY '**EXTRAMERCADO   - '  VR-BTNF-DIA-WS         00147740
147750            DISPLAY '**FATOR CM REINV - '  FATOR-CM-WS            00147750
147760            DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **' 00147760
147770            DISPLAY '**           GILSON 299.3629             **' 00147770
147780            DISPLAY '*******************************************'.00147780
147790                                                                  00147790
147800     IF  HOUVE-ERRO-TBTX                                          00147800
147810         DISPLAY '* P04808 CANCELADO - PROBLEMAS NA TBTX *'       00147810
147820         MOVE COD-RETORNO-WS (4) TO RETURN-CODE                   00147820
147830         DISPLAY 'RETURN CODE EH .. ' COD-RETORNO-WS (4)          00147830
147840         DISPLAY 'MENSAGEM RETORNO EH ' MEN-RETORNO-WS (4)        00147840
147850         GOBACK.                                                  00147850
147860                                                                  00147860
DOCINI****F* P04808/999-38-ACESSA-TAB-SIEF
DOCTXT* OBJETIVO
DOCTXT*   Carregar os indices do SIEF para calculo de encargos de
DOCTXT*   contratos de limites de cheque especial.
DOCTXT*
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*| 27|CHEF                                     | FATOR-JUR-PF-F5        |
DOCTXT*|   |                                         | FATOR-JUR-PF-F5-WS     |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*| 28|FCHE                                     | FATOR-JUR-PJ-F4        |
DOCTXT*|   |                                         | FATOR-JUR-PJ-F4-WS     |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*| 29|FCEM                                     | FATOR-JUR-CE-WS        |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*| 31|ITAF-INDICE DE TIT.EM ATRASO-P.FISICA    | VR-ITAF-ANT-WS         |
DOCTXT*|   |                                         | VR-ITAF-ATL-WS         |
DOCTXT*|   |                                         | VR-ITAF-ONTEM-WS       |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*| 32|ITAH-INDICE DE TIT.EM ATRASO-P.JURIDICA  | VR-ITAH-ANT-WS         |
DOCTXT*|   |                                         | VR-ITAH-ATL-WS         |
DOCTXT*|   |                                         | VR-ITAH-ONTEM-WS       |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*| 50|INDICE DIARIO DA TR DO DIA 01            | BTN-D01-WS             |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*| 57|IOC PESSOA JURIDICA                      | TX-IOC-JURID-D01-WS    |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*| 58|IOC PARA PESSOA FISICA                   | TX-IOC-FISICA-D01-WS   |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|112|EXCESSO CHEQUE ESPECIAL-PF               | FATOR-EXCESSO-PF-WS    |
DOCTXT*|   |CONTAS CORRENTE                          | FATOR-EXCESSO-PF-ANT-WS|
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|113|EXCESSO CHEQUE ESPECIAL PJ               | FATOR-EXCESSO-CE-WS    |
DOCTXT*|   |CONTAS CORRENTES                         | FATOR-EXCESSO-PJ-WS    |
DOCTXT*|   |                                         | FATOR-EXCESSO-CE-ANT-WS|
DOCTXT*|   |                                         | FATOR-EXCESSO-PJ-ANT-WS|
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|121|IAC1-INDICE DE ATRASO DE CREDITO         | VR-IAC-ANT-WS          |
DOCTXT*|   |CORRIGIR ALTERNATIVAMENTE CONTRATOS EM   | VR-IAC-ATL-WS          |
DOCTXT*|   |ATRASO                                   | VR-IAC-ONTEM-WS        |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|149|TAXA SELIC (% A.A.)                      | VR-SELIC-ANO-WS        |
DOCTXT*|   |NOVA FORMA DE DIVULGA??O-PARA            |                        |
DOCTXT*|   |CALCULAR REFERENCIAL                     |                        |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|158|FATOR CHEQUE ESPECIAL PF LIMITE 30% FUNC | FATOR-JUR-PF-F1        |
DOCTXT*|   |FATOR PARA JURO CHEQUE ESPECIAL PF       | FATOR-JUR-PF-F1-WS     |
DOCTXT*|   |LIMITE 30%                               |                        |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|161|FATOR CHEQUE ESPECIAL PF LIMITE 30% DEMA | FATOR-JUR-PF-F2        |
DOCTXT*|   |FATOR JURO CHEQUE ESPECIAL PF            | FATOR-JUR-PF-F2-WS     |
DOCTXT*|   |LIMITE 30% DEMAIS                        |                        |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|167|FATOR CHEQUE ESPECIAL PJ LIMITE 30%      | FATOR-JUR-PJ-F1        |
DOCTXT*|   |FATOR JURO CHEQUE ESPECIAL               | FATOR-JUR-PJ-F1-WS     |
DOCTXT*|   |PJ LIMITE 30%                            |                        |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|169|FATOR CHEQUE ESPECIAL PJ LIMITE 50%      | FATOR-JUR-PJ-F2        |
DOCTXT*|   |                                         | FATOR-JUR-PJ-F2-WS     |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|171|FATOR CHEQUE ESPECIAL PJ LIMITE 80%      | FATOR-JUR-PJ-F3        |
DOCTXT*|   |                                         | FATOR-JUR-PJ-F3-WS     |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|176|IOC PJ OPTANTE SIMPLES AT  30 MIL        | TX-IOC-SIMPLES-WS      |
DOCTXT*|   |ALIQUOTA DE IOF P/EMPRESTIMOS ATE        |                        |
DOCTXT*|   |R$ 30 MIL PJ                             |                        |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|189|TAXA EXTRAMERCADO                        | VR-BTNF-DIA-WS         |
DOCTXT*|   |CALCULO DA REMUNARACAO DAS               |                        |
DOCTXT*|   |DISPONILIDADES DO FNE                    |                        |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|190|PERCENTUAL LIBERACAO RECEBIVEIS          |PERCENTUAL-RECEBIVEIS-WS|
DOCTXT*|   |PERCREC   PERCENTUAL LIMITE DE LIBERACAO |                        |
DOCTXT*|   |DOS RECEBIVEIS                           |                        |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|272|CHEQUE EMPRESA LIMITE 30% - PROJ PILOTO  | FATOR-JUR-PJ-PP-F1     |
DOCTXT*|   |FATOR CHEQUE EMPRESA PROJETO PILOTO      | FATOR-JUR-PJ-PP-F1-WS  |
DOCTXT*+---+-----------------------------------------+                        |
DOCTXT*|273|CHEQUE EMPRESA LIMITE 50% - PROJ PILOTO  | FATOR-JUR-PJ-PP-F2     |
DOCTXT*|   |FATOR CHEQUE EMPRESA PROJETO PILOTO      | FATOR-JUR-PJ-PP-F2-WS  |
DOCTXT*+---+-----------------------------------------+                        |
DOCTXT*|274|CHEQUE EMPRESA LIMITE 80% - PROJ PILOTO  | FATOR-JUR-PJ-PP-F3     |
DOCTXT*|   |FATOR CHEQUE EMPRESA PROJETO PILOTO      | FATOR-JUR-PJ-PP-F3-WS  |
DOCTXT*+---+-----------------------------------------+                        |
DOCTXT*|275|CHEQUE EMPRESA LIMITE 100% - PROJ PILOTO | FATOR-JUR-PJ-PP-F4     |
DOCTXT*|   |FATOR CHEQUE EMPRESA PROJETO PILOTO      | FATOR-JUR-PJ-PP-F4-WS  |
DOCTXT*+---+-----------------------------------------+                        |
DOCTXT*|290|CH.ESPECIAL P/APLICADORES BNB - PF       | FATOR-JUR-PF-F3        |
DOCTXT*|   |TAXA CH.ESPECIAL REDUZIDA                | FATOR-JUR-PF-F3-WS     |
DOCTXT*|   |P/APLICADORES BNB                        |                        |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCTXT*|305|CH.ESPECIAL P/APLICADORES ACIMA 50 MIL   | FATOR-JUR-PF-F4        |
DOCTXT*|   |TAXA CH.ESPEC.REDUZIDA P/APLICADORES     | FATOR-JUR-PF-F4-WS     |
DOCTXT*|   |ACIMA 50 MIL                             |                        |
DOCTXT*+---+-----------------------------------------+------------------------+
DOCEND******
147870 999-38-ACESSA-TAB-SIEF.                                          00147870
147880                                                                  00147880
147890     MOVE 6922,450000 TO OTNF-ANT-WS.                             00147890
147900     MOVE 6922,460000 TO OTNF-ATL-WS.                             00147900
147910     MOVE ZEROS       TO VR-BTN-WS.                               00147910
147920     MOVE   58,0000   TO TX-JUROS-INSUF-D01-WS.                   00147920
147930     MOVE 2266,17     TO MVR-D01-WS.                              00147930
147940     MOVE    6,17     TO OTN-D01-WS.                              00147940
147950                                                                  00147950
147960     MOVE 048             TO W09508-CD-SIS-SLT.                   00147960
147970     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00147970
147980     MOVE 190             TO W09508-CD-ID-ECF.                    00147980
147990     MOVE '31/12/9999'    TO W09508-DT-REF-CNS.                   00147990
148000     CALL 'P09511' USING W09508-AREA-SIEF.                        00148000
148010     IF W09508-CD-RET-ROT = '**'                                  00148010
148020        IF W09508-CD-TP-ID EQUAL 2                                00148020
148030           MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                  00148030
148040           COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /  00148040
148050                                              DIV-SIEF-WS         00148050
148060           MOVE W09508-VR-ID-ECF TO PERCENTUAL-RECEBIVEIS-WS      00148060
148070        ELSE                                                      00148070
148080           MOVE W09508-VR-ID-ECF TO PERCENTUAL-RECEBIVEIS-WS      00148080
148090     ELSE                                                         00148090
148100        MOVE '**  P4808 ERRO ACESSO TABELA SIEF 3 **'             00148100
148110              TO MENSAGEM-ERRO-WS                                 00148110
148120        DISPLAY W09508-CD-ID-ECF                                  00148120
148130        DISPLAY W09508-DT-REF-CNS                                 00148130
148140        DISPLAY W09508-CD-RET-ROT                                 00148140
148150        DISPLAY W09508-DE-MSG-RET                                 00148150
148160        DISPLAY W09508-SQLCODE                                    00148160
148170        PERFORM 999-99-ROT-ERRO.                                  00148170
148180                                                                  00148180
148190     MOVE 048             TO W09508-CD-SIS-SLT.                   00148190
148200     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00148200
148210     MOVE 50              TO W09508-CD-ID-ECF.                    00148210
148220     MOVE '31/12/9999'    TO W09508-DT-REF-CNS.                   00148220
148230     CALL 'P09511' USING W09508-AREA-SIEF.                        00148230
148240     IF W09508-CD-RET-ROT = '**'                                  00148240
148250        IF W09508-CD-TP-ID EQUAL 2                                00148250
148260           MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                  00148260
148270           COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /  00148270
148280                                              DIV-SIEF-WS         00148280
148290           MOVE W09508-VR-ID-ECF TO BTN-D01-WS                    00148290
148300        ELSE                                                      00148300
148310           MOVE W09508-VR-ID-ECF TO BTN-D01-WS                    00148310
148320     ELSE                                                         00148320
148330        MOVE '** P04808 ERRO ACESSO TABELA SIEF 4 **'             00148330
148340              TO MENSAGEM-ERRO-WS                                 00148340
148350        DISPLAY W09508-CD-ID-ECF                                  00148350
148360        DISPLAY W09508-DT-REF-CNS                                 00148360
148370        DISPLAY W09508-CD-RET-ROT                                 00148370
148380        DISPLAY W09508-DE-MSG-RET                                 00148380
148390        DISPLAY W09508-SQLCODE                                    00148390
148400        PERFORM 999-99-ROT-ERRO.                                  00148400
148410                                                                  00148410
148420     MOVE 048             TO W09508-CD-SIS-SLT.                   00148420
148430     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00148430
148440     MOVE 58              TO W09508-CD-ID-ECF.                    00148440
148450     MOVE '31/12/9999'    TO W09508-DT-REF-CNS.                   00148450
148460     CALL 'P09511' USING W09508-AREA-SIEF.                        00148460
148470     IF W09508-CD-RET-ROT = '**'                                  00148470
148480        IF W09508-CD-TP-ID EQUAL 2                                00148480
148490           MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                  00148490
148500           COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /  00148500
148510                                              DIV-SIEF-WS         00148510
148520           MOVE W09508-VR-ID-ECF TO TX-IOC-FISICA-D01-WS          00148520
148530        ELSE                                                      00148530
148540           MOVE W09508-VR-ID-ECF TO TX-IOC-FISICA-D01-WS          00148540
148550     ELSE                                                         00148550
148560        MOVE '** P04808 ERRO ACESSO TABELA SIEF 5 **'             00148560
148570              TO MENSAGEM-ERRO-WS                                 00148570
148580        DISPLAY W09508-CD-ID-ECF                                  00148580
148590        DISPLAY W09508-DT-REF-CNS                                 00148590
148600        DISPLAY W09508-CD-RET-ROT                                 00148600
148610        DISPLAY W09508-DE-MSG-RET                                 00148610
148620        DISPLAY W09508-SQLCODE                                    00148620
148630        PERFORM 999-99-ROT-ERRO.                                  00148630
148640                                                                  00148640
148650     MOVE 048             TO W09508-CD-SIS-SLT.                   00148650
148660     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00148660
148670     MOVE 57              TO W09508-CD-ID-ECF.                    00148670
148680     MOVE '31/12/9999'    TO W09508-DT-REF-CNS.                   00148680
148690     CALL 'P09511' USING W09508-AREA-SIEF.                        00148690
148700     IF W09508-CD-RET-ROT = '**'                                  00148700
148710        IF W09508-CD-TP-ID EQUAL 2                                00148710
148720           MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                  00148720
148730           COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /  00148730
148740                                              DIV-SIEF-WS         00148740
148750           MOVE W09508-VR-ID-ECF TO TX-IOC-JURID-D01-WS           00148750
148760        ELSE                                                      00148760
148770           MOVE W09508-VR-ID-ECF TO TX-IOC-JURID-D01-WS           00148770
148780     ELSE                                                         00148780
148790        MOVE '** P04808 ERRO ACESSO TABELA SIEF 6 **'             00148790
148800              TO MENSAGEM-ERRO-WS                                 00148800
148810        DISPLAY W09508-CD-ID-ECF                                  00148810
148820        DISPLAY W09508-DT-REF-CNS                                 00148820
148830        DISPLAY W09508-CD-RET-ROT                                 00148830
148840        DISPLAY W09508-DE-MSG-RET                                 00148840
148850        DISPLAY W09508-SQLCODE                                    00148850
148860        PERFORM 999-99-ROT-ERRO.                                  00148860
148870                                                                  00148870
148880     MOVE 048             TO W09508-CD-SIS-SLT.                   00148880
148890     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00148890
148900     MOVE 176             TO W09508-CD-ID-ECF.                    00148900
148910     MOVE '31/12/9999'    TO W09508-DT-REF-CNS.                   00148910
148920     CALL 'P09511' USING W09508-AREA-SIEF.                        00148920
148930     IF W09508-CD-RET-ROT = '**'                                  00148930
148940        IF W09508-CD-TP-ID EQUAL 2                                00148940
148950           MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                  00148950
148960           COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /  00148960
148970                                              DIV-SIEF-WS         00148970
148980           MOVE W09508-VR-ID-ECF TO TX-IOC-SIMPLES-WS             00148980
148990        ELSE                                                      00148990
149000           MOVE W09508-VR-ID-ECF TO TX-IOC-SIMPLES-WS             00149000
149010     ELSE                                                         00149010
149020        MOVE '** P04808 ERRO ACESSO TABELA SIEF 7 **'             00149020
149030              TO MENSAGEM-ERRO-WS                                 00149030
149040        DISPLAY W09508-CD-ID-ECF                                  00149040
149050        DISPLAY W09508-DT-REF-CNS                                 00149050
149060        DISPLAY W09508-CD-RET-ROT                                 00149060
149070        DISPLAY W09508-DE-MSG-RET                                 00149070
149080        DISPLAY W09508-SQLCODE                                    00149080
149090        PERFORM 999-99-ROT-ERRO.                                  00149090
149100                                                                  00149100
149110     MOVE CH-DATA-D07     TO DATA-D07-RED-WS.                     00149110
149120     MOVE DIA-D07-WS      TO DIA-SIEF-WS.                         00149120
149130     MOVE MES-D07-WS      TO MES-SIEF-WS.                         00149130
149140     CALL 'M0952000' USING ANO-D07-WS ANO-SIEF-WS.                00149140
149150                                                                  00149150
           MOVE DIA-SIEF-WS         TO W091CL-DD-INFOR-1.
           MOVE MES-SIEF-WS         TO W091CL-MM-INFOR-1.
           MOVE ANO-SIEF-WS         TO W091CL-AA-INFOR-1.
149160                                                                  00149160
149170*--- NOVOS INDICES CH.EMPRESA --------                            00149170
149180                                                                  00149180
149190     MOVE 048             TO W09508-CD-SIS-SLT.                   00149190
149200     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00149200
149210     MOVE 167             TO W09508-CD-ID-ECF.                    00149210
149220     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00149220
149230     CALL 'P09511' USING W09508-AREA-SIEF.                        00149230
149240     IF W09508-CD-RET-ROT = '**'                                  00149240
149250      IF W09508-CD-TP-ID EQUAL 2                                  00149250
149260         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00149260
149270         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00149270
149280                                            DIV-SIEF-WS           00149280
149290         COMPUTE FATOR-JUR-PJ-F1 ROUNDED = W09508-VR-ID-ECF / 100 00149290
149300      ELSE                                                        00149300
149310         COMPUTE FATOR-JUR-PJ-F1 ROUNDED = W09508-VR-ID-ECF / 100 00149310
149320     ELSE                                                         00149320
149330        MOVE '** P04808 ERRO ACESSO TABELA SIEF 8 **'             00149330
149340              TO MENSAGEM-ERRO-WS                                 00149340
149350        DISPLAY W09508-CD-ID-ECF                                  00149350
149360        DISPLAY W09508-DT-REF-CNS                                 00149360
149370        DISPLAY W09508-CD-RET-ROT                                 00149370
149380        DISPLAY W09508-DE-MSG-RET                                 00149380
149390        DISPLAY W09508-SQLCODE                                    00149390
149400        PERFORM 999-99-ROT-ERRO.                                  00149400
149410                                                                  00149410
149420     MOVE 048             TO W09508-CD-SIS-SLT.                   00149420
149430     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00149430
149440     MOVE 169             TO W09508-CD-ID-ECF.                    00149440
149450     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00149450
149460     CALL 'P09511' USING W09508-AREA-SIEF.                        00149460
149470     IF W09508-CD-RET-ROT = '**'                                  00149470
149480      IF W09508-CD-TP-ID EQUAL 2                                  00149480
149490         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00149490
149500         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00149500
149510                                            DIV-SIEF-WS           00149510
149520         COMPUTE FATOR-JUR-PJ-F2 ROUNDED = W09508-VR-ID-ECF / 100 00149520
149530      ELSE                                                        00149530
149540         COMPUTE FATOR-JUR-PJ-F2 ROUNDED = W09508-VR-ID-ECF / 100 00149540
149550     ELSE                                                         00149550
149560        MOVE '** P04808 ERRO ACESSO TABELA SIEF 10 **'            00149560
149570              TO MENSAGEM-ERRO-WS                                 00149570
149580        DISPLAY W09508-CD-ID-ECF                                  00149580
149590        DISPLAY W09508-DT-REF-CNS                                 00149590
149600        DISPLAY W09508-CD-RET-ROT                                 00149600
149610        DISPLAY W09508-DE-MSG-RET                                 00149610
149620        DISPLAY W09508-SQLCODE                                    00149620
149630        PERFORM 999-99-ROT-ERRO.                                  00149630
149640                                                                  00149640
149650     MOVE 048             TO W09508-CD-SIS-SLT.                   00149650
149660     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00149660
149670     MOVE 171             TO W09508-CD-ID-ECF.                    00149670
149680     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00149680
149690     CALL 'P09511' USING W09508-AREA-SIEF.                        00149690
149700     IF W09508-CD-RET-ROT = '**'                                  00149700
149710      IF W09508-CD-TP-ID EQUAL 2                                  00149710
149720         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00149720
149730         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00149730
149740                                            DIV-SIEF-WS           00149740
149750         COMPUTE FATOR-JUR-PJ-F3 ROUNDED = W09508-VR-ID-ECF / 100 00149750
149760      ELSE                                                        00149760
149770         COMPUTE FATOR-JUR-PJ-F3 ROUNDED = W09508-VR-ID-ECF / 100 00149770
149780     ELSE                                                         00149780
149790        MOVE '** P04808 ERRO ACESSO TABELA SIEF 12 **'            00149790
149800              TO MENSAGEM-ERRO-WS                                 00149800
149810        DISPLAY W09508-CD-ID-ECF                                  00149810
149820        DISPLAY W09508-DT-REF-CNS                                 00149820
149830        DISPLAY W09508-CD-RET-ROT                                 00149830
149840        DISPLAY W09508-DE-MSG-RET                                 00149840
149850        DISPLAY W09508-SQLCODE                                    00149850
149860        PERFORM 999-99-ROT-ERRO.                                  00149860
149870                                                                  00149870
149890     MOVE 048             TO W09508-CD-SIS-SLT.                   00149890
149900     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00149900
149910     MOVE 28              TO W09508-CD-ID-ECF.                    00149910
149920     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00149920
149930     CALL 'P09511' USING W09508-AREA-SIEF.                        00149930
149940     IF W09508-CD-RET-ROT = '**'                                  00149940
149950      IF W09508-CD-TP-ID EQUAL 2                                  00149950
149960         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00149960
149970         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00149970
149980                                            DIV-SIEF-WS           00149980
149990         COMPUTE FATOR-JUR-PJ-F4 ROUNDED = W09508-VR-ID-ECF / 100 00149990
150000      ELSE                                                        00150000
150010         COMPUTE FATOR-JUR-PJ-F4 ROUNDED = W09508-VR-ID-ECF / 100 00150010
150020     ELSE                                                         00150020
150030        MOVE '** P04808 ERRO ACESSO TABELA SIEF 14 **'            00150030
150040              TO MENSAGEM-ERRO-WS                                 00150040
150050        DISPLAY W09508-CD-ID-ECF                                  00150050
150060        DISPLAY W09508-DT-REF-CNS                                 00150060
150070        DISPLAY W09508-CD-RET-ROT                                 00150070
150080        DISPLAY W09508-DE-MSG-RET                                 00150080
150090        DISPLAY W09508-SQLCODE                                    00150090
150100        PERFORM 999-99-ROT-ERRO.                                  00150100
150110                                                                  00150110
150120*--- NOVOS INDICES CH.EMPRESA - PROJETO PILOTO --------           00150120
150130                                                                  00150130
150140     MOVE 048             TO W09508-CD-SIS-SLT.                   00150140
150150     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00150150
150160     MOVE 272             TO W09508-CD-ID-ECF.                    00150160
150170     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00150170
150180     CALL 'P09511' USING W09508-AREA-SIEF.                        00150180
150190     IF W09508-CD-RET-ROT = '**'                                  00150190
150200      IF W09508-CD-TP-ID EQUAL 2                                  00150200
150210       MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                      00150210
150220       COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /      00150220
150230                                          DIV-SIEF-WS             00150230
150240       COMPUTE FATOR-JUR-PJ-PP-F1 ROUNDED = W09508-VR-ID-ECF / 10000150240
150250      ELSE                                                        00150250
150260       COMPUTE FATOR-JUR-PJ-PP-F1 ROUNDED = W09508-VR-ID-ECF / 10000150260
150270     ELSE                                                         00150270
150280        MOVE '** P04808 ERRO ACESSO TABELA SIEF 16 **'            00150280
150290              TO MENSAGEM-ERRO-WS                                 00150290
150300        DISPLAY W09508-CD-ID-ECF                                  00150300
150310        DISPLAY W09508-DT-REF-CNS                                 00150310
150320        DISPLAY W09508-CD-RET-ROT                                 00150320
150330        DISPLAY W09508-DE-MSG-RET                                 00150330
150340        DISPLAY W09508-SQLCODE                                    00150340
150350        PERFORM 999-99-ROT-ERRO.                                  00150350
150360                                                                  00150360
150370     MOVE 048             TO W09508-CD-SIS-SLT.                   00150370
150380     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00150380
150390     MOVE 273             TO W09508-CD-ID-ECF.                    00150390
150400     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00150400
150410     CALL 'P09511' USING W09508-AREA-SIEF.                        00150410
150420     IF W09508-CD-RET-ROT = '**'                                  00150420
150430      IF W09508-CD-TP-ID EQUAL 2                                  00150430
150440       MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                      00150440
150450       COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /      00150450
150460                                          DIV-SIEF-WS             00150460
150470       COMPUTE FATOR-JUR-PJ-PP-F2 ROUNDED = W09508-VR-ID-ECF / 10000150470
150480      ELSE                                                        00150480
150490       COMPUTE FATOR-JUR-PJ-PP-F2 ROUNDED = W09508-VR-ID-ECF / 10000150490
150500     ELSE                                                         00150500
150510        MOVE '** P04808 ERRO ACESSO TABELA SIEF 18 **'            00150510
150520              TO MENSAGEM-ERRO-WS                                 00150520
150530        DISPLAY W09508-CD-ID-ECF                                  00150530
150540        DISPLAY W09508-DT-REF-CNS                                 00150540
150550        DISPLAY W09508-CD-RET-ROT                                 00150550
150560        DISPLAY W09508-DE-MSG-RET                                 00150560
150570        DISPLAY W09508-SQLCODE                                    00150570
150580        PERFORM 999-99-ROT-ERRO.                                  00150580
150590                                                                  00150590
150600     MOVE 048             TO W09508-CD-SIS-SLT.                   00150600
150610     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00150610
150620     MOVE 274             TO W09508-CD-ID-ECF.                    00150620
150630     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00150630
150640     CALL 'P09511' USING W09508-AREA-SIEF.                        00150640
150650     IF W09508-CD-RET-ROT = '**'                                  00150650
150660      IF W09508-CD-TP-ID EQUAL 2                                  00150660
150670       MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                      00150670
150680       COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /      00150680
150690                                          DIV-SIEF-WS             00150690
150700       COMPUTE FATOR-JUR-PJ-PP-F3 ROUNDED = W09508-VR-ID-ECF / 10000150700
150710      ELSE                                                        00150710
150720       COMPUTE FATOR-JUR-PJ-PP-F3 ROUNDED = W09508-VR-ID-ECF / 10000150720
150730     ELSE                                                         00150730
150740        MOVE '** P04808 ERRO ACESSO TABELA SIEF 20 **'            00150740
150750              TO MENSAGEM-ERRO-WS                                 00150750
150760        DISPLAY W09508-CD-ID-ECF                                  00150760
150770        DISPLAY W09508-DT-REF-CNS                                 00150770
150780        DISPLAY W09508-CD-RET-ROT                                 00150780
150790        DISPLAY W09508-DE-MSG-RET                                 00150790
150800        DISPLAY W09508-SQLCODE                                    00150800
150810        PERFORM 999-99-ROT-ERRO.                                  00150810
150820                                                                  00150820
150840     MOVE 048             TO W09508-CD-SIS-SLT.                   00150840
150850     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00150850
150860     MOVE 275             TO W09508-CD-ID-ECF.                    00150860
150870     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00150870
150880     CALL 'P09511' USING W09508-AREA-SIEF.                        00150880
150890     IF W09508-CD-RET-ROT = '**'                                  00150890
150900      IF W09508-CD-TP-ID EQUAL 2                                  00150900
150910       MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                      00150910
150920       COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /      00150920
150930                                          DIV-SIEF-WS             00150930
150940       COMPUTE FATOR-JUR-PJ-PP-F4 ROUNDED = W09508-VR-ID-ECF / 10000150940
150950      ELSE                                                        00150950
150960       COMPUTE FATOR-JUR-PJ-PP-F4 ROUNDED = W09508-VR-ID-ECF / 10000150960
150970     ELSE                                                         00150970
150980        MOVE '** P04808 ERRO ACESSO TABELA SIEF 22 **'            00150980
150990              TO MENSAGEM-ERRO-WS                                 00150990
151000        DISPLAY W09508-CD-ID-ECF                                  00151000
151010        DISPLAY W09508-DT-REF-CNS                                 00151010
151020        DISPLAY W09508-CD-RET-ROT                                 00151020
151030        DISPLAY W09508-DE-MSG-RET                                 00151030
151040        DISPLAY W09508-SQLCODE                                    00151040
151050        PERFORM 999-99-ROT-ERRO.                                  00151050
151060                                                                  00151060
151070*--- NOVOS INDICES CH.ESPECIAL --------                           00151070
151080                                                                  00151080
151090     MOVE 048             TO W09508-CD-SIS-SLT.                   00151090
151100     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00151100
151110     MOVE 158             TO W09508-CD-ID-ECF.                    00151110
151120     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00151120
151130     CALL 'P09511' USING W09508-AREA-SIEF.                        00151130
151140     IF W09508-CD-RET-ROT = '**'                                  00151140
151150      IF W09508-CD-TP-ID EQUAL 2                                  00151150
151160         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00151160
151170         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00151170
151180                                            DIV-SIEF-WS           00151180
151190         COMPUTE FATOR-JUR-PF-F1 ROUNDED = W09508-VR-ID-ECF / 100 00151190
151200      ELSE                                                        00151200
151210         COMPUTE FATOR-JUR-PF-F1 ROUNDED = W09508-VR-ID-ECF / 100 00151210
151220     ELSE                                                         00151220
151230        MOVE '** P04808 ERRO ACESSO TABELA SIEF 24 **'            00151230
151240              TO MENSAGEM-ERRO-WS                                 00151240
151250        DISPLAY W09508-CD-ID-ECF                                  00151250
151260        DISPLAY W09508-DT-REF-CNS                                 00151260
151270        DISPLAY W09508-CD-RET-ROT                                 00151270
151280        DISPLAY W09508-DE-MSG-RET                                 00151280
151290        DISPLAY W09508-SQLCODE                                    00151290
151300        PERFORM 999-99-ROT-ERRO.                                  00151300
151310                                                                  00151310
151320     MOVE 048             TO W09508-CD-SIS-SLT.                   00151320
151330     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00151330
151340     MOVE 161             TO W09508-CD-ID-ECF.                    00151340
151350     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00151350
151360     CALL 'P09511' USING W09508-AREA-SIEF.                        00151360
151370     IF W09508-CD-RET-ROT = '**'                                  00151370
151380      IF W09508-CD-TP-ID EQUAL 2                                  00151380
151390         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00151390
151400         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00151400
151410                                            DIV-SIEF-WS           00151410
151420         COMPUTE FATOR-JUR-PF-F2 ROUNDED = W09508-VR-ID-ECF / 100 00151420
151430      ELSE                                                        00151430
151440         COMPUTE FATOR-JUR-PF-F2 ROUNDED = W09508-VR-ID-ECF / 100 00151440
151450     ELSE                                                         00151450
151460        MOVE '** P04808 ERRO ACESSO TABELA SIEF 26 **'            00151460
151470              TO MENSAGEM-ERRO-WS                                 00151470
151480        DISPLAY W09508-CD-ID-ECF                                  00151480
151490        DISPLAY W09508-DT-REF-CNS                                 00151490
151500        DISPLAY W09508-CD-RET-ROT                                 00151500
151510        DISPLAY W09508-DE-MSG-RET                                 00151510
151520        DISPLAY W09508-SQLCODE                                    00151520
151530        PERFORM 999-99-ROT-ERRO.                                  00151530
151540                                                                  00151540
151550     MOVE 048             TO W09508-CD-SIS-SLT.                   00151550
151560     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00151560
151570     MOVE 290             TO W09508-CD-ID-ECF.                    00151570
151580     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00151580
151590     CALL 'P09511' USING W09508-AREA-SIEF.                        00151590
151600     IF W09508-CD-RET-ROT = '**'                                  00151600
151610      IF W09508-CD-TP-ID EQUAL 2                                  00151610
151620         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00151620
151630         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00151630
151640                                            DIV-SIEF-WS           00151640
151650         COMPUTE FATOR-JUR-PF-F3 ROUNDED = W09508-VR-ID-ECF / 100 00151650
151660      ELSE                                                        00151660
151670         COMPUTE FATOR-JUR-PF-F3 ROUNDED = W09508-VR-ID-ECF / 100 00151670
151680     ELSE                                                         00151680
151690        MOVE '** P04808 ERRO ACESSO TABELA SIEF 28 **'            00151690
151700              TO MENSAGEM-ERRO-WS                                 00151700
151710        DISPLAY W09508-CD-ID-ECF                                  00151710
151720        DISPLAY W09508-DT-REF-CNS                                 00151720
151730        DISPLAY W09508-CD-RET-ROT                                 00151730
151740        DISPLAY W09508-DE-MSG-RET                                 00151740
151750        DISPLAY W09508-SQLCODE                                    00151750
151760        PERFORM 999-99-ROT-ERRO.                                  00151760
151770                                                                  00151770
151780     MOVE 048             TO W09508-CD-SIS-SLT.                   00151780
151790     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00151790
151800     MOVE 305             TO W09508-CD-ID-ECF.                    00151800
151810     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00151810
151820     CALL 'P09511' USING W09508-AREA-SIEF.                        00151820
151830     IF W09508-CD-RET-ROT = '**'                                  00151830
151840      IF W09508-CD-TP-ID EQUAL 2                                  00151840
151850         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00151850
151860         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00151860
151870                                            DIV-SIEF-WS           00151870
151880         COMPUTE FATOR-JUR-PF-F4 ROUNDED = W09508-VR-ID-ECF / 100 00151880
151890      ELSE                                                        00151890
151900         COMPUTE FATOR-JUR-PF-F4 ROUNDED = W09508-VR-ID-ECF / 100 00151900
151910     ELSE                                                         00151910
151920        MOVE '** P04808 ERRO ACESSO TABELA SIEF 30 **'            00151920
151930              TO MENSAGEM-ERRO-WS                                 00151930
151940        DISPLAY W09508-CD-ID-ECF                                  00151940
151950        DISPLAY W09508-DT-REF-CNS                                 00151950
151960        DISPLAY W09508-CD-RET-ROT                                 00151960
151970        DISPLAY W09508-DE-MSG-RET                                 00151970
151980        DISPLAY W09508-SQLCODE                                    00151980
151990        PERFORM 999-99-ROT-ERRO.                                  00151990
152000                                                                  00152000
152010     MOVE 048             TO W09508-CD-SIS-SLT.                   00152010
152020     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00152020
152030     MOVE 27              TO W09508-CD-ID-ECF.                    00152030
152040     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00152040
152050     CALL 'P09511' USING W09508-AREA-SIEF.                        00152050
152060     IF W09508-CD-RET-ROT = '**'                                  00152060
152070      IF W09508-CD-TP-ID EQUAL 2                                  00152070
152080         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00152080
152090         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00152090
152100                                            DIV-SIEF-WS           00152100
152110         COMPUTE FATOR-JUR-PF-F5 ROUNDED = W09508-VR-ID-ECF / 100 00152110
152120      ELSE                                                        00152120
152130         COMPUTE FATOR-JUR-PF-F5 ROUNDED = W09508-VR-ID-ECF / 100 00152130
152140     ELSE                                                         00152140
152150        MOVE '** P04808 ERRO ACESSO TABELA SIEF 32 **'            00152150
152160              TO MENSAGEM-ERRO-WS                                 00152160
152170        DISPLAY W09508-CD-ID-ECF                                  00152170
152180        DISPLAY W09508-DT-REF-CNS                                 00152180
152190        DISPLAY W09508-CD-RET-ROT                                 00152190
152200        DISPLAY W09508-DE-MSG-RET                                 00152200
152210        DISPLAY W09508-SQLCODE                                    00152210
152220        PERFORM 999-99-ROT-ERRO.                                  00152220
152230                                                                  00152230
152240*----------------------------------------------                   00152240
152250     MOVE 048             TO W09508-CD-SIS-SLT.                   00152250
152260     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00152260
152270     MOVE 29              TO W09508-CD-ID-ECF.                    00152270
152280     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00152280
152290     CALL 'P09511' USING W09508-AREA-SIEF.                        00152290
152300     IF W09508-CD-RET-ROT = '**'                                  00152300
152310      IF W09508-CD-TP-ID EQUAL 2                                  00152310
152320         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00152320
152330         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00152330
152340                                            DIV-SIEF-WS           00152340
152350         COMPUTE FATOR-JUR-CE-WS ROUNDED = W09508-VR-ID-ECF / 100 00152350
152360      ELSE                                                        00152360
152370         COMPUTE FATOR-JUR-CE-WS ROUNDED = W09508-VR-ID-ECF / 100 00152370
152380     ELSE                                                         00152380
152390        MOVE '** P04808 ERRO ACESSO TABELA SIEF 34 **'            00152390
152400              TO MENSAGEM-ERRO-WS                                 00152400
152410        DISPLAY W09508-CD-ID-ECF                                  00152410
152420        DISPLAY W09508-DT-REF-CNS                                 00152420
152430        DISPLAY W09508-CD-RET-ROT                                 00152430
152440        DISPLAY W09508-DE-MSG-RET                                 00152440
152450        DISPLAY W09508-SQLCODE                                    00152450
152460        PERFORM 999-99-ROT-ERRO.                                  00152460
152240*----------------------------------------------                   00152240
152470                                                                  00152470
*******    IAC1-INDICE DE ATRASO DE CREDITO
*******    CORRIGIR ALTERNATIVAMENTE CONTRATOS EM ATRASO
152480     MOVE 048             TO W09508-CD-SIS-SLT.                   00152480
152490     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00152490
152500     MOVE 121             TO W09508-CD-ID-ECF.                    00152500
152510     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00152510
152520     CALL 'P09511' USING W09508-AREA-SIEF.                        00152520
152530     IF W09508-CD-RET-ROT = '**'                                  00152530
152540      IF W09508-CD-TP-ID EQUAL 2                                  00152540
152550         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00152550
152560         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00152560
152570                                            DIV-SIEF-WS           00152570
152580         MOVE W09508-VR-ID-ECF TO VR-IAC-ANT-WS                   00152580
152590      ELSE                                                        00152590
152600         MOVE W09508-VR-ID-ECF TO VR-IAC-ANT-WS                   00152600
152610     ELSE                                                         00152610
152620        MOVE '** P04808 ERRO ACESSO TABELA SIEF 35 **'            00152620
152630              TO MENSAGEM-ERRO-WS                                 00152630
152640        DISPLAY W09508-CD-ID-ECF                                  00152640
152650        DISPLAY W09508-DT-REF-CNS                                 00152650
152660        DISPLAY W09508-CD-RET-ROT                                 00152660
152670        DISPLAY W09508-DE-MSG-RET                                 00152670
152680        DISPLAY W09508-SQLCODE                                    00152680
152690        PERFORM 999-99-ROT-ERRO.                                  00152690
152700                                                                  00152700
152710     MOVE 048             TO W09508-CD-SIS-SLT.                   00152710
152720     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00152720
152730     MOVE 32              TO W09508-CD-ID-ECF.                    00152730
152740     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00152740
152750     CALL 'P09511' USING W09508-AREA-SIEF.                        00152750
152760     IF W09508-CD-RET-ROT = '**'                                  00152760
152770      IF W09508-CD-TP-ID EQUAL 2                                  00152770
152780         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00152780
152790         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00152790
152800                                            DIV-SIEF-WS           00152800
152810         MOVE W09508-VR-ID-ECF TO VR-ITAH-ANT-WS                  00152810
152820      ELSE                                                        00152820
152830         MOVE W09508-VR-ID-ECF TO VR-ITAH-ANT-WS                  00152830
152840     ELSE                                                         00152840
152850        MOVE '** P04808 ERRO ACESSO TABELA SIEF 36 **'            00152850
152860              TO MENSAGEM-ERRO-WS                                 00152860
152870        DISPLAY W09508-CD-ID-ECF                                  00152870
152880        DISPLAY W09508-DT-REF-CNS                                 00152880
152890        DISPLAY W09508-CD-RET-ROT                                 00152890
152900        DISPLAY W09508-DE-MSG-RET                                 00152900
152910        DISPLAY W09508-SQLCODE                                    00152910
152920        PERFORM 999-99-ROT-ERRO.                                  00152920
152930                                                                  00152930
152940     MOVE 048             TO W09508-CD-SIS-SLT.                   00152940
152950     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00152950
152960     MOVE 31              TO W09508-CD-ID-ECF.                    00152960
152970     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00152970
152980     CALL 'P09511' USING W09508-AREA-SIEF.                        00152980
152990     IF W09508-CD-RET-ROT = '**'                                  00152990
153000      IF W09508-CD-TP-ID EQUAL 2                                  00153000
153010         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00153010
153020         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00153020
153030                                            DIV-SIEF-WS           00153030
153040         MOVE W09508-VR-ID-ECF TO VR-ITAF-ANT-WS                  00153040
153050      ELSE                                                        00153050
153060         MOVE W09508-VR-ID-ECF TO VR-ITAF-ANT-WS                  00153060
153070     ELSE                                                         00153070
153080        MOVE '** P04808 ERRO ACESSO TABELA SIEF 37 **'            00153080
153090              TO MENSAGEM-ERRO-WS                                 00153090
153100        DISPLAY W09508-CD-ID-ECF                                  00153100
153110        DISPLAY W09508-DT-REF-CNS                                 00153110
153120        DISPLAY W09508-CD-RET-ROT                                 00153120
153130        DISPLAY W09508-DE-MSG-RET                                 00153130
153140        DISPLAY W09508-SQLCODE                                    00153140
153150        PERFORM 999-99-ROT-ERRO.                                  00153150
153170                                                                  00153170
           MOVE ZEROS              TO FATOR-EXCESSO-PF-WS
           IF PRM-CALC-EXCESSO
153180        MOVE 048             TO W09508-CD-SIS-SLT                 00153180
153190        MOVE 'P04808'        TO W09508-CD-PRG-SLT                 00153190
153200        MOVE 112             TO W09508-CD-ID-ECF                  00153200
153210        MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS                 00153210
153220        CALL 'P09511' USING W09508-AREA-SIEF                      00153220
153230        IF W09508-CD-RET-ROT = '**'                               00153230
153240           IF W09508-CD-TP-ID EQUAL 2                             00153240
153250              MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS               00153250
153260              COMPUTE W09508-VR-ID-ECF ROUNDED =
                            W09508-VR-ID-ECF / DIV-SIEF-WS
153280              COMPUTE FATOR-EXCESSO-PF-WS ROUNDED =
153280                      W09508-VR-ID-ECF / 100
153290           ELSE                                                   00153290
153300              COMPUTE FATOR-EXCESSO-PF-WS ROUNDED =
153300                      W09508-VR-ID-ECF / 100
153310        ELSE                                                      00153310
153320           MOVE '** P04808 ERRO ACESSO TABELA SIEF 38 **'         00153320
153330                 TO MENSAGEM-ERRO-WS                              00153330
153340           DISPLAY W09508-CD-ID-ECF                               00153340
153350           DISPLAY W09508-DT-REF-CNS                              00153350
153360           DISPLAY W09508-CD-RET-ROT                              00153360
153370           DISPLAY W09508-DE-MSG-RET                              00153370
153380           DISPLAY W09508-SQLCODE                                 00153380
153390           PERFORM 999-99-ROT-ERRO.                               00153390
153400                                                                  00153400
           MOVE ZEROS              TO FATOR-EXCESSO-CE-WS
                                      FATOR-EXCESSO-PJ-WS
           IF PRM-CALC-EXCESSO
153410        MOVE 048             TO W09508-CD-SIS-SLT                 00153410
153420        MOVE 'P04808'        TO W09508-CD-PRG-SLT                 00153420
153430        MOVE 113             TO W09508-CD-ID-ECF                  00153430
153440        MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS                 00153440
153450        CALL 'P09511' USING W09508-AREA-SIEF                      00153450
153460        IF W09508-CD-RET-ROT = '**'                               00153460
153470           IF W09508-CD-TP-ID EQUAL 2                             00153470
153480              MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS               00153480
153490              COMPUTE W09508-VR-ID-ECF ROUNDED =
                            W09508-VR-ID-ECF / DIV-SIEF-WS
153510              COMPUTE FATOR-EXCESSO-CE-WS ROUNDED =
                            W09508-VR-ID-ECF / 100
153520              COMPUTE FATOR-EXCESSO-PJ-WS ROUNDED =
153520                      W09508-VR-ID-ECF / 100
153530           ELSE
153540              COMPUTE FATOR-EXCESSO-CE-WS ROUNDED =
153540                      W09508-VR-ID-ECF / 100
153550              COMPUTE FATOR-EXCESSO-PJ-WS ROUNDED =
153550                      W09508-VR-ID-ECF / 100
153560        ELSE                                                      00153560
153570           MOVE '** P04808 ERRO ACESSO TABELA SIEF 40 **'         00153570
153580                 TO MENSAGEM-ERRO-WS                              00153580
153590           DISPLAY W09508-CD-ID-ECF                               00153590
153600           DISPLAY W09508-DT-REF-CNS                              00153600
153610           DISPLAY W09508-CD-RET-ROT                              00153610
153620           DISPLAY W09508-DE-MSG-RET                              00153620
153630           DISPLAY W09508-SQLCODE                                 00153630
153640           PERFORM 999-99-ROT-ERRO.                               00153640
153650                                                                  00153650
153660     MOVE CH-DATA-D07     TO DATA-ATL-ANTERIOR-AG-RED-WS.         00153660
153670     PERFORM 999-75-CALCULA-PROX-DATA-AG.                         00153670
153680     MOVE DIA-ATL-ANT-AG-WS TO DIA-SIEF-WS.                       00153680
153690     MOVE MES-ATL-ANT-AG-WS TO MES-SIEF-WS.                       00153690
153700     CALL 'M0952000' USING ANO-ATL-ANT-AG-WS ANO-SIEF-WS.         00153700
153710                                                                  00153710
*******    IAC1-INDICE DE ATRASO DE CREDITO
*******    CORRIGIR ALTERNATIVAMENTE CONTRATOS EM ATRASO
*******    Calcula o valor do indice para o proximo dia util.
153720     MOVE 048             TO W09508-CD-SIS-SLT.                   00153720
153730     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00153730
153740     MOVE 121             TO W09508-CD-ID-ECF.                    00153740
153750     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00153750
153760     CALL 'P09511' USING W09508-AREA-SIEF.                        00153760
153770     IF W09508-CD-RET-ROT = '**'                                  00153770
153780      IF W09508-CD-TP-ID EQUAL 2                                  00153780
153790         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00153790
153800         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00153800
153810                                            DIV-SIEF-WS           00153810
153820         MOVE W09508-VR-ID-ECF TO VR-IAC-ATL-WS                   00153820
153830      ELSE                                                        00153830
153840         MOVE W09508-VR-ID-ECF TO VR-IAC-ATL-WS                   00153840
153850     ELSE                                                         00153850
153860        MOVE '** P04808 ERRO ACESSO TABELA SIEF 42 **'            00153860
153870              TO MENSAGEM-ERRO-WS                                 00153870
153880        DISPLAY W09508-CD-ID-ECF                                  00153880
153890        DISPLAY W09508-DT-REF-CNS                                 00153890
153900        DISPLAY W09508-CD-RET-ROT                                 00153900
153910        DISPLAY W09508-DE-MSG-RET                                 00153910
153920        DISPLAY W09508-SQLCODE                                    00153920
153930        PERFORM 999-99-ROT-ERRO.                                  00153930
153940                                                                  00153940
153950     MOVE 048             TO W09508-CD-SIS-SLT.                   00153950
153960     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00153960
153970     MOVE 32              TO W09508-CD-ID-ECF.                    00153970
153980     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00153980
153990     CALL 'P09511' USING W09508-AREA-SIEF.                        00153990
154000     IF W09508-CD-RET-ROT = '**'                                  00154000
154010      IF W09508-CD-TP-ID EQUAL 2                                  00154010
154020         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00154020
154030         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00154030
154040                                            DIV-SIEF-WS           00154040
154050         MOVE W09508-VR-ID-ECF TO VR-ITAH-ATL-WS                  00154050
154060      ELSE                                                        00154060
154070         MOVE W09508-VR-ID-ECF TO VR-ITAH-ATL-WS                  00154070
154080     ELSE                                                         00154080
154090        MOVE '** P04808 ERRO ACESSO TABELA SIEF 43 **'            00154090
154100              TO MENSAGEM-ERRO-WS                                 00154100
154110        DISPLAY W09508-CD-ID-ECF                                  00154110
154120        DISPLAY W09508-DT-REF-CNS                                 00154120
154130        DISPLAY W09508-CD-RET-ROT                                 00154130
154140        DISPLAY W09508-DE-MSG-RET                                 00154140
154150        DISPLAY W09508-SQLCODE                                    00154150
154160        PERFORM 999-99-ROT-ERRO.                                  00154160
154170                                                                  00154170
154180     MOVE 048             TO W09508-CD-SIS-SLT.                   00154180
154190     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00154190
154200     MOVE 31              TO W09508-CD-ID-ECF.                    00154200
154210     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00154210
154220     CALL 'P09511' USING W09508-AREA-SIEF.                        00154220
154230     IF W09508-CD-RET-ROT = '**'                                  00154230
154240      IF W09508-CD-TP-ID EQUAL 2                                  00154240
154250         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00154250
154260         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00154260
154270                                            DIV-SIEF-WS           00154270
154280         MOVE W09508-VR-ID-ECF TO VR-ITAF-ATL-WS                  00154280
154290      ELSE                                                        00154290
154300         MOVE W09508-VR-ID-ECF TO VR-ITAF-ATL-WS                  00154300
154310     ELSE                                                         00154310
154320        MOVE '** P04808 ERRO ACESSO TABELA SIEF 44 **'            00154320
154330              TO MENSAGEM-ERRO-WS                                 00154330
154340        DISPLAY W09508-CD-ID-ECF                                  00154340
154350        DISPLAY W09508-DT-REF-CNS                                 00154350
154360        DISPLAY W09508-CD-RET-ROT                                 00154360
154370        DISPLAY W09508-DE-MSG-RET                                 00154370
154380        DISPLAY W09508-SQLCODE                                    00154380
154390        PERFORM 999-99-ROT-ERRO.                                  00154390
154400                                                                  00154400
154640     MOVE CH-DATA-D07     TO DATA-ATL-ANTERIOR-AG-RED-WS.         00154640
154650     MOVE DIA-ATL-ANT-AG-WS TO DD-ONTEM-WS.                       00154650
154660     MOVE MES-ATL-ANT-AG-WS TO MM-ONTEM-WS.                       00154660
154670     CALL 'M0952000' USING ANO-ATL-ANT-AG-WS AA-ONTEM-WS.         00154670
154680     PERFORM 999-85-DECREMENTA-DATA.                              00154680
154690                                                                  00154690
*******    IAC1-INDICE DE ATRASO DE CREDITO
*******    CORRIGIR ALTERNATIVAMENTE CONTRATOS EM ATRASO
154700     MOVE 048             TO W09508-CD-SIS-SLT.                   00154700
154710     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00154710
154720     MOVE 121             TO W09508-CD-ID-ECF.                    00154720
154730     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00154730
154740     CALL 'P09511' USING W09508-AREA-SIEF.                        00154740
154750     IF W09508-CD-RET-ROT = '**'                                  00154750
154760      IF W09508-CD-TP-ID EQUAL 2                                  00154760
154770         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00154770
154780         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00154780
154790                                            DIV-SIEF-WS           00154790
154800         MOVE W09508-VR-ID-ECF TO VR-IAC-ONTEM-WS                 00154800
154810      ELSE                                                        00154810
154820         MOVE W09508-VR-ID-ECF TO VR-IAC-ONTEM-WS                 00154820
154830     ELSE                                                         00154830
154840        MOVE '** P04808 ERRO ACESSO TABELA SIEF 45 **'            00154840
154850              TO MENSAGEM-ERRO-WS                                 00154850
154860        DISPLAY W09508-CD-ID-ECF                                  00154860
154870        DISPLAY W09508-DT-REF-CNS                                 00154870
154880        DISPLAY W09508-CD-RET-ROT                                 00154880
154890        DISPLAY W09508-DE-MSG-RET                                 00154890
154900        DISPLAY W09508-SQLCODE                                    00154900
154910        PERFORM 999-99-ROT-ERRO.                                  00154910
154920                                                                  00154920
154930     MOVE 048             TO W09508-CD-SIS-SLT.                   00154930
154940     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00154940
154950     MOVE 32             TO W09508-CD-ID-ECF.                     00154950
154960     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00154960
154970     CALL 'P09511' USING W09508-AREA-SIEF.                        00154970
154980     IF W09508-CD-RET-ROT = '**'                                  00154980
154990      IF W09508-CD-TP-ID EQUAL 2                                  00154990
155000         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00155000
155010         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00155010
155020                                            DIV-SIEF-WS           00155020
155030         MOVE W09508-VR-ID-ECF TO VR-ITAH-ONTEM-WS                00155030
155040      ELSE                                                        00155040
155050         MOVE W09508-VR-ID-ECF TO VR-ITAH-ONTEM-WS                00155050
155060     ELSE                                                         00155060
155070        MOVE '** P04808 ERRO ACESSO TABELA SIEF 46 **'            00155070
155080              TO MENSAGEM-ERRO-WS                                 00155080
155090        DISPLAY W09508-CD-ID-ECF                                  00155090
155100        DISPLAY W09508-DT-REF-CNS                                 00155100
155110        DISPLAY W09508-CD-RET-ROT                                 00155110
155120        DISPLAY W09508-DE-MSG-RET                                 00155120
155130        DISPLAY W09508-SQLCODE                                    00155130
155140        PERFORM 999-99-ROT-ERRO.                                  00155140
155150                                                                  00155150
155160     MOVE 048             TO W09508-CD-SIS-SLT.                   00155160
155170     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00155170
155180     MOVE 31              TO W09508-CD-ID-ECF.                    00155180
155190     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00155190
155200     CALL 'P09511' USING W09508-AREA-SIEF.                        00155200
155210     IF W09508-CD-RET-ROT = '**'                                  00155210
155220      IF W09508-CD-TP-ID EQUAL 2                                  00155220
155230         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00155230
155240         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00155240
155250                                            DIV-SIEF-WS           00155250
155260         MOVE W09508-VR-ID-ECF TO VR-ITAF-ONTEM-WS                00155260
155270      ELSE                                                        00155270
155280         MOVE W09508-VR-ID-ECF TO VR-ITAF-ONTEM-WS                00155280
155290     ELSE                                                         00155290
155300        MOVE '** P04808 ERRO ACESSO TABELA SIEF 47 **'            00155300
155310              TO MENSAGEM-ERRO-WS                                 00155310
155320        DISPLAY W09508-CD-ID-ECF                                  00155320
155330        DISPLAY W09508-DT-REF-CNS                                 00155330
155340        DISPLAY W09508-CD-RET-ROT                                 00155340
155350        DISPLAY W09508-DE-MSG-RET                                 00155350
155360        DISPLAY W09508-SQLCODE                                    00155360
155370        PERFORM 999-99-ROT-ERRO.                                  00155370
155380                                                                  00155380
155390     MOVE 048             TO W09508-CD-SIS-SLT.                   00155390
155400     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00155400
155410     MOVE 189             TO W09508-CD-ID-ECF.                    00155410
155420     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00155420
155430     CALL 'P09511' USING W09508-AREA-SIEF.                        00155430
155440     IF W09508-CD-RET-ROT = '**'                                  00155440
155450      IF W09508-CD-TP-ID EQUAL 2                                  00155450
155460         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00155460
155470         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00155470
155480                                            DIV-SIEF-WS           00155480
155490         MOVE W09508-VR-ID-ECF TO VR-BTNF-DIA-WS                  00155490
155500      ELSE                                                        00155500
155510         MOVE W09508-VR-ID-ECF TO VR-BTNF-DIA-WS                  00155510
155520     ELSE                                                         00155520
155530        MOVE '** P04808 ERRO ACESSO TABELA SIEF 48 **'            00155530
155540              TO MENSAGEM-ERRO-WS                                 00155540
155550        DISPLAY W09508-CD-ID-ECF                                  00155550
155560        DISPLAY W09508-DT-REF-CNS                                 00155560
155570        DISPLAY W09508-CD-RET-ROT                                 00155570
155580        DISPLAY W09508-DE-MSG-RET                                 00155580
155590        DISPLAY W09508-SQLCODE                                    00155590
155600        PERFORM 999-99-ROT-ERRO.                                  00155600
155610                                                                  00155610
152240*----------------------------------------------                   00152240

155390     MOVE 048             TO W09508-CD-SIS-SLT.                   00155390
155400     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00155400
155410     MOVE 149             TO W09508-CD-ID-ECF.                    00155410
155420     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00155420
155430     CALL 'P09511' USING W09508-AREA-SIEF.                        00155430
155440     IF W09508-CD-RET-ROT = '**'                                  00155440
155450      IF W09508-CD-TP-ID EQUAL 2                                  00155450
155460         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00155460
155470         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00155470
155480                                            DIV-SIEF-WS           00155480
155490         MOVE W09508-VR-ID-ECF TO VR-SELIC-ANO-WS                 00155490
155500      ELSE                                                        00155500
155510         MOVE W09508-VR-ID-ECF TO VR-SELIC-ANO-WS                 00155510
155520     ELSE                                                         00155520
155530        MOVE '** P04808 ERRO ACESSO TABELA SIEF 49 **'            00155530
155540              TO MENSAGEM-ERRO-WS                                 00155540
155550        DISPLAY W09508-CD-ID-ECF                                  00155550
155560        DISPLAY W09508-DT-REF-CNS                                 00155560
155570        DISPLAY W09508-CD-RET-ROT                                 00155570
155580        DISPLAY W09508-DE-MSG-RET                                 00155580
155590        DISPLAY W09508-SQLCODE                                    00155590
155600        PERFORM 999-99-ROT-ERRO.                                  00155600

       999-38-ACESSA-TAB-SIEF-DEVOL.

            MOVE 048                    TO W09508-CD-SIS-SLT
            MOVE 'P04808'               TO W09508-CD-PRG-SLT
            MOVE 167                    TO W09508-CD-ID-ECF
            MOVE DATA-SIEF-DEVOL-WS     TO W09508-DT-REF-CNS

           CALL 'P09511' USING W09508-AREA-SIEF.
           IF W09508-CD-RET-ROT = '**'
              IF W09508-CD-TP-ID EQUAL 2
                 MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
                 COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /
                                                    DIV-SIEF-WS
                 COMPUTE FATOR-JUR-PJ-F1-WS ROUNDED =
                         W09508-VR-ID-ECF / 100
              ELSE
                 COMPUTE FATOR-JUR-PJ-F1-WS ROUNDED =
                         W09508-VR-ID-ECF / 100
           ELSE
              MOVE '** P04808 ERRO ACESSO TABELA SIEF 9 **'
                                       TO MENSAGEM-ERRO-WS
              DISPLAY W09508-CD-ID-ECF
              DISPLAY W09508-DT-REF-CNS
              DISPLAY W09508-CD-RET-ROT
              DISPLAY W09508-DE-MSG-RET
              DISPLAY W09508-SQLCODE
              PERFORM 999-99-ROT-ERRO.

           MOVE 048                    TO W09508-CD-SIS-SLT
           MOVE 'P04808'               TO W09508-CD-PRG-SLT
           MOVE 169                    TO W09508-CD-ID-ECF
           MOVE DATA-SIEF-DEVOL-WS     TO W09508-DT-REF-CNS

           CALL 'P09511' USING W09508-AREA-SIEF.
           IF W09508-CD-RET-ROT = '**'
              IF W09508-CD-TP-ID EQUAL 2
                 MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
                 COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /
                                                    DIV-SIEF-WS
                 COMPUTE FATOR-JUR-PJ-F2-WS ROUNDED =
                         W09508-VR-ID-ECF / 100
              ELSE
                 COMPUTE FATOR-JUR-PJ-F2-WS ROUNDED =
                         W09508-VR-ID-ECF / 100
           ELSE
              MOVE '** P04808 ERRO ACESSO TABELA SIEF 11 **'
                                       TO MENSAGEM-ERRO-WS
              DISPLAY W09508-CD-ID-ECF
              DISPLAY W09508-DT-REF-CNS
              DISPLAY W09508-CD-RET-ROT
              DISPLAY W09508-DE-MSG-RET
              DISPLAY W09508-SQLCODE
              PERFORM 999-99-ROT-ERRO.

           MOVE 048                TO W09508-CD-SIS-SLT.
           MOVE 'P04808'           TO W09508-CD-PRG-SLT.
           MOVE 171                TO W09508-CD-ID-ECF.
           MOVE DATA-SIEF-DEVOL-WS TO W09508-DT-REF-CNS.
           CALL 'P09511' USING W09508-AREA-SIEF.
           IF W09508-CD-RET-ROT = '**'
            IF W09508-CD-TP-ID EQUAL 2
               MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
               COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /
                                                  DIV-SIEF-WS
               COMPUTE FATOR-JUR-PJ-F3-WS ROUNDED =
                                                 W09508-VR-ID-ECF / 100
            ELSE
               COMPUTE FATOR-JUR-PJ-F3-WS ROUNDED =
                                                 W09508-VR-ID-ECF / 100
           ELSE
              MOVE '** P04808 ERRO ACESSO TABELA SIEF 13 **'
                    TO MENSAGEM-ERRO-WS
              DISPLAY W09508-CD-ID-ECF
              DISPLAY W09508-DT-REF-CNS
              DISPLAY W09508-CD-RET-ROT
              DISPLAY W09508-DE-MSG-RET
              DISPLAY W09508-SQLCODE
              PERFORM 999-99-ROT-ERRO.

           MOVE 048                TO W09508-CD-SIS-SLT.
           MOVE 'P04808'           TO W09508-CD-PRG-SLT.
           MOVE 28                 TO W09508-CD-ID-ECF.
           MOVE DATA-SIEF-DEVOL-WS TO W09508-DT-REF-CNS.
           CALL 'P09511' USING W09508-AREA-SIEF.
           IF W09508-CD-RET-ROT = '**'
            IF W09508-CD-TP-ID EQUAL 2
               MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
               COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /
                                                  DIV-SIEF-WS
               COMPUTE FATOR-JUR-PJ-F4-WS ROUNDED =
                                                 W09508-VR-ID-ECF / 100
            ELSE
               COMPUTE FATOR-JUR-PJ-F4-WS ROUNDED =
                                                 W09508-VR-ID-ECF / 100
           ELSE
              MOVE '** P04808 ERRO ACESSO TABELA SIEF 15 **'
                    TO MENSAGEM-ERRO-WS
              DISPLAY W09508-CD-ID-ECF
              DISPLAY W09508-DT-REF-CNS
              DISPLAY W09508-CD-RET-ROT
              DISPLAY W09508-DE-MSG-RET
              DISPLAY W09508-SQLCODE
              PERFORM 999-99-ROT-ERRO.

           MOVE 048                TO W09508-CD-SIS-SLT.
           MOVE 'P04808'           TO W09508-CD-PRG-SLT.
           MOVE 272                TO W09508-CD-ID-ECF.
           MOVE DATA-SIEF-DEVOL-WS TO W09508-DT-REF-CNS.
           CALL 'P09511' USING W09508-AREA-SIEF.
           IF W09508-CD-RET-ROT = '**'
            IF W09508-CD-TP-ID EQUAL 2
             MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
             COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /
                                                DIV-SIEF-WS
             COMPUTE FATOR-JUR-PJ-PP-F1-WS ROUNDED =
                                              W09508-VR-ID-ECF / 100
            ELSE
             COMPUTE FATOR-JUR-PJ-PP-F1-WS ROUNDED =
                                              W09508-VR-ID-ECF / 100
           ELSE
              MOVE '** P04808 ERRO ACESSO TABELA SIEF - 1 17 **'
                    TO MENSAGEM-ERRO-WS
              DISPLAY W09508-CD-ID-ECF
              DISPLAY W09508-DT-REF-CNS
              DISPLAY W09508-CD-RET-ROT
              DISPLAY W09508-DE-MSG-RET
              DISPLAY W09508-SQLCODE
              PERFORM 999-99-ROT-ERRO.

           MOVE 048                TO W09508-CD-SIS-SLT.
           MOVE 'P04808'           TO W09508-CD-PRG-SLT.
           MOVE 273                TO W09508-CD-ID-ECF.
           MOVE DATA-SIEF-DEVOL-WS TO W09508-DT-REF-CNS.
           CALL 'P09511' USING W09508-AREA-SIEF.
           IF W09508-CD-RET-ROT = '**'
            IF W09508-CD-TP-ID EQUAL 2
             MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
             COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /
                                                DIV-SIEF-WS
             COMPUTE FATOR-JUR-PJ-PP-F2-WS ROUNDED =
                                                  W09508-VR-ID-ECF / 100
            ELSE
             COMPUTE FATOR-JUR-PJ-PP-F2-WS ROUNDED =
                                                  W09508-VR-ID-ECF / 100
           ELSE
              MOVE '** P04808 ERRO ACESSO TABELA SIEF 19 **'
                    TO MENSAGEM-ERRO-WS
              DISPLAY W09508-CD-ID-ECF
              DISPLAY W09508-DT-REF-CNS
              DISPLAY W09508-CD-RET-ROT
              DISPLAY W09508-DE-MSG-RET
              DISPLAY W09508-SQLCODE
              PERFORM 999-99-ROT-ERRO.

           MOVE 048                TO W09508-CD-SIS-SLT.
           MOVE 'P04808'           TO W09508-CD-PRG-SLT.
           MOVE 274                TO W09508-CD-ID-ECF.
           MOVE DATA-SIEF-DEVOL-WS TO W09508-DT-REF-CNS.
           CALL 'P09511' USING W09508-AREA-SIEF.
           IF W09508-CD-RET-ROT = '**'
            IF W09508-CD-TP-ID EQUAL 2
             MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
             COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /
                                                DIV-SIEF-WS
             COMPUTE FATOR-JUR-PJ-PP-F3-WS ROUNDED =
                                                  W09508-VR-ID-ECF / 100
            ELSE
             COMPUTE FATOR-JUR-PJ-PP-F3-WS ROUNDED =
                                                  W09508-VR-ID-ECF / 100
           ELSE
              MOVE '** P04808 ERRO ACESSO TABELA SIEF 21 **'
                    TO MENSAGEM-ERRO-WS
              DISPLAY W09508-CD-ID-ECF
              DISPLAY W09508-DT-REF-CNS
              DISPLAY W09508-CD-RET-ROT
              DISPLAY W09508-DE-MSG-RET
              DISPLAY W09508-SQLCODE
              PERFORM 999-99-ROT-ERRO.

           MOVE 048                TO W09508-CD-SIS-SLT.
           MOVE 'P04808'           TO W09508-CD-PRG-SLT.
           MOVE 275                TO W09508-CD-ID-ECF.
           MOVE DATA-SIEF-DEVOL-WS TO W09508-DT-REF-CNS.
           CALL 'P09511' USING W09508-AREA-SIEF.
           IF W09508-CD-RET-ROT = '**'
            IF W09508-CD-TP-ID EQUAL 2
             MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
             COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /
                                                DIV-SIEF-WS
             COMPUTE FATOR-JUR-PJ-PP-F4-WS ROUNDED =
                                                  W09508-VR-ID-ECF / 100
            ELSE
             COMPUTE FATOR-JUR-PJ-PP-F4-WS ROUNDED =
                                                  W09508-VR-ID-ECF / 100
           ELSE
              MOVE '** P04808 ERRO ACESSO TABELA SIEF 23 **'
                    TO MENSAGEM-ERRO-WS
              DISPLAY W09508-CD-ID-ECF
              DISPLAY W09508-DT-REF-CNS
              DISPLAY W09508-CD-RET-ROT
              DISPLAY W09508-DE-MSG-RET
              DISPLAY W09508-SQLCODE
              PERFORM 999-99-ROT-ERRO.

           MOVE 048                TO W09508-CD-SIS-SLT.
           MOVE 'P04808'           TO W09508-CD-PRG-SLT.
           MOVE 158                TO W09508-CD-ID-ECF.
           MOVE DATA-SIEF-DEVOL-WS TO W09508-DT-REF-CNS.
           CALL 'P09511' USING W09508-AREA-SIEF.
           IF W09508-CD-RET-ROT = '**'
            IF W09508-CD-TP-ID EQUAL 2
               MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
               COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /
                                                  DIV-SIEF-WS
               COMPUTE FATOR-JUR-PF-F1-WS ROUNDED =
                                               W09508-VR-ID-ECF / 100
            ELSE
               COMPUTE FATOR-JUR-PF-F1-WS ROUNDED =
                                               W09508-VR-ID-ECF / 100
           ELSE
              MOVE '** P04808 ERRO ACESSO TABELA SIEF 25 **'
                    TO MENSAGEM-ERRO-WS
              DISPLAY W09508-CD-ID-ECF
              DISPLAY W09508-DT-REF-CNS
              DISPLAY W09508-CD-RET-ROT
              DISPLAY W09508-DE-MSG-RET
              DISPLAY W09508-SQLCODE
              PERFORM 999-99-ROT-ERRO.

           MOVE 048                TO W09508-CD-SIS-SLT.
           MOVE 'P04808'           TO W09508-CD-PRG-SLT.
           MOVE 161                TO W09508-CD-ID-ECF.
           MOVE DATA-SIEF-DEVOL-WS TO W09508-DT-REF-CNS.
           CALL 'P09511' USING W09508-AREA-SIEF.
           IF W09508-CD-RET-ROT = '**'
            IF W09508-CD-TP-ID EQUAL 2
               MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
               COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /
                                                  DIV-SIEF-WS
               COMPUTE FATOR-JUR-PF-F2-WS ROUNDED =
                                                 W09508-VR-ID-ECF / 100
            ELSE
               COMPUTE FATOR-JUR-PF-F2-WS ROUNDED =
                                                 W09508-VR-ID-ECF / 100
           ELSE
              MOVE '** P04808 ERRO ACESSO TABELA SIEF 27 **'
                    TO MENSAGEM-ERRO-WS
              DISPLAY W09508-CD-ID-ECF
              DISPLAY W09508-DT-REF-CNS
              DISPLAY W09508-CD-RET-ROT
              DISPLAY W09508-DE-MSG-RET
              DISPLAY W09508-SQLCODE
              PERFORM 999-99-ROT-ERRO.

           MOVE 048                TO W09508-CD-SIS-SLT.
           MOVE 'P04808'           TO W09508-CD-PRG-SLT.
           MOVE 290                TO W09508-CD-ID-ECF.
           MOVE DATA-SIEF-DEVOL-WS TO W09508-DT-REF-CNS.
           CALL 'P09511' USING W09508-AREA-SIEF.
           IF W09508-CD-RET-ROT = '**'
            IF W09508-CD-TP-ID EQUAL 2
               MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
               COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /
                                                  DIV-SIEF-WS
               COMPUTE FATOR-JUR-PF-F3-WS ROUNDED =
                                                 W09508-VR-ID-ECF / 100
            ELSE
               COMPUTE FATOR-JUR-PF-F3-WS ROUNDED =
                                                 W09508-VR-ID-ECF / 100
           ELSE
              MOVE '** P04808 ERRO ACESSO TABELA SIEF 29 **'
                    TO MENSAGEM-ERRO-WS
              DISPLAY W09508-CD-ID-ECF
              DISPLAY W09508-DT-REF-CNS
              DISPLAY W09508-CD-RET-ROT
              DISPLAY W09508-DE-MSG-RET
              DISPLAY W09508-SQLCODE
              PERFORM 999-99-ROT-ERRO.

           MOVE 048                TO W09508-CD-SIS-SLT.
           MOVE 'P04808'           TO W09508-CD-PRG-SLT.
           MOVE 305                TO W09508-CD-ID-ECF.
           MOVE DATA-SIEF-DEVOL-WS TO W09508-DT-REF-CNS.
           CALL 'P09511' USING W09508-AREA-SIEF.
           IF W09508-CD-RET-ROT = '**'
            IF W09508-CD-TP-ID EQUAL 2
               MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
               COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /
                                                  DIV-SIEF-WS
               COMPUTE FATOR-JUR-PF-F4-WS ROUNDED =
                                                 W09508-VR-ID-ECF / 100
            ELSE
               COMPUTE FATOR-JUR-PF-F4-WS ROUNDED =
                                                 W09508-VR-ID-ECF / 100
           ELSE
              MOVE '** P04808 ERRO ACESSO TABELA SIEF 31 **'
                    TO MENSAGEM-ERRO-WS
              DISPLAY W09508-CD-ID-ECF
              DISPLAY W09508-DT-REF-CNS
              DISPLAY W09508-CD-RET-ROT
              DISPLAY W09508-DE-MSG-RET
              DISPLAY W09508-SQLCODE
              PERFORM 999-99-ROT-ERRO.

           MOVE 048                TO W09508-CD-SIS-SLT.
           MOVE 'P04808'           TO W09508-CD-PRG-SLT.
           MOVE 27                 TO W09508-CD-ID-ECF.
           MOVE DATA-SIEF-DEVOL-WS TO W09508-DT-REF-CNS.
           CALL 'P09511' USING W09508-AREA-SIEF.
           IF W09508-CD-RET-ROT = '**'
            IF W09508-CD-TP-ID EQUAL 2
               MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
               COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /
                                                  DIV-SIEF-WS
               COMPUTE FATOR-JUR-PF-F5-WS ROUNDED =
                                                 W09508-VR-ID-ECF / 100
            ELSE
               COMPUTE FATOR-JUR-PF-F5-WS ROUNDED =
                                                 W09508-VR-ID-ECF / 100
           ELSE
              MOVE '** P04808 ERRO ACESSO TABELA SIEF 33 **'
                    TO MENSAGEM-ERRO-WS
              DISPLAY W09508-CD-ID-ECF
              DISPLAY W09508-DT-REF-CNS
              DISPLAY W09508-CD-RET-ROT
              DISPLAY W09508-DE-MSG-RET
              DISPLAY W09508-SQLCODE
              PERFORM 999-99-ROT-ERRO.

           MOVE ZEROS                 TO FATOR-EXCESSO-PF-ANT-WS
           IF PRM-CALC-EXCESSO
              MOVE 048                TO W09508-CD-SIS-SLT
              MOVE 'P04808'           TO W09508-CD-PRG-SLT
              MOVE 112                TO W09508-CD-ID-ECF
              MOVE DATA-SIEF-DEVOL-WS TO W09508-DT-REF-CNS
              CALL 'P09511' USING W09508-AREA-SIEF
              IF W09508-CD-RET-ROT = '**'
                 IF W09508-CD-TP-ID EQUAL 2
                    MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
                    COMPUTE W09508-VR-ID-ECF ROUNDED =
                            W09508-VR-ID-ECF / DIV-SIEF-WS
                    COMPUTE FATOR-EXCESSO-PF-ANT-WS ROUNDED =
                            W09508-VR-ID-ECF / 100
                 ELSE
                    COMPUTE FATOR-EXCESSO-PF-ANT-WS ROUNDED =
                            W09508-VR-ID-ECF / 100
              ELSE
                 MOVE '** P04808 ERRO ACESSO TABELA SIEF 39 **'
                       TO MENSAGEM-ERRO-WS
                 DISPLAY W09508-CD-ID-ECF
                 DISPLAY W09508-DT-REF-CNS
                 DISPLAY W09508-CD-RET-ROT
                 DISPLAY W09508-DE-MSG-RET
                 DISPLAY W09508-SQLCODE
                 PERFORM 999-99-ROT-ERRO.

           MOVE ZEROS TO FATOR-EXCESSO-CE-ANT-WS
                         FATOR-EXCESSO-PJ-ANT-WS
           IF PRM-CALC-EXCESSO
              MOVE 048                TO W09508-CD-SIS-SLT
              MOVE 'P04808'           TO W09508-CD-PRG-SLT
              MOVE 113                TO W09508-CD-ID-ECF
              MOVE DATA-SIEF-DEVOL-WS TO W09508-DT-REF-CNS
              CALL 'P09511' USING W09508-AREA-SIEF
              IF W09508-CD-RET-ROT = '**'
                 IF W09508-CD-TP-ID EQUAL 2
                    MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS
                    COMPUTE W09508-VR-ID-ECF ROUNDED =
                            W09508-VR-ID-ECF / DIV-SIEF-WS
                    COMPUTE FATOR-EXCESSO-CE-ANT-WS ROUNDED =
                            W09508-VR-ID-ECF / 100
                    COMPUTE FATOR-EXCESSO-PJ-ANT-WS ROUNDED =
                            W09508-VR-ID-ECF / 100
                 ELSE
                    COMPUTE FATOR-EXCESSO-CE-ANT-WS ROUNDED =
                            W09508-VR-ID-ECF / 100
                    COMPUTE FATOR-EXCESSO-PJ-ANT-WS ROUNDED =
                            W09508-VR-ID-ECF / 100
              ELSE
                 MOVE '** P04808 ERRO ACESSO TABELA SIEF 41 **'
                       TO MENSAGEM-ERRO-WS
                 DISPLAY W09508-CD-ID-ECF
                 DISPLAY W09508-DT-REF-CNS
                 DISPLAY W09508-CD-RET-ROT
                 DISPLAY W09508-DE-MSG-RET
                 DISPLAY W09508-SQLCODE
                 PERFORM 999-99-ROT-ERRO.

       999-37A-TST-CONSISTENCIA-DEVOL.

           IF  NOT  HOUVE-ERRO-TBTX
               MOVE ZEROS TO FATOR-IAC-PJ-WS
               IF PRM-CALC-TX-IAC1
                  COMPUTE FATOR-IAC-PJ-WS =                             00147140
                       (VR-IAC-ATL-WS / VR-IAC-ANT-WS) - 1              00147150
               END-IF

               COMPUTE FATOR-INSUF-PJ-WS =
                       (VR-IAC-ATL-WS / VR-IAC-ANT-WS) - 1
            IF FATOR-INSUF-PJ-WS LESS ZEROS
               MOVE 1 TO SW-ERRO-TBTX
               DISPLAY '*********************************************'
               DISPLAY '**P04808 - FATOR IAC ESTAH NEGATIVO        **'
               DISPLAY '**DATA-MOVIMENTO - '  CH-DATA-D07
               DISPLAY '**IAC-DAY        - '  VR-IAC-ANT-WS
               DISPLAY '**IAC-DAY-NEXT   - '  VR-IAC-ATL-WS
               DISPLAY '**FATOR-IAC      - '  FATOR-INSUF-PJ-WS
               DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS   **'
               DISPLAY '**           GILSON 299.3629               **'
               DISPLAY '*********************************************'.

           IF  NOT  HOUVE-ERRO-TBTX
               MOVE ZEROS TO FATOR-IAC-PF-WS
               IF PRM-CALC-TX-IAC1
                  COMPUTE FATOR-IAC-PF-WS =                             00147140
                       (VR-IAC-ATL-WS / VR-IAC-ANT-WS) - 1              00147150
               END-IF

               COMPUTE FATOR-INSUF-PF-WS =
                       (VR-IAC-ATL-WS / VR-IAC-ANT-WS) - 1
             IF FATOR-INSUF-PF-WS LESS ZEROS
                MOVE 1 TO SW-ERRO-TBTX
                DISPLAY '*******************************************'
                DISPLAY '**P04808 - FATOR IAC ESTAH NEGATIVO      **'
                DISPLAY '**DATA-MOVIMENTO - '  CH-DATA-D07
                DISPLAY '**IAC-DAY        - '  VR-IAC-ANT-WS
                DISPLAY '**IAC-DAY-NEXT   - '  VR-IAC-ATL-WS
                DISPLAY '**FATOR-IAC      - '  FATOR-INSUF-PF-WS
                DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'
                DISPLAY '**           GILSON 299.3629             **'
                DISPLAY '*******************************************'.

           IF  NOT  HOUVE-ERRO-TBTX
               IF FATOR-EXCESSO-PJ-ANT-WS EQUAL ZEROS
                  IF PRM-CALC-EXCESSO
                 DISPLAY '*******************************************'
                 DISPLAY '** P04808 - FATOR EXCESSO P.JURIDICA     **'
                 DISPLAY '**          ESTAH ZERADO                 **'
                 DISPLAY '** DATA-MOVIMENTO    ' CH-DATA-D07
                 DISPLAY '** FATOR EXCESSO P.J ' FATOR-EXCESSO-PJ-ANT-WS
                 DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'
                 DISPLAY '**           GILSON 299.3629             **'
                 DISPLAY '*******************************************'
                 MOVE ZEROS TO FATOR-EXCESSO-PJ-ANT-WS.

           IF  NOT  HOUVE-ERRO-TBTX
               IF FATOR-EXCESSO-PF-ANT-WS EQUAL ZEROS
                  IF PRM-CALC-EXCESSO
                 DISPLAY '*******************************************'
                 DISPLAY '** P04808 - FATOR EXCESSO P.FISICAS      **'
                 DISPLAY '**          ESTAH ZERADO                 **'
                 DISPLAY '** DATA-MOVIMENTO    ' CH-DATA-D07
                 DISPLAY '** FATOR EXCESSO P.F ' FATOR-EXCESSO-PF-ANT-WS
                 DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'
                 DISPLAY '**           GILSON 299.3629             **'
                 DISPLAY '*******************************************'
                 MOVE ZEROS TO FATOR-EXCESSO-PF-ANT-WS.

           IF  HOUVE-ERRO-TBTX
               DISPLAY '* P04808 CANCELADO - PROBLEMAS NA TBTX DEVOL *'
               MOVE COD-RETORNO-WS (4) TO RETURN-CODE
               DISPLAY 'RETURN CODE EH .. ' COD-RETORNO-WS (4)
               DISPLAY 'MENSAGEM RETORNO EH ' MEN-RETORNO-WS (4)
               GOBACK.

155620 999-39-VERIFICA-SLD-DECORR.                                      00155620
155630                                                                  00155630
155640     COMPUTE SLD-DEV-NUM-WS = SLD-EMP-RED-WS + SLD-DEP-RED-WS -   00155640
155650                 (SLD-BLO-RED-WS (1) + SLD-BLO-RED-WS (2) +       00155650
155660                  SLD-BLO-RED-WS (3) + SLD-BLO-RED-WS (4) +       00155660
155670                  SLD-BLO-RED-WS (5) + SLD-BLO-RED-WS (6) +       00155670
155680                  SLD-BLO-RED-WS (7) + SLD-BLO-RED-WS (8) +       00155680
155690                  SLD-BLO-RED-WS (9) + SLD-BLO-RED-WS (10) +      00155690
155700                  SLD-BLO-RED-WS (11) + SLD-BLO-RED-WS (12) +     00155700
155710                  SLD-BLO-RED-WS (13) + SLD-BLO-RED-WS (14) +     00155710
155720                  SLD-BLO-RED-WS (15) + SLD-BLO-RED-WS (16) +     00155720
155730                  SLD-BLO-RED-WS (17) + SLD-BLO-RED-WS (18) +     00155730
155740                  SLD-BLO-RED-WS (19) + SLD-BLO-RED-WS (20) +     00155740
155750                  SLD-BLO-RED-WS (21)).                           00155750
155760                                                                  00155760
156410 999-41-APURA-GR-DEB-CRED.                                        00156410
156420                                                                  00156420
156430     MOVE CLASSE-TAB (CH-AG-WS) TO CLASSE-TAB-WS.                 00156430
156440     IF CLASSE-ESPECIAL                                           00156440
156450        COMPUTE GR-CRED-DEB-FIS-WS = BTN-D01-WS * 5000,00         00156450
156460        COMPUTE GR-CRED-DEB-JUR-WS = BTN-D01-WS * 10000,00        00156460
156470     ELSE                                                         00156470
156480      IF PRIMEIRA-CLASSE                                          00156480
156490         COMPUTE GR-CRED-DEB-FIS-WS = BTN-D01-WS * 2500,00        00156490
156500         COMPUTE GR-CRED-DEB-JUR-WS = BTN-D01-WS * 5000,00        00156500
156510      ELSE                                                        00156510
156520       IF SEGUNDA-CLASSE                                          00156520
156530          COMPUTE GR-CRED-DEB-FIS-WS = BTN-D01-WS * 1250,00       00156530
156540          COMPUTE GR-CRED-DEB-JUR-WS = BTN-D01-WS * 2500,00       00156540
156550       ELSE                                                       00156550
156560        IF TERCEIRA-CLASSE                                        00156560
156570           COMPUTE GR-CRED-DEB-FIS-WS = BTN-D01-WS *  800,00      00156570
156580           COMPUTE GR-CRED-DEB-JUR-WS = BTN-D01-WS * 1600,00      00156580
156590        ELSE                                                      00156590
156600           COMPUTE GR-CRED-DEB-FIS-WS = BTN-D01-WS *  500,00      00156600
156610           COMPUTE GR-CRED-DEB-JUR-WS = BTN-D01-WS * 1000,00.     00156610
156620                                                                  00156620
156630     IF CH-AG-WS = 027                                            00156630
156640        MOVE 10000,00 TO GR-CRED-DEB-FIS-WS                       00156640
156650        MOVE 20000,00 TO GR-CRED-DEB-JUR-WS.                      00156650
156660                                                                  00156660
156670 999-42-ACESSA-TAB-AGENCIAS.                                      00156670
156680                                                                  00156680
156690     MOVE COD-AGN-D01 TO AGENCIA-TAB (COD-AGN-D01).               00156690
156700     MOVE CLASSE-AG-D01 TO CLASSE-TAB (COD-AGN-D01).              00156700
156710                                                                  00156710
156720 999-43-CONTROLA-PERSONALIZACAO.                                  00156720
156730                                                                  00156730
156740     MOVE CH-AG-WS TO COD-AG-D19.                                 00156740
156750                                                                  00156750
156760     READ D04819.                                                 00156760
156770     IF  STATUS-D19-WS NOT EQUAL '00'                             00156770
156780         MOVE STATUS-D19-WS TO FILE-STATUS-WS                     00156780
156790         MOVE 'P04808 ERRO LEITURA NO D04819'                     00156790
156800             TO MENSAGEM-ERRO-WS                                  00156800
156810         PERFORM 999-99-ROT-ERRO.                                 00156810
156820                                                                  00156820
156830     MOVE 1 TO CONTROLE-PERSONA-D19.                              00156830
156840     MOVE DATA-D07-RED-WS TO DATA-D19.                            00156840
156850                                                                  00156850
156860     REWRITE REG-D19.                                             00156860
156870     IF  STATUS-D19-WS NOT EQUAL '00'                             00156870
156880         MOVE STATUS-D19-WS TO FILE-STATUS-WS                     00156880
156890         MOVE 'P04808 ERRO GRAVACAO NO D04819'                    00156890
156900             TO MENSAGEM-ERRO-WS                                  00156900
156910         PERFORM 999-99-ROT-ERRO.                                 00156910
156920                                                                  00156920
156930     CLOSE D04819.                                                00156930
156940     IF STATUS-D19-WS NOT EQUAL '00'                              00156940
156950         MOVE STATUS-D19-WS TO FILE-STATUS-WS                     00156950
156960         MOVE '**P04808-ERRO NO FECHAMENTO DO D04819**'           00156960
156970             TO MENSAGEM-ERRO-WS                                  00156970
156980         PERFORM 999-99-ROT-ERRO                                  00156980
156990     ELSE                                                         00156990
157000         MOVE 0 TO SW-ABRIU-D04819.                               00157000
157010                                                                  00157010
157020 999-44-ABRE-D04819.                                              00157020
157030                                                                  00157030
157040     OPEN I-O D04819.                                             00157040
157050     IF  STATUS-D19-WS EQUAL '93'                                 00157050
157060         CALL 'M095DLAY' USING INTERVALO-WS                       00157060
157070     ELSE                                                         00157070
157080     IF  STATUS-D19-WS EQUAL '00' OR '97'                         00157080
157090         MOVE 1 TO SW-ABRIU-D04819                                00157090
157100     ELSE                                                         00157100
157110     MOVE STATUS-D19-WS TO FILE-STATUS-WS                         00157110
157120     MOVE 'P04808 ERRO DE ABERTURA DO D04819**'                   00157120
157130            TO MENSAGEM-ERRO-WS                                   00157130
157140     PERFORM 999-99-ROT-ERRO.                                     00157140
157150
DOCINI****F* P04808/999-45-DIA-SEMANA
DOCTXT* OBJETIVO
DOCTXT*   Transforma datas de seis digitos em datas de oito digitos
DOCTXT*   atraves de call ao programa assembly M0952000. Alem disso,
DOCTXT*   recupera o dia da semana de forma numerica e textual atraves
DOCTXT*   de chamada ao P09102. RESTO-SEMANA-WS -> '2SEGUNDA FEIRA'
DOCEND******
157160 999-45-DIA-SEMANA.
157170                                                                  00157170
157180     MOVE CH-DATA-D07 TO DATA-MOV-LISTAO-WS.                      00157180
157190     MOVE DIA-MOV-LISTAO-WS TO DIA-LISTAO-WS DIA-PROX-WS.         00157190
157200     MOVE MES-MOV-LISTAO-WS TO MES-LISTAO-WS MES-PROX-WS.         00157200
157210     CALL 'M0952000' USING ANO-MOV-LISTAO-WS ANO-LISTAO-WS.       00157210
157220     CALL 'M0952000' USING ANO-MOV-LISTAO-WS ANO-PROX-WS.         00157220
157230                                                                  00157230
157240     MOVE DATA-LISTAO-WS TO DATA-LISTAO1-WS.                      00157240
157250                                                                  00157250
157260     MOVE '04' TO W091CL-TP-OPER.                                 00157260
157270     MOVE 999  TO W091CL-CD-AG-REQ.                               00157270
157280     MOVE DATA-LISTAO-WS TO W091CL-DT-INFOR-1.                    00157280
157290     MOVE 1 TO W091CL-ST-ARQ-RES.                                 00157290
157300     CALL 'P09102' USING W091CL-REGISTRO.                         00157300
157310     PERFORM 999-95-TESTE-VALIDADE-RETORNO.                       00157310
157320     IF  RETORNO-SUBROT-OK                                        00157320
157330        MOVE W091CL-SEMANA-RES TO RESTO-SEMANA-WS                 00157330
157340     ELSE                                                         00157340
157350        PERFORM 999-99-ROT-ERRO.                                  00157350
157360                                                                  00157360
157380 999-50-CALCULO-PROXIMA-DATA.                                     00157380
157390                                                                  00157390
157400     MOVE SPACES TO PROXIMO-DIA-WS.                               00157400
157410     ADD 1 TO DIA-PROX-WS.                                        00157410
157420                                                                  00157420
157430     IF  MES-PROX-WS EQUAL TO 04 OR 06 OR 09 OR 11                00157430
157440         IF  DIA-PROX-WS GREATER THAN 30                          00157440
157450             MOVE 01 TO DIA-PROX-WS                               00157450
157460             ADD 1 TO MES-PROX-WS                                 00157460
157470             PERFORM 999-60-PESQUISA-FERIADO                      00157470
157480         ELSE                                                     00157480
157490             PERFORM 999-60-PESQUISA-FERIADO                      00157490
157500     ELSE                                                         00157500
157510         IF  MES-PROX-WS EQUAL TO 02                              00157510
157520             MOVE ANO-PROX-WS TO DIVIDENDO-PROX-WS                00157520
157530             DIVIDE DIVIDENDO-PROX-WS BY 4                        00157530
157540                    GIVING    QUOCIENTE-PROX-WS                   00157540
157550                    REMAINDER RESTO-PROX-WS                       00157550
157560             IF  RESTO-PROX-WS GREATER THAN ZEROS                 00157560
157570                 IF  DIA-PROX-WS GREATER THAN 28                  00157570
157580                     MOVE 01 TO DIA-PROX-WS                       00157580
157590                     MOVE 03 TO MES-PROX-WS                       00157590
157600                     PERFORM 999-60-PESQUISA-FERIADO              00157600
157610                 ELSE                                             00157610
157620                     PERFORM 999-60-PESQUISA-FERIADO              00157620
157630             ELSE                                                 00157630
157640                 IF  DIA-PROX-WS GREATER THAN 29                  00157640
157650                     MOVE 01 TO DIA-PROX-WS                       00157650
157660                     MOVE 03 TO MES-PROX-WS                       00157660
157670                     PERFORM 999-60-PESQUISA-FERIADO              00157670
157680                 ELSE                                             00157680
157690                     PERFORM 999-60-PESQUISA-FERIADO              00157690
157700         ELSE                                                     00157700
157710             IF  DIA-PROX-WS GREATER THAN 31                      00157710
157720                 MOVE 01 TO DIA-PROX-WS                           00157720
157730                 ADD 1 TO MES-PROX-WS                             00157730
157740                 PERFORM 999-55-VERIFICA-MES-PROX                 00157740
157750             ELSE                                                 00157750
157760                 PERFORM 999-60-PESQUISA-FERIADO.                 00157760
157770                                                                  00157770
157780******************      SPREAD       *******************          00157780
157790 999-52-DIAS-NAO-UTEIS.                                           00157790
157800     MOVE ZEROS TO IND-DIA DIAS-NAO-UTEIS-WS.                     00157800
157810     IF MES-D07-WS = 02                                           00157810
157820        PERFORM 999-33C-TESTA-ANO-BISSEXTO                        00157820
157830        IF ANO-BISSEXTO                                           00157830
157840           PERFORM 999-53-PESQUISA-DIAS UNTIL                     00157840
157850                         IND-DIA = (NUM-DIAS-MES-TAB(02) + 1)     00157850
157860        ELSE                                                      00157860
157870           PERFORM 999-53-PESQUISA-DIAS UNTIL                     00157870
157880                         IND-DIA = NUM-DIAS-MES-TAB(MES-D07-WS)   00157880
157890     ELSE                                                         00157890
157900        PERFORM 999-53-PESQUISA-DIAS UNTIL                        00157900
157910                         IND-DIA = NUM-DIAS-MES-TAB(MES-D07-WS).  00157910
157920                                                                  00157920
157930 999-53-PESQUISA-DIAS.                                            00157930
157940     MOVE '01'         TO W091CL-TP-OPER.                         00157940
157950     MOVE CH-CODAG-D07 TO W091CL-CD-AG-REQ.                       00157950
157960     MOVE 1            TO W091CL-ST-ARQ-RES.                      00157960
157970     ADD 1             TO IND-DIA.                                00157970
157980     MOVE IND-DIA      TO W091CL-DD-INFOR-1.                      00157980
157990     MOVE MES-D07-WS   TO W091CL-MM-INFOR-1.                      00157990
158000     CALL 'M0952000' USING ANO-D07-WS W091CL-AA-INFOR-1.          00158000
158010     CALL 'P09102'   USING W091CL-REGISTRO.                       00158010
158020     PERFORM 999-95-TESTE-VALIDADE-RETORNO.                       00158020
158030     IF  RETORNO-SUBROT-OK                                        00158030
158040         IF W091CL-VAL-RESP-1 = 'S'                               00158040
158050            ADD 1 TO DIAS-NAO-UTEIS-WS                            00158050
158060         ELSE                                                     00158060
158070            NEXT SENTENCE                                         00158070
158080     ELSE                                                         00158080
158090         PERFORM 999-99-ROT-ERRO.                                 00158090
158100                                                                  00158100
158110********************************************************          00158110
158120                                                                  00158120
158130 999-55-VERIFICA-MES-PROX.                                        00158130
158140                                                                  00158140
158150     IF  MES-PROX-WS GREATER THAN 12                              00158150
158160         MOVE 01 TO MES-PROX-WS                                   00158160
158170         ADD 1 TO ANO-PROX-WS                                     00158170
158180         PERFORM 999-60-PESQUISA-FERIADO                          00158180
158190     ELSE                                                         00158190
158200         PERFORM 999-60-PESQUISA-FERIADO.                         00158200
158210                                                                  00158210
158220 999-60-PESQUISA-FERIADO.                                         00158220
158230                                                                  00158230
158240     MOVE '01'        TO W091CL-TP-OPER.                          00158240
158250     MOVE CH-AG-WS    TO W091CL-CD-AG-REQ.                        00158250
158260     MOVE DIA-PROX-WS TO W091CL-DD-INFOR-1.                       00158260
158270     MOVE MES-PROX-WS TO W091CL-MM-INFOR-1.                       00158270
158280     MOVE ANO-PROX-WS TO W091CL-AA-INFOR-1.                       00158280
158290     MOVE 1 TO W091CL-ST-ARQ-RES.                                 00158290
158300     CALL 'P09102'   USING W091CL-REGISTRO.                       00158300
158310     PERFORM 999-95-TESTE-VALIDADE-RETORNO.                       00158310
158320     IF  RETORNO-SUBROT-OK                                        00158320
158330         MOVE W091CL-VAL-RESP-1 TO PROXIMO-DIA-WS                 00158330
158340     ELSE                                                         00158340
158350         PERFORM 999-99-ROT-ERRO.                                 00158350
158360     MOVE ZEROS TO DATA-PROX-WS                                   00158360
158370                   DIVIDENDO-PROX-WS                              00158370
158380                   QUOCIENTE-PROX-WS                              00158380
158390                   RESTO-PROX-WS.                                 00158390
158400                                                                  00158400
158410***************************************************************** 00158410
158420***************************************************************** 00158420
158430***************************************************************** 00158430
158440                                                                  00158440
158450 999-65-TESTA-SE-HOUVE-FERIADO.                                   00158450
158460                                                                  00158460
158470     MOVE ZEROS TO SW-HA-FERIADO                                  00158470
158480                   SW-FIM-FERIADOS                                00158480
158490                   SW-FIM-PESQ-TAXAS                              00158490
158500                   DTA-PRIMEIRO-FERIADO-WS                        00158500
158510                   FATOR-INSUF-CAP-PF-WS                          00158510
158520                   FATOR-INSUF-CAP-PJ-WS                          00158520
158530                   FATOR-INSUF-CAP-CE-WS                          00158530
158540                   FATOR-INSUF-EXC-PF-WS                          00158540
158550                   FATOR-INSUF-EXC-PJ-WS                          00158550
158560                   FATOR-INSUF-EXC-CE-WS                          00158560
158570                   FATOR-EXCESSO-CAP-PF-WS                        00158570
158580                   FATOR-EXCESSO-CAP-PJ-WS                        00158580
158590                   FATOR-EXCESSO-CAP-CE-WS                        00158590
158600                   VR-IAC-PRIMEIRO-FERIADO-WS                     00158600
158610                   VR-ITAF-PRIMEIRO-FERIADO-WS                    00158610
158620                   VR-ITAH-PRIMEIRO-FERIADO-WS                    00158620
158630                   FATOR-JUROS-PFISICA-WS                         00158630
158640                   FATOR-JUROS-PJURIDICA-WS                       00158640
158650                   FATOR-JUROS-CTA-EMPRES-WS                      00158650
158660                   FATOR-JUROS-PJ-PP-WS                           00158660
158670                   FATOR-EXCESSO-PFISICA-WS                       00158670
158680                   FATOR-EXCESSO-PJURIDICA-WS                     00158680
158690                   FATOR-EXCESSO-CTA-EMPRES-WS                    00158690
158700                   QTDE-DIAS-FERIADO-WS.                          00158700
158710     MOVE 1 TO FATOR-JUR-CAP-PF-WS                                00158710
158720               FATOR-JUR-CAP-PF-F1                                00158720
158730               FATOR-JUR-CAP-PF-F2                                00158730
158740               FATOR-JUR-CAP-PF-F3                                00158740
158750               FATOR-JUR-CAP-PF-F4                                00158750
158760               FATOR-JUR-CAP-PF-F5                                00158760
158770               FATOR-JUR-CAP-PJ-WS                                00158770
158780               FATOR-JUR-CAP-PJ-F1                                00158780
158790               FATOR-JUR-CAP-PJ-F2                                00158790
158800               FATOR-JUR-CAP-PJ-F3                                00158800
158810               FATOR-JUR-CAP-PJ-F4                                00158810
158820               FATOR-JUR-CAP-PJ-PP-F1                             00158820
158830               FATOR-JUR-CAP-PJ-PP-F2                             00158830
158840               FATOR-JUR-CAP-PJ-PP-F3                             00158840
158850               FATOR-JUR-CAP-PJ-PP-F4                             00158850
158860               FATOR-JUR-CAP-CE-WS                                00158860
158870               SW-PESQUISA-PRIMEIRO-FERIADO.                      00158870
158880     PERFORM 999-97-ABRE-TAB-UTILS.                               00158880
158890     PERFORM 999-70-PESQUISA-FERIADOS-AG UNTIL FIM-FERIADOS.      00158890
158900     PERFORM 999-98-FECHA-TAB-UTILS.                              00158900
158910     IF HA-FERIADO                                                00158910
158920       PERFORM 999-90-CAPITALIZACAO-TAXAS                         00158920
158930       MOVE FATOR-JUR-CAP-CE-WS     TO FATOR-JUROS-CTA-EMPRES-WS  00158930
158940       MOVE FATOR-EXCESSO-CAP-PF-WS TO FATOR-EXCESSO-PFISICA-WS   00158940
158950       MOVE FATOR-EXCESSO-CAP-PJ-WS TO FATOR-EXCESSO-PJURIDICA-WS 00158950
158960       MOVE FATOR-EXCESSO-CAP-PJ-WS TO FATOR-EXCESSO-CTA-EMPRES-WS00158960
158970     ELSE                                                         00158970
158980        MOVE ZEROS               TO QTDE-DIAS-FERIADO-WS          00158980
158990        MOVE FATOR-JUR-CE-WS     TO FATOR-JUROS-CTA-EMPRES-WS     00158990
159000        MOVE FATOR-EXCESSO-PF-WS TO FATOR-EXCESSO-PFISICA-WS      00159000
159010        MOVE FATOR-EXCESSO-PJ-WS TO FATOR-EXCESSO-PJURIDICA-WS    00159010
159020        MOVE FATOR-EXCESSO-PJ-WS TO FATOR-EXCESSO-CTA-EMPRES-WS.  00159020
159030                                                                  00159030
159040 999-70-PESQUISA-FERIADOS-AG.                                     00159040
159050                                                                  00159050
159060     PERFORM 999-75-CALCULA-PROX-DATA-AG.                         00159060
159070     IF  DATA-ATL-ANTERIOR-AG-RED-WS EQUAL CH-DATA-D07            00159070
159080         MOVE 1 TO SW-FIM-FERIADOS                                00159080
159090     ELSE                                                         00159090
159100         ADD 1 TO QTDE-DIAS-FERIADO-WS                            00159100
159110         MOVE 1 TO SW-HA-FERIADO                                  00159110
159120         MOVE ZEROS TO SW-FIM-PESQ-TAXAS                          00159120
159130         IF  PESQUISA-PRIMEIRO-FERIADO                            00159130
159140             MOVE DATA-ATL-ANTERIOR-AG-RED-WS TO                  00159140
159150                  DTA-PRIMEIRO-FERIADO-WS                         00159150
159160             MOVE ZEROS TO SW-PESQUISA-PRIMEIRO-FERIADO           00159160
159170             PERFORM 999-80-ACESSA-SIEF-FERIADO                   00159170
159180         ELSE                                                     00159180
159190             PERFORM 999-80-ACESSA-SIEF-FERIADO.                  00159190
159200                                                                  00159200
159220 999-75-CALCULA-PROX-DATA-AG.                                     00159220
159230                                                                  00159230
159240     MOVE '02'              TO W091CL-TP-OPER.                    00159240
159250     MOVE 999               TO W091CL-CD-AG-REQ.                  00159250
159260     MOVE DIA-ATL-ANT-AG-WS TO W091CL-DD-INFOR-1.                 00159260
159270     MOVE MES-ATL-ANT-AG-WS TO W091CL-MM-INFOR-1.                 00159270
159280     CALL 'M0952000' USING ANO-ATL-ANT-AG-WS W091CL-AA-INFOR-1.   00159280
159290     MOVE 1 TO W091CL-ST-ARQ-RES.                                 00159290
159300     CALL 'P09102' USING W091CL-REGISTRO.                         00159300
159310     PERFORM 999-95-TESTE-VALIDADE-RETORNO.                       00159310
159320     IF  RETORNO-SUBROT-OK                                        00159320
159330         MOVE W091CL-RESP-2-3  TO DATA-ATL-ANT-AG-RED-WS          00159330
159340         MOVE DD-ATL-ANT-AG-WS TO DIA-ATL-ANT-AG-WS               00159340
159350         MOVE MM-ATL-ANT-AG-WS TO MES-ATL-ANT-AG-WS               00159350
159360         MOVE AA-ATL-ANT-AG-WS TO ANO-ATL-ANT-AG-WS               00159360
159370     ELSE                                                         00159370
159380         PERFORM 999-99-ROT-ERRO.                                 00159380
159390                                                                  00159390
159400 999-80-ACESSA-SIEF-FERIADO.                                      00159400
159410                                                                  00159410
159420     MOVE DIA-ATL-ANT-AG-WS TO DIA-SIEF-WS.                       00159420
159430     MOVE MES-ATL-ANT-AG-WS TO MES-SIEF-WS.                       00159430
159440     CALL 'M0952000' USING ANO-ATL-ANT-AG-WS ANO-SIEF-WS.         00159440
159450                                                                  00159450
159460                                                                  00159460
159470     MOVE 048             TO W09508-CD-SIS-SLT.                   00159470
159480     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00159480
159490     MOVE 28              TO W09508-CD-ID-ECF.                    00159490
159500     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00159500
159510     CALL 'P09511' USING W09508-AREA-SIEF.                        00159510
159520     IF W09508-CD-RET-ROT = '**'                                  00159520
159530      IF W09508-CD-TP-ID EQUAL 2                                  00159530
159540         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00159540
159550         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00159550
159560                                            DIV-SIEF-WS           00159560
159570         COMPUTE FATOR-JUR-CAP-PJ-WS ROUNDED =                    00159570
159580                FATOR-JUR-CAP-PJ-WS * (1 + W09508-VR-ID-ECF / 100)00159580
159590      ELSE                                                        00159590
159600         COMPUTE FATOR-JUR-CAP-PJ-WS ROUNDED =                    00159600
159610               FATOR-JUR-CAP-PJ-WS * (1 + W09508-VR-ID-ECF / 100) 00159610
159620     ELSE                                                         00159620
159630        MOVE '** P04808 ERRO ACESSO TABELA SIEF 50 **'            00159630
159640              TO MENSAGEM-ERRO-WS                                 00159640
159650        DISPLAY W09508-CD-ID-ECF                                  00159650
159660        DISPLAY W09508-DT-REF-CNS                                 00159660
159670        DISPLAY W09508-CD-RET-ROT                                 00159670
159680        DISPLAY W09508-DE-MSG-RET                                 00159680
159690        DISPLAY W09508-SQLCODE                                    00159690
159700        PERFORM 999-99-ROT-ERRO.                                  00159700
159710                                                                  00159710
159720     IF W09508-VR-ID-ECF EQUAL ZEROS                              00159720
159730        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00159730
159740        DISPLAY '*******************************************'     00159740
159750        DISPLAY '** P04808 - FATOR CH.EMPRESA EH ZEROS    **'     00159750
159760        DISPLAY '** DATA-FERIADO      '  DATA-SIEF-WS             00159760
159770        DISPLAY '** FATOR CH.EMPRESA  '  W09508-VR-ID-ECF         00159770
159780        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00159780
159790        DISPLAY '**           GILSON 299.3629             **'     00159790
159800        DISPLAY '*******************************************'.    00159800
159810                                                                  00159810
159820*----NOVOS INDICES CH.EMPRESA------------------------------------ 00159820
159830                                                                  00159830
159840     MOVE 048             TO W09508-CD-SIS-SLT.                   00159840
159850     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00159850
159860     MOVE 167             TO W09508-CD-ID-ECF.                    00159860
159870     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00159870
159880     CALL 'P09511' USING W09508-AREA-SIEF.                        00159880
159890     IF W09508-CD-RET-ROT = '**'                                  00159890
159900      IF W09508-CD-TP-ID EQUAL 2                                  00159900
159910         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00159910
159920         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00159920
159930                                            DIV-SIEF-WS           00159930
159940         COMPUTE FATOR-JUR-CAP-PJ-F1 ROUNDED =                    00159940
159950                FATOR-JUR-CAP-PJ-F1 * (1 + W09508-VR-ID-ECF / 100)00159950
159960      ELSE                                                        00159960
159970         COMPUTE FATOR-JUR-CAP-PJ-F1 ROUNDED =                    00159970
159980               FATOR-JUR-CAP-PJ-F1 * (1 + W09508-VR-ID-ECF / 100) 00159980
159990     ELSE                                                         00159990
160000        MOVE '** P04808 ERRO ACESSO TABELA SIEF 51 **'            00160000
160010              TO MENSAGEM-ERRO-WS                                 00160010
160020        DISPLAY W09508-CD-ID-ECF                                  00160020
160030        DISPLAY W09508-DT-REF-CNS                                 00160030
160040        DISPLAY W09508-CD-RET-ROT                                 00160040
160050        DISPLAY W09508-DE-MSG-RET                                 00160050
160060        DISPLAY W09508-SQLCODE                                    00160060
160070        PERFORM 999-99-ROT-ERRO.                                  00160070
160080                                                                  00160080
160090     IF W09508-VR-ID-ECF EQUAL ZEROS                              00160090
160100        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00160100
160110        DISPLAY '*******************************************'     00160110
160120        DISPLAY '** P04808 - FATOR CH.EMPRESA EH ZEROS    **'     00160120
160130        DISPLAY '** DATA-FERIADO      '  DATA-SIEF-WS             00160130
160140        DISPLAY '** FATOR CH.EMPR. F1 '  W09508-VR-ID-ECF         00160140
160150        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00160150
160160        DISPLAY '**           GILSON 299.3629             **'     00160160
160170        DISPLAY '*******************************************'.    00160170
160180                                                                  00160180
160190     MOVE 048             TO W09508-CD-SIS-SLT.                   00160190
160200     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00160200
160210     MOVE 169             TO W09508-CD-ID-ECF.                    00160210
160220     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00160220
160230     CALL 'P09511' USING W09508-AREA-SIEF.                        00160230
160240     IF W09508-CD-RET-ROT = '**'                                  00160240
160250      IF W09508-CD-TP-ID EQUAL 2                                  00160250
160260         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00160260
160270         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00160270
160280                                            DIV-SIEF-WS           00160280
160290         COMPUTE FATOR-JUR-CAP-PJ-F2 ROUNDED =                    00160290
160300                FATOR-JUR-CAP-PJ-F2 * (1 + W09508-VR-ID-ECF / 100)00160300
160310      ELSE                                                        00160310
160320         COMPUTE FATOR-JUR-CAP-PJ-F2 ROUNDED =                    00160320
160330               FATOR-JUR-CAP-PJ-F2 * (1 + W09508-VR-ID-ECF / 100) 00160330
160340     ELSE                                                         00160340
160350        MOVE '** P04808 ERRO ACESSO TABELA SIEF 52 **'            00160350
160360              TO MENSAGEM-ERRO-WS                                 00160360
160370        DISPLAY W09508-CD-ID-ECF                                  00160370
160380        DISPLAY W09508-DT-REF-CNS                                 00160380
160390        DISPLAY W09508-CD-RET-ROT                                 00160390
160400        DISPLAY W09508-DE-MSG-RET                                 00160400
160410        DISPLAY W09508-SQLCODE                                    00160410
160420        PERFORM 999-99-ROT-ERRO.                                  00160420
160430                                                                  00160430
160440     IF W09508-VR-ID-ECF EQUAL ZEROS                              00160440
160450        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00160450
160460        DISPLAY '*******************************************'     00160460
160470        DISPLAY '** P04808 - FATOR CH.EMPRESA EH ZEROS    **'     00160470
160480        DISPLAY '** DATA-FERIADO      '  DATA-SIEF-WS             00160480
160490        DISPLAY '** FATOR CH.EMPR. F2 '  W09508-VR-ID-ECF         00160490
160500        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00160500
160510        DISPLAY '**           GILSON 299.3629             **'     00160510
160520        DISPLAY '*******************************************'.    00160520
160530                                                                  00160530
160540     MOVE 048             TO W09508-CD-SIS-SLT.                   00160540
160550     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00160550
160560     MOVE 171             TO W09508-CD-ID-ECF.                    00160560
160570     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00160570
160580     CALL 'P09511' USING W09508-AREA-SIEF.                        00160580
160590     IF W09508-CD-RET-ROT = '**'                                  00160590
160600      IF W09508-CD-TP-ID EQUAL 2                                  00160600
160610         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00160610
160620         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00160620
160630                                            DIV-SIEF-WS           00160630
160640         COMPUTE FATOR-JUR-CAP-PJ-F3 ROUNDED =                    00160640
160650                FATOR-JUR-CAP-PJ-F3 * (1 + W09508-VR-ID-ECF / 100)00160650
160660      ELSE                                                        00160660
160670         COMPUTE FATOR-JUR-CAP-PJ-F3 ROUNDED =                    00160670
160680               FATOR-JUR-CAP-PJ-F3 * (1 + W09508-VR-ID-ECF / 100) 00160680
160690     ELSE                                                         00160690
160700        MOVE '** P04808 ERRO ACESSO TABELA SIEF 53 **'            00160700
160710              TO MENSAGEM-ERRO-WS                                 00160710
160720        DISPLAY W09508-CD-ID-ECF                                  00160720
160730        DISPLAY W09508-DT-REF-CNS                                 00160730
160740        DISPLAY W09508-CD-RET-ROT                                 00160740
160750        DISPLAY W09508-DE-MSG-RET                                 00160750
160760        DISPLAY W09508-SQLCODE                                    00160760
160770        PERFORM 999-99-ROT-ERRO.                                  00160770
160780                                                                  00160780
160790     IF W09508-VR-ID-ECF EQUAL ZEROS                              00160790
160800        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00160800
160810        DISPLAY '*******************************************'     00160810
160820        DISPLAY '** P04808 - FATOR CH.EMPRESA EH ZEROS    **'     00160820
160830        DISPLAY '** DATA-FERIADO      '  DATA-SIEF-WS             00160830
160840        DISPLAY '** FATOR CH.EMPR. F3 '  W09508-VR-ID-ECF         00160840
160850        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00160850
160860        DISPLAY '**           GILSON 299.3629             **'     00160860
160870        DISPLAY '*******************************************'.    00160870
160880                                                                  00160880
160890     MOVE 048             TO W09508-CD-SIS-SLT.                   00160890
160900     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00160900
160910     MOVE 28              TO W09508-CD-ID-ECF.                    00160910
160920     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00160920
160930     CALL 'P09511' USING W09508-AREA-SIEF.                        00160930
160940     IF W09508-CD-RET-ROT = '**'                                  00160940
160950      IF W09508-CD-TP-ID EQUAL 2                                  00160950
160960         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00160960
160970         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00160970
160980                                            DIV-SIEF-WS           00160980
160990         COMPUTE FATOR-JUR-CAP-PJ-F4 ROUNDED =                    00160990
161000                FATOR-JUR-CAP-PJ-F4 * (1 + W09508-VR-ID-ECF / 100)00161000
161010      ELSE                                                        00161010
161020         COMPUTE FATOR-JUR-CAP-PJ-F4 ROUNDED =                    00161020
161030               FATOR-JUR-CAP-PJ-F4 * (1 + W09508-VR-ID-ECF / 100) 00161030
161040     ELSE                                                         00161040
161050        MOVE '** P04808 ERRO ACESSO TABELA SIEF 54 **'            00161050
161060              TO MENSAGEM-ERRO-WS                                 00161060
161070        DISPLAY W09508-CD-ID-ECF                                  00161070
161080        DISPLAY W09508-DT-REF-CNS                                 00161080
161090        DISPLAY W09508-CD-RET-ROT                                 00161090
161100        DISPLAY W09508-DE-MSG-RET                                 00161100
161110        DISPLAY W09508-SQLCODE                                    00161110
161120        PERFORM 999-99-ROT-ERRO.                                  00161120
161130                                                                  00161130
161140     IF W09508-VR-ID-ECF EQUAL ZEROS                              00161140
161150        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00161150
161160        DISPLAY '*******************************************'     00161160
161170        DISPLAY '** P04808 - FATOR CH.EMPRESA EH ZEROS    **'     00161170
161180        DISPLAY '** DATA-FERIADO      '  DATA-SIEF-WS             00161180
161190        DISPLAY '** FATOR CH.EMPR. F4 '  W09508-VR-ID-ECF         00161190
161200        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00161200
161210        DISPLAY '**           GILSON 299.3629             **'     00161210
161220        DISPLAY '*******************************************'.    00161220
161230                                                                  00161230
161240*----NOVOS INDICES CH.EMPRESA - PROJETO PILOTO ------------------ 00161240
161250                                                                  00161250
161260     MOVE 048             TO W09508-CD-SIS-SLT.                   00161260
161270     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00161270
161280     MOVE 272             TO W09508-CD-ID-ECF.                    00161280
161290     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00161290
161300     CALL 'P09511' USING W09508-AREA-SIEF.                        00161300
161310     IF W09508-CD-RET-ROT = '**'                                  00161310
161320      IF W09508-CD-TP-ID EQUAL 2                                  00161320
161330         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00161330
161340         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00161340
161350                                            DIV-SIEF-WS           00161350
161360         COMPUTE FATOR-JUR-CAP-PJ-PP-F1 ROUNDED =                 00161360
161370            FATOR-JUR-CAP-PJ-PP-F1 * (1 + W09508-VR-ID-ECF / 100) 00161370
161380      ELSE                                                        00161380
161390         COMPUTE FATOR-JUR-CAP-PJ-PP-F1 ROUNDED =                 00161390
161400            FATOR-JUR-CAP-PJ-PP-F1 * (1 + W09508-VR-ID-ECF / 100) 00161400
161410     ELSE                                                         00161410
161420        MOVE '** P04808 ERRO ACESSO TABELA SIEF 55 **'            00161420
161430              TO MENSAGEM-ERRO-WS                                 00161430
161440        DISPLAY W09508-CD-ID-ECF                                  00161440
161450        DISPLAY W09508-DT-REF-CNS                                 00161450
161460        DISPLAY W09508-CD-RET-ROT                                 00161460
161470        DISPLAY W09508-DE-MSG-RET                                 00161470
161480        DISPLAY W09508-SQLCODE                                    00161480
161490        PERFORM 999-99-ROT-ERRO.                                  00161490
161500                                                                  00161500
161510     IF W09508-VR-ID-ECF EQUAL ZEROS                              00161510
161520        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00161520
161530        DISPLAY '*******************************************'     00161530
161540        DISPLAY '** P04808 - FATOR CH.EMPRESA EH ZEROS    **'     00161540
161550        DISPLAY '** DATA-FERIADO        '  DATA-SIEF-WS           00161550
161560        DISPLAY '** FATOR CH.EMPR.PP F1 '  W09508-VR-ID-ECF       00161560
161570        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00161570
161580        DISPLAY '**           GILSON 299.3629             **'     00161580
161590        DISPLAY '*******************************************'.    00161590
161600                                                                  00161600
161610     MOVE 048             TO W09508-CD-SIS-SLT.                   00161610
161620     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00161620
161630     MOVE 273             TO W09508-CD-ID-ECF.                    00161630
161640     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00161640
161650     CALL 'P09511' USING W09508-AREA-SIEF.                        00161650
161660     IF W09508-CD-RET-ROT = '**'                                  00161660
161670      IF W09508-CD-TP-ID EQUAL 2                                  00161670
161680         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00161680
161690         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00161690
161700                                            DIV-SIEF-WS           00161700
161710         COMPUTE FATOR-JUR-CAP-PJ-PP-F2 ROUNDED =                 00161710
161720            FATOR-JUR-CAP-PJ-PP-F2 * (1 + W09508-VR-ID-ECF / 100) 00161720
161730      ELSE                                                        00161730
161740         COMPUTE FATOR-JUR-CAP-PJ-PP-F2 ROUNDED =                 00161740
161750            FATOR-JUR-CAP-PJ-PP-F2 * (1 + W09508-VR-ID-ECF / 100) 00161750
161760     ELSE                                                         00161760
161770        MOVE '** P04808 ERRO ACESSO TABELA SIEF 56 **'            00161770
161780              TO MENSAGEM-ERRO-WS                                 00161780
161790        DISPLAY W09508-CD-ID-ECF                                  00161790
161800        DISPLAY W09508-DT-REF-CNS                                 00161800
161810        DISPLAY W09508-CD-RET-ROT                                 00161810
161820        DISPLAY W09508-DE-MSG-RET                                 00161820
161830        DISPLAY W09508-SQLCODE                                    00161830
161840        PERFORM 999-99-ROT-ERRO.                                  00161840
161850                                                                  00161850
161860     IF W09508-VR-ID-ECF EQUAL ZEROS                              00161860
161870        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00161870
161880        DISPLAY '*******************************************'     00161880
161890        DISPLAY '** P04808 - FATOR CH.EMPRESA EH ZEROS    **'     00161890
161900        DISPLAY '** DATA-FERIADO         '  DATA-SIEF-WS          00161900
161910        DISPLAY '** FATOR CH.EMPR. PP F2 '  W09508-VR-ID-ECF      00161910
161920        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00161920
161930        DISPLAY '**           GILSON 299.3629             **'     00161930
161940        DISPLAY '*******************************************'.    00161940
161950                                                                  00161950
161960     MOVE 048             TO W09508-CD-SIS-SLT.                   00161960
161970     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00161970
161980     MOVE 274             TO W09508-CD-ID-ECF.                    00161980
161990     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00161990
162000     CALL 'P09511' USING W09508-AREA-SIEF.                        00162000
162010     IF W09508-CD-RET-ROT = '**'                                  00162010
162020      IF W09508-CD-TP-ID EQUAL 2                                  00162020
162030         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00162030
162040         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00162040
162050                                            DIV-SIEF-WS           00162050
162060         COMPUTE FATOR-JUR-CAP-PJ-PP-F3 ROUNDED =                 00162060
162070            FATOR-JUR-CAP-PJ-PP-F3 * (1 + W09508-VR-ID-ECF / 100) 00162070
162080      ELSE                                                        00162080
162090         COMPUTE FATOR-JUR-CAP-PJ-PP-F3 ROUNDED =                 00162090
162100            FATOR-JUR-CAP-PJ-PP-F3 * (1 + W09508-VR-ID-ECF / 100) 00162100
162110     ELSE                                                         00162110
162120        MOVE '** P04808 ERRO ACESSO TABELA SIEF 57 **'            00162120
162130              TO MENSAGEM-ERRO-WS                                 00162130
162140        DISPLAY W09508-CD-ID-ECF                                  00162140
162150        DISPLAY W09508-DT-REF-CNS                                 00162150
162160        DISPLAY W09508-CD-RET-ROT                                 00162160
162170        DISPLAY W09508-DE-MSG-RET                                 00162170
162180        DISPLAY W09508-SQLCODE                                    00162180
162190        PERFORM 999-99-ROT-ERRO.                                  00162190
162200                                                                  00162200
162210     IF W09508-VR-ID-ECF EQUAL ZEROS                              00162210
162220        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00162220
162230        DISPLAY '*******************************************'     00162230
162240        DISPLAY '** P04808 - FATOR CH.EMPRESA EH ZEROS    **'     00162240
162250        DISPLAY '** DATA-FERIADO        '  DATA-SIEF-WS           00162250
162260        DISPLAY '** FATOR CH.EMPR.PP F3 '  W09508-VR-ID-ECF       00162260
162270        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00162270
162280        DISPLAY '**           GILSON 299.3629             **'     00162280
162290        DISPLAY '*******************************************'.    00162290
162300                                                                  00162300
162310     MOVE 048             TO W09508-CD-SIS-SLT.                   00162310
162320     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00162320
162330     MOVE 275             TO W09508-CD-ID-ECF.                    00162330
162340     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00162340
162350     CALL 'P09511' USING W09508-AREA-SIEF.                        00162350
162360     IF W09508-CD-RET-ROT = '**'                                  00162360
162370      IF W09508-CD-TP-ID EQUAL 2                                  00162370
162380         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00162380
162390         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00162390
162400                                            DIV-SIEF-WS           00162400
162410         COMPUTE FATOR-JUR-CAP-PJ-PP-F4 ROUNDED =                 00162410
162420            FATOR-JUR-CAP-PJ-PP-F4 * (1 + W09508-VR-ID-ECF / 100) 00162420
162430      ELSE                                                        00162430
162440         COMPUTE FATOR-JUR-CAP-PJ-PP-F4 ROUNDED =                 00162440
162450            FATOR-JUR-CAP-PJ-PP-F4 * (1 + W09508-VR-ID-ECF / 100) 00162450
162460     ELSE                                                         00162460
162470        MOVE '** P04808 ERRO ACESSO TABELA SIEF 58 **'            00162470
162480              TO MENSAGEM-ERRO-WS                                 00162480
162490        DISPLAY W09508-CD-ID-ECF                                  00162490
162500        DISPLAY W09508-DT-REF-CNS                                 00162500
162510        DISPLAY W09508-CD-RET-ROT                                 00162510
162520        DISPLAY W09508-DE-MSG-RET                                 00162520
162530        DISPLAY W09508-SQLCODE                                    00162530
162540        PERFORM 999-99-ROT-ERRO.                                  00162540
162550                                                                  00162550
162560     IF W09508-VR-ID-ECF EQUAL ZEROS                              00162560
162570        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00162570
162580        DISPLAY '*******************************************'     00162580
162590        DISPLAY '** P04808 - FATOR CH.EMPRESA EH ZEROS    **'     00162590
162600        DISPLAY '** DATA-FERIADO         '  DATA-SIEF-WS          00162600
162610        DISPLAY '** FATOR CH.EMPR. PP F4 '  W09508-VR-ID-ECF      00162610
162620        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00162620
162630        DISPLAY '**           GILSON 299.3629             **'     00162630
162640        DISPLAY '*******************************************'.    00162640
162650                                                                  00162650
162660*----NOVOS INDICES CH.ESPECIAL------------------------------      00162660
162680                                                                  00162680
162690     MOVE 048             TO W09508-CD-SIS-SLT.                   00162690
162700     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00162700
162710     MOVE 158             TO W09508-CD-ID-ECF.                    00162710
162720     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00162720
162730     CALL 'P09511' USING W09508-AREA-SIEF.                        00162730
162740     IF W09508-CD-RET-ROT = '**'                                  00162740
162750      IF W09508-CD-TP-ID EQUAL 2                                  00162750
162760         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00162760
162770         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00162770
162780                                           DIV-SIEF-WS            00162780
162790         COMPUTE FATOR-JUR-CAP-PF-F1 ROUNDED =                    00162790
162800                FATOR-JUR-CAP-PF-F1 * (1 + W09508-VR-ID-ECF / 100)00162800
162810      ELSE                                                        00162810
162820         COMPUTE FATOR-JUR-CAP-PF-F1 ROUNDED =                    00162820
162830                FATOR-JUR-CAP-PF-F1 * (1 + W09508-VR-ID-ECF / 100)00162830
162840     ELSE                                                         00162840
162850        MOVE '** P04808 ERRO ACESSO TABELA SIEF 59 **'            00162850
162860              TO MENSAGEM-ERRO-WS                                 00162860
162870        DISPLAY W09508-CD-ID-ECF                                  00162870
162880        DISPLAY W09508-DT-REF-CNS                                 00162880
162890        DISPLAY W09508-CD-RET-ROT                                 00162890
162900        DISPLAY W09508-DE-MSG-RET                                 00162900
162910        DISPLAY W09508-SQLCODE                                    00162910
162920        PERFORM 999-99-ROT-ERRO.                                  00162920
162930                                                                  00162930
162940     IF W09508-VR-ID-ECF EQUAL ZEROS                              00162940
162950        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00162950
162960        DISPLAY '*******************************************'     00162960
162970        DISPLAY '** P04808 - FATOR CH.ESPECIAL EH ZEROS   **'     00162970
162980        DISPLAY '** DATA-FERIADO      '  DATA-SIEF-WS             00162980
162990        DISPLAY '** FATOR CH.ESPEC. F1'  W09508-VR-ID-ECF         00162990
163000        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00163000
163010        DISPLAY '**           GILSON 299.3629             **'     00163010
163020        DISPLAY '*******************************************'.    00163020
163030                                                                  00163030
163040     MOVE 048             TO W09508-CD-SIS-SLT.                   00163040
163050     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00163050
163060     MOVE 161             TO W09508-CD-ID-ECF.                    00163060
163070     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00163070
163080     CALL 'P09511' USING W09508-AREA-SIEF.                        00163080
163090     IF W09508-CD-RET-ROT = '**'                                  00163090
163100      IF W09508-CD-TP-ID EQUAL 2                                  00163100
163110         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00163110
163120         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00163120
163130                                           DIV-SIEF-WS            00163130
163140         COMPUTE FATOR-JUR-CAP-PF-F2 ROUNDED =                    00163140
163150                FATOR-JUR-CAP-PF-F2 * (1 + W09508-VR-ID-ECF / 100)00163150
163160      ELSE                                                        00163160
163170         COMPUTE FATOR-JUR-CAP-PF-F2 ROUNDED =                    00163170
163180                FATOR-JUR-CAP-PF-F2 * (1 + W09508-VR-ID-ECF / 100)00163180
163190     ELSE                                                         00163190
163200        MOVE '** P04808 ERRO ACESSO TABELA SIEF 60 **'            00163200
163210              TO MENSAGEM-ERRO-WS                                 00163210
163220        DISPLAY W09508-CD-ID-ECF                                  00163220
163230        DISPLAY W09508-DT-REF-CNS                                 00163230
163240        DISPLAY W09508-CD-RET-ROT                                 00163240
163250        DISPLAY W09508-DE-MSG-RET                                 00163250
163260        DISPLAY W09508-SQLCODE                                    00163260
163270        PERFORM 999-99-ROT-ERRO.                                  00163270
163280                                                                  00163280
163290     IF W09508-VR-ID-ECF EQUAL ZEROS                              00163290
163300        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00163300
163310        DISPLAY '*******************************************'     00163310
163320        DISPLAY '** P04808 - FATOR CH.ESPECIAL EH ZEROS   **'     00163320
163330        DISPLAY '** DATA-FERIADO      '  DATA-SIEF-WS             00163330
163340        DISPLAY '** FATOR CH.ESPEC. F2'  W09508-VR-ID-ECF         00163340
163350        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00163350
163360        DISPLAY '**           GILSON 299.3629             **'     00163360
163370        DISPLAY '*******************************************'.    00163370
163380                                                                  00163380
163390     MOVE 048             TO W09508-CD-SIS-SLT.                   00163390
163400     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00163400
163410     MOVE 290             TO W09508-CD-ID-ECF.                    00163410
163420     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00163420
163430     CALL 'P09511' USING W09508-AREA-SIEF.                        00163430
163440     IF W09508-CD-RET-ROT = '**'                                  00163440
163450      IF W09508-CD-TP-ID EQUAL 2                                  00163450
163460         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00163460
163470         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00163470
163480                                           DIV-SIEF-WS            00163480
163490         COMPUTE FATOR-JUR-CAP-PF-F3 ROUNDED =                    00163490
163500                FATOR-JUR-CAP-PF-F3 * (1 + W09508-VR-ID-ECF / 100)00163500
163510      ELSE                                                        00163510
163520         COMPUTE FATOR-JUR-CAP-PF-F3 ROUNDED =                    00163520
163530                FATOR-JUR-CAP-PF-F3 * (1 + W09508-VR-ID-ECF / 100)00163530
163540     ELSE                                                         00163540
163550        MOVE '** P04808 ERRO ACESSO TABELA SIEF 61 **'            00163550
163560              TO MENSAGEM-ERRO-WS                                 00163560
163570        DISPLAY W09508-CD-ID-ECF                                  00163570
163580        DISPLAY W09508-DT-REF-CNS                                 00163580
163590        DISPLAY W09508-CD-RET-ROT                                 00163590
163600        DISPLAY W09508-DE-MSG-RET                                 00163600
163610        DISPLAY W09508-SQLCODE                                    00163610
163620        PERFORM 999-99-ROT-ERRO.                                  00163620
163630                                                                  00163630
163640     IF W09508-VR-ID-ECF EQUAL ZEROS                              00163640
163650        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00163650
163660        DISPLAY '*******************************************'     00163660
163670        DISPLAY '** P04808 - FATOR CH.ESPECIAL EH ZEROS   **'     00163670
163680        DISPLAY '** DATA-FERIADO      '  DATA-SIEF-WS             00163680
163690        DISPLAY '** FATOR CH.ESPEC. F3'  W09508-VR-ID-ECF         00163690
163700        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00163700
163710        DISPLAY '**           GILSON 299.3629             **'     00163710
163720        DISPLAY '*******************************************'.    00163720
163730                                                                  00163730
163740     MOVE 048             TO W09508-CD-SIS-SLT.                   00163740
163750     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00163750
163760     MOVE 305             TO W09508-CD-ID-ECF.                    00163760
163770     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00163770
163780     CALL 'P09511' USING W09508-AREA-SIEF.                        00163780
163790     IF W09508-CD-RET-ROT = '**'                                  00163790
163800      IF W09508-CD-TP-ID EQUAL 2                                  00163800
163810         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00163810
163820         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00163820
163830                                           DIV-SIEF-WS            00163830
163840         COMPUTE FATOR-JUR-CAP-PF-F4 ROUNDED =                    00163840
163850                FATOR-JUR-CAP-PF-F4 * (1 + W09508-VR-ID-ECF / 100)00163850
163860      ELSE                                                        00163860
163870         COMPUTE FATOR-JUR-CAP-PF-F4 ROUNDED =                    00163870
163880                FATOR-JUR-CAP-PF-F4 * (1 + W09508-VR-ID-ECF / 100)00163880
163890     ELSE                                                         00163890
163900        MOVE '** P04808 ERRO ACESSO TABELA SIEF 62 **'            00163900
163910              TO MENSAGEM-ERRO-WS                                 00163910
163920        DISPLAY W09508-CD-ID-ECF                                  00163920
163930        DISPLAY W09508-DT-REF-CNS                                 00163930
163940        DISPLAY W09508-CD-RET-ROT                                 00163940
163950        DISPLAY W09508-DE-MSG-RET                                 00163950
163960        DISPLAY W09508-SQLCODE                                    00163960
163970        PERFORM 999-99-ROT-ERRO.                                  00163970
163980                                                                  00163980
163990     IF W09508-VR-ID-ECF EQUAL ZEROS                              00163990
164000        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00164000
164010        DISPLAY '*******************************************'     00164010
164020        DISPLAY '** P04808 - FATOR CH.ESPECIAL EH ZEROS   **'     00164020
164030        DISPLAY '** DATA-FERIADO      '  DATA-SIEF-WS             00164030
164040        DISPLAY '** FATOR CH.ESPEC. F4'  W09508-VR-ID-ECF         00164040
164050        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00164050
164060        DISPLAY '**           GILSON 299.3629             **'     00164060
164070        DISPLAY '*******************************************'.    00164070
164080                                                                  00164080
164090     MOVE 048             TO W09508-CD-SIS-SLT.                   00164090
164100     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00164100
164110     MOVE 27              TO W09508-CD-ID-ECF.                    00164110
164120     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00164120
164130     CALL 'P09511' USING W09508-AREA-SIEF.                        00164130
164140     IF W09508-CD-RET-ROT = '**'                                  00164140
164150      IF W09508-CD-TP-ID EQUAL 2                                  00164150
164160         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00164160
164170         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00164170
164180                                           DIV-SIEF-WS            00164180
164190         COMPUTE FATOR-JUR-CAP-PF-F5 ROUNDED =                    00164190
164200                FATOR-JUR-CAP-PF-F5 * (1 + W09508-VR-ID-ECF / 100)00164200
164210      ELSE                                                        00164210
164220         COMPUTE FATOR-JUR-CAP-PF-F5 ROUNDED =                    00164220
164230                FATOR-JUR-CAP-PF-F5 * (1 + W09508-VR-ID-ECF / 100)00164230
164240     ELSE                                                         00164240
164250        MOVE '** P04808 ERRO ACESSO TABELA SIEF 63 **'            00164250
164260              TO MENSAGEM-ERRO-WS                                 00164260
164270        DISPLAY W09508-CD-ID-ECF                                  00164270
164280        DISPLAY W09508-DT-REF-CNS                                 00164280
164290        DISPLAY W09508-CD-RET-ROT                                 00164290
164300        DISPLAY W09508-DE-MSG-RET                                 00164300
164310        DISPLAY W09508-SQLCODE                                    00164310
164320        PERFORM 999-99-ROT-ERRO.                                  00164320
164330                                                                  00164330
164340     IF W09508-VR-ID-ECF EQUAL ZEROS                              00164340
164350        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00164350
164360        DISPLAY '*******************************************'     00164360
164370        DISPLAY '** P04808 - FATOR CH.ESPECIAL EH ZEROS   **'     00164370
164380        DISPLAY '** DATA-FERIADO      '  DATA-SIEF-WS             00164380
164390        DISPLAY '** FATOR CH.ESPEC. F5'  W09508-VR-ID-ECF         00164390
164400        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00164400
164410        DISPLAY '**           GILSON 299.3629             **'     00164410
164420        DISPLAY '*******************************************'.    00164420
164430                                                                  00164430
164440*------------------------------------------------------------     00164440
164450     MOVE 048             TO W09508-CD-SIS-SLT.                   00164450
164460     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00164460
164470     MOVE 29              TO W09508-CD-ID-ECF.                    00164470
164480     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00164480
164490     CALL 'P09511' USING W09508-AREA-SIEF.                        00164490
164500     IF W09508-CD-RET-ROT = '**'                                  00164500
164510      IF W09508-CD-TP-ID EQUAL 2                                  00164510
164520         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00164520
164530         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00164530
164540                                            DIV-SIEF-WS           00164540
164550         COMPUTE FATOR-JUR-CAP-CE-WS ROUNDED =                    00164550
164560               FATOR-JUR-CAP-CE-WS * (1 + W09508-VR-ID-ECF / 100) 00164560
164570      ELSE                                                        00164570
164580         COMPUTE FATOR-JUR-CAP-CE-WS ROUNDED =                    00164580
164590               FATOR-JUR-CAP-CE-WS * (1 + W09508-VR-ID-ECF / 100) 00164590
164600     ELSE                                                         00164600
164610        MOVE '** P04808 ERRO ACESSO TABELA SIEF 64 **'            00164610
164620              TO MENSAGEM-ERRO-WS                                 00164620
164630        DISPLAY W09508-CD-ID-ECF                                  00164630
164640        DISPLAY W09508-DT-REF-CNS                                 00164640
164650        DISPLAY W09508-CD-RET-ROT                                 00164650
164660        DISPLAY W09508-DE-MSG-RET                                 00164660
164670        DISPLAY W09508-SQLCODE                                    00164670
164680        PERFORM 999-99-ROT-ERRO.                                  00164680
164690                                                                  00164690
164700     IF W09508-VR-ID-ECF EQUAL ZEROS                              00164700
164710        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00164710
164720        DISPLAY '*******************************************'     00164720
164730        DISPLAY '** P04808 - FATOR CTA.EMPRESA EH ZEROS   **'     00164730
164740        DISPLAY '** DATA-FERIADO      '  DATA-SIEF-WS             00164740
164750        DISPLAY '** FATOR CTA.EMPRESA '  W09508-VR-ID-ECF         00164750
164760        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00164760
164770        DISPLAY '**           GILSON 299.3629             **'     00164770
164780        DISPLAY '*******************************************'.    00164780
164790                                                                  00164790
*******    IAC1-INDICE DE ATRASO DE CREDITO
*******    CORRIGIR ALTERNATIVAMENTE CONTRATOS EM ATRASO
164800     MOVE 048             TO W09508-CD-SIS-SLT.                   00164800
164810     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00164810
164820     MOVE 121             TO W09508-CD-ID-ECF.                    00164820
164830     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00164830
164840     CALL 'P09511' USING W09508-AREA-SIEF.                        00164840
164850     IF W09508-CD-RET-ROT = '**'                                  00164850
164860      IF W09508-CD-TP-ID EQUAL 2                                  00164860
164870         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00164870
164880         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00164880
164890                                            DIV-SIEF-WS           00164890
164900         MOVE W09508-VR-ID-ECF TO VR-IAC-PRIMEIRO-FERIADO-WS      00164900
164910      ELSE                                                        00164910
164920         MOVE W09508-VR-ID-ECF TO VR-IAC-PRIMEIRO-FERIADO-WS      00164920
164930     ELSE                                                         00164930
164940        MOVE '** P04808 ERRO ACESSO TABELA SIEF 65 **'            00164940
164950              TO MENSAGEM-ERRO-WS                                 00164950
164960        DISPLAY W09508-CD-ID-ECF                                  00164960
164970        DISPLAY ' 999-80-ACESSA-SIEF-FERIADO. 1'                  00164970
164980        DISPLAY W09508-DT-REF-CNS                                 00164980
164990        DISPLAY W09508-CD-RET-ROT                                 00164990
165000        DISPLAY W09508-DE-MSG-RET                                 00165000
165010        DISPLAY W09508-SQLCODE                                    00165010
165020        PERFORM 999-99-ROT-ERRO.                                  00165020
165030                                                                  00165030
165040     IF  W09508-VR-ID-ECF EQUAL ZEROS                             00165040
165050         MOVE 1 TO SW-ERRO-FERIADO-TBTX                           00165050
165060         DISPLAY '*******************************************'    00165060
165070         DISPLAY '** P04808 - VALOR IAC ESTA ZERADO        **'    00165070
165080         DISPLAY '** DATA-FERIADO      ' DATA-SIEF-WS             00165080
165090         DISPLAY '** IAC               ' W09508-VR-ID-ECF         00165090
165100         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'    00165100
165110         DISPLAY '**           GILSON 299.3629             **'    00165110
165120         DISPLAY '*******************************************'.   00165120
165130                                                                  00165130
165140                                                                  00165140
165150     MOVE 048             TO W09508-CD-SIS-SLT.                   00165150
165160     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00165160
165170     MOVE 32              TO W09508-CD-ID-ECF.                    00165170
165180     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00165180
165190     CALL 'P09511' USING W09508-AREA-SIEF.                        00165190
165200     IF W09508-CD-RET-ROT = '**'                                  00165200
165210      IF W09508-CD-TP-ID EQUAL 2                                  00165210
165220         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00165220
165230         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00165230
165240                                            DIV-SIEF-WS           00165240
165250         MOVE W09508-VR-ID-ECF TO VR-ITAH-PRIMEIRO-FERIADO-WS     00165250
165260      ELSE                                                        00165260
165270         MOVE W09508-VR-ID-ECF TO VR-ITAH-PRIMEIRO-FERIADO-WS     00165270
165280     ELSE                                                         00165280
165290        MOVE '** P04808 ERRO ACESSO TABELA SIEF 66 **'            00165290
165300              TO MENSAGEM-ERRO-WS                                 00165300
165310        DISPLAY W09508-CD-ID-ECF                                  00165310
165320        DISPLAY ' 999-80-ACESSA-SIEF-FERIADO. 1'                  00165320
165330        DISPLAY W09508-DT-REF-CNS                                 00165330
165340        DISPLAY W09508-CD-RET-ROT                                 00165340
165350        DISPLAY W09508-DE-MSG-RET                                 00165350
165360        DISPLAY W09508-SQLCODE                                    00165360
165370        PERFORM 999-99-ROT-ERRO.                                  00165370
165380                                                                  00165380
165390     IF  W09508-VR-ID-ECF EQUAL ZEROS                             00165390
165400         MOVE 1 TO SW-ERRO-FERIADO-TBTX                           00165400
165410         DISPLAY '*******************************************'    00165410
165420         DISPLAY '** P04808 - VALOR IAC ESTA ZERADO        **'    00165420
165430         DISPLAY '** DATA-FERIADO      ' DATA-SIEF-WS             00165430
165440         DISPLAY '** ITAH              ' W09508-VR-ID-ECF         00165440
165450         DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'    00165450
165460         DISPLAY '**           GILSON 299.3629             **'    00165460
165470         DISPLAY '*******************************************'.   00165470
165480                                                                  00165480
165490     MOVE 048             TO W09508-CD-SIS-SLT.                   00165490
165500     MOVE 'P04808'        TO W09508-CD-PRG-SLT.                   00165500
165510     MOVE 31              TO W09508-CD-ID-ECF.                    00165510
165520     MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                   00165520
165530     CALL 'P09511' USING W09508-AREA-SIEF.                        00165530
165540     IF W09508-CD-RET-ROT = '**'                                  00165540
165550      IF W09508-CD-TP-ID EQUAL 2                                  00165550
165560         MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS                    00165560
165570         COMPUTE W09508-VR-ID-ECF ROUNDED = W09508-VR-ID-ECF /    00165570
165580                                            DIV-SIEF-WS           00165580
165590         MOVE W09508-VR-ID-ECF TO VR-ITAF-PRIMEIRO-FERIADO-WS     00165590
165600      ELSE                                                        00165600
165610         MOVE W09508-VR-ID-ECF TO VR-ITAF-PRIMEIRO-FERIADO-WS     00165610
165620     ELSE                                                         00165620
165630        MOVE '** P04808 ERRO ACESSO TABELA SIEF 67 **'            00165630
165640              TO MENSAGEM-ERRO-WS                                 00165640
165650        DISPLAY W09508-CD-ID-ECF                                  00165650
165660        DISPLAY ' 999-80-ACESSA-SIEF-FERIADO. 2'                  00165660
165670        DISPLAY W09508-DT-REF-CNS                                 00165670
165680        DISPLAY W09508-CD-RET-ROT                                 00165680
165690        DISPLAY W09508-DE-MSG-RET                                 00165690
165700        DISPLAY W09508-SQLCODE                                    00165700
165710        PERFORM 999-99-ROT-ERRO.                                  00165710
165720                                                                  00165720
165730     IF W09508-VR-ID-ECF EQUAL ZEROS                              00165730
165740        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00165740
165750        DISPLAY '*******************************************'     00165750
165760        DISPLAY '** P04808 - VALOR IAC  ESTA ZERADO       **'     00165760
165770        DISPLAY '** DATA-FERIADO      ' DATA-SIEF-WS              00165770
165780        DISPLAY '** ITAF              ' W09508-VR-ID-ECF          00165780
165790        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00165790
165800        DISPLAY '**           GILSON 299.3629             **'     00165800
165810        DISPLAY '*******************************************'.    00165810
165820                                                                  00165820
           MOVE ZEROS              TO FATOR-EXCESSO-PF-WS
           IF PRM-CALC-EXCESSO
165830        MOVE 048             TO W09508-CD-SIS-SLT.                00165830
165840        MOVE 'P04808'        TO W09508-CD-PRG-SLT.                00165840
165850        MOVE 112             TO W09508-CD-ID-ECF.                 00165850
165860        MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                00165860
165870        CALL 'P09511' USING W09508-AREA-SIEF.                     00165870
165880        IF W09508-CD-RET-ROT = '**'                               00165880
165890           IF W09508-CD-TP-ID EQUAL 2                             00165890
165900              MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS               00165900
165910              COMPUTE W09508-VR-ID-ECF ROUNDED =
165910                      W09508-VR-ID-ECF / DIV-SIEF-WS
165930              COMPUTE FATOR-EXCESSO-PF-WS ROUNDED =
165930                      W09508-VR-ID-ECF / 100
165940           ELSE                                                   00165940
165950              COMPUTE FATOR-EXCESSO-PF-WS ROUNDED =
                            W09508-VR-ID-ECF / 100
165960        ELSE                                                      00165960
165970           MOVE '** P04808 ERRO ACESSO TABELA SIEF 68 **'         00165970
165980                 TO MENSAGEM-ERRO-WS                              00165980
165990           DISPLAY W09508-CD-ID-ECF                               00165990
166000           DISPLAY W09508-DT-REF-CNS                              00166000
166010           DISPLAY W09508-CD-RET-ROT                              00166010
166020           DISPLAY W09508-DE-MSG-RET                              00166020
166030           DISPLAY W09508-SQLCODE                                 00166030
166040           PERFORM 999-99-ROT-ERRO.                               00166040
166050                                                                  00166050
166060     IF W09508-VR-ID-ECF EQUAL ZEROS                              00166060
166070        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00166070
166080        DISPLAY '*******************************************'     00166080
166090        DISPLAY '** P04808 - VALOR IAC  ESTA ZERADO       **'     00166090
166100        DISPLAY '** DATA-FERIADO      ' DATA-SIEF-WS              00166100
166110        DISPLAY '** FATOR EXCESSO PF  ' W09508-VR-ID-ECF          00166110
166120        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00166120
166130        DISPLAY '**           GILSON 299.3629             **'     00166130
166140        DISPLAY '*******************************************'.    00166140
166150                                                                  00166150
           MOVE ZEROS              TO FATOR-EXCESSO-CE-WS
                                      FATOR-EXCESSO-PJ-WS
           IF PRM-CALC-EXCESSO
166160        MOVE 048             TO W09508-CD-SIS-SLT.                00166160
166170        MOVE 'P04808'        TO W09508-CD-PRG-SLT.                00166170
166180        MOVE 113             TO W09508-CD-ID-ECF.                 00166180
166190        MOVE DATA-SIEF-WS    TO W09508-DT-REF-CNS.                00166190
166200        CALL 'P09511' USING W09508-AREA-SIEF.                     00166200
166210        IF W09508-CD-RET-ROT = '**'                               00166210
166220           IF W09508-CD-TP-ID EQUAL 2                             00166220
166230              MOVE W09508-NR-DIV-ATZ TO DIV-SIEF-WS               00166230
166240              COMPUTE W09508-VR-ID-ECF ROUNDED =
                            W09508-VR-ID-ECF / DIV-SIEF-WS
166260              COMPUTE FATOR-EXCESSO-CE-WS ROUNDED =
                            W09508-VR-ID-ECF / 100
166270              COMPUTE FATOR-EXCESSO-PJ-WS ROUNDED =
166270                      W09508-VR-ID-ECF / 100
166280           ELSE
166290              COMPUTE FATOR-EXCESSO-CE-WS ROUNDED =
                            W09508-VR-ID-ECF / 100
166300              COMPUTE FATOR-EXCESSO-PJ-WS ROUNDED =
                            W09508-VR-ID-ECF / 100
166310        ELSE                                                      00166310
166320           MOVE '** P04808 ERRO ACESSO TABELA SIEF 69 **'         00166320
166330                 TO MENSAGEM-ERRO-WS                              00166330
166340           DISPLAY W09508-CD-ID-ECF                               00166340
166350           DISPLAY W09508-DT-REF-CNS                              00166350
166360           DISPLAY W09508-CD-RET-ROT                              00166360
166370           DISPLAY W09508-DE-MSG-RET                              00166370
166380           DISPLAY W09508-SQLCODE                                 00166380
166390           PERFORM 999-99-ROT-ERRO.                               00166390
166400                                                                  00166400
166410     IF W09508-VR-ID-ECF EQUAL ZEROS                              00166410
166420        MOVE 1 TO SW-ERRO-FERIADO-TBTX                            00166420
166430        DISPLAY '*******************************************'     00166430
166440        DISPLAY '** P04808 - VALOR IAC  ESTA ZERADO       **'     00166440
166450        DISPLAY '** DATA-FERIADO      ' DATA-SIEF-WS              00166450
166460        DISPLAY '** FATOR EXCESSO PJ  ' W09508-VR-ID-ECF          00166460
166470        DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **'     00166470
166480        DISPLAY '**           GILSON 299.3629             **'     00166480
166490        DISPLAY '*******************************************'.    00166490
166500                                                                  00166500
166510 999-85-DECREMENTA-DATA.                                          00166510
166520                                                                  00166520
166530     MOVE 08            TO W091CL-TP-OPER.                        00166530
166540     MOVE 001           TO W091CL-CD-AG-REQ.                      00166540
166550     MOVE DATA-ONTEM-WS TO W091CL-DT-INFOR-1.                     00166550
166560     MOVE 1             TO W091CL-QT-DIA-REQ.                     00166560
166570     CALL 'P09102' USING W091CL-REGISTRO.                         00166570
166580     MOVE 1             TO W091CL-ST-ARQ-RES.                     00166580
166590     IF W091CL-STATUS-RES EQUAL '**'                              00166590
166600        MOVE W091CL-DD-RES-2-3 TO DIA-SIEF-WS ULT-DIA-PROC-WS     00166600
166610        MOVE W091CL-MM-RES-2-3 TO MES-SIEF-WS                     00166610
166620        MOVE W091CL-AA-RES-2-3 TO ANO-SIEF-WS                     00166620
166630     ELSE                                                         00166630
166640       IF W091CL-STATUS-RES EQUAL ' '                             00166640
166650          MOVE W091CL-MENSAGEM TO MENSAGEM-ERRO-WS                00166650
166660          PERFORM 999-99-ROT-ERRO                                 00166660
166670       ELSE                                                       00166670
166680          MOVE '* P04808 - SUB-ROTINA P09102 CANCELADA *' TO      00166680
166690               MENSAGEM-ERRO-WS                                   00166690
166700          PERFORM 999-99-ROT-ERRO.                                00166700
166710                                                                  00166710
166720 999-90-CAPITALIZACAO-TAXAS.                                      00166720
166740                                                                  00166740
166750     COMPUTE FATOR-JUR-CAP-CE-WS = (FATOR-JUR-CAP-CE-WS * 1)      00166750
166760                                    - 1.                          00166760
166770     COMPUTE FATOR-JUR-CAP-PJ-WS = (FATOR-JUR-CAP-PJ-WS * 1)      00166770
166780                                    - 1.                          00166780
166790     COMPUTE FATOR-JUR-CAP-PJ-F1 = (FATOR-JUR-CAP-PJ-F1 * 1)      00166790
166800                                    - 1.                          00166800
166810     COMPUTE FATOR-JUR-CAP-PJ-F2 = (FATOR-JUR-CAP-PJ-F2 * 1)      00166810
166820                                    - 1.                          00166820
166830     COMPUTE FATOR-JUR-CAP-PJ-F3 = (FATOR-JUR-CAP-PJ-F3 * 1)      00166830
166840                                    - 1.                          00166840
166850     COMPUTE FATOR-JUR-CAP-PJ-F4 = (FATOR-JUR-CAP-PJ-F4 * 1)      00166850
166860                                    - 1.                          00166860
166870     COMPUTE FATOR-JUR-CAP-PJ-PP-F1 =                             00166870
166880            (FATOR-JUR-CAP-PJ-PP-F1 * 1) - 1.                     00166880
166890     COMPUTE FATOR-JUR-CAP-PJ-PP-F2 =                             00166890
166900            (FATOR-JUR-CAP-PJ-PP-F2 * 1) - 1.                     00166900
166910     COMPUTE FATOR-JUR-CAP-PJ-PP-F3 =                             00166910
166920            (FATOR-JUR-CAP-PJ-PP-F3 * 1) - 1.                     00166920
166930     COMPUTE FATOR-JUR-CAP-PJ-PP-F4 =                             00166930
166940            (FATOR-JUR-CAP-PJ-PP-F4 * 1) - 1.                     00166940
166950                                                                  00166950
166960     COMPUTE FATOR-JUR-CAP-PF-WS = (FATOR-JUR-CAP-PF-WS * 1)      00166960
166970                                     - 1.                         00166970
166980     COMPUTE FATOR-JUR-CAP-PF-F1 = (FATOR-JUR-CAP-PF-F1 * 1)      00166980
166990                                     - 1.                         00166990
167000     COMPUTE FATOR-JUR-CAP-PF-F2 = (FATOR-JUR-CAP-PF-F2 * 1)      00167000
167010                                     - 1.                         00167010
167020     COMPUTE FATOR-JUR-CAP-PF-F3 = (FATOR-JUR-CAP-PF-F3 * 1)      00167020
167030                                     - 1.                         00167030
167040     COMPUTE FATOR-JUR-CAP-PF-F4 = (FATOR-JUR-CAP-PF-F4 * 1)      00167040
167050                                     - 1.                         00167050
167060     COMPUTE FATOR-JUR-CAP-PF-F5 = (FATOR-JUR-CAP-PF-F5 * 1)      00167060
167070                                     - 1.                         00167070
167080                                                                  00167080
167100     IF  NOT HOUVE-ERRO-FERIADO-TBTX                              00167100
167110         COMPUTE FATOR-INSUF-CAP-PJ-WS =                          00167110
167120             (VR-IAC-ATL-WS / VR-IAC-PRIMEIRO-FERIADO-WS) - 1     00167120
167130         IF FATOR-INSUF-CAP-PJ-WS LESS ZEROS                      00167130
167140            MOVE 1 TO SW-ERRO-FERIADO-TBTX                        00167140
167150            DISPLAY '*******************************************' 00167150
167160            DISPLAY '**P04808 - FATOR INSUFICIENCIA CAPITALIZADO' 00167160
167170            DISPLAY '**         P.JURIDICA ESTAH NEGATIVO     **' 00167170
167180            DISPLAY '**DATA-MOVIMENTO - '  CH-DATA-D07            00167180
167190            DISPLAY '**DATA-FERIADO   - '  DTA-PRIMEIRO-FERIADO-WS00167190
167200            DISPLAY '**IAC-DAY-NEXT   - '  VR-IAC-ATL-WS          00167200
167210            DISPLAY '**IAC-FERIADO      '                         00167210
167220                       VR-IAC-PRIMEIRO-FERIADO-WS                 00167220
167230            DISPLAY '**FATOR-CAPITALIZADO '  FATOR-INSUF-CAP-PJ-WS00167230
167240            DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **' 00167240
167250            DISPLAY '**           GILSON 299.3629             **' 00167250
167260            DISPLAY '*******************************************'.00167260
167270                                                                  00167270
167300     IF  NOT HOUVE-ERRO-FERIADO-TBTX                              00167300
167310         COMPUTE FATOR-INSUF-CAP-PF-WS =                          00167310
167320             (VR-IAC-ATL-WS / VR-IAC-PRIMEIRO-FERIADO-WS) - 1     00167320
167330         IF FATOR-INSUF-CAP-PF-WS LESS ZEROS                      00167330
167340            MOVE 1 TO SW-ERRO-FERIADO-TBTX                        00167340
167350            DISPLAY '*******************************************' 00167350
167360            DISPLAY '**P04808 - FATOR INSUFICIENCIA CAPITALIZADO' 00167360
167370            DISPLAY '**         P.FISICA   ESTAH NEGATIVO     **' 00167370
167380            DISPLAY '**DATA-MOVIMENTO - '  CH-DATA-D07            00167380
167390            DISPLAY '**DATA-FERIADO   - '  DTA-PRIMEIRO-FERIADO-WS00167390
167400            DISPLAY '**IAC-DAY-NEXT   - '  VR-IAC-ATL-WS          00167400
167410            DISPLAY '**IAC-FERIADO      '                         00167410
167420                       VR-IAC-PRIMEIRO-FERIADO-WS                 00167420
167430            DISPLAY '**FATOR-CAPITALIZADO '  FATOR-INSUF-CAP-PF-WS00167430
167440            DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **' 00167440
167450            DISPLAY '**           GILSON 299.3629             **' 00167450
167460            DISPLAY '*******************************************'.00167460
167470                                                                  00167470
167480     IF  NOT HOUVE-ERRO-FERIADO-TBTX                              00167480
167490         COMPUTE FATOR-INSUF-EXC-PJ-WS =                          00167490
167500             (VR-IAC-ANT-WS / VR-IAC-PRIMEIRO-FERIADO-WS) - 1     00167500
167510         IF FATOR-INSUF-EXC-PJ-WS LESS ZEROS                      00167510
167520            MOVE 1 TO SW-ERRO-FERIADO-TBTX                        00167520
167530            DISPLAY '*******************************************' 00167530
167540            DISPLAY '**P04808 - FATOR INSUFICIENCIA CAPITALIZADO' 00167540
167550            DISPLAY '**         P/EXCESSO-PJ ESTAH NEGATIVO   **' 00167550
167560            DISPLAY '**DATA-MOVIMENTO - '  CH-DATA-D07            00167560
167570            DISPLAY '**DATA-FERIADO   - '  DTA-PRIMEIRO-FERIADO-WS00167570
167580            DISPLAY '**IAC-DO-DIA     - '  VR-IAC-ANT-WS          00167580
167590            DISPLAY '**IAC-FERIADO      '                         00167590
167600                       VR-IAC-PRIMEIRO-FERIADO-WS                 00167600
167610            DISPLAY '**FATOR-INSUF-DIA    '  FATOR-INSUF-EXC-PJ-WS00167610
167620            DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **' 00167620
167630            DISPLAY '**           GILSON 299.3629             **' 00167630
167640            DISPLAY '*******************************************'.00167640
167650                                                                  00167650
167660     IF  NOT HOUVE-ERRO-FERIADO-TBTX                              00167660
167670         COMPUTE FATOR-INSUF-EXC-PF-WS =                          00167670
167680             (VR-IAC-ANT-WS / VR-IAC-PRIMEIRO-FERIADO-WS) - 1     00167680
167690         IF FATOR-INSUF-EXC-PF-WS LESS ZEROS                      00167690
167700            MOVE 1 TO SW-ERRO-FERIADO-TBTX                        00167700
167710            DISPLAY '*******************************************' 00167710
167720            DISPLAY '**P04808 - FATOR INSUFICIENCIA CAPITALIZADO' 00167720
167730            DISPLAY '**         P/EXCESSO-PF ESTAH NEGATIVO   **' 00167730
167740            DISPLAY '**DATA-MOVIMENTO - '  CH-DATA-D07            00167740
167750            DISPLAY '**DATA-FERIADO   - '  DTA-PRIMEIRO-FERIADO-WS00167750
167760            DISPLAY '**IAC-DO-DIA     - '  VR-IAC-ANT-WS          00167760
167770            DISPLAY '**IAC-FERIADO     '                          00167770
167780                       VR-IAC-PRIMEIRO-FERIADO-WS                 00167780
167790            DISPLAY '**FATOR-INSUF-DIA    '  FATOR-INSUF-EXC-PF-WS00167790
167800            DISPLAY '** COMUNICAR AO AMB.NEGOCIOS FINANCEIROS **' 00167800
167810            DISPLAY '**           GILSON 299.3629             **' 00167810
167820            DISPLAY '*******************************************'.00167820
167830                                                                  00167830
       999-60-CALC-VENCT-EMP.

           MOVE DIA-D07-INV         TO W091CL-DD-INFOR-1.
           MOVE MES-D07-INV         TO W091CL-MM-INFOR-1.
           MOVE ANO-D07-INV         TO W091CL-AA-INFOR-1.
           ADD  1                   TO W091CL-AA-D-INF-1.

070316     IF MES-D07-INV  =  02    AND DIA-D07-INV  =  29
070316        MOVE W091CL-AA-INFOR-1 TO ANO-AUX-WS
070316        PERFORM 999-33C-TESTA-ANO-BISSEXTO
070316        IF NOT ANO-BISSEXTO
070316           MOVE 28             TO W091CL-DD-INFOR-1
070316        END-IF
070316     END-IF

           PERFORM 999-62-VALIDA-DIA-UTIL.

       999-62-VALIDA-DIA-UTIL.

           MOVE '01'         TO W091CL-TP-OPER.
           MOVE CH-CODAG-D07 TO W091CL-CD-AG-REQ.
           MOVE 1            TO W091CL-ST-ARQ-RES.
           CALL 'P09102'  USING W091CL-REGISTRO.
           PERFORM 999-95-TESTE-VALIDADE-RETORNO.
           IF RETORNO-SUBROT-OK
             IF (W091CL-VAL-RESP-1 = 'N')
             OR (W091CL-TP-FERIADO = 'UT')
                 MOVE W091CL-DD-INFOR-1 TO DIA-VENC-EMP-WS
                                           DIA-VENC-EMP-INV-WS
                 MOVE W091CL-MM-INFOR-1 TO MES-VENC-EMP-WS
                                           MES-VENC-EMP-INV-WS
                 MOVE W091CL-AA-INFOR-1 TO ANO-VENC-EMP-WS
                                           ANO-VENC-EMP-INV-WS
             ELSE
                PERFORM 999-64-CALC-DIA-UTIL-ANT.

       999-64-CALC-DIA-UTIL-ANT.

           MOVE '08'           TO W091CL-TP-OPER.
           MOVE 001            TO W091CL-CD-AG-REQ.
           MOVE 1              TO W091CL-QT-DIA-REQ.
           MOVE 1              TO W091CL-ST-ARQ-RES.
           CALL 'P09102' USING W091CL-REGISTRO.
           PERFORM 999-95-TESTE-VALIDADE-RETORNO.
           IF RETORNO-SUBROT-OK
              MOVE W091CL-DD-RES-2-3 TO DIA-VENC-EMP-WS
                                        DIA-VENC-EMP-INV-WS
              MOVE W091CL-MM-RES-2-3 TO MES-VENC-EMP-WS
                                        MES-VENC-EMP-INV-WS
              MOVE W091CL-AA-RES-2-3 TO ANO-VENC-EMP-WS
                                        ANO-VENC-EMP-INV-WS.
DOCINI****F* P04808/999-64-CALC-DIA-UTIL-ANT-DEVOL
DOCTXT* OBJETIVO
DOCTXT*   Identificar a ultima data util anterior ? data atual da
DOCTXT*   agencia sendo processada para efeito de calculo de
DOCTXT*   encargos de devolucao.
DOCTXT* OBSERVACOES
DOCTXT*   Os encargos de devolucao sao encargos calculados para serem
DOCTXT*   subtraidos dos encargos acumulados em "memoria". Se uma conta
DOCTXT*   ficou com saldo negativo e gerou um encargo, que ficou
DOCTXT*   armazenado no VSAM, mas a transacao que gerou o saldo devedor
DOCTXT*   foi cancelada (devolucao de cheques), entao o encargo nao
DOCTXT*   deve ser cobrado. Assim, precisa-se saber o dia util anterior
DOCTXT*   para se calcular o valor a ser subtraido do encargo.
DOCTXT*
DOCTXT*   Armazena o dia anterior nas variaveis:
DOCTXT*
DOCTXT*     DATA-SIEF-DEVOL-WS
DOCTXT*         DIA-SIEF-DEVOL-WS
DOCTXT*         MES-SIEF-DEVOL-WS
DOCTXT*         ANO-SIEF-DEVOL-WS
DOCEND******
       999-64-CALC-DIA-UTIL-ANT-DEVOL.

           MOVE DIA-ULT-AG-WS           TO W091CL-DD-INFOR-1
           MOVE MES-ULT-AG-WS           TO W091CL-MM-INFOR-1
           CALL 'M0952000'           USING ANO-ULT-AG-WS
                                           W091CL-AA-INFOR-1

           MOVE '08'                    TO W091CL-TP-OPER
           MOVE CH-CODAG-D07            TO W091CL-CD-AG-REQ
           MOVE 1                       TO W091CL-QT-DIA-REQ
           MOVE 1                       TO W091CL-ST-ARQ-RES
           CALL 'P09102' USING W091CL-REGISTRO.

           PERFORM 999-95-TESTE-VALIDADE-RETORNO
           IF RETORNO-SUBROT-OK
              MOVE W091CL-DD-RES-2-3    TO DIA-SIEF-DEVOL-WS
              MOVE W091CL-MM-RES-2-3    TO MES-SIEF-DEVOL-WS
              MOVE W091CL-AA-RES-2-3    TO ANO-SIEF-DEVOL-WS.

       999-60-CALC-VENCT-EMP-31-DIAS.

           MOVE DIA-D07-INV         TO W091CL-DD-INFOR-1.
           MOVE MES-D07-INV         TO W091CL-MM-INFOR-1.
           MOVE ANO-D07-INV         TO W091CL-AA-INFOR-1.
           MOVE '11'                TO W091CL-TP-OPER.
           MOVE CH-CODAG-D07        TO W091CL-CD-AG-REQ.
           MOVE 31                  TO W091CL-QT-DIA-REQ.
           CALL 'P09102' USING W091CL-REGISTRO.
069320     PERFORM 999-95-TESTE-VALIDADE-RETORNO.                       00069320
           IF RETORNO-SUBROT-OK
              MOVE W091CL-DD-RES-2-3 TO DIA-VENC-EMP-INV-31-WS
              MOVE W091CL-MM-RES-2-3 TO MES-VENC-EMP-INV-31-WS
              MOVE W091CL-AA-RES-2-3 TO ANO-VENC-EMP-INV-31-WS.

168460 999-95-TESTE-VALIDADE-RETORNO.                                   00168460
168470                                                                  00168470
168480     MOVE ZEROS TO SW-RETORNO-SUBROT                              00168480
168490     IF  W091CL-STATUS-RES EQUAL '**'                             00168490
168500         MOVE 1 TO SW-RETORNO-SUBROT                              00168500
168510     ELSE                                                         00168510
168520     IF  W091CL-STATUS-RES EQUAL '  '                             00168520
168530         DISPLAY '*** P04808  ERRO NA SUBROTINA - FORMATO DA REQUI00168530
168540-                'SICAO INVALIDA ***'                             00168540
168550         DISPLAY 'AGENCIA         = ' CH-AG-WS                    00168550
168560         DISPLAY 'CONTA           = ' CH-NUM-CONTA-WS             00168560
168570         DISPLAY 'CH-TPREG-D07    = ' CH-TPREG-D07                00168570
168580         DISPLAY 'W091CL-REGISTRO = ' W091CL-REGISTRO             00168580
168590         MOVE ZEROS TO SW-RETORNO-SUBROT                          00168590
168600         MOVE SPACES TO MENSAGEM-ERRO-WS                          00168600
168610         MOVE W091CL-STATUS-RES TO FILE-STATUS-WS                 00168610
168620         PERFORM 999-99-ROT-ERRO                                  00168620
168630     ELSE                                                         00168630
168640         DISPLAY '*** P04808  ERRO NA SUBROTINA -  PROBLEMAS  NO I00168640
168650-                'NTERFACE ***'                                   00168650
168660         DISPLAY 'AGENCIA         = ' CH-AG-WS                    00168660
168670         DISPLAY 'CONTA           = ' CH-NUM-CONTA-WS             00168670
168680         DISPLAY 'CH-TPREG-D07    = ' CH-TPREG-D07                00168680
168690         DISPLAY 'W091CL-REGISTRO = ' W091CL-REGISTRO             00168690
168700         MOVE ZEROS TO SW-RETORNO-SUBROT                          00168700
168710         MOVE SPACES TO MENSAGEM-ERRO-WS                          00168710
168720         MOVE W091CL-STATUS-RES TO FILE-STATUS-WS                 00168720
168730         PERFORM 999-99-ROT-ERRO.                                 00168730
168740                                                                  00168740
168750 999-96-ACESSA-SICAD.                                             00168750
168760     MOVE 0 TO SW-SICAD.                                          00168760
168770     IF ID-CPF-CGC-RED-WS EQUAL 2 OR IMPESSOAL                    00168770
168780        NEXT SENTENCE                                             00168780
168790     ELSE                                                         00168790
168800        PERFORM 999-96-ACESSA-DB2.                                00168800
168810                                                                  00168810
168820 999-96-ACESSA-DB2.                                               00168820
168830                                                                  00168830
168840     MOVE CH-AG-WS    TO CD-AG OF DCLV400TITC.                    00168840
168850     MOVE CH-CONTA-WS TO CD-CTA-COR OF DCLV400TITC.               00168850
168860     MOVE 1           TO SQ-TIT-CLI OF DCLV400TITC.               00168860
168870     EXEC SQL                                                     00168870
168880          SELECT CD_CLI                                           00168880
168890          INTO   :DCLV400TITC.CD-CLI                              00168890
168900          FROM   V400TITC                                         00168900
168910          WHERE  CD_AG      = :DCLV400TITC.CD-AG                  00168910
168920          AND    CD_CTA_COR = :DCLV400TITC.CD-CTA-COR             00168920
168930          AND    SQ_TIT_CLI = :DCLV400TITC.SQ-TIT-CLI             00168930
168940     END-EXEC.                                                    00168940
168950     IF SQLCODE = NOTFOUND                                        00168950
168960        DISPLAY 'NOTFOUND V400TITC'                               00168960
168970        DISPLAY 'AGENCIA/CONTA = ' CH-AG-WS CH-CONTA-WS           00168970
168980        MOVE 1 TO SW-SICAD                                        00168980
168990     ELSE                                                         00168990
169000     IF SQLCODE = 0 OR SQLCODE = -811                             00169000
169010        PERFORM 999-96-ACESSA-PFIS                                00169010
169020     ELSE                                                         00169020
169030        MOVE 'V400TITC'    TO VISAO-WS                            00169030
169040        MOVE '999-96-ACESSA-DB2' TO LOCAL-WS                      00169040
169050        MOVE 'SELECT'      TO TIPO-ACESSO-WS                      00169050
169060        PERFORM 99-ERRO-DB2.                                      00169060
169070                                                                  00169070
169080 999-96-ACESSA-PFIS.                                              00169080
169090                                                                  00169090
169100     MOVE CD-CLI OF DCLV400TITC TO CD-CLI OF DCLV400PFIS.         00169100
169110     EXEC SQL                                                     00169110
169120          SELECT (RTRIM(LTRIM(NR_CAR_IDT))),                      00169120
169130                 SG_ORG_EMS,                                      00169130
169140                 SG_UF_EMI,                                       00169140
169150                 (RTRIM(LTRIM(NR_OUT_DOC))),                      00169150
169160                 SG_EMS_OUT                                       00169160
169170          INTO :DCLV400PFIS.NR-CAR-IDT:IND-NR-CAR-IDT,            00169170
169180               :DCLV400PFIS.SG-ORG-EMS:IND-SG-ORG-EMS,            00169180
169190               :DCLV400PFIS.SG-UF-EMI:IND-SG-UF-EMI,              00169190
169200               :DCLV400PFIS.NR-OUT-DOC:IND-NR-OUT-DOC,            00169200
169210               :DCLV400PFIS.SG-EMS-OUT:IND-SG-EMS-OUT             00169210
169220          FROM  V400PFIS                                          00169220
169230          WHERE CD_CLI = :DCLV400PFIS.CD-CLI                      00169230
169240     END-EXEC.                                                    00169240
169250     IF SQLCODE = NOTFOUND                                        00169250
169260        DISPLAY 'NOTFOUND V400PFIS'                               00169260
169270        DISPLAY 'AGENCIA/CONTA = ' CH-AG-WS CH-CONTA-WS           00169270
169280        MOVE 1 TO SW-SICAD                                        00169280
169290     ELSE                                                         00169290
169300     IF SQLCODE = 0 OR SQLCODE = -811                             00169300
169310        IF (IND-NR-CAR-IDT IS NEGATIVE) OR                        00169310
169320           (NR-CAR-IDT OF DCLV400PFIS = 0) OR                     00169320
169330           (IND-SG-ORG-EMS IS NEGATIVE) OR                        00169330
169340           (IND-SG-UF-EMI IS NEGATIVE)                            00169340
169350           IF (IND-NR-OUT-DOC IS NEGATIVE) OR                     00169350
169360              (IND-SG-EMS-OUT IS NEGATIVE)                        00169360
169380              DISPLAY 'INCONSISTENCIA RG'                         00169380
169390              DISPLAY 'AGENCIA/CONTA = ' CH-AG-WS CH-CONTA-WS     00169390
169400              MOVE 1 TO SW-SICAD                                  00169400
169410           ELSE                                                   00169410
169420              PERFORM 999-96-VALIDA-DOC                           00169420
169430        ELSE                                                      00169430
169440           PERFORM 999-96-VALIDA-RG                               00169440
169450     ELSE                                                         00169450
169460        MOVE 'V400PFIS'    TO VISAO-WS                            00169460
169470        MOVE '999-96-ACESSA-PFIS' TO LOCAL-WS                     00169470
169480        MOVE 'SELECT'      TO TIPO-ACESSO-WS                      00169480
169490        PERFORM 99-ERRO-DB2.                                      00169490
169500                                                                  00169500
       999-96-ACESSA-V048HIST.                                          00169080

           MOVE CH-HIST-D07 TO CD-HST OF DCLV048HIST.

           EXEC SQL
                SELECT GP_FBB
                INTO   :DCLV048HIST.GP-FBB
                FROM   V048HIST
                WHERE  CD_HST = :DCLV048HIST.CD-HST
           END-EXEC.

           IF SQLCODE NOT = ZEROS
              IF SQLCODE = +100
                 DISPLAY '** HISTORICO NAO CADASTRADO = '
                             CH-HIST-D07
              END-IF
              MOVE  SQLCODE                    TO  COD-ERRO-WS
              MOVE  '999-96-ACESSA-V048HIST'   TO  LOCAL-WS
              MOVE  'V048HIST'                 TO  VISAO-WS
              MOVE  'SELECT'                   TO  TIPO-ACESSO-WS
              PERFORM 99-ERRO-DB2
           END-IF.

169510 999-96-VALIDA-RG.                                                00169510
169520                                                                  00169520
169530     EXEC SQL                                                     00169530
169540          SELECT LENGTH(RTRIM(LTRIM(NR_CAR_IDT)))                 00169540
169550          INTO :TAM-RG                                            00169550
169560          FROM  V400PFIS                                          00169560
169570          WHERE CD_CLI = :DCLV400PFIS.CD-CLI                      00169570
169580     END-EXEC.                                                    00169580
169590     IF SQLCODE NOT = ZEROS AND -811                              00169590
169600        MOVE 'V400PFIS'    TO VISAO-WS                            00169600
169610        MOVE '999-96-VALIDA-RG  ' TO LOCAL-WS                     00169610
169620        MOVE 'SELECT'      TO TIPO-ACESSO-WS                      00169620
169630        PERFORM 99-ERRO-DB2.                                      00169630
169640                                                                  00169640
169650     MOVE ZEROS TO IND-NUM.                                       00169650
169660     MOVE NR-CAR-IDT OF DCLV400PFIS TO RG-WS.                     00169660
169700                                                                  00169700
169710 999-96-VALIDA-DOC.                                               00169710
169720                                                                  00169720
169730     EXEC SQL                                                     00169730
169740          SELECT LENGTH(RTRIM(LTRIM(NR_OUT_DOC)))                 00169740
169750          INTO :TAM-RG                                            00169750
169760          FROM  V400PFIS                                          00169760
169770          WHERE CD_CLI = :DCLV400PFIS.CD-CLI                      00169770
169780     END-EXEC.                                                    00169780
169790     IF SQLCODE NOT = ZEROS AND -811                              00169790
169800        MOVE 'V400PFIS'    TO VISAO-WS                            00169800
169810        MOVE '999-96-VALIDA-DOC ' TO LOCAL-WS                     00169810
169820        MOVE 'SELECT'      TO TIPO-ACESSO-WS                      00169820
169830        PERFORM 99-ERRO-DB2.                                      00169830
169840                                                                  00169840
169850     MOVE ZEROS TO IND-NUM.                                       00169850
169860     MOVE NR-OUT-DOC OF DCLV400PFIS TO RG-WS.                     00169860
169900                                                                  00169900
169990 999-97-ABRE-TAB-UTILS.                                           00169990
170000                                                                  00170000
170010     OPEN INPUT TabUtils.                                         00170010
170020     IF STATUS-D01-WS EQUAL '00' OR '97'                          00170020
170030        MOVE 1 TO SW-Abertura-TabUtils                            00170030
170040     ELSE                                                         00170040
170050        MOVE STATUS-D01-WS TO FILE-STATUS-WS                      00170050
170060        MOVE '** P04808 ERRO DE ABERTURA DO TabUtils **'          00170060
170070              TO MENSAGEM-ERRO-WS                                 00170070
170080        PERFORM 999-99-ROT-ERRO.                                  00170080
170090                                                                  00170090
170150 999-98-FECHA-TAB-UTILS.                                          00170150
170160                                                                  00170160
170170     CLOSE TabUtils.                                              00170170
170180     IF STATUS-D01-WS NOT EQUAL '00'                              00170180
170190         MOVE STATUS-D01-WS TO FILE-STATUS-WS                     00170190
170200         MOVE '**P04808-ERRO NO FECHAMENTO DO TabUtils   ***'     00170200
170210               TO MENSAGEM-ERRO-WS                                00170210
170220         PERFORM 999-99-ROT-ERRO.                                 00170220
170230     MOVE 0 TO SW-Abertura-TabUtils.                              00170230
170240                                                                  00170240
DOCINI****F* P04808/999-99-ROT-ERRO
DOCTXT* OBJETIVO
DOCTXT*   Imprime na saida padrao o conteudo de MENSAGEM-ERRO-WS,
DOCTXT*   move COD-RETORNO-WS (1) para o RETURN-CODE, imprime mensagens
DOCTXT*   traduzindo erros comuns FILE-STATUS-WS para analise rapida em
DOCTXT*   casos de abend.
DOCEND******
170250 999-99-ROT-ERRO.                                                 00170250
170260                                                                  00170260
170270     DISPLAY MENSAGEM-ERRO-WS.                                    00170270
170280     DISPLAY 'FILE STATUS EH...' FILE-STATUS-WS.                  00170280
170290     MOVE COD-RETORNO-WS (1) TO RETURN-CODE.                      00170290
170300     DISPLAY 'RETURN CODE EH ..' COD-RETORNO-WS (1).              00170300
170310     DISPLAY 'MENSAGEM RETORNO EH .. ' MEN-RETORNO-WS (1).        00170310
170320     IF  FILE-STATUS-WS EQUAL '21'                                00170320
170330         DISPLAY 'CAUSA - ERRO DE SEQUENCIA DO ARQUIVO'           00170330
170340     ELSE                                                         00170340
170350     IF  FILE-STATUS-WS EQUAL '22'                                00170350
170360         DISPLAY 'CAUSA - CHAVE DUPLICADA NO ARQUIVO'             00170360
170370     ELSE                                                         00170370
170380     IF  FILE-STATUS-WS EQUAL '23'                                00170380
170390         DISPLAY 'CAUSA - REGISTRO NAO EXISTE NO ARQUIVO'         00170390
170400     ELSE                                                         00170400
170410     IF  FILE-STATUS-WS EQUAL '24'                                00170410
170420         DISPLAY 'CAUSA - VIOLACAO DE LIMITE (ARQ.VSAM INDEXADO)' 00170420
170430     ELSE                                                         00170430
170440     IF  FILE-STATUS-WS EQUAL '30'                                00170440
170450         DISPLAY 'CAUSA - VERIFICACAO DE DADOS, PARIDADE, ERRO DE 00170450
170460-                        'TRANSMISSAO'                            00170460
170470     ELSE                                                         00170470
170480     IF  FILE-STATUS-WS EQUAL '34'                                00170480
170490         DISPLAY 'CAUSA - VIOLACAO DE LIMITE POR ARQUIVO VSAM     00170490
170500-                        'SEQUENCIAL'                             00170500
170510     ELSE                                                         00170510
170520     IF  FILE-STATUS-WS EQUAL '90'                                00170520
170530         DISPLAY 'CAUSA - NAO EXISTE AREA DISPONIVEL NO CATALOGO' 00170530
170540     ELSE                                                         00170540
170550     IF  FILE-STATUS-WS EQUAL '91'                                00170550
170560         DISPLAY 'CAUSA - FALTA PASSWORD'                         00170560
170570     ELSE                                                         00170570
170580     IF  FILE-STATUS-WS EQUAL '92'                                00170580
170590         DISPLAY 'CAUSA - ERRO DE LOGICA'                         00170590
170600     ELSE                                                         00170600
170610     IF  FILE-STATUS-WS EQUAL '93'                                00170610
170620         DISPLAY 'CAUSA - RECURSO INVALIDO'                       00170620
170630     ELSE                                                         00170630
170640     IF  FILE-STATUS-WS EQUAL '94'                                00170640
170650         DISPLAY 'CAUSA - NENHUM CURRENT RECORD POINTER P/A       00170650
170660-                        'SEQUENCIA REQUERIDA'                    00170660
170670     ELSE                                                         00170670
170680     IF  FILE-STATUS-WS EQUAL '95'                                00170680
170690         DISPLAY 'CAUSA - ARQUIVO NAO TEM CLUSTER DEFINIDO OU'    00170690
170700         DISPLAY '        NOME EXTERNO ERRADO OU CARTAO DLBL'     00170700
170710         DISPLAY '        CONTEM ERRO NO NOME DO ARQUIVO'         00170710
170720     ELSE                                                         00170720
170730     IF  FILE-STATUS-WS EQUAL '96'                                00170730
170740         DISPLAY 'CAUSA - FALTA CARTAO DLBL'.                     00170740
170750                                                                  00170750
170760     IF  FLAG-ArqContasBase-Aberto                                00170760
170770         CLOSE ArqContasBase.                                     00170770
170780
170790     IF  FLAG-ArqContasUpdate-Aberto
170800         CLOSE ArqContasUpdate.
170840
170820     IF  FLAG-ArqAgencias-Aberto
170830         CLOSE ArqContasBase.
170840
170850     IF  FLAG-ArqExtMesal-Aberto                                  00170850
170860         CLOSE ArqExtMensal.                                      00170860
170870                                                                  00170870
170880     IF  ABRIU-D04810                                             00170880
170890         CLOSE D04810.                                            00170890
170900                                                                  00170900
170910     IF  ABRIU-D04811                                             00170910
170920         CLOSE D04811.                                            00170920
170930                                                                  00170930
170940     IF  ABRIU-D04807                                             00170940
170950         CLOSE D04807.                                            00170950
170960                                                                  00170960
170970     IF  ABRIU-D0480701                                           00170970
170980         CLOSE D0480701.                                          00170980
170990                                                                  00170990
171000     IF  ABERTO-D83                                               00171000
171010         CLOSE D04883.                                            00171010
171020                                                                  00171020
171030     IF  ABERTO-D07B                                              00171030
171040         CLOSE D04807B.                                           00171040
171050                                                                  00171050
171060     IF  ABERTO-D128                                              00171060
171070         CLOSE D12802.                                            00171070
171080                                                                  00171080
171090     IF  ABRIU-D04819                                             00171090
171100         CLOSE D04819.                                            00171100
171110                                                                  00171110
171120     IF  ABRIU-D048CAN                                            00171120
171130         CLOSE D048CAN.                                           00171130
171140                                                                  00171140
171150     IF ABRIU-D15901                                              00171150
171160        CLOSE D15901.                                             00171160
171170                                                                  00171170
171180     IF ABRIU-D13002                                              00171180
171190        CLOSE D13002.                                             00171190
171200                                                                  00171200
171210     IF ABRIU-D04815                                              00171210
171220        CLOSE D04815.                                             00171220
171230                                                                  00171230
171240     IF ABRIU-D27030                                              00171240
171250        CLOSE D27030.                                             00171250
171260                                                                  00171260
171270     IF ABRIU-D30201                                              00171270
171280        CLOSE D30201.                                             00171280
171290                                                                  00171290
171300     GOBACK.                                                      00171300
171310                                                                  00171310
DOCINI****F* P04808/999-100-PERCENTUAL-UTILIZACAO
DOCTXT* OBJETIVO
DOCTXT*   Configurar a taxa de juros cobrada na utilizacao do cheque
DOCTXT*   especial.
DOCTXT*   Dado o saldo medio de aplicacoes que e calculado atraves da
DOCTXT*   soma dos saldos apresentados nos arquivos:
DOCTXT*   D270.A2028.SALDOS.MEDIOS.X,
DOCTXT*   D493.SALDO.MEDIO.CLIENTE.EX
DOCTXT*   D159.SALDOS.MEDIOS
DOCTXT*   D194.SALDOS.MEDIOS
DOCTXT*
DOCTXT*
DOCTXT*
DOCEND******
171320 999-100-PERCENTUAL-UTILIZACAO.                                   00171320
171340                                                                  00171340
171350     MOVE ZEROS TO UTILIZACAO-WS.                                 00171350
171360                                                                  00171360
171370     IF CLIENTE-PREFEREN                                          00171370
171380        COMPUTE UTILIZACAO-WS = (SLD-EMP-RED-WS / EMP-LIM-RED-WS) 00171380
171390                             * 100                                00171390
171400     ELSE                                                         00171400
171410        COMPUTE UTILIZACAO-WS = (SLD-DEV-NUM-WS / EMP-LIM-RED-WS) 00171410
171420                             * 100.                               00171420
171430                                                                  00171430
171440     IF NOT CLIENTE-PREFEREN                                      00171440
171450        IF (SLD-DEV-NUM-WS EQUAL ZEROS AND                        00171450
171460            JUROS-DIARIOS-WS NOT EQUAL ZEROS)                     00171460
171470           MOVE 100,00 TO UTILIZACAO-WS.                          00171470
171480                                                                  00171480
171490     IF CLIENTE-PREFEREN                                          00171490
171500        IF (SLD-EMP-RED-WS EQUAL ZEROS AND                        00171500
171510           JUROS-DIARIOS-WS NOT EQUAL ZEROS)                      00171510
171520           MOVE 100,00 TO UTILIZACAO-WS.                          00171520
171530                                                                  00171530
171550     IF P-FISICAS                                                 00171550
171560        PERFORM ACESSA-SM-APLICACAO                               00171560
171570        IF SALDO-MEDIO-APLIC-WS NOT LESS EMP-LIM-RED-WS           00171570
171580           IF SALDO-MEDIO-APLIC-WS LESS THAN 50000,01             00171580
171590              MOVE FATOR-JUR-PF-F3 TO FATOR-JUROS-PFISICA-WS      00171590
171600           ELSE                                                   00171600
171610              MOVE FATOR-JUR-PF-F4 TO FATOR-JUROS-PFISICA-WS      00171610
171620        ELSE                                                      00171620
171630           IF CTA-SALARIO                                         00171630
171640              MOVE FATOR-JUR-PF-F1 TO FATOR-JUROS-PFISICA-WS      00171640
171650            ELSE                                                  00171650
171660               IF FAIXA-1 OR FAIXA-2 OR FAIXA-3 OR FAIXA-4        00171660
171670                  MOVE FATOR-JUR-PF-F2 TO FATOR-JUROS-PFISICA-WS. 00171670
171680                                                                  00171680
171690      IF (P-JURIDICAS AND CH-EMPRESA)                             00171690
171700        IF FAIXA-1                                                00171700
171710           MOVE FATOR-JUR-PJ-F1      TO FATOR-JUROS-PJURIDICA-WS  00171710
171720        ELSE                                                      00171720
171730        IF FAIXA-2                                                00171730
171740           MOVE FATOR-JUR-PJ-F2      TO FATOR-JUROS-PJURIDICA-WS  00171740
171750        ELSE                                                      00171750
171760        IF FAIXA-3                                                00171760
171770           MOVE FATOR-JUR-PJ-F3      TO FATOR-JUROS-PJURIDICA-WS  00171770
171780        ELSE                                                      00171780
171790           MOVE FATOR-JUR-PJ-F4      TO FATOR-JUROS-PJURIDICA-WS. 00171790
171800                                                                  00171800
171810       IF (P-JURIDICAS AND CH-EMPRESA-PP)                         00171810
171820        IF FAIXA-1                                                00171820
171830           MOVE FATOR-JUR-PJ-PP-F1   TO FATOR-JUROS-PJ-PP-WS      00171830
171840        ELSE                                                      00171840
171850        IF FAIXA-2                                                00171850
171860           MOVE FATOR-JUR-PJ-PP-F2   TO FATOR-JUROS-PJ-PP-WS      00171860
171870        ELSE                                                      00171870
171880        IF FAIXA-3                                                00171880
171890           MOVE FATOR-JUR-PJ-PP-F3   TO FATOR-JUROS-PJ-PP-WS      00171890
171900        ELSE                                                      00171900
171910           MOVE FATOR-JUR-PJ-PP-F4   TO FATOR-JUROS-PJ-PP-WS.     00171910
171920                                                                  00171920
171930     MOVE ZEROS                      TO SALDO-MEDIO-APLIC-WS.     00171930
171940                                                                  00171940
       999-100-PERCENT-UTILIZ-DEVOL.

           MOVE ZEROS                  TO FATOR-JUROS-PFISICA-ANT-WS
                                          FATOR-JUROS-PJURIDICA-ANT-WS
                                          FATOR-JUROS-PJ-PP-ANT-WS


            MOVE ZEROS                 TO FATOR-JUR-PJ-F1-WS
                                          FATOR-JUR-PJ-F2-WS
                                          FATOR-JUR-PJ-F3-WS
                                          FATOR-JUR-PJ-F4-WS
                                          FATOR-JUR-PJ-PP-F1-WS
                                          FATOR-JUR-PJ-PP-F2-WS
                                          FATOR-JUR-PJ-PP-F3-WS
                                          FATOR-JUR-PJ-PP-F4-WS

                                          FATOR-JUR-PF-F1-WS
                                          FATOR-JUR-PF-F2-WS
                                          FATOR-JUR-PF-F3-WS
                                          FATOR-JUR-PF-F4-WS
                                          FATOR-JUR-PF-F5-WS

                                          FATOR-EXCESSO-PF-ANT-WS
                                          FATOR-EXCESSO-CE-ANT-WS
                                          FATOR-EXCESSO-PJ-ANT-WS
                                          FATOR-EXCESSO-CE-ANT-WS
                                          FATOR-EXCESSO-PJ-ANT-WS

           PERFORM 999-38-ACESSA-TAB-SIEF-DEVOL

           PERFORM 999-37A-TST-CONSISTENCIA-DEVOL

171550     IF P-FISICAS                                                 00171550
171560        PERFORM ACESSA-SM-APLICACAO                               00171560
171570        IF SALDO-MEDIO-APLIC-WS NOT LESS EMP-LIM-RED-WS           00171570
171580           IF SALDO-MEDIO-APLIC-WS LESS THAN 50000,01             00171580
171590              MOVE FATOR-JUR-PF-F3-WS TO                          00171590
171590                                       FATOR-JUROS-PFISICA-ANT-WS 00171590
171600           ELSE                                                   00171600
171610              MOVE FATOR-JUR-PF-F4-WS TO                          00171610
171610                                       FATOR-JUROS-PFISICA-ANT-WS 00171610
171620        ELSE                                                      00171620
171630           IF CTA-SALARIO                                         00171630
171640              MOVE FATOR-JUR-PF-F1-WS TO                          00171640
171640                                       FATOR-JUROS-PFISICA-ANT-WS 00171640
171650            ELSE                                                  00171650
171660               IF FAIXA-1 OR FAIXA-2 OR FAIXA-3 OR FAIXA-4        00171660
171670                  MOVE FATOR-JUR-PF-F2-WS TO                      00171670
171670                                       FATOR-JUROS-PFISICA-ANT-WS.00171670
171680                                                                  00171680
171690     IF (P-JURIDICAS AND CH-EMPRESA)                              00171690
171700        IF FAIXA-1                                                00171700
171710           MOVE FATOR-JUR-PJ-F1-WS TO FATOR-JUROS-PJURIDICA-ANT-WS00171710
171720        ELSE                                                      00171720
171730        IF FAIXA-2                                                00171730
171740           MOVE FATOR-JUR-PJ-F2-WS TO FATOR-JUROS-PJURIDICA-ANT-WS00171740
171750        ELSE                                                      00171750
171760        IF FAIXA-3                                                00171760
171770           MOVE FATOR-JUR-PJ-F3-WS TO FATOR-JUROS-PJURIDICA-ANT-WS00171770
171780        ELSE                                                      00171780
171790          MOVE FATOR-JUR-PJ-F4-WS TO FATOR-JUROS-PJURIDICA-ANT-WS.00171790
171800                                                                  00171800
171810     IF (P-JURIDICAS AND CH-EMPRESA-PP)                           00171810
171820        IF FAIXA-1                                                00171820
171830           MOVE FATOR-JUR-PJ-PP-F1-WS TO FATOR-JUROS-PJ-PP-ANT-WS 00171830
171840        ELSE                                                      00171840
171850        IF FAIXA-2                                                00171850
171860           MOVE FATOR-JUR-PJ-PP-F2-WS TO FATOR-JUROS-PJ-PP-ANT-WS 00171860
171870        ELSE                                                      00171870
171880        IF FAIXA-3                                                00171880
171890           MOVE FATOR-JUR-PJ-PP-F3-WS TO FATOR-JUROS-PJ-PP-ANT-WS 00171890
171900        ELSE                                                      00171900
171910           MOVE FATOR-JUR-PJ-PP-F4-WS TO FATOR-JUROS-PJ-PP-ANT-WS.00171910
171920                                                                  00171920
171930     MOVE ZEROS                      TO SALDO-MEDIO-APLIC-WS.     00171930
171940                                                                  00171940
171960 999-105-PERCENTUAL-UTIL-CAP.                                     00171960
171980                                                                  00171980
171990     MOVE ZEROS TO UTILIZACAO-WS.                                 00171990
172000                                                                  00172000
172010     IF CLIENTE-PREFEREN                                          00172010
172020        COMPUTE UTILIZACAO-WS = (SLD-EMP-RED-WS / EMP-LIM-RED-WS) 00172020
172030                               * 100                              00172030
172040     ELSE                                                         00172040
172050        COMPUTE UTILIZACAO-WS = (SLD-DEV-NUM-WS / EMP-LIM-RED-WS) 00172050
172060                               * 100.                             00172060
172070                                                                  00172070
172080     IF NOT CLIENTE-PREFEREN                                      00172080
172090        IF SLD-DEV-NUM-WS EQUAL ZEROS AND                         00172090
172100           JUROS-DIARIOS-WS NOT EQUAL ZEROS                       00172100
172110           MOVE 100,00 TO UTILIZACAO-WS.                          00172110
172120                                                                  00172120
172130     IF CLIENTE-PREFEREN                                          00172130
172140        IF SLD-EMP-RED-WS EQUAL ZEROS AND                         00172140
172150           JUROS-DIARIOS-WS NOT EQUAL ZEROS                       00172150
172160           MOVE 100,00 TO UTILIZACAO-WS.                          00172160
172170                                                                  00172170
172180     IF HA-FERIADO                                                00172180
172190        IF P-FISICAS                                              00172190
172200           PERFORM ACESSA-SM-APLICACAO                            00172200
172210           IF SALDO-MEDIO-APLIC-WS NOT LESS EMP-LIM-RED-WS        00172210
172220              IF SALDO-MEDIO-APLIC-WS LESS THAN 50000,01          00172220
172230                 MOVE FATOR-JUR-CAP-PF-F3 TO                      00172230
172240                                           FATOR-JUROS-PFISICA-WS 00172240
172250              ELSE                                                00172250
172260                 MOVE FATOR-JUR-CAP-PF-F4 TO                      00172260
172270                                           FATOR-JUROS-PFISICA-WS 00172270
172280        ELSE                                                      00172280
172290          IF CTA-SALARIO                                          00172290
172300             MOVE FATOR-JUR-CAP-PF-F1  TO FATOR-JUROS-PFISICA-WS  00172300
172310          ELSE                                                    00172310
172320            IF FAIXA-1 OR FAIXA-2 OR FAIXA-3 OR FAIXA-4           00172320
172330               MOVE FATOR-JUR-CAP-PF-F2 TO FATOR-JUROS-PFISICA-WS.00172330
172340                                                                  00172340
172350     IF HA-FERIADO                                                00172350
172360       IF (P-JURIDICAS AND CH-EMPRESA)                            00172360
172370        IF FAIXA-1                                                00172370
172380           MOVE FATOR-JUR-CAP-PJ-F1 TO FATOR-JUROS-PJURIDICA-WS   00172380
172390        ELSE                                                      00172390
172400        IF FAIXA-2                                                00172400
172410           MOVE FATOR-JUR-CAP-PJ-F2 TO FATOR-JUROS-PJURIDICA-WS   00172410
172420        ELSE                                                      00172420
172430        IF FAIXA-3                                                00172430
172440           MOVE FATOR-JUR-CAP-PJ-F3 TO FATOR-JUROS-PJURIDICA-WS   00172440
172450        ELSE                                                      00172450
172460           MOVE FATOR-JUR-CAP-PJ-F4 TO FATOR-JUROS-PJURIDICA-WS.  00172460
172470                                                                  00172470
172480     IF HA-FERIADO                                                00172480
172490       IF (P-JURIDICAS AND CH-EMPRESA-PP)                         00172490
172500        IF FAIXA-1                                                00172500
172510           MOVE FATOR-JUR-CAP-PJ-PP-F1 TO FATOR-JUROS-PJ-PP-WS    00172510
172520        ELSE                                                      00172520
172530        IF FAIXA-2                                                00172530
172540           MOVE FATOR-JUR-CAP-PJ-PP-F2 TO FATOR-JUROS-PJ-PP-WS    00172540
172550        ELSE                                                      00172550
172560        IF FAIXA-3                                                00172560
172570           MOVE FATOR-JUR-CAP-PJ-PP-F3 TO FATOR-JUROS-PJ-PP-WS    00172570
172580        ELSE                                                      00172580
172590           MOVE FATOR-JUR-CAP-PJ-PP-F4 TO FATOR-JUROS-PJ-PP-WS.   00172590
172620*                                                                 00172620
172630***************************************************************   00172630
172640*******  MODULO DE ACESSO AS TABELAS DB2                          00172640
172650***************************************************************   00172650
172660*                                                                 00172660
172670 ACESSA-SM-APLICACAO.                                             00172670
172680                                                                  00172680
172690     MOVE CPF-CGC-RED-WS     TO    CPF-CGC-WS.                    00172690
172700     PERFORM PROCESSA-DB2.                                        00172700
172710     PERFORM 999-107-PROCESSA-POUPANCAS.                          00172710
172720*                                                                 00172720
172730***************************************************************   00172730
172740*******  INICIO DA IMPLEMENTACAO DA PESQUISAS P/ ACUMULAR         00172740
172750***************************************************************   00172750
172760*                                                                 00172760
172770 PROCESSA-DB2.                                                    00172770
172780                                                                  00172780
172790     MOVE ZEROS         TO SALDO-MEDIO-APLIC-WS.                  00172790
172800                                                                  00172800
172810     MOVE NUM-CPF-WS    TO  NR-CGC-CPF  OF  DCLV400PESS.          00172810
172820     MOVE ZEROS         TO  NR-FIL-CGC  OF  DCLV400PESS.          00172820
172830     MOVE CONTROLE-WS   TO  DV-CGC-CPF  OF  DCLV400PESS.          00172830
172840                                                                  00172840
172850     EXEC SQL                                                     00172850
172860          DECLARE CLIENTES-CURSOR CURSOR FOR                      00172860
172870          SELECT CD_CLI,                                          00172870
172880                 CD_CLI_SCD                                       00172880
172890          FROM   V400PESS                                         00172890
172900          WHERE (NR_CGC_CPF = :DCLV400PESS.NR-CGC-CPF             00172900
172910          AND    DV_CGC_CPF = :DCLV400PESS.DV-CGC-CPF             00172910
172920          AND    NR_FIL_CGC = :DCLV400PESS.NR-FIL-CGC)            00172920
172930     END-EXEC.                                                    00172930
172940                                                                  00172940
172950     IF SQLCODE = 0 OR SQLCODE = -811                             00172950
172960        MOVE ZEROS TO SW-FIM-CLIENTE                              00172960
172970        PERFORM ABRE-CURSOR-CLIENTES                              00172970
172980        PERFORM PESQUISA-CURSOR-CLIENTES UNTIL FIM-CLIENTE        00172980
172990        PERFORM FECHA-CURSOR-CLIENTES                             00172990
173000     ELSE                                                         00173000
173010       IF SQLCODE = NOTFOUND                                      00173010
173020          NEXT SENTENCE                                           00173020
173030       ELSE                                                       00173030
173040          MOVE '400PESS'       TO VISAO-WS                        00173040
173050          MOVE 'PROCESSA-DB2'  TO LOCAL-WS                        00173050
173060          MOVE 'SELECT'        TO TIPO-ACESSO-WS                  00173060
173070          DISPLAY '****************************************'      00173070
173080          DISPLAY 'PROGRAMA SUSPENSO - ERRO ACESSO V400PESS'      00173080
173090          DISPLAY '****************************************'      00173090
173100          PERFORM 99-ERRO-DB2.                                    00173100
173110*                                                                 00173110
173120***************************************************************   00173120
173130**********  MODULO DE PESQUISA DA TABELA DE CLIENTES  *********   00173130
173140***************************************************************   00173140
173150 PESQUISA-CURSOR-CLIENTES.                                        00173150
173160                                                                  00173160
173170     EXEC SQL                                                     00173170
173180          FETCH CLIENTES-CURSOR                                   00173180
173190          INTO   :DCLV400PESS.CD-CLI,                             00173190
173200                 :DCLV400PESS.CD-CLI-SCD                          00173200
173210     END-EXEC.                                                    00173210
173220                                                                  00173220
173230     IF SQLCODE = ZEROS OR -811                                   00173230
173240        PERFORM PROCESSA-APLICACOES                               00173240
173250     ELSE                                                         00173250
173260       IF SQLCODE = NOTFOUND                                      00173260
173270          MOVE 1 TO SW-FIM-CLIENTE                                00173270
173280       ELSE                                                       00173280
173290         IF SQLCODE NOT = 0                                       00173290
173300            MOVE '400PESS'   TO VISAO-WS                          00173300
173310            MOVE 'PESQUISA-CURSOR-CLIENTES'  TO LOCAL-WS          00173310
173320            MOVE 'FETCH '    TO TIPO-ACESSO-WS                    00173320
173330            DISPLAY '****************************************'    00173330
173340            DISPLAY 'PROGRAMA SUSPENSO - ERRO FETCH  V400PESS'    00173340
173350            DISPLAY '****************************************'    00173350
173360            PERFORM 99-ERRO-DB2.                                  00173360
173370*                                                                 00173370
173380***************************************************************   00173380
173390*******  MODULO DE PROCESSAMENTO DA TABELA DE APLICACOES ******   00173390
173400***************************************************************   00173400
173410*                                                                 00173410
173420 PROCESSA-APLICACOES.                                             00173420
173430                                                                  00173430
173440     MOVE CD-CLI OF DCLV400PESS TO CD-CLI OF DCLV400TITC.         00173440
173450                                                                  00173450
173460     EXEC SQL                                                     00173460
173470          DECLARE CONTAS-CURSOR CURSOR FOR                        00173470
173480          SELECT CD_AG,                                           00173480
173490                 CD_CTA_COR                                       00173490
173500          FROM   V400TITC                                         00173500
173510          WHERE  CD_CLI     = :DCLV400TITC.CD-CLI                 00173510
173520     END-EXEC.                                                    00173520
173530                                                                  00173530
173540     IF SQLCODE = 0 OR SQLCODE = -811                             00173540
173550        MOVE ZEROS TO SW-FIM-CONTAS                               00173550
173560        PERFORM ABRE-CURSOR-CONTAS                                00173560
173570        PERFORM PESQUISA-CURSOR-CONTAS UNTIL FIM-CONTAS           00173570
173580        PERFORM FECHA-CURSOR-CONTAS                               00173580
173590     ELSE                                                         00173590
173600        IF SQLCODE = NOTFOUND                                     00173600
173610           NEXT SENTENCE                                          00173610
173620        ELSE                                                      00173620
173630           MOVE '400TITC'   TO VISAO-WS                           00173630
173640           MOVE '999-24A-PESQUISA-APLICACOES'  TO LOCAL-WS        00173640
173650           MOVE 'SELECT'    TO TIPO-ACESSO-WS                     00173650
173660           DISPLAY '****************************************'     00173660
173670           DISPLAY 'PROGRAMA SUSPENSO - ERRO ACESSO V400TITC'     00173670
173680           DISPLAY 'CLIENTE ....... '  CD-CLI OF DCLV400PESS      00173680
173690           DISPLAY '****************************************'     00173690
173700           PERFORM 99-ERRO-DB2.                                   00173700
173710*                                                                 00173710
173720***************************************************************   00173720
173730*******  MODULO DE PESQUISA DA TABELA DE CONTAS  **************   00173730
173740***************************************************************   00173740
173750*                                                                 00173750
173760 PESQUISA-CURSOR-CONTAS.                                          00173760
173770                                                                  00173770
173780     EXEC SQL                                                     00173780
173790          FETCH CONTAS-CURSOR                                     00173790
173800          INTO   :DCLV400TITC.CD-AG,                              00173800
173810                 :DCLV400TITC.CD-CTA-COR                          00173810
173820     END-EXEC.                                                    00173820
173830                                                                  00173830
173840     IF SQLCODE = ZEROS OR -811                                   00173840
173850        PERFORM ACHA-DIGITO-CTA                                   00173850
173860     ELSE                                                         00173860
173870       IF SQLCODE = NOTFOUND                                      00173870
173880          MOVE 1 TO SW-FIM-CONTAS                                 00173880
173890       ELSE                                                       00173890
173900         IF SQLCODE NOT = 0                                       00173900
173910            MOVE '400TITC'   TO VISAO-WS                          00173910
173920            MOVE 'PESQUISA-CURSOR-CONTAS' TO LOCAL-WS             00173920
173930            MOVE 'FETCH '    TO TIPO-ACESSO-WS                    00173930
173940            DISPLAY '****************************************'    00173940
173950            DISPLAY 'PROGRAMA SUSPENSO - ERRO FETCH  V400TITC'    00173950
173960            DISPLAY '****************************************'    00173960
173970            PERFORM 99-ERRO-DB2.                                  00173970
173980*                                                                 00173980
173990***************************************************************   00173990
174000*******  MODULO DE PESQUISA DA TABELA DE DIGITO ***************   00174000
174010***************************************************************   00174010
174020*                                                                 00174020
174030 ACHA-DIGITO-CTA.                                                 00174030
174040                                                                  00174040
174050     MOVE CD-AG      OF DCLV400TITC  TO CD-AG      OF DCLV400CTAD.00174050
174060     MOVE CD-CTA-COR OF DCLV400TITC  TO CD-CTA-COR OF DCLV400CTAD.00174060
174070                                                                  00174070
174080     EXEC SQL                                                     00174080
174090          SELECT DV_CTA_COR                                       00174090
174100          INTO   :DCLV400CTAD.DV-CTA-COR                          00174100
174110          FROM V400CTAD                                           00174110
174120          WHERE CD_AG      = :DCLV400CTAD.CD-AG                   00174120
174130          AND   CD_CTA_COR = :DCLV400CTAD.CD-CTA-COR              00174130
174140     END-EXEC.                                                    00174140
174150                                                                  00174150
174160     IF SQLCODE = ZEROS OR -811                                   00174160
174170        PERFORM 999-106-ACUMULA-SM-APLICACOES                     00174170
174180     ELSE                                                         00174180
174190       IF SQLCODE = NOTFOUND                                      00174190
174200          NEXT SENTENCE                                           00174200
174210       ELSE                                                       00174210
174220         IF SQLCODE NOT = 0                                       00174220
174230            MOVE '400CTAD'   TO VISAO-WS                          00174230
174240            MOVE 'ACHA-DIGITO-CTA' TO LOCAL-WS                    00174240
174250            MOVE 'SELECT'    TO TIPO-ACESSO-WS                    00174250
174260            DISPLAY '****************************************'    00174260
174270            DISPLAY 'PROGRAMA SUSPENSO - ERRO SELECT V400CTAD'    00174270
174280            DISPLAY '****************************************'    00174280
174290            PERFORM 99-ERRO-DB2.                                  00174290
174300                                                                  00174300
174310*                                                                 00174310
174320***************************************************************   00174320
174330**  MODULO QUE ACUMULA AS APLICACOES DOS CLIENTES P. FISICA  **   00174330
174340***************************************************************   00174340
174350*                                                                 00174350
174360 999-106-ACUMULA-SM-APLICACOES.                                   00174360
174370                                                                  00174370
174380     CALL 'M0952000' USING ANO-CORRENTE-WS  ANO-APLIC-WS          00174380
174390                                                                  00174390
174400     MOVE MES-CORRENTE-WS    TO MES-APLIC-WS.                     00174400
174410                                                                  00174410
174420     IF MES-APLIC-WS = 1                                          00174420
174430        COMPUTE ANO-APLIC-WS = ANO-APLIC-WS  - 1                  00174430
174440        MOVE 12              TO MES-APLIC-WS                      00174440
174450     ELSE                                                         00174450
174460        COMPUTE MES-APLIC-WS = MES-APLIC-WS  - 1.                 00174460
174470                                                                  00174470
174480     MOVE ANO-MES-APLIC-WS          TO ANO-MES-D28.               00174480
174490     MOVE CD-AG      OF DCLV400CTAD TO AGENCIA-D28.               00174490
174500     MOVE CD-CTA-COR OF DCLV400CTAD TO CLIENTE-D28.               00174500
174510                                                                  00174510
174520     READ D27028.                                                 00174520
174530     IF FS-D27028 EQUAL '23'                                      00174530
174540        NEXT SENTENCE                                             00174540
174550     ELSE                                                         00174550
174560        IF FS-D27028 EQUAL '00'                                   00174560
174570           COMPUTE SALDO-MEDIO-APLIC-WS = SALDO-MEDIO-APLIC-WS  + 00174570
174580                                          SALDO-MEDIO-FIF30-D28 + 00174580
174590                                          SALDO-MEDIO-FIF60-D28 + 00174590
174600                                          SALDO-MEDIO-FIFCP-D28 + 00174600
174610                                          SALDO-MEDIO-ACOES-D28 + 00174610
174620                                          SALDO-MEDIO-COMM-D28  + 00174620
174630                                          SALDO-MEDIO-RFCP-D28    00174630
174640        ELSE                                                      00174640
174650           MOVE  FS-D27028         TO FILE-STATUS-WS              00174650
174660           MOVE 'P04808 - ERRO NA LEITURA D27028 '                00174660
174670                                   TO MENSAGEM-ERRO-WS            00174670
174680           PERFORM  999-99-ROT-ERRO.                              00174680
174690                                                                  00174690
174700                                                                  00174700
174710        MOVE ANO-MES-APLIC-WS          TO  ANO-MES-D41.           00174710
174720        MOVE CD-AG      OF DCLV400CTAD TO  AG-D41.                00174720
174730        MOVE CD-CTA-COR OF DCLV400CTAD TO  CONTA-D41.             00174730
174740        MOVE DV-CTA-COR OF DCLV400CTAD TO  DV-CONTA-D41.          00174740
174750                                                                  00174750
174760        READ D86041.                                              00174760
174770        IF FS-D86041 EQUAL '23'                                   00174770
174780           NEXT SENTENCE                                          00174780
174790        ELSE                                                      00174790
174800           IF FS-D86041 EQUAL '00'                                00174800
174810              COMPUTE SALDO-MEDIO-APLIC-WS  =                     00174810
174820              SALDO-MEDIO-APLIC-WS          +                     00174820
174830              VLR-SALDO-MEDIO-D41                                 00174830
174840           ELSE                                                   00174840
174850              MOVE  FS-D86041         TO FILE-STATUS-WS           00174850
174860              MOVE 'P04808 - ERRO NA LEITURA D86041 '             00174860
174870                                      TO MENSAGEM-ERRO-WS         00174870
174880              PERFORM  999-99-ROT-ERRO.                           00174880
175110*                                                                 00175110
175120***************************************************************   00175120
175130******  MODULO QUE ACUMULA AS APLICACOES DE POUPANCAS *********   00175130
175140***************************************************************   00175140
175150*                                                                 00175150
175160  999-107-PROCESSA-POUPANCAS.                                     00175160
175170                                                                  00175170
175180     MOVE ZEROS            TO SW-FIM-WS AGENCIA-D15903            00175180
175190                              CONTA-D15903 DV-CONTA-D15903        00175190
175200                              DV-CPF-CGC-D15903 FILIAL-D15903.    00175200
175210                                                                  00175210
175220     MOVE NUM-CPF-WS                    TO CPF-CGC-D15903.        00175220
175230     MOVE ANO-APLIC-WS                  TO ANO-D15903.            00175230
175240     MOVE MES-APLIC-WS                  TO MES-D15903.            00175240
175250                                                                  00175250
175260                                                                  00175260
175270     START D15903 KEY NOT LESS CHAVE-D15903.                      00175270
175280                                                                  00175280
175290     IF FS-D15903 NOT EQUAL '00' AND '23' AND '10'                00175290
175300        DISPLAY 'CHAVE = ' CHAVE-D15903                           00175300
175310        MOVE  FS-D15903         TO FILE-STATUS-WS                 00175310
175320        MOVE 'P04808 - ERRO NO START D15903 '                     00175320
175330                                TO MENSAGEM-ERRO-WS               00175330
175340        PERFORM  999-99-ROT-ERRO.                                 00175340
175350                                                                  00175350
175370     IF FS-D15903 EQUAL ZEROS                                     00175370
175380        READ D15903 NEXT                                          00175380
175390        IF FS-D15903 EQUAL '10' OR '23'                           00175390
175400           MOVE 1 TO SW-FIM-WS                                    00175400
175410        ELSE                                                      00175410
175420           IF FS-D15903 NOT EQUAL '00'                            00175420
175430              MOVE  FS-D15903         TO FILE-STATUS-WS           00175430
175440              MOVE 'P04808 - ERRO NO READ NEXT D15903 '           00175440
175450                                      TO MENSAGEM-ERRO-WS         00175450
175460              PERFORM  999-99-ROT-ERRO                            00175460
175470          ELSE                                                    00175470
175480              PERFORM 999-108-PROCESSA-D15903 UNTIL FINAL-ARQUIVO 00175480
175490                          OR (CPF-CGC-D15903 NOT = NUM-CPF-WS)    00175490
175500                                                                  00175500
175510              MOVE ZEROS     TO SW-FIM-WS AGENCIA-D19401          00175510
175520                                CONTA-D19401 DV-CONTA-D19401      00175520
175530                                DV-CPF-CGC-D19401 FILIAL-D19401.  00175530
175540                                                                  00175540
175550     MOVE ANO-APLIC-WS                TO ANO-D19401.              00175550
175560     MOVE MES-APLIC-WS                TO MES-D19401.              00175560
175570     MOVE NUM-CPF-WS                  TO CPF-CGC-D19401.          00175570
175580                                                                  00175580
175590     START D19401 KEY NOT LESS CHAVE-D19401.                      00175590
175600                                                                  00175600
175610     IF FS-D19401 NOT EQUAL '00'                                  00175610
175620        MOVE  FS-D19401         TO FILE-STATUS-WS                 00175620
175630        MOVE 'P04808 - ERRO NO START D19401 '                     00175630
175640                                TO MENSAGEM-ERRO-WS               00175640
175650        PERFORM  999-99-ROT-ERRO.                                 00175650
175660                                                                  00175660
175670     READ D19401 NEXT.                                            00175670
175680                                                                  00175680
175690     IF FS-D19401 EQUAL '10' OR '23'                              00175690
175700        MOVE 1 TO SW-FIM-WS                                       00175700
175710     ELSE                                                         00175710
175720        IF FS-D19401 NOT EQUAL '00'                               00175720
175730           MOVE  FS-D19401         TO FILE-STATUS-WS              00175730
175740           MOVE 'P04808 - ERRO NO START D19401 '                  00175740
175750                                   TO MENSAGEM-ERRO-WS            00175750
175760           PERFORM  999-99-ROT-ERRO.                              00175760
175770                                                                  00175770
175780     PERFORM 999-107-PROCESSA-D19401 UNTIL FINAL-ARQUIVO OR       00175780
175790                        (CPF-CGC-D19401 NOT = NUM-CPF-WS).        00175790
175800*                                                                 00175800
175810***************************************************************   00175810
175820******  MODULO QUE ACUMULA AS APLICACOES DO D19401  ***********   00175820
175830***************************************************************   00175830
175840*                                                                 00175840
175850  999-107-PROCESSA-D19401.                                        00175850
175860                                                                  00175860
175870     IF ANO-APLIC-WS = ANO-D19401 AND MES-APLIC-WS = MES-D19401   00175870
175880        AND CPF-CGC-D19401 = NUM-CPF-WS                           00175880
175890                                                                  00175890
175900        COMPUTE SALDO-MEDIO-APLIC-WS = SALDO-MEDIO-APLIC-WS +     00175900
175910                                       SALDO-MEDIO-D19401.        00175910
175920                                                                  00175920
175930     READ D19401 NEXT.                                            00175930
175940                                                                  00175940
175950     IF FS-D19401 EQUAL '10' OR '23'                              00175950
175960        MOVE 1 TO SW-FIM-WS                                       00175960
175970     ELSE                                                         00175970
175980        IF FS-D19401 NOT EQUAL '00'                               00175980
175990           MOVE  FS-D19401         TO FILE-STATUS-WS              00175990
176000           MOVE 'P04808 - ERRO NO READ NEXT D19401 '              00176000
176010                                   TO MENSAGEM-ERRO-WS            00176010
176020           PERFORM  999-99-ROT-ERRO.                              00176020
176040*                                                                 00176040
176050***************************************************************   00176050
176060******  MODULO QUE ACUMULA AS APLICACOES DO D15903  ***********   00176060
176070***************************************************************   00176070
176080*                                                                 00176080
176090  999-108-PROCESSA-D15903.                                        00176090
176100                                                                  00176100
176110     IF ANO-APLIC-WS = ANO-D15903 AND MES-APLIC-WS = MES-D15903   00176110
176120                                                                  00176120
176130        COMPUTE SALDO-MEDIO-APLIC-WS = SALDO-MEDIO-APLIC-WS +     00176130
176140                                       SALDO-MEDIO-D15903.        00176140
176150                                                                  00176150
176160     READ D15903 NEXT.                                            00176160
176170                                                                  00176170
176180     IF FS-D15903 EQUAL '10' OR '23'                              00176180
176190        MOVE 1 TO SW-FIM-WS                                       00176190
176200     ELSE                                                         00176200
176210        IF FS-D15903 NOT EQUAL '00'                               00176210
176220           MOVE  FS-D15903         TO FILE-STATUS-WS              00176220
176230           MOVE 'P04808 - ERRO NO READ NEXT D15903 '              00176230
176240                                   TO MENSAGEM-ERRO-WS            00176240
176250           PERFORM  999-99-ROT-ERRO.                              00176250
************************************************************************
DOCINI****F* P04808/999-110-CALCULA-DIAS-VENCIDO
DOCTXT* OBJETIVO
DOCTXT*   Responsavel por calcular a quantidade de dias decorridos desde
DOCTXT*   o vencimento de um contrato de limite de credito ou
DOCTXT*   adiantamento.
DOCTXT*   Sempre faz o calculo com base em uma data especifica, casos
DOCTXT*   cobertos listados abaixo.
DOCTXT*
DOCTXT*     Cheque especial - Data do vencimento do contrato (EMP-VENC)
DOCTXT*     Adiantamento    - DATA-ADIANT-RED-WS, que e a data na qual
DOCTXT*                       o adiantamento comecou a ser contado
DOCTXT*                       efetivamente, mesmo que acontecido a dias
DOCTXT*                       atras.
DOCTXT*
DOCEND******
176280  999-110-CALCULA-DIAS-VENCIDO.                                   00176280
176290                                                                  00176290
176300     MOVE ZEROS TO QDE-DIAS-VENC-WS.                              00176300
176310                                                                  00176310
176320     IF EMP-LIM-RED-WS GREATER ZEROS                              00176320
176330        MOVE '09' TO W091CL-TP-OPER                               00176330
176340        MOVE 001             TO W091CL-CD-AG-REQ                  00176340
176350        MOVE EMP-VENC-RED-WS TO DATA-VENCIM-RED-WS                00176350
176360        MOVE DIA-VENCIM-WS   TO W091CL-DD-INFOR-1 DD-INFOR-1      00176360
176370        MOVE MES-VENCIM-WS   TO W091CL-MM-INFOR-1 MM-INFOR-1      00176370
176380        CALL 'M0952000' USING ANO-VENCIM-WS W091CL-AA-INFOR-1     00176380
176390        CALL 'M0952000' USING ANO-VENCIM-WS AA-INFOR-1            00176390
176400        MOVE DIA-D07-WS      TO W091CL-DD-INFOR-2 DD-INFOR-2      00176400
176410        MOVE MES-D07-WS      TO W091CL-MM-INFOR-2 MM-INFOR-2      00176410
176420        CALL 'M0952000' USING ANO-D07-WS W091CL-AA-INFOR-2        00176420
176430        CALL 'M0952000' USING ANO-D07-WS AA-INFOR-2               00176430
176440        IF (DT-INFOR-1 NOT LESS DT-INFOR-2)                       00176440
176450           MOVE ZEROS TO QDE-DIAS-VENC-WS                         00176450
176460        ELSE                                                      00176460
176470           MOVE 1 TO W091CL-ST-ARQ-RES                            00176470
176480           CALL 'P09102' USING W091CL-REGISTRO                    00176480
176490           PERFORM 999-95-TESTE-VALIDADE-RETORNO                  00176490
176500           IF RETORNO-SUBROT-OK                                   00176500
176510            MOVE W091CL-QT-DD-UTIL TO QDE-DIAS-VENC-WS            00176510
176520           ELSE                                                   00176520
176530            PERFORM 999-99-ROT-ERRO.                              00176530
176540                                                                  00176540
176550     IF EMP-LIM-RED-WS = ZEROS AND DATA-ADIANT-RED-WS NOT = ZEROS 00176550
176560        MOVE '09' TO W091CL-TP-OPER                               00176560
176570        MOVE 001             TO W091CL-CD-AG-REQ                  00176570
176580        MOVE DATA-ADIANT-RED-WS TO DATA-VENCIM-RED-WS             00176580
176590        MOVE DIA-VENCIM-WS   TO W091CL-DD-INFOR-1 DD-INFOR-1      00176590
176600        MOVE MES-VENCIM-WS   TO W091CL-MM-INFOR-1 MM-INFOR-1      00176600
176610        CALL 'M0952000' USING ANO-VENCIM-WS W091CL-AA-INFOR-1     00176610
176620        CALL 'M0952000' USING ANO-VENCIM-WS AA-INFOR-1            00176620
176630        MOVE DIA-D07-WS      TO W091CL-DD-INFOR-2 DD-INFOR-2      00176630
176640        MOVE MES-D07-WS      TO W091CL-MM-INFOR-2 MM-INFOR-2      00176640
176650        CALL 'M0952000' USING ANO-D07-WS W091CL-AA-INFOR-2        00176650
176660        CALL 'M0952000' USING ANO-D07-WS AA-INFOR-2               00176660
176670        IF (DT-INFOR-1 NOT LESS DT-INFOR-2)                       00176670
176680           MOVE ZEROS TO QDE-DIAS-VENC-WS                         00176680
176690        ELSE                                                      00176690
176700           MOVE 1 TO W091CL-ST-ARQ-RES                            00176700
176710           CALL 'P09102' USING W091CL-REGISTRO                    00176710
176720           PERFORM 999-95-TESTE-VALIDADE-RETORNO                  00176720
176730           IF RETORNO-SUBROT-OK                                   00176730
176740            MOVE W091CL-QT-DD-UTIL TO QDE-DIAS-VENC-WS            00176740
176750           ELSE                                                   00176750
176760            PERFORM 999-99-ROT-ERRO.                              00176760
176770                                                                  00176770
176780     IF EMP-LIM-RED-WS = ZEROS AND INS-NOVA-RED-WS NOT = ZEROS    00176780
176790      IF QDE-DIAS-VENC-WS EQUAL ZEROS                             00176790
176800        MOVE '09' TO W091CL-TP-OPER                               00176800
176810        MOVE 001             TO W091CL-CD-AG-REQ                  00176810
176820        MOVE INS-NOVA-RED-WS TO DATA-VENCIM-RED-WS                00176820
176830        MOVE DIA-VENCIM-WS   TO W091CL-DD-INFOR-1 DD-INFOR-1      00176830
176840        MOVE MES-VENCIM-WS   TO W091CL-MM-INFOR-1 MM-INFOR-1      00176840
176850        CALL 'M0952000' USING ANO-VENCIM-WS W091CL-AA-INFOR-1     00176850
176860        CALL 'M0952000' USING ANO-VENCIM-WS AA-INFOR-1            00176860
176870        MOVE DIA-D07-WS      TO W091CL-DD-INFOR-2 DD-INFOR-2      00176870
176880        MOVE MES-D07-WS      TO W091CL-MM-INFOR-2 MM-INFOR-2      00176880
176890        CALL 'M0952000' USING ANO-D07-WS W091CL-AA-INFOR-2        00176890
176900        CALL 'M0952000' USING ANO-D07-WS AA-INFOR-2               00176900
176910        IF (DT-INFOR-1 NOT LESS DT-INFOR-2)                       00176910
176920           MOVE ZEROS TO QDE-DIAS-VENC-WS                         00176920
176930        ELSE                                                      00176930
176940           MOVE 1 TO W091CL-ST-ARQ-RES                            00176940
176950           CALL 'P09102' USING W091CL-REGISTRO                    00176950
176960           PERFORM 999-95-TESTE-VALIDADE-RETORNO                  00176960
176970           IF RETORNO-SUBROT-OK                                   00176970
176980            MOVE W091CL-QT-DD-UTIL TO QDE-DIAS-VENC-WS            00176980
176990           ELSE                                                   00176990
177000            PERFORM 999-99-ROT-ERRO.                              00177000
      *--------------------------------------------------------------
       999-120-ACESSA-V048CCAD.

           MOVE CH-AG-WS       TO  CD-AG   OF  DCLV048CCAD
           MOVE CH-CONTA-WS    TO  NR-CTA  OF  DCLV048CCAD

           EXEC SQL
                SELECT
                       NR_GP_TAR
                INTO   :DCLV048CCAD.NR-GP-TAR
                       :INDR-V048CCAD.IND-NR-GP-TAR
                FROM   V048CCAD
                WHERE  CD_AG   =    :DCLV048CCAD.CD-AG
                AND    NR_CTA  =    :DCLV048CCAD.NR-CTA
                WITH UR
           END-EXEC.

           IF SQLCODE NOT = ZEROS AND +100
              MOVE 'V048CCAD'                TO VISAO-WS
              MOVE '999-120-ACESSA-V048CCAD' TO LOCAL-WS
              MOVE 'SELECT'                  TO TIPO-ACESSO-WS
              DISPLAY '***************************************'
              DISPLAY '**ERRO NO SELECT V048CCAD'
              PERFORM 99-ERRO-DB2
           ELSE
              IF (SQLCODE = +100)
              OR (IND-NR-GP-TAR OF INDR-V048CCAD IS NEGATIVE)
                  MOVE GRUPO-TARIFA-RED-WS  TO NR-GP-TAR OF DCLV048CCAD
              END-IF
           END-IF.
177010*--------------------------------------------------------------   00177010
177020 ABRE-CURSOR-CLIENTES.                                            00177020
177030                                                                  00177030
177040     EXEC SQL                                                     00177040
177050          OPEN CLIENTES-CURSOR                                    00177050
177060     END-EXEC.                                                    00177060
177070                                                                  00177070
177080     IF SQLCODE NOT = 0                                           00177080
177090        MOVE '400PESS'   TO VISAO-WS                              00177090
177100        MOVE 'ABRE-CURSOR-CLIENTES'  TO LOCAL-WS                  00177100
177110        MOVE 'OPEN  '    TO TIPO-ACESSO-WS                        00177110
177120        DISPLAY '****************************************'        00177120
177130        DISPLAY 'PROGRAMA SUSPENSO - ERRO OPEN   V400PESS'        00177130
177140        DISPLAY '****************************************'        00177140
177150        PERFORM 99-ERRO-DB2.                                      00177150
177160                                                                  00177160
177170 ABRE-CURSOR-CONTAS.                                              00177170
177180                                                                  00177180
177190     EXEC SQL                                                     00177190
177200          OPEN CONTAS-CURSOR                                      00177200
177210     END-EXEC.                                                    00177210
177220                                                                  00177220
177230     IF SQLCODE NOT = 0                                           00177230
177240        MOVE '400TITC'   TO VISAO-WS                              00177240
177250        MOVE '-ABRE-CURSOR-CONTAS'  TO LOCAL-WS                   00177250
177260        MOVE 'OPEN  '    TO TIPO-ACESSO-WS                        00177260
177270        DISPLAY '****************************************'        00177270
177280        DISPLAY 'PROGRAMA SUSPENSO - ERRO OPEN   V400TITC'        00177280
177290        DISPLAY '****************************************'        00177290
177300        PERFORM 99-ERRO-DB2.                                      00177300
177310                                                                  00177310
177320 FECHA-CURSOR-CLIENTES.                                           00177320
177330                                                                  00177330
177340      EXEC SQL                                                    00177340
177350           CLOSE CLIENTES-CURSOR                                  00177350
177360      END-EXEC.                                                   00177360
177370                                                                  00177370
177380      IF SQLCODE NOT = 0                                          00177380
177390         MOVE '400PESS'   TO VISAO-WS                             00177390
177400         MOVE 'FECHA-CURSOR-CLIENTES'  TO LOCAL-WS                00177400
177410         MOVE 'CLOSE '    TO TIPO-ACESSO-WS                       00177410
177420         DISPLAY '****************************************'       00177420
177430         DISPLAY 'PROGRAMA SUSPENSO - ERRO CLOSE  V400PESS'       00177430
177440         DISPLAY '****************************************'       00177440
177450         PERFORM 99-ERRO-DB2.                                     00177450
177460                                                                  00177460
177470 FECHA-CURSOR-CONTAS.                                             00177470
177480                                                                  00177480
177490      EXEC SQL                                                    00177490
177500           CLOSE CONTAS-CURSOR                                    00177500
177510      END-EXEC.                                                   00177510
177520                                                                  00177520
177530      IF SQLCODE NOT = 0                                          00177530
177540         MOVE '400TITC'   TO VISAO-WS                             00177540
177550         MOVE '-FECHA-CURSOR-CONTAS'  TO LOCAL-WS                 00177550
177560         MOVE 'CLOSE '    TO TIPO-ACESSO-WS                       00177560
177570         DISPLAY '****************************************'       00177570
177580         DISPLAY 'PROGRAMA SUSPENSO - ERRO CLOSE  V400TITC'       00177580
177590         DISPLAY '****************************************'       00177590
177600         PERFORM 99-ERRO-DB2.                                     00177600
177610                                                                  00177610
177620 SELECIONA-T048NMCT.                                              00177620
177630                                                                  00177630
177640     MOVE CH-AG-WS     TO CD-AG      OF DCLV048NMCT.              00177640
177650     MOVE CH-CONTA-WS  TO NR-CTA-COR OF DCLV048NMCT.              00177650
177660                                                                  00177660
177670     EXEC SQL                                                     00177670
177680          SELECT *                                                00177680
177690          INTO :DCLV048NMCT:IND-V048NMCT                          00177690
177700          FROM  V048NMCT                                          00177700
177710          WHERE CD_AG      = :DCLV048NMCT.CD-AG                   00177710
177720          AND   NR_CTA_COR = :DCLV048NMCT.NR-CTA-COR              00177720
177725          WITH UR                                                 00177725
177730     END-EXEC.                                                    00177730
177740                                                                  00177740
177750     IF  SQLCODE = ZEROS                                          00177750
177760          IF EXATLZA                                              00177760
177770             PERFORM ALTERA-T048NMCT                              00177770
177780          ELSE                                                    00177780
177790            NEXT SENTENCE                                         00177790
177800     ELSE                                                         00177800
177810     IF SQLCODE = NOTFOUND                                        00177810
177820        NEXT SENTENCE                                             00177820
177830     ELSE                                                         00177830
177840        MOVE '048NMCT'                   TO VISAO-WS              00177840
177850        MOVE 'SELECIONA-T048NMCT'        TO LOCAL-WS              00177850
177860        MOVE 'SELECT'                    TO TIPO-ACESSO-WS        00177860
177870        DISPLAY '********-------------------------*******'        00177870
177880        DISPLAY 'PROGRAMA SUSPENSO - ERRO ACESSO V048NMCT'        00177880
177890        DISPLAY 'AGENCIA........ ' CH-AG-WS                       00177890
177900        DISPLAY 'CONTA.......... ' CH-CONTA-WS                    00177900
177910        DISPLAY '********-------------------------*******'        00177910
177920        PERFORM 99-ERRO-DB2.                                      00177920
177930                                                                  00177930
177940  ALTERA-T048NMCT.                                                00177940
177950                                                                  00177950
177960     MOVE 1                TO ID-SIT-CTA-COR OF DCLV048NMCT.      00177960
177970     MOVE 1                TO ID-ST-CAD      OF DCLV048NMCT.      00177970
177980                                                                  00177980
177990     EXEC SQL                                                     00177990
178000          UPDATE V048NMCT                                         00178000
178010          SET    ID_SIT_CTA_COR  = :DCLV048NMCT.ID-SIT-CTA-COR,   00178010
178020                 ID_ST_CAD       = :DCLV048NMCT.ID-ST-CAD         00178020
178030          WHERE  CD_AG           = :DCLV048NMCT.CD-AG             00178030
178040          AND    NR_CTA_COR      = :DCLV048NMCT.NR-CTA-COR        00178040
178050     END-EXEC.                                                    00178050
178060                                                                  00178060
178070     IF SQLCODE NOT = ZEROS                                       00178070
178080        MOVE '048NMCT'                   TO VISAO-WS              00178080
178090        MOVE 'ALTERA-T048NMCT'           TO LOCAL-WS              00178090
178100        MOVE 'UPDATE'                    TO TIPO-ACESSO-WS        00178100
178110        DISPLAY '********-------------------------*******'        00178110
178120        DISPLAY 'PROGRAMA SUSPENSO - ERRO ALTERACAO V048NMCT'     00178120
178130        DISPLAY 'AGENCIA........ ' CH-AG-WS                       00178130
178140        DISPLAY 'CONTA.......... ' CH-CONTA-WS                    00178140
178150        DISPLAY '********-------------------------*******'        00178150
178160        PERFORM 99-ERRO-DB2.                                      00178160
178170                                                                  00178170
       99-ZERA-EXT-MOVIMENTOS-D10.

           ADD  1      TO IND-EXT-MOV.
           MOVE ZEROS  TO EXT-DIA-D10  (IND-EXT-MOV)
                          EXT-HIST-D10 (IND-EXT-MOV)
                          EXT-REF-D10  (IND-EXT-MOV)
                          EXT-VR-D10   (IND-EXT-MOV).

DOCINI****F* P04808/99-CALCULA-PROX-DIA-UTIL
DOCTXT* OBJETIVO
DOCTXT*   Calcula o proximo dia util para a agencia sendo processada.
DOCEND******
       99-CALCULA-PROX-DIA-UTIL.                                        00178180
           MOVE '02'               TO W091CL-TP-OPER.                   00178181
           MOVE CH-CODAG-D07       TO W091CL-CD-AG-REQ.                 00178182
           MOVE DIA-RODADA-PROC-WS TO W091CL-DD-INFOR-1.                00178183
           MOVE MES-RODADA-PROC-WS TO W091CL-MM-INFOR-1.                00178184
           MOVE ANO-RODADA-PROC-WS TO W091CL-AA-INFOR-1.                00178185
           MOVE 1                  TO W091CL-ST-ARQ-RES.                00178186
           CALL 'P09102' USING W091CL-REGISTRO.                         00178187
           PERFORM 999-95-TESTE-VALIDADE-RETORNO.                       00178188
           IF  RETORNO-SUBROT-OK                                        00178189
               MOVE W091CL-RESP-2-3 TO DATA-PROX-PROC-WS                00178190
           ELSE                                                         00178192
               PERFORM 999-99-ROT-ERRO.                                 00178193
DOCINI****F* P04808/99-CALCULA-QTD-DIAS-CORRIDOS
DOCTXT* OBJETIVO
DOCTXT*   Calcula a quantidade de dias corridos entre a data atual de
DOCTXT*   processamento e o proximo dia util.
DOCEND******
       99-CALCULA-QTD-DIAS-CORRIDOS.                                    00178194
           MOVE '09'               TO W091CL-TP-OPER.                   00178195
           MOVE CH-CODAG-D07       TO W091CL-CD-AG-REQ.                 00178196
           MOVE DIA-RODADA-PROC-WS TO W091CL-DD-INFOR-1.                00178197
           MOVE MES-RODADA-PROC-WS TO W091CL-MM-INFOR-1.                00178198
           MOVE ANO-RODADA-PROC-WS TO W091CL-AA-INFOR-1.                00178199
           MOVE W091CL-DD-RES-2-3  TO W091CL-DD-INFOR-2.                00178200
           MOVE W091CL-MM-RES-2-3  TO W091CL-MM-INFOR-2.                00178201
           MOVE W091CL-AA-RES-2-3  TO W091CL-AA-INFOR-2.                00178202
           MOVE 1                  TO W091CL-ST-ARQ-RES.                00178203
           CALL 'P09102' USING W091CL-REGISTRO.                         00178204
           PERFORM 999-95-TESTE-VALIDADE-RETORNO.                       00178205
           IF  RETORNO-SUBROT-OK                                        00178206
               MOVE W091CL-QT-DD-CORR TO QTDE-DIAS-CORRIDOS-WS          00178207
           ELSE                                                         00178208
               PERFORM 999-99-ROT-ERRO.                                 00178209
                                                                        00178214
       99-TESTA-DATAS-INSUF.

           MOVE ZEROS       TO DATA-MOV-INV-WS
                               DATA-ADIANT-RED-INV-WS.

           IF DATA-ADIANT-RED-WS > ZEROS
              MOVE DATA-MOV-WS         TO DATA-MOV-6-WS
              MOVE DIA-MOV-6-WS        TO DIA-MOV-INV-WS
              MOVE MES-MOV-6-WS        TO MES-MOV-INV-WS
              CALL 'M0952000' USING ANO-MOV-6-WS ANO-MOV-INV-WS
              MOVE DATA-ADIANT-RED-WS  TO DATA-ADIANT-RED-6-WS
              MOVE DIA-ADIANT-RED-6-WS TO DIA-ADIANT-RED-INV-WS
              MOVE MES-ADIANT-RED-6-WS TO MES-ADIANT-RED-INV-WS
              CALL 'M0952000' USING ANO-ADIANT-RED-6-WS
                                    ANO-ADIANT-RED-INV-WS
              IF ANOMES-ADIANT-RED-INV-WS LESS ANOMES-MOV-INV-WS
                 MOVE DIA-ADIANT-RED-INV-WS TO W091CL-DD-INFOR-1
                 MOVE MES-ADIANT-RED-INV-WS TO W091CL-MM-INFOR-1
                 MOVE ANO-ADIANT-RED-INV-WS TO W091CL-AA-INFOR-1
                 PERFORM 99-CALCULA-DATA-MOD-11
                 MOVE W091CL-DD-RES-2-3 TO DIA-ADIANT-RED-INV-WS
                 MOVE W091CL-MM-RES-2-3 TO MES-ADIANT-RED-INV-WS
                 MOVE W091CL-AA-RES-2-3 TO ANO-ADIANT-RED-INV-WS.

       99-CALCULA-DATA-MOD-11.

           MOVE '11'                  TO W091CL-TP-OPER.
           MOVE CH-AG-WS              TO W091CL-CD-AG-REQ
           MOVE 365                   TO W091CL-QT-DIA-REQ.
           CALL 'P09102' USING W091CL-REGISTRO.
           PERFORM 999-95-TESTE-VALIDADE-RETORNO.
           IF RETORNO-SUBROT-OK
              NEXT SENTENCE
           ELSE
              PERFORM 999-99-ROT-ERRO.

ACMF   99-VERIFICA-ISENCAO-IOF.

ACMF       MOVE NUM-CGC-AUX      TO NR-CGC-CPF  OF  DCLV400PESS
ACMF       MOVE FILIAL-AUX       TO NR-FIL-CGC  OF  DCLV400PESS
ACMF       MOVE CONTROLE-AUX     TO DV-CGC-CPF  OF  DCLV400PESS.
ACMF       EXEC SQL
ACMF            SELECT  DISTINCT ID_ISE_IOF
ACMF              INTO :DCLV400PESS.ID-ISE-IOF
ACMF              FROM  V400PESS
ACMF             WHERE  NR_CGC_CPF = :DCLV400PESS.NR-CGC-CPF
ACMF               AND  NR_FIL_CGC = :DCLV400PESS.NR-FIL-CGC
ACMF               AND  DV_CGC_CPF = :DCLV400PESS.DV-CGC-CPF
ACMF       END-EXEC.
ACMF       IF SQLCODE = ZEROS
ACMF          MOVE ID-ISE-IOF OF DCLV400PESS   TO CH-ISENTO-IOF
ACMF       ELSE
ACMF          IF SQLCODE = NOTFOUND
                 NEXT SENTENCE
              ELSE
ACMF             MOVE 'V400PESS'               TO VISAO-WS
ACMF             MOVE 'SELECT'                 TO TIPO-ACESSO-WS
ACMF             MOVE 'VERIFICA-ISENCAOI-IOF'  TO LOCAL-WS
ACMF             PERFORM 99-ERRO-DB2
              END-IF
           END-IF.
112030                                                                  00112030
       99-VER-SE-OPER-ISENTA-IOF.
           IF  COBRA-IOF
               MOVE ZEROS      TO  SW-OPER-ISENTA-IOF
           ELSE
               MOVE DIA-REC-WS     TO  DIA-OPER-IOF
               MOVE MES-REC-WS     TO  MES-OPER-IOF
               CALL 'M0952000' USING ANO-REC-WS ANO-OPER-IOF
               IF  (DT-INICIO-ISENCAO-IOF > DT-OPERACAO-IOF)
               OR  (DT-FIM-ISENCAO-IOF    < DT-OPERACAO-IOF)
                   MOVE ZEROS      TO  SW-OPER-ISENTA-IOF
               ELSE
                   MOVE 1          TO  SW-OPER-ISENTA-IOF
               END-IF
           END-IF.

       99-CALC-QT-DIAS-IOF.
           IF  ((DT-ULT-MOV-IOF NOT < DT-INICIO-ISENCAO-IOF)
           AND  (DT-ULT-MOV-IOF NOT > DT-FIM-ISENCAO-IOF))
           AND ((DT-MOV-ATUAL-IOF NOT < DT-INICIO-ISENCAO-IOF)
           AND  (DT-MOV-ATUAL-IOF NOT > DT-FIM-ISENCAO-IOF))
                   MOVE ZEROS      TO  QT-DIAS-IOF
           END-IF.

      *---------------------------*
       99-LE-TABFND-POR-CONTA.
      *---------------------------*
      * Pesquisar fundo de investimento

           MOVE CH-CONTA-WS            TO CC-CONTA-WS.
           MOVE CH-DIGITO-WS           TO DG-CONTA-WS.
           SET IND-FND  TO  1.
           SEARCH TAB-FUNDO VARYING  IND-FND
             AT END
                MOVE 0                 TO  SW-FUNDOS-FND
             WHEN CD-CC-TB(IND-FND) EQUAL CONTA-FUNDOS-WS
                MOVE 1                 TO  SW-FUNDOS-FND.

      *==============
       CARREGA-PARM.
      *==============

           DISPLAY '*** CARREGA-PARAM '
           MOVE 0                TO FLAG-DEBUG OF I048PARM-INTERFACE
           MOVE 'CALC_FATOR_EXCESSO'
                                 TO CD-PARM OF I048PARM-INTERFACE
           CALL 'P048PARM' USING I048PARM-INTERFACE
           IF CD-RETORNO OF I048PARM-INTERFACE = C048PARM-SUCESSO
              MOVE VALOR-RETORNO OF I048PARM-INTERFACE TO PARM-RETORNO
              IF PARM-SIM-NAO NOT EQUAL 'S' AND 'N'
                 DISPLAY 'ERRO: PARAMETRO EXCESSO = ' PARM-SIM-NAO
                 MOVE COD-RETORNO-WS (4) TO RETURN-CODE
                 GOBACK
              ELSE
                 MOVE PARM-SIM-NAO TO PARM-CALC-EXCESSO
                 DISPLAY '** PARM-CALC-EXCESSO ** ' PARM-SIM-NAO
              END-IF
           ELSE
              DISPLAY 'ERRO RETORNO: ' CD-RETORNO OF I048PARM-INTERFACE
              MOVE COD-RETORNO-WS (4) TO RETURN-CODE
              GOBACK
           END-IF

           MOVE 0                TO FLAG-DEBUG OF I048PARM-INTERFACE
           MOVE 'CALC_TX_IAC1'
                                 TO CD-PARM OF I048PARM-INTERFACE
           CALL 'P048PARM' USING I048PARM-INTERFACE
           IF CD-RETORNO OF I048PARM-INTERFACE = C048PARM-SUCESSO
              MOVE VALOR-RETORNO OF I048PARM-INTERFACE TO PARM-RETORNO
              IF PARM-SIM-NAO NOT EQUAL 'S' AND 'N'
                 DISPLAY 'ERRO: PARAMETRO TX-IAC1 = ' PARM-SIM-NAO
                 MOVE COD-RETORNO-WS (4) TO RETURN-CODE
                 GOBACK
              ELSE
                 MOVE PARM-SIM-NAO TO PARM-CALC-TX-IAC1
                 DISPLAY '** PARM-CALC-TX-IAC1 ** ' PARM-SIM-NAO
              END-IF
           ELSE
              DISPLAY 'ERRO RETORNO: ' CD-RETORNO OF I048PARM-INTERFACE
              MOVE COD-RETORNO-WS (4) TO RETURN-CODE
              GOBACK
           END-IF.

      ****F* P04808/ALTERA-CADASTRO-FUNCIONARIO
      * OBJETIVO
      *   Aplica regras de valida..o para o caso de funcion.rios e
      *   bolsistas. Caso as condi..es n.o sejam satisfeitas, o cadastro
      *   deve ser alterado para PF - Pessoa F.sica.
      ******
       ALTERA-CADASTRO-FUNCIONARIO.
           IF  TP-PESSOA-RED-WS = 'W' OR 'E'
      * Executa rotina de verifica..o de empregado apenas para
      * funcionarios e bolsistas
               COMPUTE I048VEMP-CD-LOT-PGT = CH-AG-WS
               COMPUTE I048VEMP-NR-CTA-COR = CH-CONTA-WS
               COMPUTE I048VEMP-DV-CTA-COR = CH-DIGITO-WS
               MOVE TP-PESSOA-RED-WS TO I048VEMP-CD-TP-PESS
               CALL 'P048VEMP' USING I048VEMP-INTERFACE
               IF  I048VEMP-RETORNO = CONS-VEMP-NAO-HA-VINCULO
                   MOVE 23             TO  C-CC-COD-MENS-D10
                   PERFORM 545-35-OCR-CAD-CC
                   MOVE CH-DATA-D07    TO  ATL-ULT-DT-RED-WS
                   MOVE 'F'            TO  TP-PESSOA-RED-WS
                   MOVE 24             TO  C-CC-COD-MENS-D10
                   PERFORM 545-35-OCR-CAD-CC
               END-IF
           END-IF.

      ****F* P04808/ALTERA-CADASTRO
      * OBJETIVO
      *   Aplica regras de validacao para o caso de clientes com cadas-
      *   especiais.
      ******
       ALTERA-CADASTRO.
           INITIALIZE I048VEMP-INTERFACE REPLACING NUMERIC BY ZEROS
                      ALPHANUMERIC BY SPACES
           COMPUTE I048VEMP-CD-LOT-PGT = CH-AG-WS
           COMPUTE I048VEMP-NR-CTA-COR = CH-CONTA-WS
           COMPUTE I048VEMP-DV-CTA-COR = CH-DIGITO-WS
           MOVE C-CC-TPPESSOA-D07 TO I048VEMP-CD-TP-PESS
           CALL 'P048VEMP' USING I048VEMP-INTERFACE.

178180 99-ERRO-DB2.                                                     00178215
178190                                                                  00178216
178200     MOVE 'P04808' TO PROGRAMA-WS.                                00178217
178210     MOVE SQLCODE  TO COD-ERRO-WS.                                00178218
178220     DISPLAY '**************************************************'.00178220
178230     DISPLAY '**                                              **'.00178230
178240     DISPLAY '**     P R O G R A M A   C A N C E L A D O      **'.00178240
178250     DISPLAY '**                                              **'.00178250
178260     DISPLAY '** ERRO ACESSO DB2 NO PROGRAMA ' PROGRAMA-WS   '**'.00178260
178270     DISPLAY '**                                              **'.00178270
178280     DISPLAY '** VISAO LOGICA -              ' VISAO-WS           00178280
178290     DISPLAY '** TIPO ACESSO  -              ' TIPO-ACESSO-WS     00178290
178300     DISPLAY '** SQLCODE      -              ' COD-ERRO-WS        00178300
178310     DISPLAY '** LOCAL        -              ' LOCAL-WS           00178310
178320     DISPLAY '**************************************************'.00178320
178330     CALL 'DSNTIAR' USING SQLCA ERROR-MESSAGE ERROR-TEXT-LEN.     00178330
178340     DISPLAY ERROR-TEXT (1).                                      00178340
178350     DISPLAY ERROR-TEXT (2).                                      00178350
178360     DISPLAY ERROR-TEXT (3).                                      00178360
178370     DISPLAY ERROR-TEXT (4).                                      00178370
178380     DISPLAY ERROR-TEXT (5).                                      00178380
178390     DISPLAY ERROR-TEXT (6).                                      00178390
178400     DISPLAY ERROR-TEXT (7).                                      00178400
178410     DISPLAY ERROR-TEXT (8).                                      00178410
178420     DISPLAY '**************************************************'.00178420
178430     MOVE 12 TO RETURN-CODE.                                      00178430
178440     GOBACK.                                                      00178440
178470***************** FIM DO PROGRAMA P04808  *********************   00178470
178470***************** FIM DO PROGRAMA P04808  *********************   00178470
178470***************** FIM DO PROGRAMA P04808  *********************   00178470
